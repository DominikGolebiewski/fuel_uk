[0m21:00:20.944754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8eaa210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8fd2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e92fb1a0>]}


============================== 21:00:20.951955 | f918d5aa-2af2-4fe0-b7ab-caae99178f6b ==============================
[0m21:00:20.951955 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:00:20.952631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:00:21.098081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f918d5aa-2af2-4fe0-b7ab-caae99178f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8d13a70>]}
[0m21:00:21.111536 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-dtlheftm'
[0m21:00:21.112018 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:00:21.155754 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:00:21.156396 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:00:21.166432 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:00:21.170132 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:00:21.402208 [info ] [MainThread]: Installed from version 1.2.0
[0m21:00:21.402744 [info ] [MainThread]: Up to date!
[0m21:00:21.403302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f918d5aa-2af2-4fe0-b7ab-caae99178f6b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8c343b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8bef410>]}
[0m21:00:21.404681 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.50804603, "process_user_time": 1.591879, "process_kernel_time": 0.124616, "process_mem_max_rss": "93076", "process_in_blocks": "5672", "process_out_blocks": "3840"}
[0m21:00:21.405295 [debug] [MainThread]: Command `dbt deps` succeeded at 21:00:21.405188 after 0.51 seconds
[0m21:00:21.405748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8eaa210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e992caa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ea0491f0>]}
[0m21:00:21.406251 [debug] [MainThread]: Flushing usage events
[0m21:00:23.183919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dc1a81a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dd3d3380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dc392000>]}


============================== 21:00:23.186764 | 00c5cfc1-e684-49c0-906a-b29bb090025b ==============================
[0m21:00:23.186764 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:00:23.187445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:00:23.415213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dc0e4e90>]}
[0m21:00:23.474418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dda0f440>]}
[0m21:00:23.475204 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m21:00:23.490414 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:00:23.491149 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:00:23.491712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d57772c0>]}
[0m21:00:24.708884 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:00:24.709588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d5469220>]}
[0m21:00:24.900557 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:00:24.906640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d5220ef0>]}
[0m21:00:25.063637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d543c380>]}
[0m21:00:25.064219 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m21:00:25.064727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d52214f0>]}
[0m21:00:25.066451 [info ] [MainThread]: 
[0m21:00:25.067153 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:00:25.071859 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:00:25.106617 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:00:25.107072 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m21:00:25.107491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:25.533862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.535472 [debug] [ThreadPool]: On list_petro: Close
[0m21:00:25.537697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:00:25.538306 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:00:25.545170 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:00:25.545622 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m21:00:25.546028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:25.551669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.553004 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:00:25.553420 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:00:25.554355 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.554771 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:00:25.555167 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:00:25.555787 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.556728 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:00:25.557140 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:00:25.557531 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:00:25.558081 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.558543 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:00:25.560517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:00:25.565802 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:00:25.566260 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:00:25.566658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:25.571509 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.571938 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:00:25.572351 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m21:00:25.591753 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.596342 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:00:25.597519 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:00:25.597944 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:00:25.601025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d53af7a0>]}
[0m21:00:25.601552 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:25.601958 [debug] [MainThread]: On master: BEGIN
[0m21:00:25.602392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:25.607369 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:00:25.607801 [debug] [MainThread]: On master: COMMIT
[0m21:00:25.608202 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:25.608598 [debug] [MainThread]: On master: COMMIT
[0m21:00:25.609227 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:00:25.609645 [debug] [MainThread]: On master: Close
[0m21:00:25.611134 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:00:25.611651 [info ] [MainThread]: 
[0m21:00:25.629868 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:00:25.630538 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:00:25.631196 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m21:00:25.631652 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:00:25.657029 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:00:25.657774 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:00:25.691987 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:00:25.692737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:00:37.006438 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.006974 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:00:37.007589 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.008051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.008503 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:00:37.009185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.011890 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.012361 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:00:37.013045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.033594 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:00:37.034080 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.034556 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:00:37.035771 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.040484 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.040979 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m21:00:37.042078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.044400 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:00:37.069529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dcc73530>]}
[0m21:00:37.070303 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.44s]
[0m21:00:37.071194 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:00:37.072178 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:00:37.072782 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:00:37.073387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:00:37.073844 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:00:37.078684 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:00:37.079322 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:00:37.112254 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.112768 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240621210037106502"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:00:37.113242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:37.127681 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.134525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.134996 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:00:37.135576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.136030 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.136477 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240621210037106502'
      
      
      order by ordinal_position

  
[0m21:00:37.162344 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.167218 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.167710 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:00:37.181680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.190310 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.190798 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:00:37.199027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.216831 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:00:37.217530 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.218011 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240621210037106502"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240621210037106502"
    )
  
[0m21:00:37.228272 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.230000 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:00:37.230512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.230950 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:00:37.239013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.239881 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:00:37.337164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a9155d60>]}
[0m21:00:37.337921 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.26s]
[0m21:00:37.338838 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:00:37.340252 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:37.340736 [debug] [MainThread]: On master: BEGIN
[0m21:00:37.341178 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:00:37.346468 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:00:37.346950 [debug] [MainThread]: On master: COMMIT
[0m21:00:37.347400 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:37.347832 [debug] [MainThread]: On master: COMMIT
[0m21:00:37.348517 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:00:37.348985 [debug] [MainThread]: On master: Close
[0m21:00:37.350436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:37.350885 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m21:00:37.351305 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:00:37.351781 [info ] [MainThread]: 
[0m21:00:37.352310 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.28 seconds (12.28s).
[0m21:00:37.353306 [debug] [MainThread]: Command end result
[0m21:00:37.380681 [info ] [MainThread]: 
[0m21:00:37.381296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:00:37.381810 [info ] [MainThread]: 
[0m21:00:37.382373 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:00:37.383343 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.24889, "process_user_time": 4.636834, "process_kernel_time": 0.333185, "process_mem_max_rss": "267884", "process_in_blocks": "1184", "process_out_blocks": "106080"}
[0m21:00:37.383989 [debug] [MainThread]: Command `dbt run` succeeded at 21:00:37.383881 after 14.25 seconds
[0m21:00:37.384482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dc8a5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dffbbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a92ff530>]}
[0m21:00:37.384977 [debug] [MainThread]: Flushing usage events
[0m21:03:40.897075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d6c7e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d6de24e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d90d1970>]}


============================== 21:03:41.039058 | 4ee9d8e9-8ad0-4fa2-8c2f-ebde5674a0c5 ==============================
[0m21:03:41.039058 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:03:41.039749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:03:41.183577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ee9d8e9-8ad0-4fa2-8c2f-ebde5674a0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d72db620>]}
[0m21:03:41.204192 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jpugovjm'
[0m21:03:41.204674 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:03:41.292975 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:03:41.293739 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:03:41.343759 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:03:41.347649 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:03:41.419490 [info ] [MainThread]: Installed from version 1.2.0
[0m21:03:41.420074 [info ] [MainThread]: Up to date!
[0m21:03:41.420722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4ee9d8e9-8ad0-4fa2-8c2f-ebde5674a0c5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d69d8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d7c9d160>]}
[0m21:03:41.422186 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5743885, "process_user_time": 1.673774, "process_kernel_time": 0.107344, "process_mem_max_rss": "93412", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m21:03:41.422796 [debug] [MainThread]: Command `dbt deps` succeeded at 21:03:41.422691 after 0.58 seconds
[0m21:03:41.423247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d70a1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d72db620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d6cc6030>]}
[0m21:03:41.423685 [debug] [MainThread]: Flushing usage events
[0m21:03:48.252082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ca83320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97d4d39b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ca83380>]}


============================== 21:03:48.254974 | 1aec2a5c-ad67-4921-bdce-de02a192cc9c ==============================
[0m21:03:48.254974 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:03:48.255634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:03:48.493316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ca128a0>]}
[0m21:03:48.556995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97d40c2c0>]}
[0m21:03:48.557920 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m21:03:48.573248 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:03:48.672329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:03:48.672812 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:03:48.678739 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:03:48.708459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97cab5490>]}
[0m21:03:48.811461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb975664b60>]}
[0m21:03:48.812056 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m21:03:48.812606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb975894890>]}
[0m21:03:48.814353 [info ] [MainThread]: 
[0m21:03:48.815109 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:03:48.819888 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:03:48.858279 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:03:48.858777 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m21:03:48.859191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:49.407276 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m21:03:49.408875 [debug] [ThreadPool]: On list_petro: Close
[0m21:03:49.411079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:03:49.411674 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:03:49.418628 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:49.419080 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m21:03:49.419505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:49.425044 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.426498 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:49.426921 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:03:49.427589 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.428007 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:49.428404 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:03:49.428984 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.429945 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:03:49.430358 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:49.430757 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:03:49.431403 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.431838 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:03:49.434039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:03:49.439375 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:03:49.439801 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:03:49.440190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:49.445060 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.445520 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:03:49.445932 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m21:03:49.465484 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.471882 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:03:49.473069 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:03:49.473539 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:03:49.477087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97e09d010>]}
[0m21:03:49.477646 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:49.478046 [debug] [MainThread]: On master: BEGIN
[0m21:03:49.478427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:03:49.483864 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:49.484302 [debug] [MainThread]: On master: COMMIT
[0m21:03:49.484700 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:49.485084 [debug] [MainThread]: On master: COMMIT
[0m21:03:49.485743 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:49.486160 [debug] [MainThread]: On master: Close
[0m21:03:49.487675 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:03:49.488187 [info ] [MainThread]: 
[0m21:03:49.497351 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:03:49.497998 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:03:49.498743 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m21:03:49.499201 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:03:49.525169 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:03:49.525842 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:03:49.560427 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:03:49.561093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:03:57.942719 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.943251 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:03:57.944049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.944517 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.944968 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:03:57.945850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.948538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.949008 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:03:57.949746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.970495 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:03:57.970989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.971442 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:03:57.972624 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.977398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.977898 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m21:03:57.979033 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.981351 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:03:58.006795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97d7872c0>]}
[0m21:03:58.007594 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.51s]
[0m21:03:58.008394 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:03:58.009419 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:03:58.009992 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:03:58.010603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:03:58.011066 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:03:58.027087 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:03:58.027753 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:03:58.061144 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.061699 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240621210358055298"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:03:58.062193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:58.076717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.083942 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.084424 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:03:58.085036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.085526 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.085980 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240621210358055298'
      
      
      order by ordinal_position

  
[0m21:03:58.112161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.117199 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.117746 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:03:58.126067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.134711 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.135209 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:03:58.144268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.162221 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:03:58.162913 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.163430 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240621210358055298"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240621210358055298"
    )
  
[0m21:03:58.173120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.174931 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:03:58.175394 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.175843 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:03:58.184638 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.185578 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:03:58.289503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb94918ae70>]}
[0m21:03:58.290341 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.28s]
[0m21:03:58.291215 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:03:58.292567 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:58.293054 [debug] [MainThread]: On master: BEGIN
[0m21:03:58.293538 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:03:58.298790 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:58.299279 [debug] [MainThread]: On master: COMMIT
[0m21:03:58.299731 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:58.300169 [debug] [MainThread]: On master: COMMIT
[0m21:03:58.300734 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:58.301201 [debug] [MainThread]: On master: Close
[0m21:03:58.302630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:58.303083 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m21:03:58.303503 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:03:58.303976 [info ] [MainThread]: 
[0m21:03:58.304538 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.49 seconds (9.49s).
[0m21:03:58.305627 [debug] [MainThread]: Command end result
[0m21:03:58.333134 [info ] [MainThread]: 
[0m21:03:58.333820 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:03:58.334371 [info ] [MainThread]: 
[0m21:03:58.334934 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:03:58.335956 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.135513, "process_user_time": 3.377523, "process_kernel_time": 0.335753, "process_mem_max_rss": "280980", "process_in_blocks": "1200", "process_out_blocks": "105520"}
[0m21:03:58.336600 [debug] [MainThread]: Command `dbt run` succeeded at 21:03:58.336490 after 10.14 seconds
[0m21:03:58.337097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97cef2ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ca83320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb94a31fc80>]}
[0m21:03:58.337616 [debug] [MainThread]: Flushing usage events
[0m21:04:00.088300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd45b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cce1b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd4584d0>]}


============================== 21:04:00.091191 | 6d0ff847-f120-4914-a5f6-f2722a0cfeb4 ==============================
[0m21:04:00.091191 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:04:00.091844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:04:00.237635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d0ff847-f120-4914-a5f6-f2722a0cfeb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd5f0da0>]}
[0m21:04:00.254043 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21470842, "process_user_time": 1.465699, "process_kernel_time": 0.091855, "process_mem_max_rss": "92004", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m21:04:00.254629 [debug] [MainThread]: Command `dbt clean` succeeded at 21:04:00.254526 after 0.22 seconds
[0m21:04:00.255073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd2f78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd45bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd45b500>]}
[0m21:04:00.255512 [debug] [MainThread]: Flushing usage events
[0m15:09:37.490422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104326750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037ff170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046130b0>]}


============================== 15:09:37.493033 | fed66eda-7429-4c22-9306-2773c8f8ba2e ==============================
[0m15:09:37.493033 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:09:37.493378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:09:37.701277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fed66eda-7429-4c22-9306-2773c8f8ba2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d39e0>]}
[0m15:09:37.732645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fed66eda-7429-4c22-9306-2773c8f8ba2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10410b710>]}
[0m15:09:37.733444 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:09:37.744055 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/dbt_packages/dbt_utils/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in /Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/dbt_packages/dbt_utils
[0m15:09:37.745972 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.29012808, "process_user_time": 0.71857, "process_kernel_time": 0.133344, "process_mem_max_rss": "107872256", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:09:37.746444 [debug] [MainThread]: Command `dbt run` failed at 15:09:37.746379 after 0.29 seconds
[0m15:09:37.746752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041faba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104799580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104798b00>]}
[0m15:09:37.746985 [debug] [MainThread]: Flushing usage events
[0m15:11:48.316480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106682660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e14560>]}


============================== 15:11:48.319149 | 77f6d568-f934-4241-9a39-46acf7cc7213 ==============================
[0m15:11:48.319149 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:11:48.319485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:11:48.526884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77f6d568-f934-4241-9a39-46acf7cc7213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052410d0>]}
[0m15:11:48.551648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77f6d568-f934-4241-9a39-46acf7cc7213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10527eae0>]}
[0m15:11:48.552292 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:11:48.562108 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/dbt_packages/dbt_utils/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in /Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/dbt_packages/dbt_utils
[0m15:11:48.564109 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.28322184, "process_user_time": 0.708596, "process_kernel_time": 0.1308, "process_mem_max_rss": "111247360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:11:48.564589 [debug] [MainThread]: Command `dbt run` failed at 15:11:48.564524 after 0.28 seconds
[0m15:11:48.564849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cead80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b59a90>]}
[0m15:11:48.565067 [debug] [MainThread]: Flushing usage events
[0m15:11:54.543031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10392b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10392b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ed6de0>]}


============================== 15:11:54.545602 | 3b954267-3675-4fc1-b015-363c1e0e1a6b ==============================
[0m15:11:54.545602 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:11:54.545929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:11:54.616551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b954267-3675-4fc1-b015-363c1e0e1a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c25910>]}
[0m15:11:54.631811 [debug] [MainThread]: Set downloads directory='/var/folders/dk/sk1h93cx0q3c33j8g4dmjgv00000gn/T/dbt-downloads-xyw8jbi1'
[0m15:11:54.632064 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:11:55.702442 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:11:55.704402 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:11:56.434403 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:11:56.438891 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:11:59.160325 [info ] [MainThread]: Installed from version 1.2.0
[0m15:11:59.161137 [info ] [MainThread]: Up to date!
[0m15:11:59.161602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3b954267-3675-4fc1-b015-363c1e0e1a6b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f92ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f92a80>]}
[0m15:11:59.163820 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.652415, "process_user_time": 0.705097, "process_kernel_time": 0.138505, "process_mem_max_rss": "97337344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:11:59.164473 [debug] [MainThread]: Command `dbt deps` succeeded at 15:11:59.164339 after 4.65 seconds
[0m15:11:59.164866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a24170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10027eb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033acbf0>]}
[0m15:11:59.165072 [debug] [MainThread]: Flushing usage events
[0m15:13:09.032599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106402e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106277170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b3290>]}


============================== 15:13:09.035383 | e664f550-bc85-44c4-ad5a-c7c71702bd6f ==============================
[0m15:13:09.035383 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:13:09.035752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:13:09.247374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e16a0>]}
[0m15:13:09.272326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ca300>]}
[0m15:13:09.272923 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:13:09.284722 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m15:13:09.285285 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:13:09.285512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a5400>]}
[0m15:13:09.885184 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:13:09.885535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b40e60>]}
[0m15:13:09.969854 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m15:13:09.972457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af02c0>]}
[0m15:13:10.050179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4fb90>]}
[0m15:13:10.050476 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m15:13:10.050654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d05400>]}
[0m15:13:10.051470 [info ] [MainThread]: 
[0m15:13:10.051739 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:13:10.053922 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m15:13:10.083910 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m15:13:10.084159 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m15:13:10.084318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:10.104530 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.105947 [debug] [ThreadPool]: On list_petro: Close
[0m15:13:10.107472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m15:13:10.107760 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m15:13:10.111347 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m15:13:10.111593 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m15:13:10.111755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:10.116361 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.117148 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m15:13:10.117315 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m15:13:10.117520 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.117660 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m15:13:10.117795 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m15:13:10.118653 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.119073 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m15:13:10.119212 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m15:13:10.119339 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m15:13:10.119516 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.119659 [debug] [ThreadPool]: On create_petro_main: Close
[0m15:13:10.120848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m15:13:10.123664 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m15:13:10.123885 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m15:13:10.124044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:10.127868 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.128149 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m15:13:10.128325 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m15:13:10.148635 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.153407 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m15:13:10.154334 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m15:13:10.154491 [debug] [ThreadPool]: On list_petro_main: Close
[0m15:13:10.156347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f321b0>]}
[0m15:13:10.156569 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:10.156714 [debug] [MainThread]: On master: BEGIN
[0m15:13:10.156839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:10.160194 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:13:10.160373 [debug] [MainThread]: On master: COMMIT
[0m15:13:10.160518 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:10.160646 [debug] [MainThread]: On master: COMMIT
[0m15:13:10.160814 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:13:10.160952 [debug] [MainThread]: On master: Close
[0m15:13:10.161762 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m15:13:10.161990 [info ] [MainThread]: 
[0m15:13:10.164565 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m15:13:10.164948 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m15:13:10.165197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m15:13:10.165372 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m15:13:10.178046 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m15:13:10.178794 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m15:13:10.195526 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m15:13:10.196250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:24.320349 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m15:13:24.321075 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m15:13:24.321459 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.321663 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m15:13:24.321859 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m15:13:24.322487 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.324161 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m15:13:24.324364 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m15:13:24.324670 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.335159 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m15:13:24.335377 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m15:13:24.335549 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m15:13:24.335890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.338125 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m15:13:24.338312 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m15:13:24.338844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.339989 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m15:13:24.360459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f840e0>]}
[0m15:13:24.360904 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 14.19s]
[0m15:13:24.361260 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m15:13:24.361753 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m15:13:24.362036 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m15:13:24.362327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m15:13:24.362523 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m15:13:24.364774 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m15:13:24.365217 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m15:13:24.383701 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.384018 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622151324380798"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m15:13:24.384219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:24.394708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.399847 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.400114 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m15:13:24.400402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.400567 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.400732 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622151324380798'
      
      
      order by ordinal_position

  
[0m15:13:24.424555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.427473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.427686 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m15:13:24.434920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.439018 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.439269 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m15:13:24.446567 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.454429 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m15:13:24.454898 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.455092 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622151324380798"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622151324380798"
    )
  
[0m15:13:24.462596 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.463477 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m15:13:24.463659 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.463816 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m15:13:24.469542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.469995 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m15:13:24.541486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcbba40>]}
[0m15:13:24.541958 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m15:13:24.542270 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m15:13:24.543125 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:24.543443 [debug] [MainThread]: On master: BEGIN
[0m15:13:24.543659 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:13:24.547559 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:13:24.547855 [debug] [MainThread]: On master: COMMIT
[0m15:13:24.548021 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:24.548172 [debug] [MainThread]: On master: COMMIT
[0m15:13:24.548386 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:13:24.548548 [debug] [MainThread]: On master: Close
[0m15:13:24.549479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:24.549632 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m15:13:24.549802 [info ] [MainThread]: 
[0m15:13:24.549978 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.50 seconds (14.50s).
[0m15:13:24.550370 [debug] [MainThread]: Command end result
[0m15:13:24.566291 [info ] [MainThread]: 
[0m15:13:24.566589 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:24.566761 [info ] [MainThread]: 
[0m15:13:24.566935 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:13:24.568379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.570353, "process_user_time": 3.690199, "process_kernel_time": 0.826286, "process_mem_max_rss": "211435520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:13:24.568669 [debug] [MainThread]: Command `dbt run` succeeded at 15:13:24.568627 after 15.57 seconds
[0m15:13:24.568846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d0e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdd3620>]}
[0m15:13:24.569020 [debug] [MainThread]: Flushing usage events
[0m13:48:02.872110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5a59e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5a69b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5a59e300>]}


============================== 13:48:02.879532 | 26a57913-33c6-45d9-888a-204e0fdddd7c ==============================
[0m13:48:02.879532 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:48:02.880223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:48:03.025567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26a57913-33c6-45d9-888a-204e0fdddd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5afc75c0>]}
[0m13:48:03.039315 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ss59q2_3'
[0m13:48:03.039799 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:48:03.084575 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:48:03.085337 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:48:03.095997 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:48:03.099769 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:48:03.255041 [info ] [MainThread]: Installed from version 1.2.0
[0m13:48:03.255669 [info ] [MainThread]: Up to date!
[0m13:48:03.256219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '26a57913-33c6-45d9-888a-204e0fdddd7c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5b5bc9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5b5bc9b0>]}
[0m13:48:03.282582 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45893046, "process_user_time": 1.595321, "process_kernel_time": 0.149315, "process_mem_max_rss": "93660", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m13:48:03.283384 [debug] [MainThread]: Command `dbt deps` succeeded at 13:48:03.283254 after 0.46 seconds
[0m13:48:03.283883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5a69b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5a9eac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5a2e4e90>]}
[0m13:48:03.284346 [debug] [MainThread]: Flushing usage events
[0m13:48:04.929008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12e671d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a16471a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a14c18830>]}


============================== 13:48:04.932050 | 1285590a-ff38-43b1-acd3-650ae6316bae ==============================
[0m13:48:04.932050 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:48:04.932757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:48:05.173976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a153519a0>]}
[0m13:48:05.233939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12d2a900>]}
[0m13:48:05.234870 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:48:05.250792 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:48:05.251580 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:48:05.252152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12dd3590>]}
[0m13:48:06.473572 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:48:06.474274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12c9ce60>]}
[0m13:48:06.668814 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m13:48:06.674075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0c024e30>]}
[0m13:48:06.838632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0be638f0>]}
[0m13:48:06.839229 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m13:48:06.839727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0be47200>]}
[0m13:48:06.841479 [info ] [MainThread]: 
[0m13:48:06.842202 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:48:06.847077 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m13:48:06.883244 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m13:48:06.883771 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m13:48:06.884187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:07.361283 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.362821 [debug] [ThreadPool]: On list_petro: Close
[0m13:48:07.365062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m13:48:07.365629 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m13:48:07.372382 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:48:07.372829 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m13:48:07.373286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:07.378714 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.380079 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:48:07.380499 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m13:48:07.381357 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.381795 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:48:07.382192 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m13:48:07.382739 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.383669 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m13:48:07.384085 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:48:07.384479 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m13:48:07.385109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.385539 [debug] [ThreadPool]: On create_petro_main: Close
[0m13:48:07.387826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m13:48:07.393329 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m13:48:07.393763 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m13:48:07.394158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:07.399494 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.399947 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m13:48:07.400367 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m13:48:07.421052 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.426051 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m13:48:07.427320 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m13:48:07.427746 [debug] [ThreadPool]: On list_petro_main: Close
[0m13:48:07.431370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0be95fa0>]}
[0m13:48:07.431921 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:07.432340 [debug] [MainThread]: On master: BEGIN
[0m13:48:07.432752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:48:07.438170 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:48:07.438617 [debug] [MainThread]: On master: COMMIT
[0m13:48:07.439031 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:07.439428 [debug] [MainThread]: On master: COMMIT
[0m13:48:07.440067 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:48:07.440497 [debug] [MainThread]: On master: Close
[0m13:48:07.442251 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:48:07.442767 [info ] [MainThread]: 
[0m13:48:07.452082 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m13:48:07.452720 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m13:48:07.453433 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m13:48:07.453896 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m13:48:07.479487 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m13:48:07.480339 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m13:48:07.514726 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m13:48:07.515608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:50:30.195058 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:50:30.195637 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m13:50:30.196583 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.197262 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:50:30.197747 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m13:50:30.198619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.201611 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:50:30.202112 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m13:50:30.202971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.223833 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m13:50:30.224338 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:50:30.224798 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m13:50:30.226062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.230935 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:50:30.231421 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m13:50:30.232686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.235083 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m13:50:30.261136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0bfe43b0>]}
[0m13:50:30.261982 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 142.81s]
[0m13:50:30.262886 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m13:50:30.263919 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m13:50:30.264494 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m13:50:30.265199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m13:50:30.265678 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m13:50:30.270819 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m13:50:30.271480 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m13:50:30.305241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.305842 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622135030299232"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m13:50:30.306350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:30.323409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.331555 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.332105 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m13:50:30.332908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.333423 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.333888 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622135030299232'
      
      
      order by ordinal_position

  
[0m13:50:30.360782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.366447 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.366966 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m13:50:30.381424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.390629 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.391172 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m13:50:30.400633 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.419069 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m13:50:30.419855 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.420362 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622135030299232"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622135030299232"
    )
  
[0m13:50:30.432863 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.434801 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m13:50:30.435277 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.435725 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m13:50:30.444346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.445308 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m13:50:30.562363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69e00c3620>]}
[0m13:50:30.563210 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m13:50:30.563981 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m13:50:30.565328 [debug] [MainThread]: Using duckdb connection "master"
[0m13:50:30.565831 [debug] [MainThread]: On master: BEGIN
[0m13:50:30.566290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:30.571778 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:50:30.572288 [debug] [MainThread]: On master: COMMIT
[0m13:50:30.572744 [debug] [MainThread]: Using duckdb connection "master"
[0m13:50:30.573266 [debug] [MainThread]: On master: COMMIT
[0m13:50:30.573987 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:50:30.574460 [debug] [MainThread]: On master: Close
[0m13:50:30.576132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:30.576591 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m13:50:30.577057 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m13:50:30.577557 [info ] [MainThread]: 
[0m13:50:30.578110 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 2 minutes and 23.74 seconds (143.74s).
[0m13:50:30.579122 [debug] [MainThread]: Command end result
[0m13:50:30.606704 [info ] [MainThread]: 
[0m13:50:30.607401 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:50:30.607927 [info ] [MainThread]: 
[0m13:50:30.608461 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:50:30.609494 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 145.72975, "process_user_time": 4.790523, "process_kernel_time": 0.290696, "process_mem_max_rss": "267828", "process_in_blocks": "1184", "process_out_blocks": "107024"}
[0m13:50:30.610149 [debug] [MainThread]: Command `dbt run` succeeded at 13:50:30.610040 after 145.73 seconds
[0m13:50:30.610657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12fe1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a13148da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69e0161b50>]}
[0m13:50:30.611155 [debug] [MainThread]: Flushing usage events
[0m13:50:32.401985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd37ad850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd2984b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd2c27a70>]}


============================== 13:50:32.404866 | dc83d47b-f8b6-4298-85e4-235e985099a8 ==============================
[0m13:50:32.404866 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:50:32.405654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:50:32.550954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc83d47b-f8b6-4298-85e4-235e985099a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd2c25700>]}
[0m13:50:32.569046 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21620041, "process_user_time": 1.406766, "process_kernel_time": 0.13226, "process_mem_max_rss": "92160", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m13:50:32.569664 [debug] [MainThread]: Command `dbt clean` succeeded at 13:50:32.569556 after 0.22 seconds
[0m13:50:32.570130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd4b1d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd261ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd26bd370>]}
[0m13:50:32.570580 [debug] [MainThread]: Flushing usage events
[0m14:05:22.048919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4d923e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4dd7a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4dd78860>]}


============================== 14:05:22.056871 | bf4b2954-f21c-454a-aeac-93659c33bd01 ==============================
[0m14:05:22.056871 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:22.057593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:22.209644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf4b2954-f21c-454a-aeac-93659c33bd01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4de03320>]}
[0m14:05:22.223440 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zc7qqx8u'
[0m14:05:22.223913 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:22.316534 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:22.317345 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:22.329167 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:22.333058 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:22.486762 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:22.487382 [info ] [MainThread]: Up to date!
[0m14:05:22.488001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bf4b2954-f21c-454a-aeac-93659c33bd01', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4d7b2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4e27d0a0>]}
[0m14:05:22.489456 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48974532, "process_user_time": 1.59689, "process_kernel_time": 0.136075, "process_mem_max_rss": "93524", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m14:05:22.490084 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:22.489975 after 0.49 seconds
[0m14:05:22.490608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4e3e3320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4d7b2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4d923d70>]}
[0m14:05:22.491069 [debug] [MainThread]: Flushing usage events
[0m14:05:24.128871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84401cf260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8440286cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844105c9b0>]}


============================== 14:05:24.132122 | efb0c34b-50ff-417e-9837-dd88c9566f79 ==============================
[0m14:05:24.132122 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:24.132811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:24.378766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843ffc2870>]}
[0m14:05:24.439329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844000d100>]}
[0m14:05:24.440270 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:24.479639 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:24.480399 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:24.480969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843ffc3a10>]}
[0m14:05:25.700506 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:25.701323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843947a390>]}
[0m14:05:25.896585 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:25.901864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843ffb0d40>]}
[0m14:05:26.040551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843913f470>]}
[0m14:05:26.041156 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:26.041695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8439158b00>]}
[0m14:05:26.043528 [info ] [MainThread]: 
[0m14:05:26.044310 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:26.049410 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:26.086618 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:26.087130 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:26.087541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:26.801583 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:26.803198 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:26.805402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:26.805977 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:26.812869 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:26.813316 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:26.813724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:26.819611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.821040 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:26.821455 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:26.822115 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.822563 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:26.822962 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:26.823541 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.824476 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:26.824890 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:26.825279 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:26.825827 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.826301 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:26.828857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:26.834510 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:26.834954 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:26.835349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:26.840711 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.841139 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:26.841559 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:26.861346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.866306 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:26.867515 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:26.867937 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:26.871489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843913faa0>]}
[0m14:05:26.872029 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.872429 [debug] [MainThread]: On master: BEGIN
[0m14:05:26.872806 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:26.878070 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.878544 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.878942 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.879325 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.879951 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.880366 [debug] [MainThread]: On master: Close
[0m14:05:26.881980 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:26.882559 [info ] [MainThread]: 
[0m14:05:26.892123 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:26.892784 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:26.893557 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:26.894020 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:26.919676 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:26.920500 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:26.954890 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:26.955784 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:38.313032 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.313637 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:38.314670 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.315149 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.315600 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:38.316378 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.319426 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.319903 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:38.320631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.341828 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:38.342464 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.342931 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:38.344678 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.349844 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.350369 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:38.351628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.354099 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:38.380458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840cb03dd0>]}
[0m14:05:38.381330 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.49s]
[0m14:05:38.382272 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:38.383305 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:38.383896 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:38.384589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:38.385075 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:38.390388 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:38.391085 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:38.425319 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.425969 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622140538419200"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:38.426512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:38.442074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.449982 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.450540 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:38.451230 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.451693 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.452147 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622140538419200'
      
      
      order by ordinal_position

  
[0m14:05:38.479787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.485703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.486310 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:38.494916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.504388 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.504965 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:38.514638 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.533504 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:38.534362 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.534860 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622140538419200"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622140538419200"
    )
  
[0m14:05:38.547208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.549333 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:38.549831 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.550339 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:38.559846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.560850 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:38.685294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840caae090>]}
[0m14:05:38.686169 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m14:05:38.686976 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:38.688457 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:38.688948 [debug] [MainThread]: On master: BEGIN
[0m14:05:38.689414 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:38.694999 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:38.695493 [debug] [MainThread]: On master: COMMIT
[0m14:05:38.695946 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:38.696384 [debug] [MainThread]: On master: COMMIT
[0m14:05:38.696947 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:38.697416 [debug] [MainThread]: On master: Close
[0m14:05:38.699058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:38.699516 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:38.699940 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:38.700439 [info ] [MainThread]: 
[0m14:05:38.701010 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.66 seconds (12.66s).
[0m14:05:38.702071 [debug] [MainThread]: Command end result
[0m14:05:38.730592 [info ] [MainThread]: 
[0m14:05:38.731340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:38.731903 [info ] [MainThread]: 
[0m14:05:38.732476 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:38.733559 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.654432, "process_user_time": 4.813725, "process_kernel_time": 0.323309, "process_mem_max_rss": "274504", "process_in_blocks": "1184", "process_out_blocks": "107104"}
[0m14:05:38.734251 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:38.734114 after 14.66 seconds
[0m14:05:38.734781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84342467b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84405f4d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844013f6e0>]}
[0m14:05:38.735284 [debug] [MainThread]: Flushing usage events
[0m14:05:40.570780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4246f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4246ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4246eb10>]}


============================== 14:05:40.573651 | 81f8f104-bd44-4d0b-9ee1-e2a2749a72be ==============================
[0m14:05:40.573651 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:40.574369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:40.724535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81f8f104-bd44-4d0b-9ee1-e2a2749a72be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c42bb6d20>]}
[0m14:05:40.741317 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21956562, "process_user_time": 1.43797, "process_kernel_time": 0.108148, "process_mem_max_rss": "92124", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:40.741930 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:40.741826 after 0.22 seconds
[0m14:05:40.742422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4246d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4246ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c41adf680>]}
[0m14:05:40.742870 [debug] [MainThread]: Flushing usage events
[0m23:25:24.084505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d3a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df7110>]}


============================== 23:25:24.087361 | 7b8fee30-4d72-46c3-84ab-007b1cb39f55 ==============================
[0m23:25:24.087361 [info ] [MainThread]: Running with dbt=1.8.2
[0m23:25:24.087706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:25:24.291283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e77e30>]}
[0m23:25:24.316246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db2900>]}
[0m23:25:24.316873 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m23:25:24.328806 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m23:25:24.395738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:25:24.396000 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:25:24.398950 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m23:25:24.413147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080fb200>]}
[0m23:25:24.462738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10801b9b0>]}
[0m23:25:24.463030 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m23:25:24.463207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6cb60>]}
[0m23:25:24.464078 [info ] [MainThread]: 
[0m23:25:24.464380 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:25:24.466460 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m23:25:24.496435 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m23:25:24.496677 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m23:25:24.496829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:25:24.513114 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.514140 [debug] [ThreadPool]: On list_petro: Close
[0m23:25:24.515549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m23:25:24.515774 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m23:25:24.519006 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:25:24.519180 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m23:25:24.519319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:25:24.523037 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.523944 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:25:24.524108 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m23:25:24.524291 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.524429 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:25:24.524564 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m23:25:24.525408 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.525810 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m23:25:24.525946 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:25:24.526070 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m23:25:24.526244 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.526382 [debug] [ThreadPool]: On create_petro_main: Close
[0m23:25:24.527584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m23:25:24.530230 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m23:25:24.530415 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m23:25:24.530559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:25:24.534104 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.534348 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m23:25:24.534512 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m23:25:24.553004 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.557476 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m23:25:24.558440 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m23:25:24.558593 [debug] [ThreadPool]: On list_petro_main: Close
[0m23:25:24.560550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593ed50>]}
[0m23:25:24.560822 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:24.560978 [debug] [MainThread]: On master: BEGIN
[0m23:25:24.561116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:25:24.564518 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:25:24.564705 [debug] [MainThread]: On master: COMMIT
[0m23:25:24.564853 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:24.564992 [debug] [MainThread]: On master: COMMIT
[0m23:25:24.565177 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:25:24.565319 [debug] [MainThread]: On master: Close
[0m23:25:24.566120 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m23:25:24.566297 [info ] [MainThread]: 
[0m23:25:24.568008 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m23:25:24.568278 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m23:25:24.568506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m23:25:24.568675 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m23:25:24.581338 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m23:25:24.582216 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m23:25:24.598371 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m23:25:24.598874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:34.226950 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:25:34.227500 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m23:25:34.227931 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.228175 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:25:34.228406 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m23:25:34.229078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.230915 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:25:34.231156 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m23:25:34.231513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.243319 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m23:25:34.243555 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:25:34.243745 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m23:25:34.244115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.246731 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:25:34.246944 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m23:25:34.247446 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.248744 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m23:25:34.269740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797d730>]}
[0m23:25:34.270147 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.70s]
[0m23:25:34.270454 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m23:25:34.270850 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m23:25:34.271118 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m23:25:34.271331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m23:25:34.271506 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m23:25:34.278959 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m23:25:34.279426 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m23:25:34.295242 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.295579 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622232534292421"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m23:25:34.295799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:34.306353 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.310918 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.311205 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m23:25:34.311550 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.311773 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.311961 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622232534292421'
      
      
      order by ordinal_position

  
[0m23:25:34.335688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.339348 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.339610 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m23:25:34.348170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.353324 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.353697 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m23:25:34.362878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.372857 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m23:25:34.373487 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.373706 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622232534292421"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622232534292421"
    )
  
[0m23:25:34.385357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.386485 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m23:25:34.386695 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.386869 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m23:25:34.395350 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.396101 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m23:25:34.471562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c3adbb0>]}
[0m23:25:34.471977 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.20s]
[0m23:25:34.472300 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m23:25:34.473033 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:34.473193 [debug] [MainThread]: On master: BEGIN
[0m23:25:34.473330 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:25:34.476762 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:25:34.476945 [debug] [MainThread]: On master: COMMIT
[0m23:25:34.477089 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:34.477221 [debug] [MainThread]: On master: COMMIT
[0m23:25:34.477395 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:25:34.477535 [debug] [MainThread]: On master: Close
[0m23:25:34.478346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:25:34.478534 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m23:25:34.478759 [info ] [MainThread]: 
[0m23:25:34.478959 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.01 seconds (10.01s).
[0m23:25:34.479384 [debug] [MainThread]: Command end result
[0m23:25:34.495957 [info ] [MainThread]: 
[0m23:25:34.496282 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:25:34.496452 [info ] [MainThread]: 
[0m23:25:34.496625 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:25:34.498504 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.448308, "process_user_time": 2.847289, "process_kernel_time": 1.129004, "process_mem_max_rss": "200294400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:25:34.498900 [debug] [MainThread]: Command `dbt run` succeeded at 23:25:34.498853 after 10.45 seconds
[0m23:25:34.499122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d3a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f80e0>]}
[0m23:25:34.499303 [debug] [MainThread]: Flushing usage events
[0m23:27:17.532882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10217c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10403b1a0>]}


============================== 23:27:17.535623 | 4a1f0b10-ed61-49b9-a046-ad5e29b07e7f ==============================
[0m23:27:17.535623 [info ] [MainThread]: Running with dbt=1.8.2
[0m23:27:17.535963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:27:17.730839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a8f140>]}
[0m23:27:17.755780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035d91c0>]}
[0m23:27:17.756440 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m23:27:17.768364 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m23:27:17.842748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:27:17.843025 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:27:17.845923 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m23:27:17.859751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440a600>]}
[0m23:27:17.905905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104319610>]}
[0m23:27:17.906195 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m23:27:17.906372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104531040>]}
[0m23:27:17.907192 [info ] [MainThread]: 
[0m23:27:17.907485 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:27:17.909598 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m23:27:17.939243 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m23:27:17.939497 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m23:27:17.939657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:17.955507 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.956840 [debug] [ThreadPool]: On list_petro: Close
[0m23:27:17.958222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m23:27:17.958492 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m23:27:17.961782 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:27:17.961971 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m23:27:17.962120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:17.965897 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.966603 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:27:17.966756 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m23:27:17.966942 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.967083 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:27:17.967219 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m23:27:17.967954 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.968391 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m23:27:17.968541 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:27:17.968686 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m23:27:17.968877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.969026 [debug] [ThreadPool]: On create_petro_main: Close
[0m23:27:17.970120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m23:27:17.972704 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m23:27:17.972871 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m23:27:17.973002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:17.976205 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.976395 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m23:27:17.976553 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m23:27:17.994614 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.998915 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m23:27:17.999921 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m23:27:18.000084 [debug] [ThreadPool]: On list_petro_main: Close
[0m23:27:18.002174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10431a5d0>]}
[0m23:27:18.002399 [debug] [MainThread]: Using duckdb connection "master"
[0m23:27:18.002537 [debug] [MainThread]: On master: BEGIN
[0m23:27:18.002667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:27:18.006070 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:27:18.006254 [debug] [MainThread]: On master: COMMIT
[0m23:27:18.006399 [debug] [MainThread]: Using duckdb connection "master"
[0m23:27:18.006528 [debug] [MainThread]: On master: COMMIT
[0m23:27:18.006701 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:27:18.006843 [debug] [MainThread]: On master: Close
[0m23:27:18.007702 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m23:27:18.007893 [info ] [MainThread]: 
[0m23:27:18.010794 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m23:27:18.011092 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m23:27:18.011323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m23:27:18.011496 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m23:27:18.023601 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m23:27:18.024479 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m23:27:18.040538 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m23:27:18.041154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:23.815456 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:27:23.815795 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m23:27:23.816166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.816396 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:27:23.816620 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m23:27:23.817271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.819191 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:27:23.819445 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m23:27:23.819845 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.831818 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m23:27:23.832065 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:27:23.832261 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m23:27:23.832651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.835415 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:27:23.835636 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m23:27:23.836135 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.837352 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m23:27:23.857617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a24ad0>]}
[0m23:27:23.858004 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 5.85s]
[0m23:27:23.858319 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m23:27:23.858735 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m23:27:23.859003 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m23:27:23.859229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m23:27:23.859408 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m23:27:23.866803 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m23:27:23.867530 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m23:27:23.883825 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.884104 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622232723881223"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m23:27:23.884293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:23.894631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.899285 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.899523 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m23:27:23.899836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.900010 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.900181 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622232723881223'
      
      
      order by ordinal_position

  
[0m23:27:23.923942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.927147 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.927405 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m23:27:23.936151 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.940492 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.940755 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m23:27:23.949191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.957226 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m23:27:23.957976 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.958176 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622232723881223"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622232723881223"
    )
  
[0m23:27:23.966119 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.967008 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m23:27:23.967199 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.967354 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m23:27:23.972733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.973165 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m23:27:24.048521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12719e240>]}
[0m23:27:24.048947 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.19s]
[0m23:27:24.049251 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m23:27:24.049820 [debug] [MainThread]: Using duckdb connection "master"
[0m23:27:24.050012 [debug] [MainThread]: On master: BEGIN
[0m23:27:24.050160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:27:24.055637 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:27:24.055859 [debug] [MainThread]: On master: COMMIT
[0m23:27:24.056158 [debug] [MainThread]: Using duckdb connection "master"
[0m23:27:24.056384 [debug] [MainThread]: On master: COMMIT
[0m23:27:24.056765 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:27:24.057048 [debug] [MainThread]: On master: Close
[0m23:27:24.058749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:24.059018 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m23:27:24.059554 [info ] [MainThread]: 
[0m23:27:24.059909 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 6.15 seconds (6.15s).
[0m23:27:24.060385 [debug] [MainThread]: Command end result
[0m23:27:24.076952 [info ] [MainThread]: 
[0m23:27:24.077296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:27:24.077486 [info ] [MainThread]: 
[0m23:27:24.077665 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:27:24.079797 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.584207, "process_user_time": 2.837844, "process_kernel_time": 1.169798, "process_mem_max_rss": "210436096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:27:24.080178 [debug] [MainThread]: Command `dbt run` succeeded at 23:27:24.080132 after 6.58 seconds
[0m23:27:24.080374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040adb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aec440>]}
[0m23:27:24.080569 [debug] [MainThread]: Flushing usage events
[0m21:29:00.982754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55eff2ed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ef98d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ef98cc80>]}


============================== 21:29:00.989637 | bcac8110-35a9-49a3-bb74-874deb3e44eb ==============================
[0m21:29:00.989637 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:29:00.990422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m21:29:01.135062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcac8110-35a9-49a3-bb74-874deb3e44eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ef915910>]}
[0m21:29:01.148296 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-10b7qqmu'
[0m21:29:01.148770 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:29:01.221818 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:29:01.222471 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:29:01.245152 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:29:01.248821 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:29:01.319243 [info ] [MainThread]: Installed from version 1.2.0
[0m21:29:01.319789 [info ] [MainThread]: Up to date!
[0m21:29:01.320381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bcac8110-35a9-49a3-bb74-874deb3e44eb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55eff2ed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ef8c2f00>]}
[0m21:29:01.321809 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38735923, "process_user_time": 1.571707, "process_kernel_time": 0.107161, "process_mem_max_rss": "93396", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m21:29:01.322425 [debug] [MainThread]: Command `dbt deps` succeeded at 21:29:01.322320 after 0.39 seconds
[0m21:29:01.322873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55efbc2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ef4f2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55eff2ed20>]}
[0m21:29:01.323313 [debug] [MainThread]: Flushing usage events
[0m21:29:02.882443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e83248200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e80f13bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e80f12540>]}


============================== 21:29:02.885154 | c0ff1444-ceb4-42bb-8df8-f349f625605e ==============================
[0m21:29:02.885154 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:29:02.885850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:29:03.117793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e809533e0>]}
[0m21:29:03.176885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e808f6870>]}
[0m21:29:03.177657 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m21:29:03.192879 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:29:03.193611 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:29:03.194200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e82688230>]}
[0m21:29:04.397405 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:29:04.398239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e79c7dd60>]}
[0m21:29:04.586705 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:29:04.591627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e79d041a0>]}
[0m21:29:04.714562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e815519a0>]}
[0m21:29:04.715116 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m21:29:04.715653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e80f2a930>]}
[0m21:29:04.717361 [info ] [MainThread]: 
[0m21:29:04.718086 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:29:04.722954 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:29:04.758087 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:29:04.758636 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m21:29:04.759044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:05.284124 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m21:29:05.285693 [debug] [ThreadPool]: On list_petro: Close
[0m21:29:05.287980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:29:05.288564 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:29:05.295448 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:29:05.295895 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m21:29:05.296298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:05.301827 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:29:05.303154 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:29:05.303574 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:29:05.304109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:29:05.304512 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:29:05.304901 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:29:05.305468 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:29:05.306424 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:29:05.306836 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:29:05.307228 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:29:05.307802 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:29:05.308279 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:29:05.310434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:29:05.315724 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:29:05.316149 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:29:05.316533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:05.321396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:29:05.321860 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:29:05.322275 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m21:29:05.342271 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:29:05.346959 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:29:05.348122 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:29:05.348539 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:29:05.351549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e82689670>]}
[0m21:29:05.352066 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:05.352464 [debug] [MainThread]: On master: BEGIN
[0m21:29:05.352841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:05.357798 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:29:05.358232 [debug] [MainThread]: On master: COMMIT
[0m21:29:05.358626 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:05.359008 [debug] [MainThread]: On master: COMMIT
[0m21:29:05.359648 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:29:05.360067 [debug] [MainThread]: On master: Close
[0m21:29:05.361468 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:29:05.362002 [info ] [MainThread]: 
[0m21:29:05.371057 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:29:05.371656 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:29:05.372312 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m21:29:05.372757 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:29:05.398576 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:29:05.399329 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:29:05.433705 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:29:05.434425 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:29:14.625821 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:29:14.626357 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:29:14.626965 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.627435 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:29:14.627879 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:29:14.628562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.631217 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:29:14.631682 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:29:14.632373 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.652822 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:29:14.653304 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:29:14.653778 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:29:14.654930 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.659595 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:29:14.660074 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m21:29:14.661196 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.663503 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:29:14.689005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e822c2570>]}
[0m21:29:14.689754 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.32s]
[0m21:29:14.690527 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:29:14.691504 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:29:14.692082 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:29:14.692662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:29:14.693124 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:29:14.697858 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:29:14.698494 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:29:14.731910 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.732458 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622212914726033"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:29:14.732946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:14.749640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.756845 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.757349 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:29:14.758125 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.758586 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.759066 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622212914726033'
      
      
      order by ordinal_position

  
[0m21:29:14.785799 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.791168 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.791656 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:29:14.800235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.808939 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.809436 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:29:14.817547 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.835449 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:29:14.836159 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.836646 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622212914726033"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622212914726033"
    )
  
[0m21:29:14.845849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.847556 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:29:14.848017 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.848450 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:29:14.856936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.857878 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:29:14.993826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e4d4e80b0>]}
[0m21:29:14.994639 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m21:29:14.995375 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:29:14.996738 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:14.997225 [debug] [MainThread]: On master: BEGIN
[0m21:29:14.997669 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:15.003052 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:29:15.003531 [debug] [MainThread]: On master: COMMIT
[0m21:29:15.003973 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:15.004397 [debug] [MainThread]: On master: COMMIT
[0m21:29:15.004949 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:29:15.005409 [debug] [MainThread]: On master: Close
[0m21:29:15.006755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:15.007197 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m21:29:15.007612 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:29:15.008074 [info ] [MainThread]: 
[0m21:29:15.008669 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m21:29:15.009851 [debug] [MainThread]: Command end result
[0m21:29:15.037202 [info ] [MainThread]: 
[0m21:29:15.037922 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:29:15.038527 [info ] [MainThread]: 
[0m21:29:15.039137 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:29:15.040216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.206544, "process_user_time": 4.680707, "process_kernel_time": 0.311514, "process_mem_max_rss": "282052", "process_in_blocks": "1184", "process_out_blocks": "108632"}
[0m21:29:15.040873 [debug] [MainThread]: Command `dbt run` succeeded at 21:29:15.040763 after 12.21 seconds
[0m21:29:15.041383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e83248200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e80a73740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e79ecb650>]}
[0m21:29:15.041918 [debug] [MainThread]: Flushing usage events
[0m21:29:16.672399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca445ef380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca445ef2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca44e701d0>]}


============================== 21:29:16.675184 | eb376c2d-6d86-4c48-8754-8569d6f316b7 ==============================
[0m21:29:16.675184 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:29:16.675834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:29:16.817476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb376c2d-6d86-4c48-8754-8569d6f316b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca4503d9a0>]}
[0m21:29:16.834002 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21008946, "process_user_time": 1.411492, "process_kernel_time": 0.111643, "process_mem_max_rss": "92148", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m21:29:16.834582 [debug] [MainThread]: Command `dbt clean` succeeded at 21:29:16.834479 after 0.21 seconds
[0m21:29:16.835023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca4488f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca448c4bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca456036e0>]}
[0m21:29:16.835460 [debug] [MainThread]: Flushing usage events
[0m22:06:09.742657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e531ed8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e52855580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e5162bd40>]}


============================== 22:06:09.789746 | 93ff7505-44b7-4915-9cb7-bd9e1dee6efa ==============================
[0m22:06:09.789746 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:09.790472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:09.933024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93ff7505-44b7-4915-9cb7-bd9e1dee6efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e520a5b80>]}
[0m22:06:09.946333 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5vp294jm'
[0m22:06:09.946797 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:10.006981 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:10.007654 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:10.017706 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:10.021545 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:10.068027 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:10.068570 [info ] [MainThread]: Up to date!
[0m22:06:10.069170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '93ff7505-44b7-4915-9cb7-bd9e1dee6efa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e51625520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e5138f8c0>]}
[0m22:06:10.084090 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38966253, "process_user_time": 1.566005, "process_kernel_time": 0.115852, "process_mem_max_rss": "93244", "process_in_blocks": "5672", "process_out_blocks": "3840"}
[0m22:06:10.084699 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:10.084596 after 0.39 seconds
[0m22:06:10.085169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e517d7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e553bbd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e51f430b0>]}
[0m22:06:10.085614 [debug] [MainThread]: Flushing usage events
[0m22:06:11.661192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46395a4e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4639c66cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463aaab3e0>]}


============================== 22:06:11.664082 | 156ace07-4859-4a70-bec2-f7b2bd5d3ed2 ==============================
[0m22:06:11.664082 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:11.664826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:11.890486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46395a5100>]}
[0m22:06:11.949285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463a604800>]}
[0m22:06:11.950037 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:06:11.964833 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:11.965573 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:11.966121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4639457f20>]}
[0m22:06:13.189916 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:13.190668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4632ba6f30>]}
[0m22:06:13.380217 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:13.385082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46328cfcb0>]}
[0m22:06:13.523254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4639467b60>]}
[0m22:06:13.523827 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:13.524315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463269aba0>]}
[0m22:06:13.526024 [info ] [MainThread]: 
[0m22:06:13.526716 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:13.531374 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:13.566296 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:13.566752 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:06:13.567157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:14.028870 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.030449 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:14.032805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:14.033441 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:14.040309 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:14.040760 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:06:14.041198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:14.046592 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.047915 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:14.048331 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:14.049204 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.049616 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:14.050014 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:14.050646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.051588 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:14.052015 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:14.052407 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:14.052954 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.053419 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:14.055528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:14.060827 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:14.061292 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:14.061711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:14.066555 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.066980 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:14.067390 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:06:14.087188 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.091899 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:14.093068 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:14.093524 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:14.096579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463269bf20>]}
[0m22:06:14.097100 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:14.097545 [debug] [MainThread]: On master: BEGIN
[0m22:06:14.097997 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:14.103054 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:14.103482 [debug] [MainThread]: On master: COMMIT
[0m22:06:14.103877 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:14.104260 [debug] [MainThread]: On master: COMMIT
[0m22:06:14.104891 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:14.105339 [debug] [MainThread]: On master: Close
[0m22:06:14.106831 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:14.107376 [info ] [MainThread]: 
[0m22:06:14.122803 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:14.123407 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:14.124133 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:14.124585 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:14.150198 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:14.150941 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:14.185585 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:14.186321 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:21.662714 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.663249 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:21.664034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.664508 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.664964 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:21.665699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.668372 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.668841 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:21.669590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.690287 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:21.690798 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.691251 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:21.692302 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.697040 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.697553 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:21.698665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.700967 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:21.726539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463a067410>]}
[0m22:06:21.727276 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.60s]
[0m22:06:21.728064 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:21.729058 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:21.729668 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:21.730280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:21.730750 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:21.735575 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:21.736233 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:21.769681 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.770197 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622220621763818"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:21.770683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:21.785052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.791967 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.792454 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:21.793076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.793557 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.794011 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622220621763818'
      
      
      order by ordinal_position

  
[0m22:06:21.826267 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.831132 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.831621 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:21.840128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.848512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.849009 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:21.858052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.875974 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:21.876655 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.877163 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622220621763818"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622220621763818"
    )
  
[0m22:06:21.888287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.890022 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:21.890483 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.890919 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:21.899535 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.900399 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:22.040657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46065d0d10>]}
[0m22:06:22.041493 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m22:06:22.042265 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:22.043682 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:22.044178 [debug] [MainThread]: On master: BEGIN
[0m22:06:22.044628 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:22.049942 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:22.050426 [debug] [MainThread]: On master: COMMIT
[0m22:06:22.050876 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:22.051308 [debug] [MainThread]: On master: COMMIT
[0m22:06:22.051995 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:22.052462 [debug] [MainThread]: On master: Close
[0m22:06:22.053891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:22.054343 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:22.054766 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:22.055247 [info ] [MainThread]: 
[0m22:06:22.055854 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.53 seconds (8.53s).
[0m22:06:22.056974 [debug] [MainThread]: Command end result
[0m22:06:22.084552 [info ] [MainThread]: 
[0m22:06:22.085257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:22.085872 [info ] [MainThread]: 
[0m22:06:22.086482 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:22.087579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.475895, "process_user_time": 4.714553, "process_kernel_time": 0.312169, "process_mem_max_rss": "281976", "process_in_blocks": "1184", "process_out_blocks": "108640"}
[0m22:06:22.088234 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:22.088123 after 10.48 seconds
[0m22:06:22.088736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463a7cf8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4632654530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4639a418e0>]}
[0m22:06:22.089276 [debug] [MainThread]: Flushing usage events
[0m22:06:23.706844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fdc16bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fdc16b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fdc17c80>]}


============================== 22:06:23.709561 | d6f4023d-19ad-44c3-ae46-0c6d2ecbe8d4 ==============================
[0m22:06:23.709561 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:23.710296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:23.850267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6f4023d-19ad-44c3-ae46-0c6d2ecbe8d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fe1b5c10>]}
[0m22:06:23.866690 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20847084, "process_user_time": 1.414527, "process_kernel_time": 0.104186, "process_mem_max_rss": "92248", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:23.867280 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:23.867177 after 0.21 seconds
[0m22:06:23.867730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fd4a7d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fd4a4bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fd02dac0>]}
[0m22:06:23.868172 [debug] [MainThread]: Flushing usage events
[0m06:02:10.216111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5af219b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aee71b6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aee71b6b0>]}


============================== 06:02:10.223290 | 0403180a-75f1-4c0d-b8ce-7f65668a4a69 ==============================
[0m06:02:10.223290 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.223965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.362641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0403180a-75f1-4c0d-b8ce-7f65668a4a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aef4d8aa0>]}
[0m06:02:10.375995 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-niwqi81k'
[0m06:02:10.376456 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.498711 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.499341 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.563712 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.567463 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.701618 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.702118 [info ] [MainThread]: Up to date!
[0m06:02:10.702709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0403180a-75f1-4c0d-b8ce-7f65668a4a69', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aee87af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aee3c6e70>]}
[0m06:02:10.704103 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.53657216, "process_user_time": 1.557671, "process_kernel_time": 0.107562, "process_mem_max_rss": "93644", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m06:02:10.704698 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.704594 after 0.54 seconds
[0m06:02:10.705134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5af21bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aee87af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5af1539bb0>]}
[0m06:02:10.705569 [debug] [MainThread]: Flushing usage events
[0m06:02:12.330110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe08d5b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe09850cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe09852000>]}


============================== 06:02:12.332878 | 1b304f64-eb2f-49f8-a398-8f57932b18d4 ==============================
[0m06:02:12.332878 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.333618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.561144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe08b34770>]}
[0m06:02:12.620178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe091876e0>]}
[0m06:02:12.620928 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:12.636153 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:12.636879 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:12.637438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe08a461e0>]}
[0m06:02:13.845663 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:13.846462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe01fb49e0>]}
[0m06:02:14.035549 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:14.040466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe020c50a0>]}
[0m06:02:14.171347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe01d011f0>]}
[0m06:02:14.171890 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.172432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe01eecef0>]}
[0m06:02:14.174128 [info ] [MainThread]: 
[0m06:02:14.174856 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.179555 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.214408 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.214917 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:14.215331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:14.716271 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:14.717841 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:14.720024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:14.720611 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:14.727540 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.727992 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:14.728409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.733932 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.735379 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.735803 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:14.736350 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.736762 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.737155 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:14.737727 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.738689 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.739109 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.739507 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.740116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.740541 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:14.742661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:14.747966 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.748405 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:14.748795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.753661 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.754089 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.754528 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:14.774587 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.779286 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:14.780475 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:14.780903 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:14.783946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe01eab320>]}
[0m06:02:14.784477 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.784882 [debug] [MainThread]: On master: BEGIN
[0m06:02:14.785262 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:14.790255 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.790730 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.791133 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.791523 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.792166 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.792581 [debug] [MainThread]: On master: Close
[0m06:02:14.794018 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:14.794589 [info ] [MainThread]: 
[0m06:02:14.804036 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:14.804640 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:14.805386 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:14.805846 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:14.831265 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:14.832016 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:14.866103 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:14.866852 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:23.772403 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.772934 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:23.773556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.774030 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.774485 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:23.775359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.778005 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.778476 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:23.779198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.799851 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.800340 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.800795 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.801922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.806640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.807124 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:23.808623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.810950 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:23.836388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd5e2e960>]}
[0m06:02:23.837103 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.03s]
[0m06:02:23.837883 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:23.838887 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:23.839474 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:23.840058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:23.840521 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:23.845260 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:23.845911 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:23.878774 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.879293 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240623060223872931"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:23.879784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:23.893993 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.900799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.901279 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:23.901867 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.902334 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.902830 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240623060223872931'
      
      
      order by ordinal_position

  
[0m06:02:23.929203 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.934006 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.934527 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.942907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.951217 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.951717 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.960145 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.978045 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:23.978749 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.979242 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240623060223872931"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240623060223872931"
    )
  
[0m06:02:23.988851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.990610 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.991084 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.991530 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:24.000097 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.001033 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:24.147387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd5d67fe0>]}
[0m06:02:24.148164 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m06:02:24.148948 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:24.150330 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:24.150859 [debug] [MainThread]: On master: BEGIN
[0m06:02:24.151316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:24.156647 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:24.157129 [debug] [MainThread]: On master: COMMIT
[0m06:02:24.157573 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:24.158003 [debug] [MainThread]: On master: COMMIT
[0m06:02:24.158725 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:24.159192 [debug] [MainThread]: On master: Close
[0m06:02:24.160581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:24.161024 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:24.161441 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:24.161911 [info ] [MainThread]: 
[0m06:02:24.162549 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.99 seconds (9.99s).
[0m06:02:24.163675 [debug] [MainThread]: Command end result
[0m06:02:24.191457 [info ] [MainThread]: 
[0m06:02:24.192142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:24.192755 [info ] [MainThread]: 
[0m06:02:24.193366 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:24.194463 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.913357, "process_user_time": 4.674241, "process_kernel_time": 0.303366, "process_mem_max_rss": "268800", "process_in_blocks": "1184", "process_out_blocks": "109120"}
[0m06:02:24.195158 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:24.195047 after 11.91 seconds
[0m06:02:24.195654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe0cbbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd65a51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbde889d100>]}
[0m06:02:24.196151 [debug] [MainThread]: Flushing usage events
[0m06:02:25.889204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f39b6e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f43ca930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f43caff0>]}


============================== 06:02:25.891976 | efd07a2c-8d4c-46d5-b64e-ee02f04a6cfd ==============================
[0m06:02:25.891976 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.892697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:26.035070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efd07a2c-8d4c-46d5-b64e-ee02f04a6cfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f3845880>]}
[0m06:02:26.051567 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21105623, "process_user_time": 1.410436, "process_kernel_time": 0.099889, "process_mem_max_rss": "92288", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:26.052151 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:26.052047 after 0.21 seconds
[0m06:02:26.052597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f5e2d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f37dac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f6ee9c40>]}
[0m06:02:26.053039 [debug] [MainThread]: Flushing usage events
[0m13:56:00.489779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112be3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112827170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e2f020>]}


============================== 13:56:00.492526 | 7dd3d873-9664-410d-b441-18792474801c ==============================
[0m13:56:00.492526 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:56:00.492875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:56:00.689703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a79cd0>]}
[0m13:56:00.714524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138d2d80>]}
[0m13:56:00.715153 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:56:00.727832 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:56:00.795680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:00.795930 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:00.798863 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m13:56:00.812528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a34050>]}
[0m13:56:00.859594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11135dac0>]}
[0m13:56:00.859886 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m13:56:00.860078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113865b20>]}
[0m13:56:00.860894 [info ] [MainThread]: 
[0m13:56:00.861199 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:56:00.863280 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m13:56:00.893700 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m13:56:00.893968 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m13:56:00.894131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:00.914475 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.916049 [debug] [ThreadPool]: On list_petro: Close
[0m13:56:00.918196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m13:56:00.918495 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m13:56:00.922330 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:56:00.922559 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m13:56:00.922702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:00.926584 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.927472 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:56:00.927628 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m13:56:00.927822 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.927962 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:56:00.928098 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m13:56:00.928663 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.929151 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m13:56:00.929313 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:56:00.929458 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m13:56:00.929692 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.929846 [debug] [ThreadPool]: On create_petro_main: Close
[0m13:56:00.931050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m13:56:00.933720 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m13:56:00.933885 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m13:56:00.934017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:00.937422 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.937604 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m13:56:00.937759 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m13:56:00.958877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.962748 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m13:56:00.963693 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m13:56:00.963856 [debug] [ThreadPool]: On list_petro_main: Close
[0m13:56:00.965866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a18c80>]}
[0m13:56:00.966094 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:00.966236 [debug] [MainThread]: On master: BEGIN
[0m13:56:00.966374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:00.969646 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:56:00.969822 [debug] [MainThread]: On master: COMMIT
[0m13:56:00.969966 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:00.970100 [debug] [MainThread]: On master: COMMIT
[0m13:56:00.970325 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:56:00.970502 [debug] [MainThread]: On master: Close
[0m13:56:00.971326 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:56:00.971538 [info ] [MainThread]: 
[0m13:56:00.973263 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m13:56:00.973530 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m13:56:00.973750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m13:56:00.973916 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m13:56:00.986331 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m13:56:00.987205 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m13:56:01.003723 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m13:56:01.004755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:20.995750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:56:20.996395 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m13:56:20.996847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:20.997080 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:56:20.997307 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m13:56:20.997984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:20.999866 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:56:21.000108 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m13:56:21.000477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.012298 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m13:56:21.012550 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:56:21.012740 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m13:56:21.013108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.015727 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:56:21.015944 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m13:56:21.016479 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.018178 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m13:56:21.038883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f521370>]}
[0m13:56:21.039435 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 20.06s]
[0m13:56:21.039842 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m13:56:21.040613 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m13:56:21.040927 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m13:56:21.041159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m13:56:21.041339 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m13:56:21.051967 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m13:56:21.053844 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m13:56:21.076410 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.076796 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240623135621073585"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m13:56:21.077037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:21.088821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.094141 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.094461 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m13:56:21.094807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.094987 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.095166 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240623135621073585'
      
      
      order by ordinal_position

  
[0m13:56:21.118412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.121283 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.121513 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m13:56:21.129026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.132965 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.133207 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m13:56:21.140504 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.148491 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m13:56:21.148977 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.149177 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240623135621073585"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240623135621073585"
    )
  
[0m13:56:21.159133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.160152 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m13:56:21.160416 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.160632 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m13:56:21.165279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.165835 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m13:56:21.256095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f9c78f0>]}
[0m13:56:21.256534 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.21s]
[0m13:56:21.256839 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m13:56:21.257507 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:21.257717 [debug] [MainThread]: On master: BEGIN
[0m13:56:21.257869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:21.261400 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:56:21.261592 [debug] [MainThread]: On master: COMMIT
[0m13:56:21.261745 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:21.261885 [debug] [MainThread]: On master: COMMIT
[0m13:56:21.262060 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:56:21.262206 [debug] [MainThread]: On master: Close
[0m13:56:21.262966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:21.263161 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m13:56:21.263368 [info ] [MainThread]: 
[0m13:56:21.263565 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 20.40 seconds (20.40s).
[0m13:56:21.263991 [debug] [MainThread]: Command end result
[0m13:56:21.292322 [info ] [MainThread]: 
[0m13:56:21.292687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:21.292870 [info ] [MainThread]: 
[0m13:56:21.293068 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:56:21.296161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.856356, "process_user_time": 2.826022, "process_kernel_time": 1.142126, "process_mem_max_rss": "182501376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:56:21.296731 [debug] [MainThread]: Command `dbt run` succeeded at 13:56:21.296671 after 20.86 seconds
[0m13:56:21.297005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f74d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11279c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112be3650>]}
[0m13:56:21.297216 [debug] [MainThread]: Flushing usage events
[0m11:58:03.241061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca8d42000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca7028e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca6f20aa0>]}


============================== 11:58:03.248191 | 1eb90afa-de04-46a2-8f11-f965027fdde1 ==============================
[0m11:58:03.248191 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:58:03.248843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:58:03.387580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1eb90afa-de04-46a2-8f11-f965027fdde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca76fb290>]}
[0m11:58:03.400796 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q8q_a93p'
[0m11:58:03.401262 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:58:03.475793 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:58:03.476414 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:58:03.499793 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:58:03.503426 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:58:03.573185 [info ] [MainThread]: Installed from version 1.2.0
[0m11:58:03.573685 [info ] [MainThread]: Up to date!
[0m11:58:03.574214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1eb90afa-de04-46a2-8f11-f965027fdde1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca6f20aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca7c9d5e0>]}
[0m11:58:03.575485 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3823983, "process_user_time": 1.540696, "process_kernel_time": 0.133096, "process_mem_max_rss": "93492", "process_in_blocks": "5672", "process_out_blocks": "3840"}
[0m11:58:03.576100 [debug] [MainThread]: Command `dbt deps` succeeded at 11:58:03.575997 after 0.38 seconds
[0m11:58:03.576545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca7303380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca6ae6030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca6cc69f0>]}
[0m11:58:03.576977 [debug] [MainThread]: Flushing usage events
[0m11:58:05.165675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfee55b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfd2cf5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfd2cf4d0>]}


============================== 11:58:05.168396 | bf957561-8e59-4507-a382-a636972b80b0 ==============================
[0m11:58:05.168396 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:58:05.169085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:58:05.392148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfe25bfe0>]}
[0m11:58:05.449554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfee55b50>]}
[0m11:58:05.450290 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:58:05.473658 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m11:58:05.474371 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:58:05.474936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfd0861e0>]}
[0m11:58:06.670941 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:58:06.671598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df5ecbbc0>]}
[0m11:58:06.856672 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m11:58:06.861302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df60c92e0>]}
[0m11:58:06.990655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df5c37260>]}
[0m11:58:06.991229 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m11:58:06.991678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df5c4ce60>]}
[0m11:58:06.993523 [info ] [MainThread]: 
[0m11:58:06.994244 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:58:06.998955 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m11:58:07.033522 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m11:58:07.033982 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m11:58:07.034397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:07.579526 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m11:58:07.581201 [debug] [ThreadPool]: On list_petro: Close
[0m11:58:07.583387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m11:58:07.584013 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m11:58:07.590857 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m11:58:07.591308 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m11:58:07.591750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:07.597130 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:07.598449 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m11:58:07.598862 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m11:58:07.599728 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:07.600148 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m11:58:07.600546 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m11:58:07.601103 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:07.602031 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m11:58:07.602446 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m11:58:07.602834 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m11:58:07.603493 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:07.603969 [debug] [ThreadPool]: On create_petro_main: Close
[0m11:58:07.605940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m11:58:07.611216 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m11:58:07.611645 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m11:58:07.612074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:07.616975 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:07.617400 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m11:58:07.617811 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m11:58:07.637819 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:07.642517 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m11:58:07.643720 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m11:58:07.644145 [debug] [ThreadPool]: On list_petro_main: Close
[0m11:58:07.647446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfd3ddb20>]}
[0m11:58:07.648031 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:07.648439 [debug] [MainThread]: On master: BEGIN
[0m11:58:07.648825 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:58:07.653862 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:58:07.654298 [debug] [MainThread]: On master: COMMIT
[0m11:58:07.654695 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:07.655092 [debug] [MainThread]: On master: COMMIT
[0m11:58:07.655773 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:58:07.656199 [debug] [MainThread]: On master: Close
[0m11:58:07.657626 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:58:07.658119 [info ] [MainThread]: 
[0m11:58:07.667133 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m11:58:07.667771 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m11:58:07.668404 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m11:58:07.668858 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m11:58:07.694087 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m11:58:07.694834 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m11:58:07.728838 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m11:58:07.729568 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:58:20.335240 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m11:58:20.335801 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m11:58:20.336428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.336900 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m11:58:20.337355 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m11:58:20.338047 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.340760 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m11:58:20.341236 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m11:58:20.342068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.362734 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m11:58:20.363224 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m11:58:20.363678 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m11:58:20.365395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.370101 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m11:58:20.370579 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m11:58:20.371669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.373983 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m11:58:20.399880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfea8a720>]}
[0m11:58:20.400593 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.73s]
[0m11:58:20.401466 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m11:58:20.402433 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m11:58:20.403000 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m11:58:20.403668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m11:58:20.404174 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m11:58:20.408917 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m11:58:20.409552 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m11:58:20.442294 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.442816 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240623115820436510"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m11:58:20.443300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:20.459677 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.466558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.467033 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m11:58:20.467619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.468102 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.468555 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240623115820436510'
      
      
      order by ordinal_position

  
[0m11:58:20.495043 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.499946 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.500439 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m11:58:20.508992 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.517430 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.517927 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m11:58:20.526518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.544346 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m11:58:20.545037 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.545534 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240623115820436510"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240623115820436510"
    )
  
[0m11:58:20.557811 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.559509 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m11:58:20.560010 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.560447 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m11:58:20.571229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.572157 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m11:58:20.730632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc9c15640>]}
[0m11:58:20.731428 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m11:58:20.732266 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m11:58:20.733591 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:20.734080 [debug] [MainThread]: On master: BEGIN
[0m11:58:20.734532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:58:20.739903 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:58:20.740397 [debug] [MainThread]: On master: COMMIT
[0m11:58:20.740851 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:20.741291 [debug] [MainThread]: On master: COMMIT
[0m11:58:20.741957 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:58:20.742431 [debug] [MainThread]: On master: Close
[0m11:58:20.743973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:20.744437 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m11:58:20.744862 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m11:58:20.745339 [info ] [MainThread]: 
[0m11:58:20.745910 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.75 seconds (13.75s).
[0m11:58:20.746956 [debug] [MainThread]: Command end result
[0m11:58:20.774554 [info ] [MainThread]: 
[0m11:58:20.775231 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:58:20.775816 [info ] [MainThread]: 
[0m11:58:20.776381 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:58:20.777407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.660628, "process_user_time": 4.667923, "process_kernel_time": 0.277183, "process_mem_max_rss": "276412", "process_in_blocks": "1184", "process_out_blocks": "109656"}
[0m11:58:20.778070 [debug] [MainThread]: Command `dbt run` succeeded at 11:58:20.777957 after 15.66 seconds
[0m11:58:20.778576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e00dbbd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df4971220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc9baa660>]}
[0m11:58:20.779075 [debug] [MainThread]: Flushing usage events
[0m11:58:22.396565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88f4261e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88ffb61e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88fb1ad20>]}


============================== 11:58:22.399237 | 001014b8-5f70-43ea-9342-46f2c47cca55 ==============================
[0m11:58:22.399237 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:58:22.399979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:58:22.547161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '001014b8-5f70-43ea-9342-46f2c47cca55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88f05b9b0>]}
[0m11:58:22.563649 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21528837, "process_user_time": 1.396306, "process_kernel_time": 0.112346, "process_mem_max_rss": "92296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:58:22.564278 [debug] [MainThread]: Command `dbt clean` succeeded at 11:58:22.564176 after 0.22 seconds
[0m11:58:22.564731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa892bbbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88ed820c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88f3774a0>]}
[0m11:58:22.565171 [debug] [MainThread]: Flushing usage events
[0m14:05:29.796131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9ea67d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9ee85b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9f4a6f60>]}


============================== 14:05:29.803199 | 2af7c019-afb8-4289-8b7b-019084e56bdf ==============================
[0m14:05:29.803199 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:29.803872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:29.948789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2af7c019-afb8-4289-8b7b-019084e56bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aa01f2030>]}
[0m14:05:29.962120 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x27b7apb'
[0m14:05:29.962588 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:30.034077 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:30.034720 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:30.044487 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:30.048221 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:30.109828 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:30.110333 [info ] [MainThread]: Up to date!
[0m14:05:30.110835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2af7c019-afb8-4289-8b7b-019084e56bdf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9e881970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9e83ffe0>]}
[0m14:05:30.112250 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.36413231, "process_user_time": 1.489832, "process_kernel_time": 0.191208, "process_mem_max_rss": "93560", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m14:05:30.112845 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:30.112741 after 0.36 seconds
[0m14:05:30.113313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9ebc41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9fb93fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9e993d70>]}
[0m14:05:30.113748 [debug] [MainThread]: Flushing usage events
[0m14:05:31.691401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d21eda00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d25f6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d25f70e0>]}


============================== 14:05:31.694415 | c68646c2-0eb3-4fe2-812a-11c3169b7cd1 ==============================
[0m14:05:31.694415 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:31.695131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:31.930002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d1fe6a80>]}
[0m14:05:31.988327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d2613b90>]}
[0m14:05:31.989188 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:32.004814 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:32.005594 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:32.006140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d339c170>]}
[0m14:05:33.209653 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:33.210378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29cb4a4140>]}
[0m14:05:33.399606 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:33.404509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29cb2191c0>]}
[0m14:05:33.533715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29cb3a0230>]}
[0m14:05:33.534319 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:33.534855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29cb37c9b0>]}
[0m14:05:33.536609 [info ] [MainThread]: 
[0m14:05:33.537362 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:33.542145 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:33.577596 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:33.578096 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:33.578506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:34.131404 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:34.132949 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:34.135358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:34.135951 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:34.142804 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.143263 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:34.143678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:34.149251 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.150572 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.150980 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:34.151623 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.152028 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.152410 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:34.152991 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.153961 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:34.154372 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.154761 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:34.155296 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.155718 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:34.157860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:34.163067 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:34.163493 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:34.163877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:34.168890 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.169355 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:34.169770 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:34.189891 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.194471 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:34.195642 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:34.196062 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:34.199612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d228b290>]}
[0m14:05:34.200135 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.200539 [debug] [MainThread]: On master: BEGIN
[0m14:05:34.200925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:34.206016 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.206445 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.206849 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.207237 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.207861 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.208282 [debug] [MainThread]: On master: Close
[0m14:05:34.210014 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:34.210510 [info ] [MainThread]: 
[0m14:05:34.219894 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:34.220506 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:34.221258 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:34.221714 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:34.246784 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:34.247536 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:34.281507 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:34.282275 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:49.959786 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:49.960314 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:49.960955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:49.961465 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:49.961918 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:49.962602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:49.965281 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:49.965757 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:49.966585 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:49.987406 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:49.987904 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:49.988354 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:49.989615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:49.994309 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:49.994794 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:49.995956 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:49.998291 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:50.023681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29c85113a0>]}
[0m14:05:50.024400 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 15.80s]
[0m14:05:50.025197 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:50.026184 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:50.026769 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:50.027343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:50.027818 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:50.032572 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:50.033250 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:50.066179 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.066696 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240623140550060382"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:50.067192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:50.083496 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.090343 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.090820 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:50.091471 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.091933 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.092385 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240623140550060382'
      
      
      order by ordinal_position

  
[0m14:05:50.124600 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.129429 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.129926 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:50.138615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.147176 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.147681 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:50.156039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.173814 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:50.174497 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.174977 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240623140550060382"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240623140550060382"
    )
  
[0m14:05:50.186742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.188430 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:50.188896 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.189398 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:50.198699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.199553 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:50.371415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299b1abdd0>]}
[0m14:05:50.372233 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m14:05:50.372984 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:50.374421 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:50.374911 [debug] [MainThread]: On master: BEGIN
[0m14:05:50.375369 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:50.380840 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:50.381374 [debug] [MainThread]: On master: COMMIT
[0m14:05:50.381832 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:50.382266 [debug] [MainThread]: On master: COMMIT
[0m14:05:50.382953 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:50.383426 [debug] [MainThread]: On master: Close
[0m14:05:50.384959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:50.385456 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:50.385881 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:50.386362 [info ] [MainThread]: 
[0m14:05:50.386970 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 16.85 seconds (16.85s).
[0m14:05:50.388079 [debug] [MainThread]: Command end result
[0m14:05:50.415657 [info ] [MainThread]: 
[0m14:05:50.416389 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:50.416998 [info ] [MainThread]: 
[0m14:05:50.417639 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:50.418721 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.775753, "process_user_time": 4.772354, "process_kernel_time": 0.284498, "process_mem_max_rss": "275324", "process_in_blocks": "1184", "process_out_blocks": "109664"}
[0m14:05:50.419376 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:50.419265 after 18.78 seconds
[0m14:05:50.419882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d21eda00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d2573860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299b1e05c0>]}
[0m14:05:50.420383 [debug] [MainThread]: Flushing usage events
[0m14:05:52.023911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8611d55eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86101cf290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86101cf200>]}


============================== 14:05:52.026652 | 600daa58-0ff4-4ca3-ad25-57516a1cc326 ==============================
[0m14:05:52.026652 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:52.027394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:52.168653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '600daa58-0ff4-4ca3-ad25-57516a1cc326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860ff63ce0>]}
[0m14:05:52.184747 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20914142, "process_user_time": 1.453116, "process_kernel_time": 0.064049, "process_mem_max_rss": "92168", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:52.185360 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:52.185253 after 0.21 seconds
[0m14:05:52.185806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86104d2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86101cf290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86101cf200>]}
[0m14:05:52.186256 [debug] [MainThread]: Flushing usage events
[0m22:05:10.780788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12309c56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1230c29f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12307061e0>]}


============================== 22:05:10.788164 | 79f1c0cb-6ce8-4e01-9d64-40024b480f62 ==============================
[0m22:05:10.788164 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:10.788840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:10.929923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79f1c0cb-6ce8-4e01-9d64-40024b480f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1230451df0>]}
[0m22:05:10.943268 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r2ucme2m'
[0m22:05:10.943737 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:11.013532 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:11.014144 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:11.035987 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:11.039603 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:11.108342 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:11.108886 [info ] [MainThread]: Up to date!
[0m22:05:11.109431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '79f1c0cb-6ce8-4e01-9d64-40024b480f62', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12305e58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f123028c230>]}
[0m22:05:11.110781 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.37822577, "process_user_time": 1.573308, "process_kernel_time": 0.108089, "process_mem_max_rss": "93624", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m22:05:11.111398 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:11.111295 after 0.38 seconds
[0m22:05:11.111838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1230503da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12303fc5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1230733e30>]}
[0m22:05:11.112270 [debug] [MainThread]: Flushing usage events
[0m22:05:12.717898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf83562ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf8189ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf81fb94c0>]}


============================== 22:05:12.720844 | b70b262e-57a4-43a4-a46b-a4f31efc8ff9 ==============================
[0m22:05:12.720844 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:12.721540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:12.952734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf8273f890>]}
[0m22:05:13.012558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf8273f890>]}
[0m22:05:13.013358 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:13.049057 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:13.049787 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:13.050337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf80dba270>]}
[0m22:05:14.259802 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:14.260484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf819cc740>]}
[0m22:05:14.451001 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:14.455983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf79f51730>]}
[0m22:05:14.583100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf79f34650>]}
[0m22:05:14.583709 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:14.584216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf79f96fc0>]}
[0m22:05:14.585909 [info ] [MainThread]: 
[0m22:05:14.586616 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:14.591572 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:14.626755 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:14.627254 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:14.627692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:15.274752 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:15.276436 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:15.278805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:15.279450 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:15.286444 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:15.286907 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:15.287368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:15.293215 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:15.294649 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:15.295075 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:15.295788 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:15.296208 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:15.296610 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:15.297200 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:15.298133 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:15.298572 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:15.298973 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:15.299678 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:15.300117 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:15.302351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:15.307833 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:15.308264 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:15.308657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:15.313602 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:15.314031 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:15.314450 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:15.334811 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:15.339509 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:15.340736 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:15.341162 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:15.344784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf81f6db20>]}
[0m22:05:15.345314 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:15.345726 [debug] [MainThread]: On master: BEGIN
[0m22:05:15.346114 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:15.351231 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:15.351678 [debug] [MainThread]: On master: COMMIT
[0m22:05:15.352082 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:15.352476 [debug] [MainThread]: On master: COMMIT
[0m22:05:15.353126 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:15.353551 [debug] [MainThread]: On master: Close
[0m22:05:15.355106 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:15.355689 [info ] [MainThread]: 
[0m22:05:15.364989 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:15.365619 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:15.366425 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:15.367153 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:15.394914 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:15.395787 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:15.430390 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:15.431259 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:25.010388 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.010928 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:25.013052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.013528 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.013980 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:25.014686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.017447 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.017923 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:25.018770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.039419 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:25.039913 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.040437 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:25.042365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.047182 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.047706 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:25.049361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.051713 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:25.078108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf700a2360>]}
[0m22:05:25.078973 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.71s]
[0m22:05:25.079822 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:25.080850 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:25.081457 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:25.082093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:25.082570 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:25.087861 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:25.088533 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:25.122123 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.122664 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240623220525116260"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:25.123159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:25.137825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.144957 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.145447 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:25.146071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.146537 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.146994 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240623220525116260'
      
      
      order by ordinal_position

  
[0m22:05:25.173611 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.178666 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.179165 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:25.187517 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.196218 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.196715 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:25.210974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.228791 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:25.229511 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.229998 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240623220525116260"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240623220525116260"
    )
  
[0m22:05:25.241928 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.243771 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:25.244244 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.244700 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:25.254342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.255264 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:25.439558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70b262e-57a4-43a4-a46b-a4f31efc8ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4d894860>]}
[0m22:05:25.440447 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m22:05:25.441365 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:25.442819 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:25.443355 [debug] [MainThread]: On master: BEGIN
[0m22:05:25.443818 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:25.449299 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:25.449784 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.450233 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:25.450674 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.451405 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:25.451881 [debug] [MainThread]: On master: Close
[0m22:05:25.453420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:25.453876 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:25.454304 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:25.454786 [info ] [MainThread]: 
[0m22:05:25.455363 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.87 seconds (10.87s).
[0m22:05:25.456406 [debug] [MainThread]: Command end result
[0m22:05:25.484305 [info ] [MainThread]: 
[0m22:05:25.484960 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:25.485484 [info ] [MainThread]: 
[0m22:05:25.486017 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:25.487036 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.818917, "process_user_time": 4.771646, "process_kernel_time": 0.307719, "process_mem_max_rss": "282988", "process_in_blocks": "1184", "process_out_blocks": "110176"}
[0m22:05:25.487720 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:25.487608 after 12.82 seconds
[0m22:05:25.488236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf78c6e720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4d882180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4d8817c0>]}
[0m22:05:25.488742 [debug] [MainThread]: Flushing usage events
[0m22:05:27.197886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2c656d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2a999a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2a99be0>]}


============================== 22:05:27.200742 | cca7d8f3-1abe-4a23-a91b-55a8dc57f2a0 ==============================
[0m22:05:27.200742 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:27.201471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:27.345162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cca7d8f3-1abe-4a23-a91b-55a8dc57f2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2ae8ec0>]}
[0m22:05:27.361880 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21280985, "process_user_time": 1.422547, "process_kernel_time": 0.123873, "process_mem_max_rss": "92292", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:27.362490 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:27.362375 after 0.21 seconds
[0m22:05:27.362943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2884b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2886300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd1ffda60>]}
[0m22:05:27.363429 [debug] [MainThread]: Flushing usage events
[0m06:02:00.653671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f6de3a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f7283f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f6d53dd0>]}


============================== 06:02:00.661198 | 543961bf-a289-4072-9bda-21801dee755f ==============================
[0m06:02:00.661198 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:00.661956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:00.810563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '543961bf-a289-4072-9bda-21801dee755f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f6ca3050>]}
[0m06:02:00.824298 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nah4g3gi'
[0m06:02:00.824776 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:00.915608 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:00.916464 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:00.928787 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:00.932676 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:00.980795 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:00.981404 [info ] [MainThread]: Up to date!
[0m06:02:00.982013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '543961bf-a289-4072-9bda-21801dee755f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f6f0fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f6b4b0e0>]}
[0m06:02:00.983473 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.37835535, "process_user_time": 1.594632, "process_kernel_time": 0.144238, "process_mem_max_rss": "93552", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m06:02:00.984120 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:00.984011 after 0.38 seconds
[0m06:02:00.984575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f7e2ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f6b2b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51fa2e9c40>]}
[0m06:02:00.985019 [debug] [MainThread]: Flushing usage events
[0m06:02:02.617297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108ae98980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1089ab2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1089798080>]}


============================== 06:02:02.620441 | 52801b4c-9882-47f3-a75a-7aa5aaeb9cbe ==============================
[0m06:02:02.620441 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:02.621258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:02.861859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1089777a40>]}
[0m06:02:02.921969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108965b3b0>]}
[0m06:02:02.922861 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:02.938779 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:02.939526 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:02.940115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1082d1e030>]}
[0m06:02:04.149093 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:04.149823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1082cd5a30>]}
[0m06:02:04.344676 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:04.349978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1082951730>]}
[0m06:02:04.509500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108282b0b0>]}
[0m06:02:04.510130 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:04.510706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1082844e60>]}
[0m06:02:04.512544 [info ] [MainThread]: 
[0m06:02:04.513316 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:04.518245 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:04.554486 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:04.555000 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:04.555421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:05.078477 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:05.080130 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:05.082393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:05.083015 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:05.090030 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.090485 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:05.090898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:05.096653 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.098071 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.098494 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:05.099184 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.099600 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.100067 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:05.100666 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.101601 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:05.102016 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.102415 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:05.102959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.103387 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:05.105543 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:05.111120 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:05.111554 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:05.111989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:05.117225 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.117658 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:05.118073 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:05.138445 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.143454 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:05.144681 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:05.145106 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:05.148525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1089b34170>]}
[0m06:02:05.149061 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:05.149467 [debug] [MainThread]: On master: BEGIN
[0m06:02:05.149851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:05.155140 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:05.155589 [debug] [MainThread]: On master: COMMIT
[0m06:02:05.156033 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:05.156426 [debug] [MainThread]: On master: COMMIT
[0m06:02:05.157065 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:05.157486 [debug] [MainThread]: On master: Close
[0m06:02:05.159180 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:05.159726 [info ] [MainThread]: 
[0m06:02:05.169325 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:05.169963 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:05.170712 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:05.171169 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:05.197204 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:05.198007 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:05.232727 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:05.233569 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:12.048995 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:12.049561 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:12.050228 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.050701 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:12.051160 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:12.052096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.054978 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:12.055452 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:12.056368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.077194 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:12.077710 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:12.078173 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:12.079579 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.084522 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:12.085017 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:12.086343 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.088768 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:12.115776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10563df470>]}
[0m06:02:12.116647 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.94s]
[0m06:02:12.117483 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:12.118507 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:12.119117 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:12.119753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:12.120269 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:12.125574 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:12.126259 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:12.160159 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:12.160738 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240624060212154192"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:12.161250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:12.177208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.185265 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:12.185832 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:12.186558 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.187039 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:12.187509 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240624060212154192'
      
      
      order by ordinal_position

  
[0m06:02:12.214548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.220383 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:12.220926 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:12.229754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.238967 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:12.239488 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:12.248748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.267096 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:12.267894 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:12.268396 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240624060212154192"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240624060212154192"
    )
  
[0m06:02:12.281902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.283963 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:12.284472 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:12.284938 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:12.294410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:12.295361 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:12.478831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52801b4c-9882-47f3-a75a-7aa5aaeb9cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105614aab0>]}
[0m06:02:12.479768 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m06:02:12.480660 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:12.482277 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.482790 [debug] [MainThread]: On master: BEGIN
[0m06:02:12.483254 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:12.488950 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.489449 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.489904 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.490349 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.491060 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.491556 [debug] [MainThread]: On master: Close
[0m06:02:12.493384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:12.493838 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:12.494266 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:12.494763 [info ] [MainThread]: 
[0m06:02:12.495335 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.98 seconds (7.98s).
[0m06:02:12.496453 [debug] [MainThread]: Command end result
[0m06:02:12.525027 [info ] [MainThread]: 
[0m06:02:12.525730 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:12.526289 [info ] [MainThread]: 
[0m06:02:12.526864 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:12.527959 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.960196, "process_user_time": 4.884432, "process_kernel_time": 0.284958, "process_mem_max_rss": "288128", "process_in_blocks": "1184", "process_out_blocks": "110168"}
[0m06:02:12.528624 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:12.528510 after 9.96 seconds
[0m06:02:12.529329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1089872ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1056a1e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1082829640>]}
[0m06:02:12.529960 [debug] [MainThread]: Flushing usage events
[0m06:02:14.251099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bea19af00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bea44ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be955c110>]}


============================== 06:02:14.254074 | dceb43fc-f73c-4d0e-bfe4-47d5e9c7739f ==============================
[0m06:02:14.254074 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.254709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.400214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dceb43fc-f73c-4d0e-bfe4-47d5e9c7739f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be9ba2ff0>]}
[0m06:02:14.416769 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21444912, "process_user_time": 1.453364, "process_kernel_time": 0.079855, "process_mem_max_rss": "92280", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:14.417384 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:14.417278 after 0.22 seconds
[0m06:02:14.417840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be988d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be97d3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bea804560>]}
[0m06:02:14.418292 [debug] [MainThread]: Flushing usage events
[0m14:05:08.108772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cf3353050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cf3353b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cf283bdd0>]}


============================== 14:05:08.116922 | 665ef06c-78aa-4c88-b960-ee2929c41746 ==============================
[0m14:05:08.116922 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:08.117654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:08.355685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '665ef06c-78aa-4c88-b960-ee2929c41746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cf63bbd40>]}
[0m14:05:08.372704 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wop012c9'
[0m14:05:08.373438 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:08.430146 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:08.431433 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:08.445083 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:08.449944 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:08.505789 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:08.506610 [info ] [MainThread]: Up to date!
[0m14:05:08.507272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '665ef06c-78aa-4c88-b960-ee2929c41746', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cf2cf6870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cf2736ff0>]}
[0m14:05:08.509184 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45352206, "process_user_time": 2.071649, "process_kernel_time": 0.132232, "process_mem_max_rss": "93560", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m14:05:08.509899 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:08.509788 after 0.45 seconds
[0m14:05:08.510416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cf29f5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cf63bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cf63bbd10>]}
[0m14:05:08.510918 [debug] [MainThread]: Flushing usage events
[0m14:05:12.135533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d7721790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d66e2630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d5c4caa0>]}


============================== 14:05:12.140110 | 1fd57981-6756-4ce2-b4f4-452f138ca36a ==============================
[0m14:05:12.140110 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:12.141218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:12.429853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d715af00>]}
[0m14:05:12.497626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d6419c10>]}
[0m14:05:12.498906 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:12.517882 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:12.518890 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:12.519530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d5bca900>]}
[0m14:05:13.840047 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:13.840959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8cefcaf00>]}
[0m14:05:14.057176 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:14.064025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8cec93770>]}
[0m14:05:14.286692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8cecf3b90>]}
[0m14:05:14.287517 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:14.288169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d70b9fd0>]}
[0m14:05:14.290459 [info ] [MainThread]: 
[0m14:05:14.291521 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:14.298153 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:14.347952 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:14.348641 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:14.349136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:14.895475 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:14.897755 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:14.901289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:14.902160 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:14.910773 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.911423 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:14.911927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:14.918727 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.920494 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.920929 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:14.921678 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.922189 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.922612 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:14.923260 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.924299 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:14.924720 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.925114 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:14.925649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.926078 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:14.928950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:14.935168 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:14.935674 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:14.936120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:14.942372 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.942934 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:14.943383 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:14.964749 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.972190 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:14.973862 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:14.974452 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:14.980274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d6418e60>]}
[0m14:05:14.981028 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:14.981503 [debug] [MainThread]: On master: BEGIN
[0m14:05:14.981961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:14.989480 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:14.990184 [debug] [MainThread]: On master: COMMIT
[0m14:05:14.990678 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:14.991150 [debug] [MainThread]: On master: COMMIT
[0m14:05:14.991815 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:14.992325 [debug] [MainThread]: On master: Close
[0m14:05:14.995035 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:14.995685 [info ] [MainThread]: 
[0m14:05:15.007193 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:15.008185 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:15.009140 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:15.009715 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:15.040364 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:15.041379 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:15.081811 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:15.082905 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:23.046575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.047363 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:23.048703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.049355 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.049954 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:23.051016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.054674 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.055213 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:23.056484 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.080642 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:23.081385 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.081888 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:23.083529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.090944 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.091730 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:23.093641 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.097079 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:23.131360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ea7b890>]}
[0m14:05:23.132711 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.12s]
[0m14:05:23.133695 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:23.134968 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:23.135644 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:23.136425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:23.136933 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:23.143660 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:23.144808 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:23.183013 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.183722 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240624140523176509"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:23.184285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:23.203702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.212127 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.212790 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:23.213697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.214167 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.214619 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240624140523176509'
      
      
      order by ordinal_position

  
[0m14:05:23.247759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.255660 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.256462 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:23.268577 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.280591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.281255 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:23.291922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.313666 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:23.314679 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.315246 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240624140523176509"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240624140523176509"
    )
  
[0m14:05:23.329329 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.331661 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:23.332346 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.332828 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:23.346408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.347819 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:23.539420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fd57981-6756-4ce2-b4f4-452f138ca36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89eab3fb0>]}
[0m14:05:23.540465 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.40s]
[0m14:05:23.541312 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:23.543342 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:23.544292 [debug] [MainThread]: On master: BEGIN
[0m14:05:23.544972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:23.552301 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:23.553051 [debug] [MainThread]: On master: COMMIT
[0m14:05:23.553631 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:23.554179 [debug] [MainThread]: On master: COMMIT
[0m14:05:23.555095 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:23.555644 [debug] [MainThread]: On master: Close
[0m14:05:23.558167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:23.558736 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:23.559216 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:23.559800 [info ] [MainThread]: 
[0m14:05:23.560489 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.27 seconds (9.27s).
[0m14:05:23.561624 [debug] [MainThread]: Command end result
[0m14:05:23.595489 [info ] [MainThread]: 
[0m14:05:23.596369 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:23.596928 [info ] [MainThread]: 
[0m14:05:23.597478 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:23.598604 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.520457, "process_user_time": 5.643769, "process_kernel_time": 0.385624, "process_mem_max_rss": "273568", "process_in_blocks": "1184", "process_out_blocks": "110648"}
[0m14:05:23.599302 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:23.599186 after 11.52 seconds
[0m14:05:23.599887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d5d0e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b3de3fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8cedebc50>]}
[0m14:05:23.600435 [debug] [MainThread]: Flushing usage events
[0m14:05:26.419065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72d456f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72d4a9e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72d409ae10>]}


============================== 14:05:26.422611 | 9b37b026-5bef-4a21-895b-6f3079381875 ==============================
[0m14:05:26.422611 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:26.423441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:26.622052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b37b026-5bef-4a21-895b-6f3079381875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72d519c9e0>]}
[0m14:05:26.644699 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.27845472, "process_user_time": 1.696782, "process_kernel_time": 0.119772, "process_mem_max_rss": "92040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:26.645527 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:26.645396 after 0.28 seconds
[0m14:05:26.646113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72d409b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72d4a9e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72d3fe1610>]}
[0m14:05:26.646699 [debug] [MainThread]: Flushing usage events
[0m22:06:34.120951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd074cf9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd073b1d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd073132750>]}


============================== 22:06:34.128696 | fc502711-3971-4a88-89b7-b8b176b37af6 ==============================
[0m22:06:34.128696 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:34.129470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:34.275237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc502711-3971-4a88-89b7-b8b176b37af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0734dd430>]}
[0m22:06:34.288929 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xikfdj4u'
[0m22:06:34.289483 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:34.428092 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:34.428844 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:34.440837 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:34.444601 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:34.493811 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:34.494411 [info ] [MainThread]: Up to date!
[0m22:06:34.495173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fc502711-3971-4a88-89b7-b8b176b37af6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd072e97aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd072e97d70>]}
[0m22:06:34.496771 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42490903, "process_user_time": 1.615261, "process_kernel_time": 0.131289, "process_mem_max_rss": "93560", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m22:06:34.497414 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:34.497307 after 0.43 seconds
[0m22:06:34.497872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd07312fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd072f9aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0734dd430>]}
[0m22:06:34.498308 [debug] [MainThread]: Flushing usage events
[0m22:06:36.143271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502c0648f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502c362000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502c066c90>]}


============================== 22:06:36.146200 | 848d815f-3df2-47ab-90b5-dfaa7f2feeed ==============================
[0m22:06:36.146200 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:36.146874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:36.378949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5024b2d100>]}
[0m22:06:36.439635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502b64a600>]}
[0m22:06:36.440552 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:06:36.455946 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:36.456681 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:36.457270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5024a195b0>]}
[0m22:06:37.664825 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:37.665600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502486a480>]}
[0m22:06:37.858520 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:37.866063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5024650200>]}
[0m22:06:37.990636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50248ec140>]}
[0m22:06:37.991231 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:37.991723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50247e38f0>]}
[0m22:06:37.993489 [info ] [MainThread]: 
[0m22:06:37.994205 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:37.999104 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:38.035221 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:38.035734 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:06:38.036149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:38.597064 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:38.598648 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:38.600864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:38.601457 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:38.608229 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:38.608672 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:06:38.609077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:38.614833 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:38.616170 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:38.616586 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:38.617455 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:38.617872 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:38.618268 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:38.618842 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:38.619769 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:38.620199 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:38.620599 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:38.621142 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:38.621619 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:38.623765 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:38.629270 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:38.629703 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:38.630098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:38.635277 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:38.635716 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:38.636125 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:06:38.656496 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:38.661470 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:38.662692 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:38.663109 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:38.667222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502463a390>]}
[0m22:06:38.667759 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:38.668162 [debug] [MainThread]: On master: BEGIN
[0m22:06:38.668548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:38.673913 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:38.674354 [debug] [MainThread]: On master: COMMIT
[0m22:06:38.674752 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:38.675135 [debug] [MainThread]: On master: COMMIT
[0m22:06:38.675784 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:38.676204 [debug] [MainThread]: On master: Close
[0m22:06:38.677854 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:38.678356 [info ] [MainThread]: 
[0m22:06:38.687685 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:38.688324 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:38.688981 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:38.689472 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:38.715176 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:38.716010 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:38.750829 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:38.751731 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:50.550761 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:50.551398 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:50.554702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.555197 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:50.555651 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:50.556602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.559546 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:50.560023 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:50.560790 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.581725 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:50.582255 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:50.582709 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:50.584365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.589303 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:50.589791 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:50.591081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.593493 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:50.620174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5024a2eb40>]}
[0m22:06:50.620993 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.93s]
[0m22:06:50.621817 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:50.622828 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:50.623428 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:50.624027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:50.624495 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:50.629723 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:50.630407 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:50.664554 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:50.665147 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240624220650658583"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:50.665658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:50.682506 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.689979 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:50.690478 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:50.691106 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.691566 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:50.692035 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240624220650658583'
      
      
      order by ordinal_position

  
[0m22:06:50.718661 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.723851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:50.724351 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:50.733055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.741965 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:50.742480 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:50.751888 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.770543 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:50.771385 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:50.771883 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240624220650658583"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240624220650658583"
    )
  
[0m22:06:50.785253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.787299 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:50.787780 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:50.788238 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:50.799797 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:50.800852 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:50.913269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848d815f-3df2-47ab-90b5-dfaa7f2feeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ff8545280>]}
[0m22:06:50.914147 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m22:06:50.915033 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:50.916480 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:50.916979 [debug] [MainThread]: On master: BEGIN
[0m22:06:50.917478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:50.923126 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:50.923630 [debug] [MainThread]: On master: COMMIT
[0m22:06:50.924086 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:50.924530 [debug] [MainThread]: On master: COMMIT
[0m22:06:50.925281 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:50.925761 [debug] [MainThread]: On master: Close
[0m22:06:50.927469 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:50.927926 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:50.928349 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:50.928840 [info ] [MainThread]: 
[0m22:06:50.929422 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.93 seconds (12.93s).
[0m22:06:50.930465 [debug] [MainThread]: Command end result
[0m22:06:50.959191 [info ] [MainThread]: 
[0m22:06:50.959901 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:50.960436 [info ] [MainThread]: 
[0m22:06:50.960967 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:50.962013 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.868215, "process_user_time": 4.793325, "process_kernel_time": 0.326727, "process_mem_max_rss": "283524", "process_in_blocks": "1184", "process_out_blocks": "105576"}
[0m22:06:50.962675 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:50.962561 after 14.87 seconds
[0m22:06:50.963189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502c362000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5024928c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f502463ab10>]}
[0m22:06:50.963688 [debug] [MainThread]: Flushing usage events
[0m22:06:52.728559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41de21c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41de91b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41de232f0>]}


============================== 22:06:52.731573 | 37535ad6-40ae-43d2-b0fe-1a809f224ce8 ==============================
[0m22:06:52.731573 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:52.732333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:52.883718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37535ad6-40ae-43d2-b0fe-1a809f224ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41dbd0650>]}
[0m22:06:52.900740 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22148597, "process_user_time": 1.411532, "process_kernel_time": 0.135954, "process_mem_max_rss": "92156", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:52.901392 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:52.901279 after 0.22 seconds
[0m22:06:52.901853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41e1b2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41dc02c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41de566c0>]}
[0m22:06:52.902303 [debug] [MainThread]: Flushing usage events
[0m07:40:41.837141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106faab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084233e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108422c30>]}


============================== 07:40:41.839892 | 8c979e33-25f2-471d-8581-5ec05ac4114b ==============================
[0m07:40:41.839892 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:40:41.840229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:40:42.041136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c979e33-25f2-471d-8581-5ec05ac4114b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728d9d0>]}
[0m07:40:42.066190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c979e33-25f2-471d-8581-5ec05ac4114b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e45dc0>]}
[0m07:40:42.066827 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m07:40:42.079292 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:40:42.146500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:40:42.146746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:40:42.149655 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m07:40:42.163421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c979e33-25f2-471d-8581-5ec05ac4114b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108614b60>]}
[0m07:40:42.209720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c979e33-25f2-471d-8581-5ec05ac4114b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10885a8d0>]}
[0m07:40:42.210019 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m07:40:42.210196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c979e33-25f2-471d-8581-5ec05ac4114b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084fcb00>]}
[0m07:40:42.211031 [info ] [MainThread]: 
[0m07:40:42.211325 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:40:42.213399 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m07:40:42.244257 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m07:40:42.244526 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m07:40:42.244695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:40:42.262543 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:40:42.263876 [debug] [ThreadPool]: On list_petro: Close
[0m07:40:42.265293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m07:40:42.265564 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m07:40:42.268855 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:40:42.269041 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m07:40:42.269191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:40:42.273218 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:40:42.273919 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:40:42.274068 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m07:40:42.274263 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:40:42.274401 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:40:42.274535 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m07:40:42.275148 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:40:42.275550 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m07:40:42.275684 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:40:42.275806 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m07:40:42.275985 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:40:42.276122 [debug] [ThreadPool]: On create_petro_main: Close
[0m07:40:42.277246 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m07:40:42.279821 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m07:40:42.279987 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m07:40:42.280121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:40:42.283679 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:40:42.283888 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m07:40:42.284039 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m07:40:42.301920 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:40:42.306432 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m07:40:42.307390 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m07:40:42.307548 [debug] [ThreadPool]: On list_petro_main: Close
[0m07:40:42.309497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c979e33-25f2-471d-8581-5ec05ac4114b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c2510>]}
[0m07:40:42.309774 [debug] [MainThread]: Using duckdb connection "master"
[0m07:40:42.309927 [debug] [MainThread]: On master: BEGIN
[0m07:40:42.310065 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:40:42.313443 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:40:42.313627 [debug] [MainThread]: On master: COMMIT
[0m07:40:42.313772 [debug] [MainThread]: Using duckdb connection "master"
[0m07:40:42.313901 [debug] [MainThread]: On master: COMMIT
[0m07:40:42.314074 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:40:42.314212 [debug] [MainThread]: On master: Close
[0m07:40:42.315020 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m07:40:42.315200 [info ] [MainThread]: 
[0m07:40:42.317130 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m07:40:42.317437 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m07:40:42.317690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m07:40:42.317857 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m07:40:42.331045 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m07:40:42.332113 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m07:40:42.349185 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m07:40:42.349948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:40:52.475597 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:40:52.476053 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m07:40:52.476415 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.476630 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:40:52.476842 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m07:40:52.477643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.479425 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:40:52.479671 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m07:40:52.480035 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.491700 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m07:40:52.491937 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:40:52.492125 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m07:40:52.492509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.495195 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:40:52.495423 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m07:40:52.496020 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.497347 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m07:40:52.519540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c979e33-25f2-471d-8581-5ec05ac4114b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d4cb6b0>]}
[0m07:40:52.519937 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.20s]
[0m07:40:52.520258 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m07:40:52.520711 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m07:40:52.521006 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m07:40:52.521262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m07:40:52.521449 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m07:40:52.529515 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m07:40:52.530338 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m07:40:52.547050 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:40:52.547390 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240625074052544367"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m07:40:52.547595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:40:52.560404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.565652 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:40:52.565877 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m07:40:52.566159 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.566324 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:40:52.566485 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240625074052544367'
      
      
      order by ordinal_position

  
[0m07:40:52.589090 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.591897 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:40:52.592108 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m07:40:52.599321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.602992 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:40:52.603194 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m07:40:52.610430 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.618421 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m07:40:52.618861 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:40:52.619066 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240625074052544367"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240625074052544367"
    )
  
[0m07:40:52.628701 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.629543 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m07:40:52.629726 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:40:52.629884 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m07:40:52.634643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:40:52.635090 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m07:40:52.693783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c979e33-25f2-471d-8581-5ec05ac4114b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d40d820>]}
[0m07:40:52.694305 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m07:40:52.694649 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m07:40:52.695590 [debug] [MainThread]: Using duckdb connection "master"
[0m07:40:52.695784 [debug] [MainThread]: On master: BEGIN
[0m07:40:52.695935 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:40:52.700061 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:40:52.700295 [debug] [MainThread]: On master: COMMIT
[0m07:40:52.700454 [debug] [MainThread]: Using duckdb connection "master"
[0m07:40:52.700595 [debug] [MainThread]: On master: COMMIT
[0m07:40:52.700785 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:40:52.700935 [debug] [MainThread]: On master: Close
[0m07:40:52.701936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:40:52.702128 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m07:40:52.702319 [info ] [MainThread]: 
[0m07:40:52.702505 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.49 seconds (10.49s).
[0m07:40:52.702906 [debug] [MainThread]: Command end result
[0m07:40:52.719008 [info ] [MainThread]: 
[0m07:40:52.719280 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:40:52.719455 [info ] [MainThread]: 
[0m07:40:52.719629 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:40:52.721161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.919691, "process_user_time": 3.11396, "process_kernel_time": 0.78215, "process_mem_max_rss": "207339520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:40:52.721488 [debug] [MainThread]: Command `dbt run` succeeded at 07:40:52.721447 after 10.92 seconds
[0m07:40:52.721698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a11f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e77f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d477d40>]}
[0m07:40:52.721873 [debug] [MainThread]: Flushing usage events
[0m06:02:13.176009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe725679b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe725ac7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe72567a090>]}


============================== 06:02:13.183691 | 56de5e40-84d4-4cc0-95b6-3d1ee1fec1ce ==============================
[0m06:02:13.183691 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:13.184370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.347411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56de5e40-84d4-4cc0-95b6-3d1ee1fec1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7254e3bf0>]}
[0m06:02:13.362484 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1xv8r8fi'
[0m06:02:13.363080 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:13.392340 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:13.393179 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:13.406237 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:13.410224 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:13.656237 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:13.656829 [info ] [MainThread]: Up to date!
[0m06:02:13.657398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '56de5e40-84d4-4cc0-95b6-3d1ee1fec1ce', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7254e2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7253c0380>]}
[0m06:02:13.658977 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5325097, "process_user_time": 1.628601, "process_kernel_time": 0.149154, "process_mem_max_rss": "93564", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m06:02:13.659605 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:13.659498 after 0.53 seconds
[0m06:02:13.660063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7255ebe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7254e1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe725a4b5f0>]}
[0m06:02:13.660508 [debug] [MainThread]: Flushing usage events
[0m06:02:18.908497 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m06:02:20.529266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6084277b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6082c37860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f608214c320>]}


============================== 06:02:20.532228 | fd1bfae7-e340-44f0-9d8c-14faa4721fae ==============================
[0m06:02:20.532228 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:20.532981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.777188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6082222000>]}
[0m06:02:20.839652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f608219c1d0>]}
[0m06:02:20.840652 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:20.857638 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:20.858543 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:20.859150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f608205deb0>]}
[0m06:02:22.085030 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:22.085803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f607b495f40>]}
[0m06:02:22.283626 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:22.289327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f607b3064e0>]}
[0m06:02:22.428208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f607b3045c0>]}
[0m06:02:22.428809 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:22.429306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f607b3b7ef0>]}
[0m06:02:22.431114 [info ] [MainThread]: 
[0m06:02:22.431848 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:22.436857 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:22.474646 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:22.475194 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:22.475623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:22.903341 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.904924 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:22.907326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:22.907946 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:22.915163 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.915693 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:22.916108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:22.922522 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.924155 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.924611 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:22.925194 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.925604 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.926015 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:22.926682 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.927667 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:22.928104 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.928504 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:22.929392 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.929836 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:22.932583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:22.938511 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.939044 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:22.939456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:22.945260 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.945766 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.946255 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:22.967343 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.973334 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:22.974759 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:22.975215 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:22.979300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60824cb5c0>]}
[0m06:02:22.979882 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.980317 [debug] [MainThread]: On master: BEGIN
[0m06:02:22.980705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:22.986319 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.986831 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.987254 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.987689 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.988236 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.988682 [debug] [MainThread]: On master: Close
[0m06:02:22.990572 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:22.991111 [info ] [MainThread]: 
[0m06:02:23.001159 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:23.001847 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:23.002619 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:23.003081 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:23.029663 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:23.030620 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:23.066339 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:23.067261 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:32.074808 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.075392 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:32.076370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.076846 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.077298 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:32.078230 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.081285 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.081766 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:32.082766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.103876 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:32.104397 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.104850 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:32.106941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.112035 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.112542 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:32.113785 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.116258 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:32.143204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604ac2a840>]}
[0m06:02:32.144050 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.14s]
[0m06:02:32.144834 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:32.145855 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:32.146473 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:32.147094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:32.147574 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:32.152764 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:32.153477 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:32.187445 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.188014 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240625060232181455"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:32.188499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:32.205219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.213019 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.213544 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:32.214386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.214858 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.215328 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240625060232181455'
      
      
      order by ordinal_position

  
[0m06:02:32.242477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.248087 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.248631 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:32.257481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.266740 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.267265 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:32.276011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.294606 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:32.295371 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.295870 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240625060232181455"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240625060232181455"
    )
  
[0m06:02:32.307150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.309132 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:32.309612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.310051 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:32.318860 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.319838 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:32.425886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1bfae7-e340-44f0-9d8c-14faa4721fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604ac3ecc0>]}
[0m06:02:32.426816 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.28s]
[0m06:02:32.427613 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:32.429120 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:32.429630 [debug] [MainThread]: On master: BEGIN
[0m06:02:32.430080 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:32.435705 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:32.436235 [debug] [MainThread]: On master: COMMIT
[0m06:02:32.436695 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:32.437136 [debug] [MainThread]: On master: COMMIT
[0m06:02:32.437821 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:32.438343 [debug] [MainThread]: On master: Close
[0m06:02:32.440087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:32.440545 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:32.440968 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:32.441456 [info ] [MainThread]: 
[0m06:02:32.442127 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.01 seconds (10.01s).
[0m06:02:32.443285 [debug] [MainThread]: Command end result
[0m06:02:32.472435 [info ] [MainThread]: 
[0m06:02:32.473239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:32.473868 [info ] [MainThread]: 
[0m06:02:32.474533 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:32.475687 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.995988, "process_user_time": 4.84027, "process_kernel_time": 0.3187, "process_mem_max_rss": "270920", "process_in_blocks": "1184", "process_out_blocks": "106080"}
[0m06:02:32.476352 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:32.476238 after 12.00 seconds
[0m06:02:32.476871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60832094c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60833c77a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6082e031d0>]}
[0m06:02:32.477372 [debug] [MainThread]: Flushing usage events
[0m06:02:38.219978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931dd2a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931b603050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931b6031a0>]}


============================== 06:02:38.223045 | dd1fc596-d65e-4a7d-90d7-8a675e25bef7 ==============================
[0m06:02:38.223045 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:38.223738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:38.380308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd1fc596-d65e-4a7d-90d7-8a675e25bef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931b600c80>]}
[0m06:02:38.397560 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22758175, "process_user_time": 1.439669, "process_kernel_time": 0.140357, "process_mem_max_rss": "92004", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:38.398222 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:38.398076 after 0.23 seconds
[0m06:02:38.398694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931b6031a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931b600c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931c1ef8f0>]}
[0m06:02:38.399167 [debug] [MainThread]: Flushing usage events
[0m14:05:02.345601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a02f26f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a02d633b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0249a270>]}


============================== 14:05:02.353102 | 93fbe739-3253-4a17-96e1-6c3cc7e3f29d ==============================
[0m14:05:02.353102 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:02.353774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:02.499736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93fbe739-3253-4a17-96e1-6c3cc7e3f29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0234c9e0>]}
[0m14:05:02.513385 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-e38vpglk'
[0m14:05:02.513884 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:02.548182 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:02.548880 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:02.559734 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:02.563517 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:02.773050 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:02.773691 [info ] [MainThread]: Up to date!
[0m14:05:02.774297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '93fbe739-3253-4a17-96e1-6c3cc7e3f29d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a021d3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a022e8230>]}
[0m14:05:02.775857 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47860673, "process_user_time": 1.604244, "process_kernel_time": 0.119719, "process_mem_max_rss": "93568", "process_in_blocks": "5672", "process_out_blocks": "3840"}
[0m14:05:02.776514 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:02.776398 after 0.48 seconds
[0m14:05:02.777034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a024e7da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a02602120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0249bd40>]}
[0m14:05:02.777499 [debug] [MainThread]: Flushing usage events
[0m14:05:05.185648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6b09dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6b9519d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e695272f0>]}


============================== 14:05:05.188456 | e0126243-bace-48a1-800a-203525940d96 ==============================
[0m14:05:05.188456 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:05.189201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:05.427462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e69497590>]}
[0m14:05:05.486739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6955a600>]}
[0m14:05:05.487613 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:05.502777 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:05.503522 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:05.504109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6926c230>]}
[0m14:05:06.708048 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:06.708734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e692ba5d0>]}
[0m14:05:06.898580 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:06.903791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e62686b40>]}
[0m14:05:07.062341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e626f17f0>]}
[0m14:05:07.062916 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:07.063403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e62593200>]}
[0m14:05:07.065145 [info ] [MainThread]: 
[0m14:05:07.065848 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:07.070750 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:07.106616 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:07.107137 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:07.107558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:07.615736 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:07.617402 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:07.619560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:07.620127 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:07.626892 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:07.627337 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:07.627744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:07.633560 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.634910 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:07.635332 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:07.636019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.636437 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:07.636870 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:07.637469 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.638397 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:07.638818 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:07.639221 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:07.639775 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.640205 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:07.642332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:07.647815 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:07.648247 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:07.648644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:07.653718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.654144 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:07.654559 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:07.674939 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.679750 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:07.681021 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:07.681454 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:07.685100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6ab699a0>]}
[0m14:05:07.685619 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:07.686018 [debug] [MainThread]: On master: BEGIN
[0m14:05:07.686408 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:07.691643 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:07.692101 [debug] [MainThread]: On master: COMMIT
[0m14:05:07.692518 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:07.692943 [debug] [MainThread]: On master: COMMIT
[0m14:05:07.693584 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:07.693997 [debug] [MainThread]: On master: Close
[0m14:05:07.695540 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:07.696042 [info ] [MainThread]: 
[0m14:05:07.705841 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:07.706479 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:07.707155 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:07.707614 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:07.733452 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:07.734218 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:07.768678 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:07.769515 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:16.952493 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.953065 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:16.953749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.954214 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.954656 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:16.955374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.958130 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.958603 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:16.959304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.979953 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:16.980568 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.981053 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:16.983260 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.988457 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.988968 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:16.990398 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.992891 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:17.018971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6254c2c0>]}
[0m14:05:17.019810 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.31s]
[0m14:05:17.020594 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:17.021645 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:17.022238 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:17.022888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:17.023358 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:17.028471 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:17.029184 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:17.062514 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.063076 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240625140517056573"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:17.063559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:17.077993 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.085250 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.085733 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:17.086366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.086840 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.087296 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240625140517056573'
      
      
      order by ordinal_position

  
[0m14:05:17.114105 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.119350 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.119850 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:17.128493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.137332 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.137838 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:17.146714 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.164774 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:17.165517 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.166011 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240625140517056573"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240625140517056573"
    )
  
[0m14:05:17.179955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.181941 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:17.182417 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.182860 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:17.192065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.193030 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:17.302450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0126243-bace-48a1-800a-203525940d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e324564b0>]}
[0m14:05:17.303290 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.28s]
[0m14:05:17.304058 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:17.305533 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:17.306055 [debug] [MainThread]: On master: BEGIN
[0m14:05:17.306504 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:17.311935 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:17.312417 [debug] [MainThread]: On master: COMMIT
[0m14:05:17.312903 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:17.313343 [debug] [MainThread]: On master: COMMIT
[0m14:05:17.313900 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:17.314364 [debug] [MainThread]: On master: Close
[0m14:05:17.315734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:17.316179 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:17.316599 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:17.317178 [info ] [MainThread]: 
[0m14:05:17.317709 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.25 seconds (10.25s).
[0m14:05:17.318724 [debug] [MainThread]: Command end result
[0m14:05:17.347035 [info ] [MainThread]: 
[0m14:05:17.347797 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:17.348340 [info ] [MainThread]: 
[0m14:05:17.348902 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:17.349978 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.212913, "process_user_time": 4.789226, "process_kernel_time": 0.248063, "process_mem_max_rss": "281232", "process_in_blocks": "1184", "process_out_blocks": "106552"}
[0m14:05:17.350646 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:17.350533 after 12.21 seconds
[0m14:05:17.351186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6cfbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e603cde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e324c11c0>]}
[0m14:05:17.351729 [debug] [MainThread]: Flushing usage events
[0m14:05:22.302937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5625f64b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5625f6ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5625f7ce0>]}


============================== 14:05:22.305828 | 497692df-b625-41ed-bc81-e25a74709f80 ==============================
[0m14:05:22.305828 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:22.307807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:22.450924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '497692df-b625-41ed-bc81-e25a74709f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5624215e0>]}
[0m14:05:22.467395 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21292976, "process_user_time": 1.428454, "process_kernel_time": 0.119702, "process_mem_max_rss": "92060", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:22.467996 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:22.467891 after 0.21 seconds
[0m14:05:22.468450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa562fa2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa56269a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5623bb7d0>]}
[0m14:05:22.468921 [debug] [MainThread]: Flushing usage events
[0m14:05:27.683242 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m22:05:19.580864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f951fa4e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9520319d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9522099730>]}


============================== 22:05:19.610791 | 4a7538a1-ce9a-4c0f-9049-fdf157541d30 ==============================
[0m22:05:19.610791 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:19.611499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:19.752427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a7538a1-ce9a-4c0f-9049-fdf157541d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f951fa4cd70>]}
[0m22:05:19.765844 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r6prohk1'
[0m22:05:19.766310 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:19.946538 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:19.947283 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:19.978096 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:19.981835 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:20.339983 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:20.340598 [info ] [MainThread]: Up to date!
[0m22:05:20.341150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4a7538a1-ce9a-4c0f-9049-fdf157541d30', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95200b2ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f951f7b31a0>]}
[0m22:05:20.352202 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8198836, "process_user_time": 1.558904, "process_kernel_time": 0.136957, "process_mem_max_rss": "93560", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m22:05:20.352827 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:20.352721 after 0.82 seconds
[0m22:05:20.353282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f951fbb2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95200b2ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95207870b0>]}
[0m22:05:20.353733 [debug] [MainThread]: Flushing usage events
[0m22:05:22.148294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70ca455730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c833b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c80a3500>]}


============================== 22:05:22.151091 | 104a067d-e94e-4cd2-ac44-ca8c69a3b8a6 ==============================
[0m22:05:22.151091 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:22.151820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:22.375964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c7dece90>]}
[0m22:05:22.434292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c151e9f0>]}
[0m22:05:22.435083 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:22.455070 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:22.455813 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:22.456340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c7ea8e30>]}
[0m22:05:23.659035 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:23.659725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c151f950>]}
[0m22:05:23.848750 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:23.853985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c102e030>]}
[0m22:05:23.986102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c7e58fb0>]}
[0m22:05:23.986674 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:23.987217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c862af60>]}
[0m22:05:23.988948 [info ] [MainThread]: 
[0m22:05:23.989674 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:23.994373 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:24.029287 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:24.029739 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:24.030150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:24.668486 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:24.670036 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:24.672186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:24.672750 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:24.679664 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.680110 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:24.680521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.685927 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.687260 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.687672 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:24.688328 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.688736 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.689128 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:24.689695 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.690614 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.691085 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.691487 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.692018 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.692435 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:24.694402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:24.699679 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.700104 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:24.700491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.705371 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.705800 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.706203 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:24.726577 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.731442 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:24.732679 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:24.733117 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:24.736879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c11d3f20>]}
[0m22:05:24.737406 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.737805 [debug] [MainThread]: On master: BEGIN
[0m22:05:24.738183 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:24.743522 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.743963 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.744364 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.744740 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.745371 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.745788 [debug] [MainThread]: On master: Close
[0m22:05:24.747495 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:24.747995 [info ] [MainThread]: 
[0m22:05:24.767139 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:24.767772 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:24.768472 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:24.768917 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:24.794395 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:24.795164 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:24.829236 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:24.829965 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:39.176656 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.177172 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:39.177787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.178246 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.178689 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:39.179637 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.182297 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.182763 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:39.183490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.204194 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:39.204680 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.205127 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:39.207584 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.212317 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.212803 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:39.214574 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.216925 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:39.243418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c97d6600>]}
[0m22:05:39.244136 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 14.47s]
[0m22:05:39.245047 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:39.246022 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:39.246583 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:39.247291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:39.247763 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:39.252602 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:39.253239 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:39.286461 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:39.286999 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240625220539280686"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:39.287477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:39.302010 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.308939 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:39.309405 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:39.309991 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.310448 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:39.310950 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240625220539280686'
      
      
      order by ordinal_position

  
[0m22:05:39.337508 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.342453 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:39.342971 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:39.351609 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.360354 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:39.360847 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:39.369453 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.387471 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:39.388164 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:39.388661 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240625220539280686"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240625220539280686"
    )
  
[0m22:05:39.402406 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.404159 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:39.404648 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:39.405085 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:39.416140 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.417024 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:39.538059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '104a067d-e94e-4cd2-ac44-ca8c69a3b8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7094928560>]}
[0m22:05:39.538925 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m22:05:39.539802 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:39.541225 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:39.541718 [debug] [MainThread]: On master: BEGIN
[0m22:05:39.542162 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:39.547578 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:39.548061 [debug] [MainThread]: On master: COMMIT
[0m22:05:39.548504 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:39.548934 [debug] [MainThread]: On master: COMMIT
[0m22:05:39.549629 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:39.550093 [debug] [MainThread]: On master: Close
[0m22:05:39.551512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:39.551957 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:39.552370 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:39.552835 [info ] [MainThread]: 
[0m22:05:39.553373 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 15.56 seconds (15.56s).
[0m22:05:39.554362 [debug] [MainThread]: Command end result
[0m22:05:39.581849 [info ] [MainThread]: 
[0m22:05:39.582493 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:39.583060 [info ] [MainThread]: 
[0m22:05:39.583598 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:39.584580 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.484686, "process_user_time": 4.632635, "process_kernel_time": 0.34986, "process_mem_max_rss": "274952", "process_in_blocks": "1184", "process_out_blocks": "107112"}
[0m22:05:39.585225 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:39.585116 after 17.49 seconds
[0m22:05:39.585723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70ca455730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c102d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c8435100>]}
[0m22:05:39.586213 [debug] [MainThread]: Flushing usage events
[0m22:05:41.490062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c144b1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c12bf2330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c130aae70>]}


============================== 22:05:41.492823 | b7d417b0-1f2c-44f6-9abf-0137890c9397 ==============================
[0m22:05:41.492823 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:41.493492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:41.635405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7d417b0-1f2c-44f6-9abf-0137890c9397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c13e4b1d0>]}
[0m22:05:41.651571 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2107093, "process_user_time": 1.43257, "process_kernel_time": 0.079808, "process_mem_max_rss": "92064", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:41.652172 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:41.652068 after 0.21 seconds
[0m22:05:41.652623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c12a20da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c12688890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c12a7acc0>]}
[0m22:05:41.653069 [debug] [MainThread]: Flushing usage events
[0m06:02:24.793021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e6d31730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e4a95c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e56842c0>]}


============================== 06:02:24.838694 | 3a5afe4d-6aca-41ea-ae5b-e63d285a99df ==============================
[0m06:02:24.838694 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.839787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.984902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a5afe4d-6aca-41ea-ae5b-e63d285a99df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e4534050>]}
[0m06:02:24.998271 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6032hz3a'
[0m06:02:24.998733 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:25.072663 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:25.073390 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:25.095481 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:25.099187 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:25.173236 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:25.173798 [info ] [MainThread]: Up to date!
[0m06:02:25.174378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3a5afe4d-6aca-41ea-ae5b-e63d285a99df', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e44cd1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e44ce810>]}
[0m06:02:25.186576 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44206268, "process_user_time": 1.596394, "process_kernel_time": 0.12676, "process_mem_max_rss": "93688", "process_in_blocks": "5672", "process_out_blocks": "3840"}
[0m06:02:25.187327 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:25.187198 after 0.44 seconds
[0m06:02:25.187779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e4832000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e5716c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e4415580>]}
[0m06:02:25.188230 [debug] [MainThread]: Flushing usage events
[0m06:02:26.782673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55ec33680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5611d5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55ec33890>]}


============================== 06:02:26.785472 | 2e48f65e-7087-424a-a4d8-1859e2d42895 ==============================
[0m06:02:26.785472 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:26.786129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.009370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55f90b530>]}
[0m06:02:27.068192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55ebfdeb0>]}
[0m06:02:27.069006 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:27.083902 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:27.084620 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:27.085184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55eade840>]}
[0m06:02:28.292390 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:28.293045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc557e924e0>]}
[0m06:02:28.485493 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:28.490893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc557ef3fb0>]}
[0m06:02:28.705980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc557d4d0a0>]}
[0m06:02:28.706557 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:28.707057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc557da9610>]}
[0m06:02:28.708792 [info ] [MainThread]: 
[0m06:02:28.709497 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:28.714458 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:28.749970 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:28.750454 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:28.750871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:29.119419 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.120987 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:29.123297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:29.123896 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:29.130776 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.131284 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:29.131718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.137183 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.138509 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.138925 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:29.139827 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.140249 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.140645 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:29.141275 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.142204 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.142620 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.143019 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.143609 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.144031 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:29.146088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:29.151459 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.151888 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:29.152278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.157311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.157737 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.158157 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:29.178304 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.182996 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:29.184193 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:29.184614 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:29.187857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55f7e6d20>]}
[0m06:02:29.188382 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.188781 [debug] [MainThread]: On master: BEGIN
[0m06:02:29.189159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:29.194190 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.194623 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.195017 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.195440 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.196067 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.196477 [debug] [MainThread]: On master: Close
[0m06:02:29.197919 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:29.198454 [info ] [MainThread]: 
[0m06:02:29.213799 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:29.214405 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:29.215165 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:29.215630 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:29.240631 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:29.241364 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:29.275724 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:29.276477 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:41.827485 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:41.828008 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:41.828619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.829085 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:41.829531 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:41.830220 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.832946 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:41.833417 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:41.834283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.854784 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:41.855302 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:41.855754 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:41.857001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.861746 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:41.862234 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:41.863592 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.865896 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:41.893473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc527b0d550>]}
[0m06:02:41.894219 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.68s]
[0m06:02:41.895121 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:41.896122 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:41.896694 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:41.897374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:41.897857 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:41.902754 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:41.903429 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:41.936586 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:41.937101 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240626060241930784"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:41.937577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:41.952390 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.959283 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:41.959758 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:41.960344 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.960797 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:41.961242 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240626060241930784'
      
      
      order by ordinal_position

  
[0m06:02:41.987306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:41.992165 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:41.992655 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:42.006855 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.015352 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:42.015860 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:42.029609 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.047440 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:42.048144 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:42.048624 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240626060241930784"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240626060241930784"
    )
  
[0m06:02:42.062903 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.064711 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:42.065168 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:42.065605 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:42.075919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:42.076804 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:42.207348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e48f65e-7087-424a-a4d8-1859e2d42895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc527b837a0>]}
[0m06:02:42.208161 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m06:02:42.208913 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:42.210296 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:42.210787 [debug] [MainThread]: On master: BEGIN
[0m06:02:42.211278 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:42.216581 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:42.217067 [debug] [MainThread]: On master: COMMIT
[0m06:02:42.217514 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:42.217953 [debug] [MainThread]: On master: COMMIT
[0m06:02:42.218656 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:42.219154 [debug] [MainThread]: On master: Close
[0m06:02:42.220603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:42.221057 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:42.221477 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:42.221949 [info ] [MainThread]: 
[0m06:02:42.222554 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.51 seconds (13.51s).
[0m06:02:42.223708 [debug] [MainThread]: Command end result
[0m06:02:42.251281 [info ] [MainThread]: 
[0m06:02:42.251974 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:42.252569 [info ] [MainThread]: 
[0m06:02:42.253181 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:42.254262 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.519896, "process_user_time": 4.757894, "process_kernel_time": 0.293102, "process_mem_max_rss": "270912", "process_in_blocks": "1184", "process_out_blocks": "108608"}
[0m06:02:42.254909 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:42.254799 after 15.52 seconds
[0m06:02:42.255453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55ef0f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55ec337a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc527b9e1e0>]}
[0m06:02:42.255949 [debug] [MainThread]: Flushing usage events
[0m06:02:43.887650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79df6930b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79df33b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79df33ba40>]}


============================== 06:02:43.890472 | 8e5cce46-8e9e-4382-a387-2138a8e6c650 ==============================
[0m06:02:43.890472 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:43.891254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:44.037609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e5cce46-8e9e-4382-a387-2138a8e6c650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79df584b90>]}
[0m06:02:44.054387 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21854515, "process_user_time": 1.394104, "process_kernel_time": 0.144217, "process_mem_max_rss": "92024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:44.054974 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:44.054872 after 0.22 seconds
[0m06:02:44.055461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79dfb335f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79df690830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79dfcd3800>]}
[0m06:02:44.055907 [debug] [MainThread]: Flushing usage events
[0m14:04:48.911773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fcc9d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fb74db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fb0c2090>]}


============================== 14:04:48.930136 | d3375578-7281-4150-93f7-8a19a5836904 ==============================
[0m14:04:48.930136 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:48.930822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:49.076408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3375578-7281-4150-93f7-8a19a5836904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5faf20110>]}
[0m14:04:49.090161 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8eespdjs'
[0m14:04:49.090648 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:49.245434 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:49.246332 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:49.330195 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:49.334166 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:49.406837 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:49.407452 [info ] [MainThread]: Up to date!
[0m14:04:49.408015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd3375578-7281-4150-93f7-8a19a5836904', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fb4ea990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fae0c6b0>]}
[0m14:04:49.409449 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5469035, "process_user_time": 1.622801, "process_kernel_time": 0.122999, "process_mem_max_rss": "93540", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m14:04:49.410061 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:49.409954 after 0.55 seconds
[0m14:04:49.410519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fcc9d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fcf50c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5faebb560>]}
[0m14:04:49.410962 [debug] [MainThread]: Flushing usage events
[0m14:04:51.000156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fc2552b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fab62000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f9e85d00>]}


============================== 14:04:51.003107 | d653fea0-4bf6-4744-8ecf-2d99eed48452 ==============================
[0m14:04:51.003107 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:51.003765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:51.231023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f9bc86e0>]}
[0m14:04:51.290405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f9c54920>]}
[0m14:04:51.291262 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:51.306555 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:51.307300 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:51.307854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f9c0b770>]}
[0m14:04:52.519409 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:52.520195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f30dfda0>]}
[0m14:04:52.714377 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:52.720518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f306a510>]}
[0m14:04:52.856459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f9c7ff20>]}
[0m14:04:52.857071 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:52.857563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fad7a960>]}
[0m14:04:52.859316 [info ] [MainThread]: 
[0m14:04:52.860039 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:52.864839 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:52.902157 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:52.902701 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:52.903136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:53.475120 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:53.476703 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:53.479190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:53.479781 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:53.486664 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.487114 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:53.487522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:53.493353 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.494770 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.495199 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:53.495756 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.496228 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.496617 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:53.497269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.498213 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:53.498629 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.499028 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:53.499562 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.499991 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:53.502442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:53.508061 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:53.508502 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:53.508892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:53.514379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.514819 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:53.515251 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:53.535025 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.539921 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:53.541211 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:53.541659 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:53.545296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f2ec2390>]}
[0m14:04:53.545835 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:53.546247 [debug] [MainThread]: On master: BEGIN
[0m14:04:53.546629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:53.551909 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:53.552346 [debug] [MainThread]: On master: COMMIT
[0m14:04:53.552739 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:53.553175 [debug] [MainThread]: On master: COMMIT
[0m14:04:53.553812 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:53.554228 [debug] [MainThread]: On master: Close
[0m14:04:53.555859 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:53.556361 [info ] [MainThread]: 
[0m14:04:53.566551 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:53.567202 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:53.567866 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:53.568320 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:53.594472 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:53.595323 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:53.630138 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:53.630945 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:00.960750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:00.961342 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:00.961985 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:00.962448 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:00.962904 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:00.963601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:00.966302 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:00.966776 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:00.967470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:00.988107 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:00.988621 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:00.989097 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:00.990382 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:00.995243 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:00.995732 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:00.996897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:00.999300 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:01.025094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fb5da180>]}
[0m14:05:01.025842 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.46s]
[0m14:05:01.026626 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:01.027618 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:01.028194 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:01.028802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:01.029306 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:01.034278 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:01.034967 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:01.068419 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.068952 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240626140501062545"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:01.069483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:01.085896 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.093129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.093617 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:01.094216 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.094676 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.095127 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240626140501062545'
      
      
      order by ordinal_position

  
[0m14:05:01.127058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.132216 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.132722 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:01.144341 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.153128 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.153630 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:01.167610 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.185757 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:01.186463 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.186951 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240626140501062545"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240626140501062545"
    )
  
[0m14:05:01.199995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.201807 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:01.202276 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.202718 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:01.213627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.214533 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:01.338190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd653fea0-4bf6-4744-8ecf-2d99eed48452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c2d20bc0>]}
[0m14:05:01.339043 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m14:05:01.339909 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:01.341509 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:01.342001 [debug] [MainThread]: On master: BEGIN
[0m14:05:01.342450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:01.347782 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:01.348272 [debug] [MainThread]: On master: COMMIT
[0m14:05:01.348723 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:01.349200 [debug] [MainThread]: On master: COMMIT
[0m14:05:01.349887 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:01.350361 [debug] [MainThread]: On master: Close
[0m14:05:01.351807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:01.352253 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:01.352670 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:01.353198 [info ] [MainThread]: 
[0m14:05:01.353808 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.49 seconds (8.49s).
[0m14:05:01.354937 [debug] [MainThread]: Command end result
[0m14:05:01.382566 [info ] [MainThread]: 
[0m14:05:01.383274 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:01.383896 [info ] [MainThread]: 
[0m14:05:01.384513 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:01.385613 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.434969, "process_user_time": 4.828375, "process_kernel_time": 0.26556, "process_mem_max_rss": "276552", "process_in_blocks": "1184", "process_out_blocks": "107592"}
[0m14:05:01.386266 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:01.386155 after 10.44 seconds
[0m14:05:01.386774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fa4365d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f9e85d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fb5da180>]}
[0m14:05:01.387275 [debug] [MainThread]: Flushing usage events
[0m14:05:03.045990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63cc5f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63d932c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63cc5f2f0>]}


============================== 14:05:03.048842 | 2c7146b5-edb6-4833-a89f-82e2073def4a ==============================
[0m14:05:03.048842 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:03.049532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:03.191429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c7146b5-edb6-4833-a89f-82e2073def4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63ca549e0>]}
[0m14:05:03.208067 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21137992, "process_user_time": 1.409804, "process_kernel_time": 0.108138, "process_mem_max_rss": "92016", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:03.208669 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:03.208563 after 0.21 seconds
[0m14:05:03.209174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63dc45e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6409bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63cf92fc0>]}
[0m14:05:03.209629 [debug] [MainThread]: Flushing usage events
[0m22:05:19.993750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fb2c8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43faa2bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fc58d820>]}


============================== 22:05:20.000761 | 21dfe44b-9508-4e25-98ed-106da07d6d84 ==============================
[0m22:05:20.000761 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:20.001394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:20.137477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21dfe44b-9508-4e25-98ed-106da07d6d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fab422a0>]}
[0m22:05:20.150492 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vdhar8hk'
[0m22:05:20.150952 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:20.226360 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:20.226984 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:20.250073 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:20.253765 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:20.326015 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:20.326523 [info ] [MainThread]: Up to date!
[0m22:05:20.327051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '21dfe44b-9508-4e25-98ed-106da07d6d84', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fa6ea0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fa7433e0>]}
[0m22:05:20.344124 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.39853555, "process_user_time": 1.54561, "process_kernel_time": 0.120125, "process_mem_max_rss": "93680", "process_in_blocks": "5672", "process_out_blocks": "3840"}
[0m22:05:20.344734 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:20.344628 after 0.40 seconds
[0m22:05:20.345176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fe7bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fbbcef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fab422a0>]}
[0m22:05:20.345608 [debug] [MainThread]: Flushing usage events
[0m22:05:21.894260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe802617860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8028f33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe802614c20>]}


============================== 22:05:21.897044 | c1b33cc7-0a1b-4b04-a777-a23cd209ce2b ==============================
[0m22:05:21.897044 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:21.897780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:22.115655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7fb769f40>]}
[0m22:05:22.174693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7fb743860>]}
[0m22:05:22.175541 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:22.190818 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:22.191585 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:22.192130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7fb7b90d0>]}
[0m22:05:23.382859 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:23.383533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7fb768a10>]}
[0m22:05:23.574213 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:23.579226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80203d4f0>]}
[0m22:05:23.712949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe802bc2f60>]}
[0m22:05:23.713518 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:23.714028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7fb2aef60>]}
[0m22:05:23.715739 [info ] [MainThread]: 
[0m22:05:23.716438 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:23.721147 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:23.755751 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:23.756200 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:23.756607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:24.393270 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:24.394804 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:24.397119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:24.397703 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:24.404464 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.404912 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:24.405318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.410778 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.412057 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.412438 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:24.413257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.413670 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.414062 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:24.414612 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.415596 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.416016 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.416406 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.417050 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.417473 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:24.419638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:24.424909 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.425336 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:24.425723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.430563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.430986 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.431453 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:24.451405 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.456143 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:24.457339 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:24.457763 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:24.461107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe803290380>]}
[0m22:05:24.461657 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.462065 [debug] [MainThread]: On master: BEGIN
[0m22:05:24.462454 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:24.467636 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.468072 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.468478 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.468867 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.469397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.469823 [debug] [MainThread]: On master: Close
[0m22:05:24.471326 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:24.471838 [info ] [MainThread]: 
[0m22:05:24.486149 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:24.486762 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:24.487449 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:24.487900 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:24.513598 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:24.514336 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:24.548618 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:24.549446 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:32.823253 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:32.823734 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:32.824321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:32.824750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:32.825162 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:32.825968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:32.828666 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:32.829135 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:32.829824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:32.850137 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:32.850615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:32.851097 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:32.853078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:32.857860 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:32.858354 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:32.859479 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:32.861745 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:32.887151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7cab6f500>]}
[0m22:05:32.887855 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.40s]
[0m22:05:32.888735 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:32.889695 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:32.890270 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:32.890947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:32.891419 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:32.896178 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:32.896829 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:32.929652 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:32.930184 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240626220532923885"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:32.930683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:32.945055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:32.951832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:32.952310 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:32.952852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:32.953278 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:32.953693 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240626220532923885'
      
      
      order by ordinal_position

  
[0m22:05:32.979004 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:32.983854 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:32.984353 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:32.993080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.001851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.002346 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:33.010881 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.028810 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:33.029493 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.029974 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240626220532923885"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240626220532923885"
    )
  
[0m22:05:33.042692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.044481 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:33.044941 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.045376 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:33.054519 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.055429 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:33.191058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b33cc7-0a1b-4b04-a777-a23cd209ce2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7cabf0e00>]}
[0m22:05:33.191890 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m22:05:33.192760 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:33.194155 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.194647 [debug] [MainThread]: On master: BEGIN
[0m22:05:33.195131 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:33.200465 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.200950 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.201395 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.201824 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.202388 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.202845 [debug] [MainThread]: On master: Close
[0m22:05:33.204220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:33.204669 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:33.205083 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:33.205548 [info ] [MainThread]: 
[0m22:05:33.206086 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.49 seconds (9.49s).
[0m22:05:33.207132 [debug] [MainThread]: Command end result
[0m22:05:33.234830 [info ] [MainThread]: 
[0m22:05:33.235491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:33.236011 [info ] [MainThread]: 
[0m22:05:33.236540 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:33.237530 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.392115, "process_user_time": 4.670752, "process_kernel_time": 0.253015, "process_mem_max_rss": "271668", "process_in_blocks": "1184", "process_out_blocks": "108648"}
[0m22:05:33.238182 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:33.238073 after 11.39 seconds
[0m22:05:33.238687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8028f33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe805806a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f0f42a80>]}
[0m22:05:33.239198 [debug] [MainThread]: Flushing usage events
[0m22:05:34.930727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0246272c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02464f2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0246271a00>]}


============================== 22:05:34.933586 | 512226c7-dd91-4eb2-b176-118bae286117 ==============================
[0m22:05:34.933586 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:34.934264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:35.078053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '512226c7-dd91-4eb2-b176-118bae286117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0245610770>]}
[0m22:05:35.094176 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21260738, "process_user_time": 1.471596, "process_kernel_time": 0.103971, "process_mem_max_rss": "92084", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:35.094756 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:35.094653 after 0.21 seconds
[0m22:05:35.095241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02464f2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0245612c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02462a0e00>]}
[0m22:05:35.095681 [debug] [MainThread]: Flushing usage events
[0m06:02:14.788059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62f38e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd631619970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62f81b3b0>]}


============================== 06:02:14.795673 | 277c7d73-cd1d-4ee7-9ac3-779d6d91dcef ==============================
[0m06:02:14.795673 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.796366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.938225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '277c7d73-cd1d-4ee7-9ac3-779d6d91dcef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62efebbf0>]}
[0m06:02:14.951584 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-bxrqygv0'
[0m06:02:14.952043 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:15.196532 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:15.197409 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:15.230583 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:15.234476 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:15.595964 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:15.596598 [info ] [MainThread]: Up to date!
[0m06:02:15.597172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '277c7d73-cd1d-4ee7-9ac3-779d6d91dcef', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62f18d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62efeb410>]}
[0m06:02:15.598744 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8588429, "process_user_time": 1.602331, "process_kernel_time": 0.133527, "process_mem_max_rss": "93396", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m06:02:15.599387 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:15.599241 after 0.86 seconds
[0m06:02:15.599842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62f2f65a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62effa270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62eff9040>]}
[0m06:02:15.600280 [debug] [MainThread]: Flushing usage events
[0m06:02:18.293131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc892c31bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8935ab8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc894a6c560>]}


============================== 06:02:18.295984 | ebef625f-1923-4357-9fcb-b6410c6f3867 ==============================
[0m06:02:18.295984 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:18.296721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:18.526471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8929c1e20>]}
[0m06:02:18.586016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8929c1e20>]}
[0m06:02:18.586887 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:18.602539 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:18.603281 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:18.603878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc892ad09e0>]}
[0m06:02:19.799333 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:19.800018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc892a93cb0>]}
[0m06:02:19.989754 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:19.994897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc892869520>]}
[0m06:02:20.121262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88bb6bad0>]}
[0m06:02:20.121843 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:20.122346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8941d6b40>]}
[0m06:02:20.124070 [info ] [MainThread]: 
[0m06:02:20.124772 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:20.129738 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:20.165655 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:20.166189 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:20.166617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:20.756629 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:20.758153 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:20.760377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:20.760947 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:20.767688 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:20.768129 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:20.768542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:20.773821 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.775113 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:20.775584 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:20.776214 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.776620 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:20.777009 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:20.777556 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.778462 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:20.778874 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:20.779268 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:20.779851 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.780268 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:20.782285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:20.787499 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:20.787920 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:20.788304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:20.793255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.793682 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:20.794088 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:20.813669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.818452 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:20.819655 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:20.820067 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:20.823356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8937d5820>]}
[0m06:02:20.823886 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.824299 [debug] [MainThread]: On master: BEGIN
[0m06:02:20.824684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:20.829860 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.830288 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.830687 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.831068 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.831734 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.832152 [debug] [MainThread]: On master: Close
[0m06:02:20.833816 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:20.834307 [info ] [MainThread]: 
[0m06:02:20.844542 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:20.845177 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:20.845932 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:20.846385 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:20.872146 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:20.872905 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:20.907243 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:20.908103 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:33.371876 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:33.372404 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:33.373039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.373507 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:33.373959 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:33.374651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.377380 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:33.377852 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:33.378733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.399433 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:33.399930 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:33.400439 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:33.402899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.407735 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:33.408217 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:33.409547 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.411928 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:33.440199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc88bb10c80>]}
[0m06:02:33.440994 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.59s]
[0m06:02:33.441785 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:33.442776 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:33.443392 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:33.444017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:33.444484 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:33.449546 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:33.450210 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:33.483946 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.484491 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240627060233477997"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:33.484988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:33.501275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.508488 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.508971 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:33.509570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.510054 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.510506 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240627060233477997'
      
      
      order by ordinal_position

  
[0m06:02:33.536716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.541728 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.542215 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:33.549986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.558591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.559095 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:33.567568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.585621 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:33.586330 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.586810 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240627060233477997"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240627060233477997"
    )
  
[0m06:02:33.602768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.604718 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:33.605191 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.605632 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:33.615272 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.616226 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:33.759687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebef625f-1923-4357-9fcb-b6410c6f3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc85b98bfe0>]}
[0m06:02:33.760541 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m06:02:33.761408 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:33.762826 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:33.763383 [debug] [MainThread]: On master: BEGIN
[0m06:02:33.763874 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:33.769178 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:33.769654 [debug] [MainThread]: On master: COMMIT
[0m06:02:33.770103 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:33.770540 [debug] [MainThread]: On master: COMMIT
[0m06:02:33.771228 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:33.771737 [debug] [MainThread]: On master: Close
[0m06:02:33.773120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:33.773564 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:33.773983 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:33.774453 [info ] [MainThread]: 
[0m06:02:33.774983 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.65 seconds (13.65s).
[0m06:02:33.776037 [debug] [MainThread]: Command end result
[0m06:02:33.803533 [info ] [MainThread]: 
[0m06:02:33.804220 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:33.804728 [info ] [MainThread]: 
[0m06:02:33.805248 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:33.806227 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.561697, "process_user_time": 4.723607, "process_kernel_time": 0.300738, "process_mem_max_rss": "267856", "process_in_blocks": "1184", "process_out_blocks": "108616"}
[0m06:02:33.806876 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:33.806767 after 15.56 seconds
[0m06:02:33.807416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8965bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc892f882c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc85ba32b10>]}
[0m06:02:33.807924 [debug] [MainThread]: Flushing usage events
[0m06:02:39.608514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711a4d5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711c0df650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711b7d1b20>]}


============================== 06:02:39.611477 | 6cd69af9-1d5e-4535-83c8-ac622bb23f1b ==============================
[0m06:02:39.611477 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:39.612201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:39.775670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cd69af9-1d5e-4535-83c8-ac622bb23f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711a4d7260>]}
[0m06:02:39.792071 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23307717, "process_user_time": 1.472227, "process_kernel_time": 0.080012, "process_mem_max_rss": "92288", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:39.792667 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:39.792563 after 0.23 seconds
[0m06:02:39.793129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711b669670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711a331820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711a593a70>]}
[0m06:02:39.793577 [debug] [MainThread]: Flushing usage events
[0m14:05:18.631806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9810563da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9810c5b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9810762000>]}


============================== 14:05:18.679988 | 64105381-5b6c-4181-943f-263bc38ccdb4 ==============================
[0m14:05:18.679988 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:18.680664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:18.822449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64105381-5b6c-4181-943f-263bc38ccdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98106475c0>]}
[0m14:05:18.835818 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q1ll6ac8'
[0m14:05:18.836288 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:18.951352 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:18.952084 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:18.996233 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:19.000018 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:19.071568 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:19.072101 [info ] [MainThread]: Up to date!
[0m14:05:19.072616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '64105381-5b6c-4181-943f-263bc38ccdb4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981044a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9810415dc0>]}
[0m14:05:19.074004 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49170014, "process_user_time": 1.589429, "process_kernel_time": 0.107018, "process_mem_max_rss": "93556", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m14:05:19.074604 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:19.074499 after 0.49 seconds
[0m14:05:19.075046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9810a4b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981044a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9810eb6480>]}
[0m14:05:19.075511 [debug] [MainThread]: Flushing usage events
[0m14:05:21.773380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a12ecc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a12ecf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a12ec530>]}


============================== 14:05:21.776214 | 174142d3-82e4-42d3-ba93-6535f8f7b519 ==============================
[0m14:05:21.776214 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:21.776889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:22.004955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a1153500>]}
[0m14:05:22.064964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a1783e00>]}
[0m14:05:22.065827 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:22.225731 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:22.226541 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:22.227116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a1d537a0>]}
[0m14:05:23.453429 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:23.454082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79a5c49e0>]}
[0m14:05:23.646036 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:23.651110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79a4b7980>]}
[0m14:05:23.778046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79a4b58e0>]}
[0m14:05:23.778618 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:23.779177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79a35b110>]}
[0m14:05:23.780921 [info ] [MainThread]: 
[0m14:05:23.781668 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:23.786533 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:23.822247 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:23.822735 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:23.823157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:24.219073 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.220735 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:24.223029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:24.223681 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:24.230738 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:24.231223 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:24.231663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:24.237379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.238742 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:24.239164 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:24.239736 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.240149 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:24.240548 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:24.241127 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.242064 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:24.242482 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:24.242884 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:24.243517 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.244000 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:24.245999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:24.251382 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:24.251814 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:24.252207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:24.257125 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.257552 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:24.257981 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:24.278005 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.284562 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:24.285776 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:24.286195 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:24.289487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a1eb32c0>]}
[0m14:05:24.290014 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:24.290422 [debug] [MainThread]: On master: BEGIN
[0m14:05:24.290807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:24.295952 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:24.296403 [debug] [MainThread]: On master: COMMIT
[0m14:05:24.296813 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:24.297209 [debug] [MainThread]: On master: COMMIT
[0m14:05:24.297865 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:24.298290 [debug] [MainThread]: On master: Close
[0m14:05:24.299895 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:24.300414 [info ] [MainThread]: 
[0m14:05:24.334277 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:24.334909 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:24.335618 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:24.336079 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:24.361676 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:24.362435 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:24.396862 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:24.397622 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:33.630597 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:33.631161 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:33.631911 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.632382 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:33.632838 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:33.633583 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.636452 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:33.636927 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:33.637634 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.658461 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:33.658991 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:33.659486 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:33.661250 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.666173 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:33.666680 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:33.667885 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.670257 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:33.696063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7989d5c70>]}
[0m14:05:33.696850 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.36s]
[0m14:05:33.697750 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:33.698752 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:33.699365 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:33.700057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:33.700534 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:33.705593 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:33.706260 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:33.740379 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.740922 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240627140533734419"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:33.741414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:33.755882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.762956 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.763473 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:33.764087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.764553 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.765009 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240627140533734419'
      
      
      order by ordinal_position

  
[0m14:05:33.791229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.796145 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.796642 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:33.805225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.813934 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.814447 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:33.823239 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.841319 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:33.842039 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.842530 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240627140533734419"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240627140533734419"
    )
  
[0m14:05:33.855620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.857468 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:33.857937 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.858383 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:33.868001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.868907 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:34.016763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '174142d3-82e4-42d3-ba93-6535f8f7b519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76b7e5580>]}
[0m14:05:34.017616 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m14:05:34.018390 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:34.019962 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.020508 [debug] [MainThread]: On master: BEGIN
[0m14:05:34.020953 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:34.026436 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.026921 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.027439 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.027884 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.028581 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.029046 [debug] [MainThread]: On master: Close
[0m14:05:34.030530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:34.030977 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:34.031457 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:34.031942 [info ] [MainThread]: 
[0m14:05:34.032543 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.25 seconds (10.25s).
[0m14:05:34.033653 [debug] [MainThread]: Command end result
[0m14:05:34.068014 [info ] [MainThread]: 
[0m14:05:34.068940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:34.069791 [info ] [MainThread]: 
[0m14:05:34.070617 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:34.072101 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.348133, "process_user_time": 4.761526, "process_kernel_time": 0.277019, "process_mem_max_rss": "267372", "process_in_blocks": "1184", "process_out_blocks": "108592"}
[0m14:05:34.073177 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:34.073016 after 12.35 seconds
[0m14:05:34.074054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79a693c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a1780f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76a2c8fb0>]}
[0m14:05:34.074876 [debug] [MainThread]: Flushing usage events
[0m14:05:36.704592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b88c3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b8db4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b8e37650>]}


============================== 14:05:36.707401 | f9343c0c-f144-472d-8ba1-58edfdff8657 ==============================
[0m14:05:36.707401 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:36.708155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:36.852535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9343c0c-f144-472d-8ba1-58edfdff8657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b87d4470>]}
[0m14:05:36.869168 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21403854, "process_user_time": 1.408605, "process_kernel_time": 0.120051, "process_mem_max_rss": "91924", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:36.869748 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:36.869643 after 0.21 seconds
[0m14:05:36.870197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b8804dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b8e36600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b86ebdd0>]}
[0m14:05:36.870646 [debug] [MainThread]: Flushing usage events
[0m22:05:19.388005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2159c11760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2157f97c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2158aadb80>]}


============================== 22:05:19.395717 | fff876ba-342c-4628-a5b8-f015481488cd ==============================
[0m22:05:19.395717 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:19.396408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:05:19.535653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fff876ba-342c-4628-a5b8-f015481488cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2158062030>]}
[0m22:05:19.548854 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nlyqu5e6'
[0m22:05:19.549314 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:19.583326 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:19.583975 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:19.695242 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:19.699142 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:20.056337 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:20.056976 [info ] [MainThread]: Up to date!
[0m22:05:20.057523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fff876ba-342c-4628-a5b8-f015481488cd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2157ed5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2157ed5bb0>]}
[0m22:05:20.074461 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.73503107, "process_user_time": 1.561475, "process_kernel_time": 0.125079, "process_mem_max_rss": "93304", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m22:05:20.075202 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:20.075080 after 0.74 seconds
[0m22:05:20.075659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21582149b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f215935a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2158e9aa20>]}
[0m22:05:20.076109 [debug] [MainThread]: Flushing usage events
[0m22:05:21.884783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da71dc860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da7076b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da7139730>]}


============================== 22:05:21.887653 | 635589b7-b28e-4fb4-ba9f-017d689f3397 ==============================
[0m22:05:21.887653 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:21.888386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:22.113583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da6bbb0e0>]}
[0m22:05:22.172552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da6a65490>]}
[0m22:05:22.173340 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:22.226369 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:22.227111 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:22.227655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da010eb70>]}
[0m22:05:23.432855 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:23.433558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9ff5f2f0>]}
[0m22:05:23.621673 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:23.626610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9fe95340>]}
[0m22:05:23.746788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9fff2db0>]}
[0m22:05:23.747371 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:23.747874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9fd7f7a0>]}
[0m22:05:23.749545 [info ] [MainThread]: 
[0m22:05:23.750251 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:23.755107 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:23.789763 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:23.790256 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:23.790679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:24.202191 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.203813 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:24.206200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:24.206862 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:24.213714 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.214164 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:24.214618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.220427 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.221821 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.222271 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:24.222958 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.223373 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.223769 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:24.224363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.225303 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.225718 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.226109 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.226789 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.227225 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:24.229430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:24.234780 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.235209 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:24.235597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.240690 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.241119 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.241538 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:24.261632 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.266524 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:24.267741 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:24.268163 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:24.271355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9fd3c530>]}
[0m22:05:24.271898 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.272314 [debug] [MainThread]: On master: BEGIN
[0m22:05:24.272696 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:24.277900 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.278363 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.278773 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.279167 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.279688 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.280118 [debug] [MainThread]: On master: Close
[0m22:05:24.281722 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:24.282302 [info ] [MainThread]: 
[0m22:05:24.292068 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:24.292695 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:24.293440 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:24.293913 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:24.319455 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:24.320217 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:24.354492 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:24.355248 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:37.819356 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.819899 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:37.820671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.821142 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.821591 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:37.822451 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.826694 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.827425 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:37.828374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.852894 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:37.853434 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.854181 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:37.866464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.872563 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.873216 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:37.879724 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.882724 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:37.932826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6fb03890>]}
[0m22:05:37.934034 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.64s]
[0m22:05:37.935208 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:37.936323 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:37.936937 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:37.937575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:37.938091 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:37.943265 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:37.943933 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:37.977477 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.978008 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240627220537971623"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:37.978525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:37.994480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.001438 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.001920 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:38.002653 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.003130 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.003587 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240627220537971623'
      
      
      order by ordinal_position

  
[0m22:05:38.031014 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.035850 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.036338 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:38.044953 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.053392 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.053891 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:38.062846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.080792 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:38.081532 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.082024 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240627220537971623"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240627220537971623"
    )
  
[0m22:05:38.096536 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.098473 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:38.098944 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.099386 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:38.109863 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.110843 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:38.267403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '635589b7-b28e-4fb4-ba9f-017d689f3397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6fba7e30>]}
[0m22:05:38.268253 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m22:05:38.269112 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:38.270540 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:38.271033 [debug] [MainThread]: On master: BEGIN
[0m22:05:38.271481 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:38.276738 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:38.277218 [debug] [MainThread]: On master: COMMIT
[0m22:05:38.277659 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:38.278086 [debug] [MainThread]: On master: COMMIT
[0m22:05:38.278819 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:38.279280 [debug] [MainThread]: On master: Close
[0m22:05:38.280647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:38.281090 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:38.281503 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:38.281971 [info ] [MainThread]: 
[0m22:05:38.282538 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.53 seconds (14.53s).
[0m22:05:38.283517 [debug] [MainThread]: Command end result
[0m22:05:38.311188 [info ] [MainThread]: 
[0m22:05:38.311813 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:38.312326 [info ] [MainThread]: 
[0m22:05:38.312856 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:38.313851 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.477825, "process_user_time": 4.743039, "process_kernel_time": 0.299182, "process_mem_max_rss": "267940", "process_in_blocks": "1184", "process_out_blocks": "109152"}
[0m22:05:38.314566 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:38.314450 after 16.48 seconds
[0m22:05:38.315069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da6d3bc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9ea4f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da89494f0>]}
[0m22:05:38.315566 [debug] [MainThread]: Flushing usage events
[0m22:05:40.176274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32967b4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3295dcb7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3295dcb590>]}


============================== 22:05:40.179063 | f868163d-72b5-4f51-bff4-9c07c59d2b03 ==============================
[0m22:05:40.179063 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:40.179714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:40.317941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f868163d-72b5-4f51-bff4-9c07c59d2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3296d3c9b0>]}
[0m22:05:40.334227 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2066004, "process_user_time": 1.414725, "process_kernel_time": 0.08792, "process_mem_max_rss": "92036", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:40.334865 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:40.334757 after 0.21 seconds
[0m22:05:40.335320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3295d63bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3295bf9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329692a840>]}
[0m22:05:40.335767 [debug] [MainThread]: Flushing usage events
[0m06:02:00.980306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c3a92180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c44bf260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c60cd460>]}


============================== 06:02:00.988493 | 8da4f272-398b-4d94-8bf4-d2f9b71340e5 ==============================
[0m06:02:00.988493 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:00.989226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:01.129444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8da4f272-398b-4d94-8bf4-d2f9b71340e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c40ee7e0>]}
[0m06:02:01.142642 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-33j3zrqe'
[0m06:02:01.143111 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:01.409356 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:01.410003 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:01.441539 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:01.445348 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:01.778408 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:01.778933 [info ] [MainThread]: Up to date!
[0m06:02:01.779472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8da4f272-398b-4d94-8bf4-d2f9b71340e5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c3792420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c3bfa420>]}
[0m06:02:01.785267 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8534143, "process_user_time": 1.55399, "process_kernel_time": 0.135824, "process_mem_max_rss": "93468", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m06:02:01.785878 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:01.785767 after 0.85 seconds
[0m06:02:01.786334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c44bf260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c3ada840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c38f0d10>]}
[0m06:02:01.786781 [debug] [MainThread]: Flushing usage events
[0m06:02:03.620552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d6133b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d744ccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d68aa0f0>]}


============================== 06:02:03.623242 | 053f4e3e-d3ca-496e-a5a5-ce312824939a ==============================
[0m06:02:03.623242 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:03.623983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:03.851041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d99bbd40>]}
[0m06:02:03.909931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d76435c0>]}
[0m06:02:03.910675 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:03.961937 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:03.962672 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:03.963238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d7199a30>]}
[0m06:02:05.162841 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:05.166730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4cf093e30>]}
[0m06:02:05.355537 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:05.360365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4cefaf8f0>]}
[0m06:02:05.501488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4cefafef0>]}
[0m06:02:05.502055 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:05.502582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4cee8a7b0>]}
[0m06:02:05.504275 [info ] [MainThread]: 
[0m06:02:05.505007 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:05.509721 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:05.544370 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:05.544833 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:05.545250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:06.105041 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:06.106664 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:06.109109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:06.109713 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:06.116624 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.117083 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:06.117497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:06.123351 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.124801 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.125227 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:06.125900 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.126311 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.126724 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:06.127305 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.128236 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:06.128693 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.129093 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:06.129641 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.130063 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:06.132233 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:06.138167 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:06.138624 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:06.139023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:06.145090 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.145600 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:06.146056 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:06.166657 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.171523 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:06.172806 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:06.173236 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:06.176826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d741ff20>]}
[0m06:02:06.177377 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.177786 [debug] [MainThread]: On master: BEGIN
[0m06:02:06.178171 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:06.183372 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.183812 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.184211 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.184642 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.185279 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.185696 [debug] [MainThread]: On master: Close
[0m06:02:06.187429 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:06.187946 [info ] [MainThread]: 
[0m06:02:06.201544 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:06.202239 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:06.202939 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:06.203393 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:06.229251 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:06.230015 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:06.264728 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:06.265683 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:18.678513 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.679106 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:18.679806 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.680282 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.680784 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:18.681525 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.684391 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.684862 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:18.685728 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.706646 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:18.707191 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.707647 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:18.709009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.713966 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.714454 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:18.715750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.718194 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:18.745276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c4431430>]}
[0m06:02:18.746113 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.54s]
[0m06:02:18.746898 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:18.747899 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:18.748512 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:18.749109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:18.749582 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:18.754726 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:18.755393 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:18.789091 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.789663 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240628060218783159"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:18.790148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:18.806527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.813933 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.814420 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:18.815088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.815548 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.815994 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240628060218783159'
      
      
      order by ordinal_position

  
[0m06:02:18.848369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.853787 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.854289 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:18.863192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.871932 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.872472 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:18.881454 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.899433 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:18.900170 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.900696 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240628060218783159"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240628060218783159"
    )
  
[0m06:02:18.914951 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.916857 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:18.917326 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.917767 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:18.928528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.929440 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:19.092310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '053f4e3e-d3ca-496e-a5a5-ce312824939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4a2d61b50>]}
[0m06:02:19.093200 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m06:02:19.093955 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:19.095444 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.095932 [debug] [MainThread]: On master: BEGIN
[0m06:02:19.096408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:19.102127 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.102644 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.103098 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.103537 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.104248 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.104770 [debug] [MainThread]: On master: Close
[0m06:02:19.106617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:19.107096 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:19.107522 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:19.108029 [info ] [MainThread]: 
[0m06:02:19.108641 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.60 seconds (13.60s).
[0m06:02:19.109703 [debug] [MainThread]: Command end result
[0m06:02:19.137949 [info ] [MainThread]: 
[0m06:02:19.138654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:19.139212 [info ] [MainThread]: 
[0m06:02:19.139780 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:19.140860 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.568721, "process_user_time": 4.861901, "process_kernel_time": 0.241285, "process_mem_max_rss": "280260", "process_in_blocks": "1184", "process_out_blocks": "109120"}
[0m06:02:19.141521 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:19.141408 after 15.57 seconds
[0m06:02:19.142033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d5e8bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d6279940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d76b5160>]}
[0m06:02:19.142535 [debug] [MainThread]: Flushing usage events
[0m06:02:21.087683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d6a5b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d69965a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d6a5b800>]}


============================== 06:02:21.090595 | ba6019ca-8492-4887-91bd-d07949964611 ==============================
[0m06:02:21.090595 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:21.091325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:21.237569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba6019ca-8492-4887-91bd-d07949964611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d6827f20>]}
[0m06:02:21.254323 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21593904, "process_user_time": 1.447459, "process_kernel_time": 0.099962, "process_mem_max_rss": "92040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:21.254935 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:21.254824 after 0.22 seconds
[0m06:02:21.255396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d6c6aae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d6ad1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d6952c00>]}
[0m06:02:21.255843 [debug] [MainThread]: Flushing usage events
[0m14:04:44.021268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe9009b920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8f18e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8fed3740>]}


============================== 14:04:44.028650 | 0ff9f583-4e56-479c-8331-9903430e139b ==============================
[0m14:04:44.028650 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:44.029339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:44.173584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ff9f583-4e56-479c-8331-9903430e139b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8ee145c0>]}
[0m14:04:44.186905 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-n0grnjt3'
[0m14:04:44.187376 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:44.263164 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:44.263920 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:44.292127 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:44.296198 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:44.344430 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:44.344916 [info ] [MainThread]: Up to date!
[0m14:04:44.345406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0ff9f583-4e56-479c-8331-9903430e139b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8eeadbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8ed782f0>]}
[0m14:04:44.346725 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.37372598, "process_user_time": 1.594642, "process_kernel_time": 0.108179, "process_mem_max_rss": "93680", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m14:04:44.347321 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:44.347217 after 0.37 seconds
[0m14:04:44.347768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe9009b920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8f19f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8f047e30>]}
[0m14:04:44.348201 [debug] [MainThread]: Flushing usage events
[0m14:04:46.044800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4804d81c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480675d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48045edbe0>]}


============================== 14:04:46.047547 | 9d0f04dc-2efe-41cf-8318-1661384f4e23 ==============================
[0m14:04:46.047547 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:46.048226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:04:46.270969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480471b3b0>]}
[0m14:04:46.329809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480471b3b0>]}
[0m14:04:46.330556 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:46.384795 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:46.385539 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:46.386121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48040429c0>]}
[0m14:04:47.585523 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:47.586228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47fd5a8aa0>]}
[0m14:04:47.774650 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:47.779609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47fd588da0>]}
[0m14:04:47.900911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47fd4cf500>]}
[0m14:04:47.901488 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:47.902074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47fd3b3f50>]}
[0m14:04:47.903781 [info ] [MainThread]: 
[0m14:04:47.904505 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:47.909224 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:47.944731 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:47.945228 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:47.945653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:48.516819 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:48.518417 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:48.520606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:48.521204 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:48.528061 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:48.528517 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:48.528926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:48.534381 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:48.535720 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:48.536136 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:48.536955 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:48.537372 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:48.537814 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:48.538406 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:48.539354 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:48.539774 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:48.540178 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:48.540729 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:48.541151 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:48.543189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:48.548458 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:48.548885 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:48.549271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:48.554079 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:48.554502 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:48.554913 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:48.574741 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:48.579491 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:48.580663 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:48.581078 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:48.584166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48043a3a10>]}
[0m14:04:48.584691 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:48.585117 [debug] [MainThread]: On master: BEGIN
[0m14:04:48.585496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:48.590693 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:48.591128 [debug] [MainThread]: On master: COMMIT
[0m14:04:48.591538 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:48.591922 [debug] [MainThread]: On master: COMMIT
[0m14:04:48.592433 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:48.592843 [debug] [MainThread]: On master: Close
[0m14:04:48.594477 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:48.595022 [info ] [MainThread]: 
[0m14:04:48.613822 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:48.614457 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:48.615217 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:48.615679 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:48.641116 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:48.641892 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:48.675918 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:48.676666 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:55.227922 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:55.228461 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:04:55.229269 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.229765 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:55.230227 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:04:55.231043 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.233698 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:55.234197 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:04:55.234914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.255429 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:55.255932 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:55.256401 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:55.257610 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.262356 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:55.262845 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:04:55.264593 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.266935 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:04:55.292459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d7bb3ec0>]}
[0m14:04:55.293196 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.68s]
[0m14:04:55.294018 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:04:55.295032 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:04:55.295695 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:04:55.296346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:04:55.296818 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:04:55.301557 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:04:55.302241 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:04:55.335687 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:55.336205 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240628140455329486"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:04:55.336695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:55.355185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.362197 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:55.362683 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:04:55.363335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.363795 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:55.364241 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240628140455329486'
      
      
      order by ordinal_position

  
[0m14:04:55.391027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.395851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:55.396339 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:55.404815 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.413318 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:55.413884 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:55.428968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.453610 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:04:55.454364 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:55.454854 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240628140455329486"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240628140455329486"
    )
  
[0m14:04:55.472790 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.474899 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:55.475402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:55.475862 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:55.500955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:55.502281 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:04:55.675462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d0f04dc-2efe-41cf-8318-1661384f4e23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d0be1340>]}
[0m14:04:55.676296 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m14:04:55.677152 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:04:55.678514 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:55.679044 [debug] [MainThread]: On master: BEGIN
[0m14:04:55.679514 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:55.684975 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:55.685462 [debug] [MainThread]: On master: COMMIT
[0m14:04:55.685952 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:55.686390 [debug] [MainThread]: On master: COMMIT
[0m14:04:55.687087 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:55.687554 [debug] [MainThread]: On master: Close
[0m14:04:55.688957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:55.689403 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:04:55.689860 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:04:55.690336 [info ] [MainThread]: 
[0m14:04:55.690872 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.79 seconds (7.79s).
[0m14:04:55.691881 [debug] [MainThread]: Command end result
[0m14:04:55.719476 [info ] [MainThread]: 
[0m14:04:55.720134 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:55.720682 [info ] [MainThread]: 
[0m14:04:55.721232 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:55.722252 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.72627, "process_user_time": 4.740103, "process_kernel_time": 0.323461, "process_mem_max_rss": "279468", "process_in_blocks": "1184", "process_out_blocks": "109600"}
[0m14:04:55.722902 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:55.722793 after 9.73 seconds
[0m14:04:55.723400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480675d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48079bc680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48047358e0>]}
[0m14:04:55.723887 [debug] [MainThread]: Flushing usage events
[0m14:04:57.406259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb33adba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb33846120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb33d5ac00>]}


============================== 14:04:57.409005 | 61abf74b-d96b-45c3-b7c4-6e2c0706bfa8 ==============================
[0m14:04:57.409005 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:57.409731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:04:57.553520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61abf74b-d96b-45c3-b7c4-6e2c0706bfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb347483b0>]}
[0m14:04:57.569977 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.212335, "process_user_time": 1.402655, "process_kernel_time": 0.095908, "process_mem_max_rss": "92168", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:04:57.570572 [debug] [MainThread]: Command `dbt clean` succeeded at 14:04:57.570462 after 0.21 seconds
[0m14:04:57.571019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb371bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb34262fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb339adbe0>]}
[0m14:04:57.571475 [debug] [MainThread]: Flushing usage events
[0m22:05:19.936756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881cc47e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881d59f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881cc46300>]}


============================== 22:05:19.944262 | 986511e8-9c19-403b-afac-6fa36876c317 ==============================
[0m22:05:19.944262 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:19.944965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:20.089775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '986511e8-9c19-403b-afac-6fa36876c317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881caf8e90>]}
[0m22:05:20.104069 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hc6o62ti'
[0m22:05:20.104560 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:20.132637 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:20.133400 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:20.145010 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:20.148748 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:20.359814 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:20.360414 [info ] [MainThread]: Up to date!
[0m22:05:20.360982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '986511e8-9c19-403b-afac-6fa36876c317', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881cafa900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881cafaea0>]}
[0m22:05:20.362561 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4747897, "process_user_time": 1.558276, "process_kernel_time": 0.142742, "process_mem_max_rss": "93348", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m22:05:20.363164 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:20.363058 after 0.48 seconds
[0m22:05:20.363612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881ca5fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881d092690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f881d091400>]}
[0m22:05:20.364056 [debug] [MainThread]: Flushing usage events
[0m22:05:22.188648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed7f68bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed856e180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed7f68080>]}


============================== 22:05:22.191558 | 93742f37-6dc1-4119-bc22-4abaff892d6b ==============================
[0m22:05:22.191558 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:22.192204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:22.419747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed85efec0>]}
[0m22:05:22.478966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed87dfa10>]}
[0m22:05:22.479800 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:22.495546 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:22.496279 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:22.496850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed8077890>]}
[0m22:05:23.705040 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:23.705737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed13d7cb0>]}
[0m22:05:23.895555 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:23.900818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed1528200>]}
[0m22:05:24.025593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed9c33ef0>]}
[0m22:05:24.026169 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:24.026671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed11a4a10>]}
[0m22:05:24.028358 [info ] [MainThread]: 
[0m22:05:24.029090 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:24.033917 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:24.069309 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:24.069800 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:24.070211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:24.451374 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.453055 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:24.455277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:24.455892 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:24.462845 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.463310 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:24.463718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.469440 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.470929 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.471346 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:24.472021 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.472433 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.472869 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:24.473485 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.474439 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.474851 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.475254 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.475906 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.476333 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:24.478671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:24.484097 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.484531 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:24.484974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.489984 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.490414 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.490828 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:24.510828 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.515676 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:24.516910 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:24.517334 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:24.520627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed84c2d80>]}
[0m22:05:24.521191 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.521592 [debug] [MainThread]: On master: BEGIN
[0m22:05:24.521973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:24.527216 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.527657 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.528056 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.528466 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.529130 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.529556 [debug] [MainThread]: On master: Close
[0m22:05:24.531155 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:24.531712 [info ] [MainThread]: 
[0m22:05:24.540934 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:24.541562 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:24.542310 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:24.542767 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:24.568909 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:24.569680 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:24.604119 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:24.604928 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:33.748283 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.748931 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:33.749773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.750269 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.750732 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:33.751543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.754562 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.755055 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:33.755807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.776847 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:33.777363 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.777818 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:33.779831 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.784771 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.785290 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:33.786749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.789173 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:33.815263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea5377f80>]}
[0m22:05:33.816141 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.27s]
[0m22:05:33.817003 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:33.818074 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:33.818685 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:33.819403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:33.819875 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:33.825011 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:33.825677 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:33.859245 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.859800 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240628220533853299"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:33.860289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:33.875763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.883238 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.883732 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:33.884425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.884916 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.885377 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240628220533853299'
      
      
      order by ordinal_position

  
[0m22:05:33.911911 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.917185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.917687 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:33.926249 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.933805 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.934297 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:33.942901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.962188 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:33.962919 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.963407 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240628220533853299"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240628220533853299"
    )
  
[0m22:05:33.977221 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.979153 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:33.979640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.980081 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:33.989913 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.990890 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:34.165134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93742f37-6dc1-4119-bc22-4abaff892d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea514ff80>]}
[0m22:05:34.165982 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m22:05:34.166853 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:34.168188 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:34.168673 [debug] [MainThread]: On master: BEGIN
[0m22:05:34.169160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:34.174549 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:34.175033 [debug] [MainThread]: On master: COMMIT
[0m22:05:34.175478 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:34.175912 [debug] [MainThread]: On master: COMMIT
[0m22:05:34.176600 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:34.177118 [debug] [MainThread]: On master: Close
[0m22:05:34.178714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:34.179160 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:34.179588 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:34.180058 [info ] [MainThread]: 
[0m22:05:34.180621 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.15 seconds (10.15s).
[0m22:05:34.181680 [debug] [MainThread]: Command end result
[0m22:05:34.209309 [info ] [MainThread]: 
[0m22:05:34.209969 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:34.210519 [info ] [MainThread]: 
[0m22:05:34.211069 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:34.212094 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.072771, "process_user_time": 4.770731, "process_kernel_time": 0.282033, "process_mem_max_rss": "290464", "process_in_blocks": "1184", "process_out_blocks": "108928"}
[0m22:05:34.212748 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:34.212638 after 12.07 seconds
[0m22:05:34.213299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed8077650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed7f6be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb8f5bb60>]}
[0m22:05:34.213794 [debug] [MainThread]: Flushing usage events
[0m22:05:36.137052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca89ae6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca88ed5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcaa9c93d0>]}


============================== 22:05:36.139959 | 5e84a050-c439-4b54-a1bd-35ef267a7bfd ==============================
[0m22:05:36.139959 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:36.140699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:36.286328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e84a050-c439-4b54-a1bd-35ef267a7bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca956c0b0>]}
[0m22:05:36.303081 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21510698, "process_user_time": 1.40863, "process_kernel_time": 0.120053, "process_mem_max_rss": "92156", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:36.303687 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:36.303581 after 0.22 seconds
[0m22:05:36.304150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca88ed5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca86fe390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca88b7ef0>]}
[0m22:05:36.304611 [debug] [MainThread]: Flushing usage events
[0m06:02:07.699968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b008b2330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b008b0170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b01551a30>]}


============================== 06:02:07.744618 | 704a10ad-951c-4618-bafd-c96a7ff48171 ==============================
[0m06:02:07.744618 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:07.745319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.888015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '704a10ad-951c-4618-bafd-c96a7ff48171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b00cc7860>]}
[0m06:02:07.901272 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7q7pq4p7'
[0m06:02:07.901740 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:07.944251 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:07.944911 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:07.957114 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:07.960865 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:08.095284 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:08.095786 [info ] [MainThread]: Up to date!
[0m06:02:08.096330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '704a10ad-951c-4618-bafd-c96a7ff48171', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b0070a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b018d8c80>]}
[0m06:02:08.097921 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44616526, "process_user_time": 1.572341, "process_kernel_time": 0.099767, "process_mem_max_rss": "93312", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m06:02:08.098513 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:08.098408 after 0.45 seconds
[0m06:02:08.098952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b012e3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b006b2c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b0070a960>]}
[0m06:02:08.099388 [debug] [MainThread]: Flushing usage events
[0m06:02:09.727810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cc9cf170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cc9cf2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cd427e00>]}


============================== 06:02:09.730607 | 4d04c263-4adc-4a00-bd02-5790002a2ee2 ==============================
[0m06:02:09.730607 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.731274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:09.961117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cc89b440>]}
[0m06:02:10.019748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cc80d340>]}
[0m06:02:10.020504 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:10.055569 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:10.056312 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:10.056885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cc80eb40>]}
[0m06:02:11.270221 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:11.270911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c5c3b590>]}
[0m06:02:11.460770 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:11.467235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c5cccd70>]}
[0m06:02:11.594135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c5cbad80>]}
[0m06:02:11.594710 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:11.595200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c5a0a150>]}
[0m06:02:11.596907 [info ] [MainThread]: 
[0m06:02:11.597594 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:11.602238 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:11.636822 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:11.637282 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:11.637699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:12.178991 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:12.180580 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:12.182877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:12.183470 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:12.190370 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.190819 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:12.191224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.196660 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.198008 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.198424 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:12.199262 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.199672 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.200064 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:12.200750 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.201698 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.202113 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.202517 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.203062 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.203480 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:12.205639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:12.210920 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.211348 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:12.211749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.216746 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.217172 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.217581 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:12.237487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.242116 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:12.243312 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:12.243731 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:12.246881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c4948b90>]}
[0m06:02:12.247409 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.247803 [debug] [MainThread]: On master: BEGIN
[0m06:02:12.248179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:12.253330 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.253762 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.254158 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.254543 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.255175 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.255589 [debug] [MainThread]: On master: Close
[0m06:02:12.257124 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:12.257659 [info ] [MainThread]: 
[0m06:02:12.281532 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:12.282143 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:12.282875 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:12.283327 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:12.308698 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:12.309449 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:12.343400 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:12.344138 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:20.013616 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.014207 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:20.014995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.015476 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.015938 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:20.016739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.019615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.020090 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:20.020824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.041582 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.042091 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.042557 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.045068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.049840 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.050326 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:20.052411 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.054732 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:20.080638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2299493590>]}
[0m06:02:20.081385 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.80s]
[0m06:02:20.082271 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:20.083248 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:20.083831 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:20.084556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:20.085035 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:20.089967 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:20.090643 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:20.123964 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.124548 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240629060220118067"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:20.125042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:20.140111 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.147233 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.147721 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:20.148414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.148884 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.149343 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240629060220118067'
      
      
      order by ordinal_position

  
[0m06:02:20.176019 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.181075 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.181591 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:20.190108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.197549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.198043 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:20.212425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.231520 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:20.232234 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.232765 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240629060220118067"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240629060220118067"
    )
  
[0m06:02:20.247127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.249055 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:20.249539 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.249990 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:20.260038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.261026 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:20.436808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d04c263-4adc-4a00-bd02-5790002a2ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22992eee40>]}
[0m06:02:20.437662 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m06:02:20.438462 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:20.439940 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.440471 [debug] [MainThread]: On master: BEGIN
[0m06:02:20.440924 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:20.446344 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.446836 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.447291 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.447737 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.448462 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.448942 [debug] [MainThread]: On master: Close
[0m06:02:20.450635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:20.451089 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:20.451514 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:20.451993 [info ] [MainThread]: 
[0m06:02:20.452574 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.85 seconds (8.85s).
[0m06:02:20.453604 [debug] [MainThread]: Command end result
[0m06:02:20.481818 [info ] [MainThread]: 
[0m06:02:20.482485 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:20.483010 [info ] [MainThread]: 
[0m06:02:20.483539 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:20.484560 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.805444, "process_user_time": 4.719902, "process_kernel_time": 0.289219, "process_mem_max_rss": "276716", "process_in_blocks": "1184", "process_out_blocks": "108912"}
[0m06:02:20.485226 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:20.485113 after 10.81 seconds
[0m06:02:20.485727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cc95fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2299b23d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2299374980>]}
[0m06:02:20.486257 [debug] [MainThread]: Flushing usage events
[0m06:02:22.186283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85646ff980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856351b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8563518ad0>]}


============================== 06:02:22.189153 | 58d80699-44cf-401c-893c-b7a45a486e70 ==============================
[0m06:02:22.189153 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:22.189813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:22.328001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58d80699-44cf-401c-893c-b7a45a486e70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8563303bf0>]}
[0m06:02:22.344177 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20647684, "process_user_time": 1.399729, "process_kernel_time": 0.104277, "process_mem_max_rss": "91876", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:22.344790 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:22.344687 after 0.21 seconds
[0m06:02:22.345264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856354fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856339a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8563301790>]}
[0m06:02:22.345736 [debug] [MainThread]: Flushing usage events
[0m14:04:33.943835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10be47e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10bed933b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10be88dbe0>]}


============================== 14:04:33.950920 | d1b33c93-48c7-4abb-81ed-9be8ded03881 ==============================
[0m14:04:33.950920 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:33.951603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:04:34.088145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1b33c93-48c7-4abb-81ed-9be8ded03881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10be27f980>]}
[0m14:04:34.101250 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2wi1cqek'
[0m14:04:34.101708 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:34.197761 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:34.198463 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:34.210090 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:34.213944 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:34.281906 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:34.282472 [info ] [MainThread]: Up to date!
[0m14:04:34.283030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd1b33c93-48c7-4abb-81ed-9be8ded03881', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10beb05670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10be189250>]}
[0m14:04:34.284551 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3885446, "process_user_time": 1.559477, "process_kernel_time": 0.095722, "process_mem_max_rss": "93692", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m14:04:34.285158 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:34.285052 after 0.39 seconds
[0m14:04:34.285605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10bf0c70b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10be5ab2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10be2d4da0>]}
[0m14:04:34.286046 [debug] [MainThread]: Flushing usage events
[0m14:04:35.877402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0617feab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff061b1e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff06233caa0>]}


============================== 14:04:35.880287 | c861e98d-8df4-496a-b488-1587eeeb86cd ==============================
[0m14:04:35.880287 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:35.880952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:36.110616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0617cb620>]}
[0m14:04:36.169977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff062992f00>]}
[0m14:04:36.170870 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:36.186934 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:36.187710 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:36.188282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0615acef0>]}
[0m14:04:37.394037 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:37.394752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0627b9af0>]}
[0m14:04:37.584319 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:37.589323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05a9f8200>]}
[0m14:04:37.716198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05a7559a0>]}
[0m14:04:37.716793 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:37.717359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05a7b7ef0>]}
[0m14:04:37.719099 [info ] [MainThread]: 
[0m14:04:37.719876 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:37.724879 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:37.760927 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:37.761440 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:37.761863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:38.325713 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:38.327266 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:38.329562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:38.330170 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:38.337150 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:38.337601 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:38.338011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:38.343563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:38.344919 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:38.345337 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:38.346177 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:38.346589 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:38.346991 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:38.347595 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:38.348553 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:38.348968 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:38.349361 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:38.349912 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:38.350335 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:38.352564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:38.358133 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:38.358558 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:38.358955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:38.364126 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:38.364558 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:38.364964 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:38.385329 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:38.390395 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:38.391724 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:38.392219 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:38.395946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05a7dbda0>]}
[0m14:04:38.396488 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:38.396895 [debug] [MainThread]: On master: BEGIN
[0m14:04:38.397279 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:38.402587 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:38.403022 [debug] [MainThread]: On master: COMMIT
[0m14:04:38.403477 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:38.403871 [debug] [MainThread]: On master: COMMIT
[0m14:04:38.404503 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:38.404922 [debug] [MainThread]: On master: Close
[0m14:04:38.406407 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:38.406909 [info ] [MainThread]: 
[0m14:04:38.416047 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:38.416669 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:38.417347 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:38.417800 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:38.443477 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:38.444237 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:38.478344 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:38.479095 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:45.567831 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:45.568429 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:04:45.569459 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.569959 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:45.570442 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:04:45.571230 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.574178 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:45.574652 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:04:45.575402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.596186 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:45.596692 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:45.597157 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:45.599221 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.604160 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:45.604642 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:04:45.606012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.608382 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:04:45.633526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02a717e90>]}
[0m14:04:45.634294 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.22s]
[0m14:04:45.635191 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:04:45.636235 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:04:45.636824 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:04:45.637507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:04:45.637990 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:04:45.642940 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:04:45.643654 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:04:45.677315 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:45.677850 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240629140445671423"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:04:45.678341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:45.694025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.701427 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:45.701932 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:04:45.702568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.703037 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:45.703515 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240629140445671423'
      
      
      order by ordinal_position

  
[0m14:04:45.730083 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.735501 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:45.736059 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:45.750649 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.758977 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:45.759545 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:45.770364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.797248 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:04:45.798405 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:45.799280 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240629140445671423"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240629140445671423"
    )
  
[0m14:04:45.820664 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.822892 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:45.823467 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:45.823953 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:45.844912 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:45.845910 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:04:46.030045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c861e98d-8df4-496a-b488-1587eeeb86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02a699430>]}
[0m14:04:46.030881 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.39s]
[0m14:04:46.031782 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:04:46.033130 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:46.033608 [debug] [MainThread]: On master: BEGIN
[0m14:04:46.034047 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:46.039472 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:46.039961 [debug] [MainThread]: On master: COMMIT
[0m14:04:46.040411 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:46.040844 [debug] [MainThread]: On master: COMMIT
[0m14:04:46.041542 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:46.042013 [debug] [MainThread]: On master: Close
[0m14:04:46.043552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:46.044005 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:04:46.044423 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:04:46.044899 [info ] [MainThread]: 
[0m14:04:46.045499 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.33 seconds (8.33s).
[0m14:04:46.046614 [debug] [MainThread]: Command end result
[0m14:04:46.074348 [info ] [MainThread]: 
[0m14:04:46.075065 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:46.075705 [info ] [MainThread]: 
[0m14:04:46.076327 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:46.077419 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.248616, "process_user_time": 4.792791, "process_kernel_time": 0.284521, "process_mem_max_rss": "271740", "process_in_blocks": "1184", "process_out_blocks": "109424"}
[0m14:04:46.078075 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:46.077963 after 10.25 seconds
[0m14:04:46.078583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff065567d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff062e53a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff063359b20>]}
[0m14:04:46.079082 [debug] [MainThread]: Flushing usage events
[0m14:04:47.687677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3698360230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369a815340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36987e4aa0>]}


============================== 14:04:47.690434 | ab5c0ba9-051d-43d2-93ba-33536a8506f3 ==============================
[0m14:04:47.690434 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:47.691078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:47.831801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab5c0ba9-051d-43d2-93ba-33536a8506f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3698363050>]}
[0m14:04:47.848005 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20940295, "process_user_time": 1.392168, "process_kernel_time": 0.112013, "process_mem_max_rss": "92124", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:04:47.848605 [debug] [MainThread]: Command `dbt clean` succeeded at 14:04:47.848502 after 0.21 seconds
[0m14:04:47.849053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3699b87290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36981c62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36981850d0>]}
[0m14:04:47.849495 [debug] [MainThread]: Flushing usage events
[0m22:05:11.805553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790c0a8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790bfd2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790c0ab350>]}


============================== 22:05:11.813167 | b91aec07-8010-4fde-a135-16073d623540 ==============================
[0m22:05:11.813167 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:11.813972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:11.962675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b91aec07-8010-4fde-a135-16073d623540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790cd19a00>]}
[0m22:05:11.976245 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3lfglk0y'
[0m22:05:11.976736 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:12.076019 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:12.076758 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:12.087365 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:12.091225 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:12.305856 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:12.306440 [info ] [MainThread]: Up to date!
[0m22:05:12.306988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b91aec07-8010-4fde-a135-16073d623540', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790b405d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790b405370>]}
[0m22:05:12.308470 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.55139095, "process_user_time": 1.626261, "process_kernel_time": 0.107884, "process_mem_max_rss": "93412", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m22:05:12.309089 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:12.308981 after 0.55 seconds
[0m22:05:12.309594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790c0451c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790f367d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790c1830b0>]}
[0m22:05:12.310049 [debug] [MainThread]: Flushing usage events
[0m22:05:14.178867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbccc642000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcca9604a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcca9616d0>]}


============================== 22:05:14.181838 | 0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405 ==============================
[0m22:05:14.181838 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:14.182490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:14.412003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcca1b7ec0>]}
[0m22:05:14.471680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbccaea4a40>]}
[0m22:05:14.472565 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:14.517060 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:14.517875 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:14.518456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc9d50d10>]}
[0m22:05:15.734781 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:15.735522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc32f5d00>]}
[0m22:05:15.925936 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:15.931180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc30661e0>]}
[0m22:05:16.056378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc2f302c0>]}
[0m22:05:16.056982 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:16.057553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc2f6c890>]}
[0m22:05:16.059381 [info ] [MainThread]: 
[0m22:05:16.060127 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:16.064972 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:16.101005 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:16.101547 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:16.101961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:16.451752 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.453370 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:16.455846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:16.456452 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:16.463505 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:16.463983 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:16.464405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:16.470125 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.471536 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:16.471965 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:16.472507 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.472935 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:16.473393 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:16.474192 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.475166 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:16.475579 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:16.476006 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:16.476673 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.477104 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:16.479550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:16.485102 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:16.485576 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:16.485964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:16.491182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.491641 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:16.492046 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:16.511517 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.516250 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:16.517489 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:16.517911 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:16.521685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc2f6f710>]}
[0m22:05:16.522211 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:16.522612 [debug] [MainThread]: On master: BEGIN
[0m22:05:16.522992 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:16.528090 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:16.528518 [debug] [MainThread]: On master: COMMIT
[0m22:05:16.528915 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:16.529341 [debug] [MainThread]: On master: COMMIT
[0m22:05:16.529968 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:16.530379 [debug] [MainThread]: On master: Close
[0m22:05:16.531859 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:16.532412 [info ] [MainThread]: 
[0m22:05:16.541862 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:16.542492 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:16.543229 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:16.543680 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:16.569441 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:16.570276 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:16.604926 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:16.605881 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:26.003899 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:26.004515 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:26.005355 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.005830 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:26.006282 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:26.007064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.010067 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:26.010549 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:26.011294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.032396 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:26.032989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:26.033508 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:26.035518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.040665 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:26.041203 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:26.042667 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.045235 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:26.072090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc93467f20>]}
[0m22:05:26.072974 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.53s]
[0m22:05:26.073843 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:26.074879 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:26.075463 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:26.076107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:26.076576 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:26.081877 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:26.082615 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:26.117123 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:26.117750 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240629220526110993"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:26.118246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:26.132078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.139653 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:26.140150 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:26.140806 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.141300 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:26.141756 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240629220526110993'
      
      
      order by ordinal_position

  
[0m22:05:26.168556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.174265 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:26.174789 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:26.183540 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.191123 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:26.191621 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:26.205874 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.225228 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:26.225962 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:26.226445 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240629220526110993"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240629220526110993"
    )
  
[0m22:05:26.241244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.243288 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:26.243761 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:26.244206 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:26.253671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:26.254640 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:26.445615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6d6cf0-cdd8-41a4-bdaf-0339e8b43405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc92e292e0>]}
[0m22:05:26.446464 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m22:05:26.447229 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:26.448729 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:26.449247 [debug] [MainThread]: On master: BEGIN
[0m22:05:26.449694 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:26.455108 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:26.455593 [debug] [MainThread]: On master: COMMIT
[0m22:05:26.456037 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:26.456468 [debug] [MainThread]: On master: COMMIT
[0m22:05:26.457158 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:26.457636 [debug] [MainThread]: On master: Close
[0m22:05:26.459107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:26.459558 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:26.459974 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:26.460441 [info ] [MainThread]: 
[0m22:05:26.460996 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.40 seconds (10.40s).
[0m22:05:26.462091 [debug] [MainThread]: Command end result
[0m22:05:26.489870 [info ] [MainThread]: 
[0m22:05:26.490564 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:26.491125 [info ] [MainThread]: 
[0m22:05:26.491692 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:26.492740 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.362995, "process_user_time": 4.764984, "process_kernel_time": 0.332907, "process_mem_max_rss": "282192", "process_in_blocks": "1184", "process_out_blocks": "109952"}
[0m22:05:26.493430 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:26.493318 after 12.36 seconds
[0m22:05:26.493943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcca1eaae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcc9e83d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc92e498b0>]}
[0m22:05:26.494439 [debug] [MainThread]: Flushing usage events
[0m22:05:28.431530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ea517800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ea5176b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ea0809b0>]}


============================== 22:05:28.434444 | e35743db-11a8-4661-a6f5-05750594fde1 ==============================
[0m22:05:28.434444 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:28.435126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:28.577633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e35743db-11a8-4661-a6f5-05750594fde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3eae2dd60>]}
[0m22:05:28.594156 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2115214, "process_user_time": 1.430046, "process_kernel_time": 0.087879, "process_mem_max_rss": "92284", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:28.594759 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:28.594655 after 0.21 seconds
[0m22:05:28.595220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ea081010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ea063a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e9f9be00>]}
[0m22:05:28.595668 [debug] [MainThread]: Flushing usage events
[0m06:02:35.541370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2ca61bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2c3f49b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2ca63170>]}


============================== 06:02:35.621940 | 9330f291-fcae-4b12-a6b7-9342c7c40fad ==============================
[0m06:02:35.621940 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:35.622725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:35.772313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9330f291-fcae-4b12-a6b7-9342c7c40fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2bde6db0>]}
[0m06:02:35.786192 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-p97fvq__'
[0m06:02:35.786688 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:35.854779 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:35.855539 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:35.878931 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:35.882840 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:35.958187 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:35.958791 [info ] [MainThread]: Up to date!
[0m06:02:35.959334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9330f291-fcae-4b12-a6b7-9342c7c40fad', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2c14a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2cda5430>]}
[0m06:02:35.961703 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4696397, "process_user_time": 1.635888, "process_kernel_time": 0.119991, "process_mem_max_rss": "93692", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m06:02:35.962306 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:35.962200 after 0.47 seconds
[0m06:02:35.962750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2c3f49b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2ca61bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2c14a240>]}
[0m06:02:35.963196 [debug] [MainThread]: Flushing usage events
[0m06:02:37.760678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613f881ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6141cc51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6141cc57f0>]}


============================== 06:02:37.763924 | 46688d0d-a85e-4320-89f7-c483a4c48b7f ==============================
[0m06:02:37.763924 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:37.764674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:38.021336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613f664530>]}
[0m06:02:38.086560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613f6d3140>]}
[0m06:02:38.087553 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:38.204081 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:38.204951 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:38.205578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61387ab9b0>]}
[0m06:02:39.497535 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:39.498339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613860b620>]}
[0m06:02:39.706748 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:39.712362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613831ccb0>]}
[0m06:02:39.851997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613f730d70>]}
[0m06:02:39.852619 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:39.853200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613fcab8c0>]}
[0m06:02:39.855007 [info ] [MainThread]: 
[0m06:02:39.855786 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:39.860844 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:39.897758 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:39.898293 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:39.898730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:40.463340 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:40.464978 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:40.467273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:40.467890 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:40.474801 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:40.475266 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:40.475723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:40.481634 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:40.483169 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:40.483637 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:40.484239 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:40.484712 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:40.485111 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:40.485715 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:40.486690 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:40.487101 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:40.487499 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:40.488095 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:40.488532 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:40.490942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:40.496659 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:40.497107 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:40.497503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:40.503149 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:40.503669 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:40.504102 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:40.525068 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:40.530299 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:40.531688 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:40.532170 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:40.536924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61382c84a0>]}
[0m06:02:40.537494 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:40.537912 [debug] [MainThread]: On master: BEGIN
[0m06:02:40.538306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:40.543889 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:40.544376 [debug] [MainThread]: On master: COMMIT
[0m06:02:40.544800 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:40.545214 [debug] [MainThread]: On master: COMMIT
[0m06:02:40.545867 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:40.546301 [debug] [MainThread]: On master: Close
[0m06:02:40.548126 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:40.548640 [info ] [MainThread]: 
[0m06:02:40.593340 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:40.594048 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:40.594757 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:40.595215 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:40.621375 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:40.622335 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:40.657999 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:40.658987 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:49.604326 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:49.604987 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:49.605880 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.606389 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:49.606859 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:49.607741 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.610871 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:49.611360 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:49.612216 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.633882 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:49.634500 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:49.634999 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:49.636773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.642040 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:49.642547 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:49.644357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.646928 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:49.676802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610c16fc50>]}
[0m06:02:49.677693 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.08s]
[0m06:02:49.678549 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:49.679658 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:49.680299 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:49.680943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:49.681431 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:49.686808 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:49.687517 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:49.722379 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:49.723020 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240630060249716173"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:49.723583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:49.739547 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.747592 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:49.748152 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:49.748865 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.749351 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:49.749818 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240630060249716173'
      
      
      order by ordinal_position

  
[0m06:02:49.783276 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.789271 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:49.789837 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:49.798883 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.807037 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:49.807601 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:49.817052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.838927 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:49.839897 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:49.840457 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240630060249716173"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240630060249716173"
    )
  
[0m06:02:49.858171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.860452 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:49.861036 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:49.861532 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:49.870029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:49.871066 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:50.067944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46688d0d-a85e-4320-89f7-c483a4c48b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610c1e6ed0>]}
[0m06:02:50.068825 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.39s]
[0m06:02:50.069592 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:50.071071 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:50.071626 [debug] [MainThread]: On master: BEGIN
[0m06:02:50.072097 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:50.077690 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:50.078201 [debug] [MainThread]: On master: COMMIT
[0m06:02:50.078661 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:50.079097 [debug] [MainThread]: On master: COMMIT
[0m06:02:50.079708 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:50.080188 [debug] [MainThread]: On master: Close
[0m06:02:50.081790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:50.082243 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:50.082665 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:50.083151 [info ] [MainThread]: 
[0m06:02:50.083743 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.23 seconds (10.23s).
[0m06:02:50.084805 [debug] [MainThread]: Command end result
[0m06:02:50.113372 [info ] [MainThread]: 
[0m06:02:50.114109 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:50.114668 [info ] [MainThread]: 
[0m06:02:50.115236 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:50.116360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.409639, "process_user_time": 5.088242, "process_kernel_time": 0.284909, "process_mem_max_rss": "271624", "process_in_blocks": "1184", "process_out_blocks": "110448"}
[0m06:02:50.117033 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:50.116919 after 12.41 seconds
[0m06:02:50.117552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f614012ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6141cc6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f610c1c53a0>]}
[0m06:02:50.118054 [debug] [MainThread]: Flushing usage events
[0m06:02:51.832835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8faad93380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8faae02330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fab0c38c0>]}


============================== 06:02:51.836063 | e8a536f6-c57d-4bd3-ba8a-965764890d1a ==============================
[0m06:02:51.836063 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:51.836845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:52.009658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8a536f6-c57d-4bd3-ba8a-965764890d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8faab7b050>]}
[0m06:02:52.027661 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.24849483, "process_user_time": 1.520109, "process_kernel_time": 0.104281, "process_mem_max_rss": "91836", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:52.028307 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:52.028198 after 0.25 seconds
[0m06:02:52.028784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8faaea17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8faaa61fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8faab483e0>]}
[0m06:02:52.029254 [debug] [MainThread]: Flushing usage events
[0m14:05:23.393807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff405ffee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff405378170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff405378f50>]}


============================== 14:05:23.401072 | 97abaa12-1450-4118-8456-29c0e54e48b1 ==============================
[0m14:05:23.401072 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.401799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.537031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97abaa12-1450-4118-8456-29c0e54e48b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4055c76b0>]}
[0m14:05:23.550088 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6du6k86l'
[0m14:05:23.550545 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:23.640697 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:23.641322 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:23.693303 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:23.697176 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:23.785348 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:23.785894 [info ] [MainThread]: Up to date!
[0m14:05:23.786448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '97abaa12-1450-4118-8456-29c0e54e48b1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4053d2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4052399a0>]}
[0m14:05:23.787729 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44139385, "process_user_time": 1.539298, "process_kernel_time": 0.112828, "process_mem_max_rss": "93792", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m14:05:23.788319 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:23.788216 after 0.44 seconds
[0m14:05:23.788761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4055c2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4052d43e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff405988b30>]}
[0m14:05:23.789191 [debug] [MainThread]: Flushing usage events
[0m14:05:25.323692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd8514b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd875c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd99c1310>]}


============================== 14:05:25.326409 | b6377189-090f-4547-91bb-d5ab025b4ca8 ==============================
[0m14:05:25.326409 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:25.327128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:25.549040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd9c171d0>]}
[0m14:05:25.607440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd1966c60>]}
[0m14:05:25.608140 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:25.640266 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:25.640976 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:25.641530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd182ab70>]}
[0m14:05:26.836764 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:26.837361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd1738da0>]}
[0m14:05:27.023352 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:27.028032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd95b5d60>]}
[0m14:05:27.144293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd15f0c50>]}
[0m14:05:27.144839 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:27.145345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd14aeb40>]}
[0m14:05:27.146975 [info ] [MainThread]: 
[0m14:05:27.147678 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:27.152390 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:27.186516 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:27.186970 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:27.187428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:27.694577 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:27.696184 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:27.698368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:27.698955 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:27.705778 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:27.706231 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:27.706639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:27.712052 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:27.713378 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:27.713796 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:27.714652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:27.715068 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:27.715522 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:27.716142 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:27.717081 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:27.717492 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:27.717880 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:27.718419 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:27.718835 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:27.720979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:27.726245 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:27.726675 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:27.727069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:27.731897 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:27.732321 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:27.732728 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:27.752233 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:27.756868 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:27.758032 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:27.758446 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:27.761409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd8fcb620>]}
[0m14:05:27.761930 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:27.762334 [debug] [MainThread]: On master: BEGIN
[0m14:05:27.762711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:27.767667 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:27.768091 [debug] [MainThread]: On master: COMMIT
[0m14:05:27.768564 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:27.768964 [debug] [MainThread]: On master: COMMIT
[0m14:05:27.769469 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:27.769875 [debug] [MainThread]: On master: Close
[0m14:05:27.771288 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:27.771774 [info ] [MainThread]: 
[0m14:05:27.780487 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:27.781080 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:27.781701 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:27.782144 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:27.807480 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:27.808213 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:27.842269 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:27.843004 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:34.307744 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.308323 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:34.309094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.309572 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.310031 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:34.310787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.313643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.314126 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:34.314833 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.335573 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:34.336067 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.336517 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:34.337751 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.342496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.342979 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:34.344152 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.346449 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:34.371063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fc0f92ed0>]}
[0m14:05:34.371814 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.59s]
[0m14:05:34.372565 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:34.373508 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:34.374080 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:34.374652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:34.375111 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:34.379940 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:34.380591 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:34.413812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.414334 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240630140534407994"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:34.414822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:34.429838 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.436706 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.437184 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:34.437772 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.438234 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.438689 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240630140534407994'
      
      
      order by ordinal_position

  
[0m14:05:34.470306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.475162 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.475685 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:34.484020 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.491236 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.491729 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:34.500179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.519072 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:34.519784 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.520266 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240630140534407994"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240630140534407994"
    )
  
[0m14:05:34.534398 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.536126 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:34.536591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.537025 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:34.547046 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.547946 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:34.705265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6377189-090f-4547-91bb-d5ab025b4ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fc8778740>]}
[0m14:05:34.706103 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m14:05:34.706850 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:34.708233 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.708718 [debug] [MainThread]: On master: BEGIN
[0m14:05:34.709158 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:34.714403 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.714895 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.715378 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.715819 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.716511 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.716978 [debug] [MainThread]: On master: Close
[0m14:05:34.718368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:34.718821 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:34.719267 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:34.719749 [info ] [MainThread]: 
[0m14:05:34.720272 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.57 seconds (7.57s).
[0m14:05:34.721261 [debug] [MainThread]: Command end result
[0m14:05:34.748714 [info ] [MainThread]: 
[0m14:05:34.749327 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:34.749843 [info ] [MainThread]: 
[0m14:05:34.750376 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:34.751369 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.476417, "process_user_time": 4.685581, "process_kernel_time": 0.343236, "process_mem_max_rss": "293316", "process_in_blocks": "1184", "process_out_blocks": "106864"}
[0m14:05:34.752015 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:34.751907 after 9.48 seconds
[0m14:05:34.752517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd81f0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd99efe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd9ad8da0>]}
[0m14:05:34.753008 [debug] [MainThread]: Flushing usage events
[0m14:05:36.344993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa43569bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa42296600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa4181b8c0>]}


============================== 14:05:36.347695 | 5ec6e506-1b80-43da-81e6-00bfacf220ce ==============================
[0m14:05:36.347695 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:36.348414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:36.485167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ec6e506-1b80-43da-81e6-00bfacf220ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa417e1eb0>]}
[0m14:05:36.501149 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20449881, "process_user_time": 1.416213, "process_kernel_time": 0.084012, "process_mem_max_rss": "92148", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:36.501721 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:36.501621 after 0.21 seconds
[0m14:05:36.502164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa41fe7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa4181b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa417e1eb0>]}
[0m14:05:36.502601 [debug] [MainThread]: Flushing usage events
[0m22:05:23.478966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769ac565a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769ad507a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769ad53a40>]}


============================== 22:05:23.511502 | 912ce4a2-07b9-45ef-90f2-d80424e70492 ==============================
[0m22:05:23.511502 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:23.512184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:23.651649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '912ce4a2-07b9-45ef-90f2-d80424e70492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769a70c410>]}
[0m22:05:23.664904 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qa8jm4fa'
[0m22:05:23.665379 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:23.845333 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:23.846149 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:23.908442 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:23.912293 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:24.083274 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:24.083889 [info ] [MainThread]: Up to date!
[0m22:05:24.084495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '912ce4a2-07b9-45ef-90f2-d80424e70492', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769a630770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769a6c58b0>]}
[0m22:05:24.085908 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6553382, "process_user_time": 1.578024, "process_kernel_time": 0.123532, "process_mem_max_rss": "93676", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m22:05:24.086576 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:24.086469 after 0.66 seconds
[0m22:05:24.087024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769e3bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769a70d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769a70cb30>]}
[0m22:05:24.087471 [debug] [MainThread]: Flushing usage events
[0m22:05:25.722228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fe8cf320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ffa5e7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fe8cf440>]}


============================== 22:05:25.724955 | c12e0c07-24a8-4809-8926-088130413e74 ==============================
[0m22:05:25.724955 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:25.725610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:25.949723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ff17a840>]}
[0m22:05:26.008130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fe7660c0>]}
[0m22:05:26.008893 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:26.041668 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:26.042430 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:26.042987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fe93e1e0>]}
[0m22:05:27.246986 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:27.247695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f7522480>]}
[0m22:05:27.436463 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:27.441423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f7238200>]}
[0m22:05:27.563719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f73dba70>]}
[0m22:05:27.564427 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:27.565025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f72737a0>]}
[0m22:05:27.566765 [info ] [MainThread]: 
[0m22:05:27.567517 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:27.572306 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:27.607041 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:27.607498 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:27.607909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:28.175276 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:28.176862 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:28.179250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:28.179846 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:28.186748 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:28.187196 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:28.187610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:28.193318 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:28.194720 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:28.195139 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:28.195988 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:28.196402 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:28.196797 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:28.197382 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:28.198366 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:28.198787 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:28.199177 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:28.199725 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:28.200146 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:28.202200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:28.207527 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:28.207956 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:28.208348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:28.213377 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:28.213806 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:28.214288 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:28.234662 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:28.239399 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:28.240595 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:28.241016 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:28.244853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fff89d30>]}
[0m22:05:28.245383 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:28.245783 [debug] [MainThread]: On master: BEGIN
[0m22:05:28.246205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:28.251245 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:28.251684 [debug] [MainThread]: On master: COMMIT
[0m22:05:28.252081 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:28.252469 [debug] [MainThread]: On master: COMMIT
[0m22:05:28.252990 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:28.253400 [debug] [MainThread]: On master: Close
[0m22:05:28.254825 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:28.255376 [info ] [MainThread]: 
[0m22:05:28.279993 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:28.280619 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:28.281351 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:28.281816 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:28.307250 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:28.308071 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:28.342459 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:28.343257 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:35.446227 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.446826 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:35.447626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.448108 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.448576 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:35.449361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.452258 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.452736 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:35.453466 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.474181 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:35.474685 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.475139 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:35.476412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.481216 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.481703 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:35.483050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.485351 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:35.510720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c7172d50>]}
[0m22:05:35.511519 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.23s]
[0m22:05:35.512304 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:35.513339 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:35.513949 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:35.514546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:35.515025 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:35.520087 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:35.520757 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:35.554117 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.554641 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240630220535548226"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:35.555133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:35.568527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.575417 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.575899 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:35.576515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.576978 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.577431 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240630220535548226'
      
      
      order by ordinal_position

  
[0m22:05:35.609692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.614674 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.615163 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:35.623743 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.631046 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.631537 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:35.640492 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.659669 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:35.660376 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.660871 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240630220535548226"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240630220535548226"
    )
  
[0m22:05:35.673494 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.675268 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:35.675733 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.676169 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:35.685652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.686582 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:35.958485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12e0c07-24a8-4809-8926-088130413e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c71b7980>]}
[0m22:05:35.959501 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.44s]
[0m22:05:35.960444 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:35.962305 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:35.962796 [debug] [MainThread]: On master: BEGIN
[0m22:05:35.963250 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:35.969858 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:35.970380 [debug] [MainThread]: On master: COMMIT
[0m22:05:35.970829 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:35.971266 [debug] [MainThread]: On master: COMMIT
[0m22:05:35.971977 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:35.972448 [debug] [MainThread]: On master: Close
[0m22:05:35.973911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:35.974390 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:35.974801 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:35.975280 [info ] [MainThread]: 
[0m22:05:35.975870 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.41 seconds (8.41s).
[0m22:05:35.976899 [debug] [MainThread]: Command end result
[0m22:05:36.009010 [info ] [MainThread]: 
[0m22:05:36.009751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:36.010395 [info ] [MainThread]: 
[0m22:05:36.011003 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:36.012074 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.338226, "process_user_time": 4.671705, "process_kernel_time": 0.307717, "process_mem_max_rss": "275288", "process_in_blocks": "1184", "process_out_blocks": "106888"}
[0m22:05:36.012731 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:36.012622 after 10.34 seconds
[0m22:05:36.013238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73fe858950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74023bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c71b0890>]}
[0m22:05:36.013731 [debug] [MainThread]: Flushing usage events
[0m22:05:37.747991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293dfe2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293ea888f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2940095340>]}


============================== 22:05:37.750742 | 5eb55665-3b48-4809-b2f5-40a8742d4023 ==============================
[0m22:05:37.750742 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:37.751413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:37.891162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5eb55665-3b48-4809-b2f5-40a8742d4023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293dc1b4d0>]}
[0m22:05:37.907430 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20791948, "process_user_time": 1.377325, "process_kernel_time": 0.123759, "process_mem_max_rss": "92268", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:37.908018 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:37.907915 after 0.21 seconds
[0m22:05:37.908464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293e6a1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293da9b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f293da12c60>]}
[0m22:05:37.908907 [debug] [MainThread]: Flushing usage events
[0m06:02:09.827356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccbc11700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccabab380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cca45e600>]}


============================== 06:02:09.853365 | fca7f0b5-61f3-49f2-a853-3258ee36e056 ==============================
[0m06:02:09.853365 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.854095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.001063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fca7f0b5-61f3-49f2-a853-3258ee36e056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cca6e2120>]}
[0m06:02:10.015483 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-m0jx8aeo'
[0m06:02:10.015987 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.062293 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.063097 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.074877 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.078861 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.292694 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.293341 [info ] [MainThread]: Up to date!
[0m06:02:10.294004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fca7f0b5-61f3-49f2-a853-3258ee36e056', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cc9d61880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccb060950>]}
[0m06:02:10.295623 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5177814, "process_user_time": 1.561708, "process_kernel_time": 0.147406, "process_mem_max_rss": "93560", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m06:02:10.296244 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.296137 after 0.52 seconds
[0m06:02:10.296697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccbc11700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cc9e3fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cca0623c0>]}
[0m06:02:10.297151 [debug] [MainThread]: Flushing usage events
[0m06:02:12.162264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f048ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1efb8b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1efa13350>]}


============================== 06:02:12.165253 | bfa0a6ac-073b-486a-bd72-16065c89cddf ==============================
[0m06:02:12.165253 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.166050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.405474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e8f24140>]}
[0m06:02:12.465514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ef8b3050>]}
[0m06:02:12.466452 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:12.557854 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:12.558675 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:12.559281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ef851df0>]}
[0m06:02:13.779436 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:13.780180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e8cf9820>]}
[0m06:02:13.974841 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:13.980426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e8cf8bf0>]}
[0m06:02:14.139737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f10a7a40>]}
[0m06:02:14.140389 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.140927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e8a398b0>]}
[0m06:02:14.142763 [info ] [MainThread]: 
[0m06:02:14.143530 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.148514 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.184500 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.185033 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:14.185450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:14.490998 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.492600 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:14.494754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:14.495363 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:14.502101 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.502559 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:14.502966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.508584 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.509962 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.510375 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:14.511229 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.511715 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.512110 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:14.512781 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.513734 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.514141 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.514532 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.515080 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.515552 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:14.517933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:14.523427 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.523855 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:14.524251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.529400 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.529835 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.530244 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:14.550418 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.555355 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:14.556587 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:14.557002 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:14.560606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e8a74fb0>]}
[0m06:02:14.561166 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.561585 [debug] [MainThread]: On master: BEGIN
[0m06:02:14.561983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:14.567499 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.567989 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.568408 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.568814 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.569473 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.569909 [debug] [MainThread]: On master: Close
[0m06:02:14.571768 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:14.572291 [info ] [MainThread]: 
[0m06:02:14.581410 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:14.582079 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:14.582787 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:14.583304 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:14.609057 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:14.609900 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:14.644604 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:14.645517 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:23.091273 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.091901 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:23.092731 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.093225 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.093689 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:23.094507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.097504 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.097987 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:23.098735 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.119720 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.120228 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.120687 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.122031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.126897 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.127419 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:23.128652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.131011 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:23.155968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bcbe7830>]}
[0m06:02:23.156766 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.57s]
[0m06:02:23.157676 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:23.158706 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:23.159357 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:23.160055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:23.160527 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:23.165584 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:23.166256 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:23.200426 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.200969 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240701060223194468"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:23.201464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:23.216111 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.223496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.224002 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:23.224628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.225104 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.225556 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240701060223194468'
      
      
      order by ordinal_position

  
[0m06:02:23.251873 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.256933 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.257425 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.265962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.273344 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.273839 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.282452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.301783 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:23.302496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.302977 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240701060223194468"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240701060223194468"
    )
  
[0m06:02:23.317478 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.319389 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.319872 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.320313 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.328790 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.329697 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:23.466997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfa0a6ac-073b-486a-bd72-16065c89cddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bc9bd6a0>]}
[0m06:02:23.467892 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m06:02:23.468783 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:23.470188 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.470690 [debug] [MainThread]: On master: BEGIN
[0m06:02:23.471149 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:23.476651 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.477151 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.477609 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.478055 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.478638 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.479124 [debug] [MainThread]: On master: Close
[0m06:02:23.480872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:23.481337 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:23.481764 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:23.482265 [info ] [MainThread]: 
[0m06:02:23.482880 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.34 seconds (9.34s).
[0m06:02:23.484048 [debug] [MainThread]: Command end result
[0m06:02:23.512192 [info ] [MainThread]: 
[0m06:02:23.512902 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:23.513509 [info ] [MainThread]: 
[0m06:02:23.514129 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:23.515211 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.402095, "process_user_time": 4.761874, "process_kernel_time": 0.312385, "process_mem_max_rss": "268556", "process_in_blocks": "1184", "process_out_blocks": "107896"}
[0m06:02:23.515914 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:23.515801 after 11.40 seconds
[0m06:02:23.516423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1efb22ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1efe382f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1d1dec260>]}
[0m06:02:23.516917 [debug] [MainThread]: Flushing usage events
[0m06:02:25.448733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6bb9a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6c95f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6ba39d90>]}


============================== 06:02:25.451622 | 07d23671-d75c-4d19-8185-3860bde62bc2 ==============================
[0m06:02:25.451622 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.452300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:25.596278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07d23671-d75c-4d19-8185-3860bde62bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6b6291f0>]}
[0m06:02:25.612687 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21297897, "process_user_time": 1.430638, "process_kernel_time": 0.096177, "process_mem_max_rss": "92288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:25.613308 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:25.613204 after 0.21 seconds
[0m06:02:25.613762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6f567d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6b834110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6b5c3f20>]}
[0m06:02:25.614207 [debug] [MainThread]: Flushing usage events
[0m14:04:48.260955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa4e36000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa47a57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa6a09070>]}


============================== 14:04:48.318641 | 5f861c1a-1bdc-4fbf-8dce-14662c837f2b ==============================
[0m14:04:48.318641 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:48.319340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:48.461266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f861c1a-1bdc-4fbf-8dce-14662c837f2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa47a7d40>]}
[0m14:04:48.474726 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-v_erobe_'
[0m14:04:48.475236 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:48.520842 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:48.521522 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:48.531944 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:48.535725 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:48.740767 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:48.741372 [info ] [MainThread]: Up to date!
[0m14:04:48.741962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5f861c1a-1bdc-4fbf-8dce-14662c837f2b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa43fa960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa477a0f0>]}
[0m14:04:48.743423 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.53091365, "process_user_time": 1.574452, "process_kernel_time": 0.124828, "process_mem_max_rss": "93556", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m14:04:48.744061 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:48.743950 after 0.53 seconds
[0m14:04:48.744619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa43b23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa4542ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa4323e30>]}
[0m14:04:48.745090 [debug] [MainThread]: Flushing usage events
[0m14:04:50.566546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b9960da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ba03a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75bbe215e0>]}


============================== 14:04:50.569468 | 59767cf1-b964-4c73-8a84-7d005c50b91d ==============================
[0m14:04:50.569468 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:50.570149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:50.804180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b9961190>]}
[0m14:04:50.863842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b983a060>]}
[0m14:04:50.864716 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:50.921959 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:50.922759 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:50.923360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b96f6120>]}
[0m14:04:52.159161 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:52.159896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b2ba9340>]}
[0m14:04:52.351477 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:52.356328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b2c04620>]}
[0m14:04:52.475248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b2aea060>]}
[0m14:04:52.475805 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:52.476341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b2943ef0>]}
[0m14:04:52.477992 [info ] [MainThread]: 
[0m14:04:52.478677 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:52.483622 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:52.518145 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:52.518598 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:52.519049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:53.042249 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:53.043900 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:53.046296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:53.046931 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:53.053879 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.054333 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:53.054747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:53.060258 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.061603 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.062020 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:53.062878 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.063349 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.063750 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:53.064371 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.065317 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:53.065735 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.066147 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:53.066990 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.067554 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:53.069885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:53.075278 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:53.075706 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:53.076095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:53.081155 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.081584 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:53.082004 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:53.102187 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.106871 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:53.108122 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:53.108545 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:53.112186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75bbf84a40>]}
[0m14:04:53.112722 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:53.113130 [debug] [MainThread]: On master: BEGIN
[0m14:04:53.113521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:53.118644 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:53.119125 [debug] [MainThread]: On master: COMMIT
[0m14:04:53.119539 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:53.119941 [debug] [MainThread]: On master: COMMIT
[0m14:04:53.120581 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:53.121016 [debug] [MainThread]: On master: Close
[0m14:04:53.122598 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:53.123130 [info ] [MainThread]: 
[0m14:04:53.132208 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:53.132833 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:53.133483 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:53.133938 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:53.159970 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:53.160724 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:53.195315 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:53.196053 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:03.150795 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:03.151391 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:03.152145 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.152613 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:03.153066 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:03.154062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.156840 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:03.157316 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:03.158018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.178747 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:03.179282 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:03.179735 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:03.181573 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.186384 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:03.186877 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:03.188155 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.190520 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:03.216595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a89facc0>]}
[0m14:05:03.217334 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.08s]
[0m14:05:03.218136 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:03.219180 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:03.219762 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:03.220376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:03.220851 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:03.225727 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:03.226392 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:03.259725 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:03.260263 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240701140503253755"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:03.260761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:03.277595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.284813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:03.285300 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:03.285963 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.286432 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:03.286896 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240701140503253755'
      
      
      order by ordinal_position

  
[0m14:05:03.319364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.324590 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:03.325090 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:03.333699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.342325 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:03.342818 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:03.350783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.368726 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:03.369439 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:03.369923 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240701140503253755"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240701140503253755"
    )
  
[0m14:05:03.382967 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.384700 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:03.385173 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:03.385619 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:03.400065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:03.400956 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:03.543423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59767cf1-b964-4c73-8a84-7d005c50b91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75828a9400>]}
[0m14:05:03.544289 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m14:05:03.545168 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:03.546650 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:03.547218 [debug] [MainThread]: On master: BEGIN
[0m14:05:03.547704 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:03.553115 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:03.553621 [debug] [MainThread]: On master: COMMIT
[0m14:05:03.554082 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:03.554536 [debug] [MainThread]: On master: COMMIT
[0m14:05:03.555286 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:03.555767 [debug] [MainThread]: On master: Close
[0m14:05:03.557197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:03.557659 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:03.558097 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:03.558591 [info ] [MainThread]: 
[0m14:05:03.559183 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.08 seconds (11.08s).
[0m14:05:03.560234 [debug] [MainThread]: Command end result
[0m14:05:03.588163 [info ] [MainThread]: 
[0m14:05:03.588819 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:03.589374 [info ] [MainThread]: 
[0m14:05:03.589945 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:03.591025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.073806, "process_user_time": 4.791286, "process_kernel_time": 0.300456, "process_mem_max_rss": "288616", "process_in_blocks": "1184", "process_out_blocks": "108576"}
[0m14:05:03.591687 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:03.591575 after 13.07 seconds
[0m14:05:03.592195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b986ef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ba27ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b9df9280>]}
[0m14:05:03.592697 [debug] [MainThread]: Flushing usage events
[0m14:05:05.473882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc6d894c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc7b49160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc5d15be0>]}


============================== 14:05:05.476821 | 85e9d62e-dab1-4252-99be-41d55c5b55e7 ==============================
[0m14:05:05.476821 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:05.477524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:05.624129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85e9d62e-dab1-4252-99be-41d55c5b55e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc5505640>]}
[0m14:05:05.640541 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21559656, "process_user_time": 1.424479, "process_kernel_time": 0.095763, "process_mem_max_rss": "92160", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:05.641147 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:05.641045 after 0.22 seconds
[0m14:05:05.641604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc6d894c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc54c72f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc5fa1160>]}
[0m14:05:05.642042 [debug] [MainThread]: Flushing usage events
[0m22:05:35.587221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b77611f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b87da9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b7a56450>]}


============================== 22:05:35.594784 | 28c55452-5f7e-4190-b5ac-7bdfb1f46e3e ==============================
[0m22:05:35.594784 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:35.595583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:35.750062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28c55452-5f7e-4190-b5ac-7bdfb1f46e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b7fbe5d0>]}
[0m22:05:35.764284 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-exeoynuc'
[0m22:05:35.764798 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:35.792552 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:35.793345 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:35.804788 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:35.808728 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:36.019649 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:36.020301 [info ] [MainThread]: Up to date!
[0m22:05:36.020951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '28c55452-5f7e-4190-b5ac-7bdfb1f46e3e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b7ab2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b9176240>]}
[0m22:05:36.022390 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48446536, "process_user_time": 1.604271, "process_kernel_time": 0.141791, "process_mem_max_rss": "93672", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m22:05:36.023001 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:36.022893 after 0.49 seconds
[0m22:05:36.023459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b7a57860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b76aac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b7fbe5d0>]}
[0m22:05:36.023958 [debug] [MainThread]: Flushing usage events
[0m22:05:37.921180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8870f9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8855aaf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe885834d40>]}


============================== 22:05:37.924135 | df7de61f-c544-4879-b562-f4ea46183a5b ==============================
[0m22:05:37.924135 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:37.924794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:38.164958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe885f82cf0>]}
[0m22:05:38.225351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe888fbbd40>]}
[0m22:05:38.226294 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:38.242613 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:38.243430 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:38.244012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe885405280>]}
[0m22:05:39.468276 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:39.469247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87e78c260>]}
[0m22:05:39.665386 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:39.670958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87e74d100>]}
[0m22:05:39.812745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87e6ca420>]}
[0m22:05:39.813373 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:39.813902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87e573fe0>]}
[0m22:05:39.815770 [info ] [MainThread]: 
[0m22:05:39.816530 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:39.821466 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:39.857718 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:39.858250 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:39.858664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:40.354227 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.355796 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:40.357928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:40.358494 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:40.365288 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.365752 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:40.366161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:40.372019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.373452 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.373871 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:40.374728 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.375140 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.375538 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:40.376211 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.377160 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:40.377574 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.377971 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:40.378510 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.378938 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:40.381386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:40.386954 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:40.387385 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:40.387833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:40.393068 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.393511 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:40.393935 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:40.414721 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.420297 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:40.421576 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:40.421997 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:40.425718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8878b6540>]}
[0m22:05:40.426461 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:40.426881 [debug] [MainThread]: On master: BEGIN
[0m22:05:40.427302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:40.432942 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:40.433437 [debug] [MainThread]: On master: COMMIT
[0m22:05:40.433855 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:40.434257 [debug] [MainThread]: On master: COMMIT
[0m22:05:40.434942 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:40.435373 [debug] [MainThread]: On master: Close
[0m22:05:40.437251 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:40.437814 [info ] [MainThread]: 
[0m22:05:40.447205 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:40.447898 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:40.448674 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:40.449138 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:40.475042 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:40.475960 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:40.510985 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:40.511947 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:51.134613 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.135191 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:51.135939 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.136410 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.136862 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:51.137597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.140570 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.141058 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:51.141787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.162923 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.163536 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.164030 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.165692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.170783 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.171279 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:51.172559 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.175022 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:51.204046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe851e27950>]}
[0m22:05:51.204929 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.75s]
[0m22:05:51.205777 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:51.206824 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:51.207473 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:51.208200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:51.208684 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:51.214213 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:51.215025 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:51.249677 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.250308 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240701220551243559"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:51.250800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:51.265785 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.273533 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.274061 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:51.274758 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.275222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.275675 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240701220551243559'
      
      
      order by ordinal_position

  
[0m22:05:51.303070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.308868 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.309399 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:51.324232 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.333875 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.334465 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:51.344276 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.363044 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:51.363930 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.364439 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240701220551243559"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240701220551243559"
    )
  
[0m22:05:51.378009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.380127 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:51.380610 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.381054 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:51.390702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.391788 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:51.543326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7de61f-c544-4879-b562-f4ea46183a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe851ee2db0>]}
[0m22:05:51.544212 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m22:05:51.544985 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:51.546498 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:51.546999 [debug] [MainThread]: On master: BEGIN
[0m22:05:51.547457 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:51.552947 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:51.553442 [debug] [MainThread]: On master: COMMIT
[0m22:05:51.553904 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:51.554341 [debug] [MainThread]: On master: COMMIT
[0m22:05:51.555053 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:51.555537 [debug] [MainThread]: On master: Close
[0m22:05:51.557303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:51.557754 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:51.558170 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:51.558649 [info ] [MainThread]: 
[0m22:05:51.559202 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.74 seconds (11.74s).
[0m22:05:51.560268 [debug] [MainThread]: Command end result
[0m22:05:51.588362 [info ] [MainThread]: 
[0m22:05:51.589093 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:51.589631 [info ] [MainThread]: 
[0m22:05:51.590164 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:51.591184 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.7198, "process_user_time": 4.887137, "process_kernel_time": 0.297408, "process_mem_max_rss": "269896", "process_in_blocks": "1184", "process_out_blocks": "108616"}
[0m22:05:51.591874 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:51.591760 after 13.72 seconds
[0m22:05:51.592389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8854ebb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe885f835c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe851ee9a00>]}
[0m22:05:51.592883 [debug] [MainThread]: Flushing usage events
[0m22:05:53.588588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fc09fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f9630e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f8db7020>]}


============================== 22:05:53.591504 | 78fe9049-a545-44f7-84ea-d04c886016aa ==============================
[0m22:05:53.591504 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:53.592199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:05:53.743998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78fe9049-a545-44f7-84ea-d04c886016aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f97feba0>]}
[0m22:05:53.760750 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22222081, "process_user_time": 1.445221, "process_kernel_time": 0.116098, "process_mem_max_rss": "92272", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:53.761365 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:53.761260 after 0.22 seconds
[0m22:05:53.761836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f8c53410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f8b6cef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f8debbf0>]}
[0m22:05:53.762301 [debug] [MainThread]: Flushing usage events
[0m06:02:08.683747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b344f9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b36720fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b344f9610>]}


============================== 06:02:08.691034 | cba8867b-a0d8-47d7-bf45-5894a1c7cbf0 ==============================
[0m06:02:08.691034 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:08.691708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:08.831876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cba8867b-a0d8-47d7-bf45-5894a1c7cbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b35765670>]}
[0m06:02:08.845163 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6x868bad'
[0m06:02:08.845633 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:08.936964 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:08.937596 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:08.961106 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:08.964790 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:09.038263 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:09.038803 [info ] [MainThread]: Up to date!
[0m06:02:09.039370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cba8867b-a0d8-47d7-bf45-5894a1c7cbf0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b33e30440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b33e5c560>]}
[0m06:02:09.040700 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40574142, "process_user_time": 1.512654, "process_kernel_time": 0.160493, "process_mem_max_rss": "93684", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m06:02:09.041285 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:09.041181 after 0.41 seconds
[0m06:02:09.041717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b37bbbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b34542840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b34d390d0>]}
[0m06:02:09.042209 [debug] [MainThread]: Flushing usage events
[0m06:02:10.608768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163c176480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163b7e2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163b7e0950>]}


============================== 06:02:10.611546 | 6a11a7b3-ff9a-4068-8a31-00088c53426d ==============================
[0m06:02:10.611546 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.612237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.838716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163d0472f0>]}
[0m06:02:10.898120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163b6a6ea0>]}
[0m06:02:10.898872 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:10.914233 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:10.914954 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:10.915501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163b6bf950>]}
[0m06:02:12.131477 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:12.132161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1634929580>]}
[0m06:02:12.322490 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:12.327302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1634aa3200>]}
[0m06:02:12.451164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1634aac4d0>]}
[0m06:02:12.451722 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:12.452214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1634860a40>]}
[0m06:02:12.453873 [info ] [MainThread]: 
[0m06:02:12.454549 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:12.459292 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:12.493952 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:12.494414 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:12.494837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:13.013731 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:13.015335 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:13.017498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:13.018152 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:13.025055 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.025509 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:13.025961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:13.031389 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.032729 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.033143 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:13.034031 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.034444 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.034837 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:13.035482 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.036449 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:13.036864 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.037252 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:13.037794 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.038266 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:13.040387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:13.045695 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:13.046161 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:13.046553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:13.051412 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.051837 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:13.052247 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:13.071663 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.076370 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:13.077549 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:13.078001 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:13.080765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163486bf20>]}
[0m06:02:13.081279 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:13.081680 [debug] [MainThread]: On master: BEGIN
[0m06:02:13.082097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:13.087066 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:13.087511 [debug] [MainThread]: On master: COMMIT
[0m06:02:13.087910 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:13.088305 [debug] [MainThread]: On master: COMMIT
[0m06:02:13.088927 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:13.089343 [debug] [MainThread]: On master: Close
[0m06:02:13.090891 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:13.091427 [info ] [MainThread]: 
[0m06:02:13.100869 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:13.101477 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:13.102173 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:13.102628 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:13.128289 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:13.129046 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:13.163398 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:13.164142 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:21.548853 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.549394 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:21.550036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.550507 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.550958 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:21.551737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.554422 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.554897 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:21.555700 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.576402 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:21.576906 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.577391 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:21.578490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.583266 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.583747 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:21.584862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.587188 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:21.612046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16087aff80>]}
[0m06:02:21.612757 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.51s]
[0m06:02:21.613653 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:21.614704 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:21.615383 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:21.616047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:21.616519 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:21.621300 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:21.622008 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:21.655488 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.656005 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240702060221649568"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:21.656490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:21.671990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.678843 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.679324 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:21.679922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.680381 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.680832 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240702060221649568'
      
      
      order by ordinal_position

  
[0m06:02:21.706658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.711518 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.712007 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.720568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.728904 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.729401 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.738404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.756494 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:21.757161 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.757659 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240702060221649568"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240702060221649568"
    )
  
[0m06:02:21.772906 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.774655 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.775129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.775574 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.784114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.784991 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:21.935799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a11a7b3-ff9a-4068-8a31-00088c53426d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f160879f0b0>]}
[0m06:02:21.936559 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m06:02:21.937321 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:21.938787 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.939271 [debug] [MainThread]: On master: BEGIN
[0m06:02:21.939714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:21.945021 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.945508 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.946016 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.946466 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.947150 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.947617 [debug] [MainThread]: On master: Close
[0m06:02:21.949237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:21.949691 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:21.950161 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:21.950638 [info ] [MainThread]: 
[0m06:02:21.951188 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.50 seconds (9.50s).
[0m06:02:21.952294 [debug] [MainThread]: Command end result
[0m06:02:21.980136 [info ] [MainThread]: 
[0m06:02:21.980829 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:21.981441 [info ] [MainThread]: 
[0m06:02:21.982073 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:21.983145 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.422882, "process_user_time": 4.733403, "process_kernel_time": 0.256509, "process_mem_max_rss": "266784", "process_in_blocks": "1184", "process_out_blocks": "109104"}
[0m06:02:21.983803 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:21.983693 after 11.42 seconds
[0m06:02:21.984301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163efbc830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163b88b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163b807a40>]}
[0m06:02:21.984791 [debug] [MainThread]: Flushing usage events
[0m06:02:23.586388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f010b0f7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f010b4c6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f010b0f7350>]}


============================== 06:02:23.589273 | 13471731-2886-49fb-b217-53e8715c90b6 ==============================
[0m06:02:23.589273 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:23.589988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:23.733864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13471731-2886-49fb-b217-53e8715c90b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f010b12a510>]}
[0m06:02:23.750093 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21287633, "process_user_time": 1.384671, "process_kernel_time": 0.128062, "process_mem_max_rss": "91928", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:23.750681 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:23.750578 after 0.21 seconds
[0m06:02:23.751130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f010bef2ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f010b0cb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f010adc6570>]}
[0m06:02:23.751573 [debug] [MainThread]: Flushing usage events
[0m14:05:06.003394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe766852f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe765db3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe766852ea0>]}


============================== 14:05:06.010560 | 2aaea165-6efd-4c81-b802-0b0ce941a813 ==============================
[0m14:05:06.010560 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:06.011216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:06.153466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2aaea165-6efd-4c81-b802-0b0ce941a813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe765d47bf0>]}
[0m14:05:06.166707 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-001eu6sg'
[0m14:05:06.167170 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:06.209071 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:06.209681 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:06.220115 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:06.223908 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:06.452097 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:06.452649 [info ] [MainThread]: Up to date!
[0m14:05:06.453187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2aaea165-6efd-4c81-b802-0b0ce941a813', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe765ae1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe765b1c800>]}
[0m14:05:06.454937 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49940225, "process_user_time": 1.551718, "process_kernel_time": 0.17376, "process_mem_max_rss": "93432", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m14:05:06.455582 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:06.455474 after 0.50 seconds
[0m14:05:06.456028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7667fff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe765c91820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe765d47bf0>]}
[0m14:05:06.456477 [debug] [MainThread]: Flushing usage events
[0m14:05:08.348109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102a520c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102a917170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102a6a5be0>]}


============================== 14:05:08.351041 | fe15777e-bc08-42ae-ab14-a576a088ca45 ==============================
[0m14:05:08.351041 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:08.351763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:08.587191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102a3d5bb0>]}
[0m14:05:08.650043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102a3fd9a0>]}
[0m14:05:08.650842 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:08.759626 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:08.760372 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:08.760934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102a2def00>]}
[0m14:05:09.992106 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:09.992876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102bcbfe30>]}
[0m14:05:10.198979 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:10.204243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1023745760>]}
[0m14:05:10.333546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102393f320>]}
[0m14:05:10.334121 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:10.334678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1023562780>]}
[0m14:05:10.336455 [info ] [MainThread]: 
[0m14:05:10.337190 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:10.342020 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:10.376440 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:10.376914 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:10.377323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:11.078719 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:11.080364 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:11.082779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:11.083391 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:11.090214 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:11.090665 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:11.091074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:11.096869 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.098243 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:11.098657 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:11.099350 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.099767 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:11.100159 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:11.100734 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.101654 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:11.102072 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:11.102470 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:11.102996 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.103451 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:11.105526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:11.110782 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:11.111219 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:11.111654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:11.116713 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.117140 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:11.117556 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:11.137473 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.142154 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:11.143369 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:11.143795 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:11.146870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10237de330>]}
[0m14:05:11.147421 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:11.147828 [debug] [MainThread]: On master: BEGIN
[0m14:05:11.148209 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:11.153313 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:11.153742 [debug] [MainThread]: On master: COMMIT
[0m14:05:11.154138 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:11.154522 [debug] [MainThread]: On master: COMMIT
[0m14:05:11.155038 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:11.155496 [debug] [MainThread]: On master: Close
[0m14:05:11.156953 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:11.157460 [info ] [MainThread]: 
[0m14:05:11.167359 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:11.167979 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:11.168649 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:11.169100 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:11.194764 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:11.195563 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:11.229934 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:11.230683 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:20.782281 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.782818 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:20.783498 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.783969 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.784424 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:20.785119 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.787862 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.788337 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:20.789035 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.810662 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:20.811162 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.811659 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:20.812910 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.817679 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.818172 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:20.819551 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.821899 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:20.847944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102bd96600>]}
[0m14:05:20.848678 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.68s]
[0m14:05:20.849456 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:20.850463 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:20.851049 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:20.851656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:20.852127 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:20.856966 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:20.857638 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:20.890859 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:20.891407 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240702140520885012"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:20.891903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:20.908413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.915535 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:20.916042 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:20.916639 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.917126 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:20.917591 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240702140520885012'
      
      
      order by ordinal_position

  
[0m14:05:20.944547 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.949517 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:20.950012 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:20.958590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.967171 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:20.967705 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:20.976115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.994083 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:20.994788 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:20.995310 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240702140520885012"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240702140520885012"
    )
  
[0m14:05:21.011612 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.013363 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:21.013832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.014278 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:21.023966 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.024923 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:21.188730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe15777e-bc08-42ae-ab14-a576a088ca45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff7477fe0>]}
[0m14:05:21.189590 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m14:05:21.190364 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:21.191893 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.192418 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.192893 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:21.198464 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.198947 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.199437 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.199880 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.200537 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.201003 [debug] [MainThread]: On master: Close
[0m14:05:21.202503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:21.202951 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:21.203418 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:21.203902 [info ] [MainThread]: 
[0m14:05:21.204503 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.87 seconds (10.87s).
[0m14:05:21.205615 [debug] [MainThread]: Command end result
[0m14:05:21.233250 [info ] [MainThread]: 
[0m14:05:21.233948 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:21.234566 [info ] [MainThread]: 
[0m14:05:21.235181 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:21.236321 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.939521, "process_user_time": 4.834602, "process_kernel_time": 0.26327, "process_mem_max_rss": "271404", "process_in_blocks": "1184", "process_out_blocks": "109592"}
[0m14:05:21.236987 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:21.236872 after 12.94 seconds
[0m14:05:21.237494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10236f8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102ab36c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10238bb980>]}
[0m14:05:21.237995 [debug] [MainThread]: Flushing usage events
[0m14:05:23.498545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a967d5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a949bb020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a949bac00>]}


============================== 14:05:23.501527 | 4afe5002-d961-4c68-834a-8270374370cc ==============================
[0m14:05:23.501527 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.502280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.651724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4afe5002-d961-4c68-834a-8270374370cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a942cc620>]}
[0m14:05:23.668507 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22140175, "process_user_time": 1.415608, "process_kernel_time": 0.115641, "process_mem_max_rss": "92088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:23.669099 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:23.668996 after 0.22 seconds
[0m14:05:23.669559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a94264290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a942649b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a949bb3b0>]}
[0m14:05:23.670002 [debug] [MainThread]: Flushing usage events
[0m22:06:18.599066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d4a60200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d4a9bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d444c0e0>]}


============================== 22:06:18.631270 | b0e4ee1a-e5bf-4db9-ba0d-0b5fb5afdb54 ==============================
[0m22:06:18.631270 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:18.632155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:18.784962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0e4ee1a-e5bf-4db9-ba0d-0b5fb5afdb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d450bbf0>]}
[0m22:06:18.798614 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3r8xmz0r'
[0m22:06:18.799102 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:18.993701 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:18.994528 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:19.028536 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:19.032635 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:19.389219 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:19.389835 [info ] [MainThread]: Up to date!
[0m22:06:19.390486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b0e4ee1a-e5bf-4db9-ba0d-0b5fb5afdb54', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d4393170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d4359820>]}
[0m22:06:19.391932 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8417211, "process_user_time": 1.612079, "process_kernel_time": 0.129289, "process_mem_max_rss": "93284", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m22:06:19.392543 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:19.392439 after 0.84 seconds
[0m22:06:19.392992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d4a60200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d55c95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d442fce0>]}
[0m22:06:19.393430 [debug] [MainThread]: Flushing usage events
[0m22:06:21.497412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a0f1eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a1eadcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a03074d0>]}


============================== 22:06:21.500476 | 1f972b7f-82c0-424e-945c-0db81c1fa700 ==============================
[0m22:06:21.500476 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:21.501236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:21.745293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a001e900>]}
[0m22:06:21.806697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a0161fd0>]}
[0m22:06:21.807753 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:06:21.868243 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:21.869437 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:21.870226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a013d970>]}
[0m22:06:23.118380 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:23.119133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a09536e0>]}
[0m22:06:23.313808 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:23.319386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc199557530>]}
[0m22:06:23.460995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a28c0a10>]}
[0m22:06:23.461611 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:23.462124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a0774680>]}
[0m22:06:23.463973 [info ] [MainThread]: 
[0m22:06:23.464712 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:23.469677 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:23.506105 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:23.506638 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:06:23.507057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:24.123107 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:24.124795 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:24.127041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:24.127656 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:24.134547 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.135007 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:06:24.135453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:24.141171 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.142582 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.142998 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:24.143668 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.144081 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.144482 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:24.145130 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.146074 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:24.146490 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.146885 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:24.147466 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.147895 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:24.150305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:24.155855 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:24.156312 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:24.156702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:24.162007 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.162441 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:24.162856 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:06:24.183316 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.188613 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:24.189919 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:24.190386 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:24.193905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a1666420>]}
[0m22:06:24.194468 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:24.194877 [debug] [MainThread]: On master: BEGIN
[0m22:06:24.195259 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:24.200735 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:24.201179 [debug] [MainThread]: On master: COMMIT
[0m22:06:24.201579 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:24.201976 [debug] [MainThread]: On master: COMMIT
[0m22:06:24.202647 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:24.203086 [debug] [MainThread]: On master: Close
[0m22:06:24.204942 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:24.205453 [info ] [MainThread]: 
[0m22:06:24.245921 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:24.246648 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:24.247408 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:24.247881 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:24.273723 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:24.274575 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:24.309758 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:24.310779 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:37.788611 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.789215 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:37.790023 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.790496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.790985 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:37.791824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.794734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.795213 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:37.795975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.816877 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:37.817406 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.817866 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:37.819550 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.824473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:37.824964 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:37.826304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.828833 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:37.857411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16d2783b0>]}
[0m22:06:37.858289 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.61s]
[0m22:06:37.859197 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:37.860396 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:37.860979 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:37.861681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:37.862164 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:37.867420 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:37.868089 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:37.901742 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.902346 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240702220637895788"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:37.902832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:37.919688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.927600 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.928125 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:37.928818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.929275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.929724 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240702220637895788'
      
      
      order by ordinal_position

  
[0m22:06:37.956446 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.961998 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.962522 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:37.977170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:37.987057 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:37.987736 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:38.000571 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:38.023521 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:38.024434 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:38.025080 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240702220637895788"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240702220637895788"
    )
  
[0m22:06:38.049013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:38.051196 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:38.051716 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:38.052181 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:38.065556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:38.066721 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:38.246006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f972b7f-82c0-424e-945c-0db81c1fa700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16d22c800>]}
[0m22:06:38.246902 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m22:06:38.247710 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:38.249285 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:38.249782 [debug] [MainThread]: On master: BEGIN
[0m22:06:38.250224 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:38.255735 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:38.256232 [debug] [MainThread]: On master: COMMIT
[0m22:06:38.256676 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:38.257104 [debug] [MainThread]: On master: COMMIT
[0m22:06:38.257667 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:38.258127 [debug] [MainThread]: On master: Close
[0m22:06:38.259629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:38.260085 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:38.260504 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:38.261005 [info ] [MainThread]: 
[0m22:06:38.261568 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.80 seconds (14.80s).
[0m22:06:38.262608 [debug] [MainThread]: Command end result
[0m22:06:38.290834 [info ] [MainThread]: 
[0m22:06:38.291580 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:38.292180 [info ] [MainThread]: 
[0m22:06:38.292795 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:38.293909 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.846651, "process_user_time": 4.96508, "process_kernel_time": 0.323549, "process_mem_max_rss": "281508", "process_in_blocks": "1184", "process_out_blocks": "109640"}
[0m22:06:38.294571 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:38.294458 after 16.85 seconds
[0m22:06:38.295079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a1edf470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a1467d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc199436de0>]}
[0m22:06:38.295621 [debug] [MainThread]: Flushing usage events
[0m22:06:40.236060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff4a70eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff4a01a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff4c0f97c0>]}


============================== 22:06:40.239219 | be6b3289-5fa0-461e-8e58-32d1a8c03da4 ==============================
[0m22:06:40.239219 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:40.239959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:40.397182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be6b3289-5fa0-461e-8e58-32d1a8c03da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff49aa1640>]}
[0m22:06:40.413984 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2273765, "process_user_time": 1.466205, "process_kernel_time": 0.096144, "process_mem_max_rss": "91928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:40.414599 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:40.414494 after 0.23 seconds
[0m22:06:40.415056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff49c4ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff49ab2c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff49d7cec0>]}
[0m22:06:40.415575 [debug] [MainThread]: Flushing usage events
[0m06:02:10.311741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263110bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26312222d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263110b710>]}


============================== 06:02:10.361390 | 1c9fedcc-2043-47c6-9e74-193de9bf0706 ==============================
[0m06:02:10.361390 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.362047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.510634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c9fedcc-2043-47c6-9e74-193de9bf0706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263135cc80>]}
[0m06:02:10.524813 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-sep9zvvz'
[0m06:02:10.525291 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.597337 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.597971 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.610415 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.614275 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.825160 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.825792 [info ] [MainThread]: Up to date!
[0m06:02:10.826408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1c9fedcc-2043-47c6-9e74-193de9bf0706', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2630e5c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2630e23290>]}
[0m06:02:10.828546 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5679207, "process_user_time": 1.623239, "process_kernel_time": 0.119649, "process_mem_max_rss": "93712", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m06:02:10.829155 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.829048 after 0.57 seconds
[0m06:02:10.829607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263148b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26314e29f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263102bd70>]}
[0m06:02:10.830051 [debug] [MainThread]: Flushing usage events
[0m06:02:12.745963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03a166e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0398f5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03a167230>]}


============================== 06:02:12.748820 | 616e87ed-4c42-4675-b2ae-15ca04155233 ==============================
[0m06:02:12.748820 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.749571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.997106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03a7eb4d0>]}
[0m06:02:13.059270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0390ab950>]}
[0m06:02:13.060091 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:13.144819 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:13.145548 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:13.146096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd032515070>]}
[0m06:02:14.408664 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:14.409351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0324754c0>]}
[0m06:02:14.609410 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:14.614579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0324d0c20>]}
[0m06:02:14.740160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0320259a0>]}
[0m06:02:14.740723 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.741257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0321ca480>]}
[0m06:02:14.742994 [info ] [MainThread]: 
[0m06:02:14.743715 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.748478 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.782903 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.783418 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:14.783849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:15.219761 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.221361 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:15.223664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:15.224255 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:15.231265 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.231723 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:15.232136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.237803 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.239279 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.239712 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:15.240400 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.240825 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.241237 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:15.241831 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.242863 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.243291 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.243681 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.244219 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.244643 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:15.246939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:15.252337 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.252768 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:15.253157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.258152 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.258578 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.259028 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:15.279359 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.284066 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:15.285285 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:15.285700 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:15.289201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd038de8740>]}
[0m06:02:15.289718 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.290118 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.290500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:15.295621 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.296054 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.296459 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.296846 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.297484 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.297904 [debug] [MainThread]: On master: Close
[0m06:02:15.299363 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:15.299877 [info ] [MainThread]: 
[0m06:02:15.348997 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:15.349621 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:15.350299 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:15.350771 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:15.378151 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:15.378975 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:15.415677 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:15.416471 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:27.519202 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.519781 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:27.520740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.521210 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.521670 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:27.522503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.525374 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.525847 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:27.526611 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.547376 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:27.547939 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.548403 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:27.551582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.556724 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.557220 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:27.559052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.561643 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:27.589975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0201313a0>]}
[0m06:02:27.590919 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.24s]
[0m06:02:27.591770 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:27.592827 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:27.593452 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:27.594110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:27.594586 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:27.600039 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:27.600733 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:27.634917 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.635531 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240703060227628881"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:27.636051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:27.651625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.659606 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.660135 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:27.660794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.661272 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.661735 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240703060227628881'
      
      
      order by ordinal_position

  
[0m06:02:27.688156 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.693385 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.693887 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:27.702422 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.711861 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.712383 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:27.721057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.739015 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:27.739743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.740224 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240703060227628881"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240703060227628881"
    )
  
[0m06:02:27.755091 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.757090 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:27.757590 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.758050 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:27.769744 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.770708 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:27.946997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616e87ed-4c42-4675-b2ae-15ca04155233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd005f37590>]}
[0m06:02:27.947867 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m06:02:27.948738 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:27.950161 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.950655 [debug] [MainThread]: On master: BEGIN
[0m06:02:27.951145 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:27.956627 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.957113 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.957561 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.957995 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.958697 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.959209 [debug] [MainThread]: On master: Close
[0m06:02:27.960746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:27.961205 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:27.961633 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:27.962119 [info ] [MainThread]: 
[0m06:02:27.962692 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.22 seconds (13.22s).
[0m06:02:27.963767 [debug] [MainThread]: Command end result
[0m06:02:27.991561 [info ] [MainThread]: 
[0m06:02:27.992221 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:27.992770 [info ] [MainThread]: 
[0m06:02:27.993327 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:27.994355 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.299865, "process_user_time": 4.892074, "process_kernel_time": 0.336005, "process_mem_max_rss": "298808", "process_in_blocks": "1184", "process_out_blocks": "109616"}
[0m06:02:27.995035 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:27.994924 after 15.30 seconds
[0m06:02:27.995547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03a166ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd038fe33e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd006f65580>]}
[0m06:02:27.996045 [debug] [MainThread]: Flushing usage events
[0m06:02:30.054430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e21ab6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e21a9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e261a000>]}


============================== 06:02:30.057557 | fd08c3bd-6d0c-49d0-8d88-ef34b440ee7b ==============================
[0m06:02:30.057557 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:30.058328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:30.215996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd08c3bd-6d0c-49d0-8d88-ef34b440ee7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e1bffd70>]}
[0m06:02:30.233318 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23176347, "process_user_time": 1.485321, "process_kernel_time": 0.107805, "process_mem_max_rss": "91968", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:30.233929 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:30.233824 after 0.23 seconds
[0m06:02:30.234392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e1cc2ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e1b5a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e2036600>]}
[0m06:02:30.234883 [debug] [MainThread]: Flushing usage events
[0m14:04:47.115979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6651b7adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6650894d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f664fd82330>]}


============================== 14:04:47.123652 | 02deac34-8a88-4d78-888e-1c9302abe8d5 ==============================
[0m14:04:47.123652 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:47.124431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:47.276911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02deac34-8a88-4d78-888e-1c9302abe8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f664fc3ce90>]}
[0m14:04:47.291095 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-h76c07tx'
[0m14:04:47.291626 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:47.371528 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:47.372405 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:47.641841 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:47.645719 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:47.705533 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:47.706182 [info ] [MainThread]: Up to date!
[0m14:04:47.706743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '02deac34-8a88-4d78-888e-1c9302abe8d5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f664fc3dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f664fbe8800>]}
[0m14:04:47.708171 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.64215595, "process_user_time": 1.63173, "process_kernel_time": 0.142776, "process_mem_max_rss": "93776", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m14:04:47.708800 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:47.708691 after 0.64 seconds
[0m14:04:47.709251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66501a57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6653b67d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f664fadc680>]}
[0m14:04:47.709711 [debug] [MainThread]: Flushing usage events
[0m14:04:49.423686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96174a72f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9618fef650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96177a63f0>]}


============================== 14:04:49.426800 | 3d1c411a-963e-44be-b8a2-aa68aafc7e55 ==============================
[0m14:04:49.426800 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:49.427481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:49.668030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9610911eb0>]}
[0m14:04:49.728437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9618c5b320>]}
[0m14:04:49.729369 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:49.765234 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:49.766155 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:49.766738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96172e5eb0>]}
[0m14:04:51.011820 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:51.012623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f961089a600>]}
[0m14:04:51.216826 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:51.222573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96105ec2c0>]}
[0m14:04:51.367310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f961044b0e0>]}
[0m14:04:51.367918 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:51.368414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96104aa780>]}
[0m14:04:51.370211 [info ] [MainThread]: 
[0m14:04:51.370966 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:51.376057 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:51.413819 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:51.414420 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:51.414844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:52.019633 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:52.021193 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:52.023403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:52.023973 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:52.030819 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.031269 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:52.031685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:52.037272 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.038686 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.039105 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:52.039727 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.040138 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.040528 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:52.041156 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.042129 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:52.042549 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.042945 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:52.043490 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.043914 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:52.046090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:52.051423 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:52.051851 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:52.052237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:52.057390 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.057827 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:52.058269 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:52.078561 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.083624 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:52.084825 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:52.085240 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:52.088770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9617aea6f0>]}
[0m14:04:52.089352 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:52.089767 [debug] [MainThread]: On master: BEGIN
[0m14:04:52.090210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:52.095496 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:52.095957 [debug] [MainThread]: On master: COMMIT
[0m14:04:52.096368 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:52.096779 [debug] [MainThread]: On master: COMMIT
[0m14:04:52.097456 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:52.097886 [debug] [MainThread]: On master: Close
[0m14:04:52.099789 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:52.100292 [info ] [MainThread]: 
[0m14:04:52.109485 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:52.110165 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:52.110841 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:52.111300 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:52.137296 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:52.138127 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:52.173093 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:52.174107 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:58.991590 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:58.992166 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:04:58.992881 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.993359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:58.993820 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:04:58.994645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.997618 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:58.998141 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:04:58.998902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.019992 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:59.020502 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:59.020990 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:59.022335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.027552 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:59.028107 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:04:59.029664 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.032259 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:04:59.058909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9604f1da60>]}
[0m14:04:59.059842 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.95s]
[0m14:04:59.060822 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:04:59.061955 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:04:59.062644 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:04:59.063392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:04:59.063882 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:04:59.069212 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:04:59.069912 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:04:59.104562 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:59.105211 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240703140459098423"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:04:59.105715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:59.120413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.128314 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:59.128846 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:04:59.129518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.130018 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:59.130482 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240703140459098423'
      
      
      order by ordinal_position

  
[0m14:04:59.157595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.163703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:59.164247 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:59.173919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.183203 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:59.183730 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:59.192469 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.210931 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:04:59.211743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:59.212258 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240703140459098423"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240703140459098423"
    )
  
[0m14:04:59.230636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.232762 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:59.233292 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:59.233759 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:59.244264 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:59.245365 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:04:59.428408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d1c411a-963e-44be-b8a2-aa68aafc7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e445d190>]}
[0m14:04:59.429311 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m14:04:59.430188 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:04:59.431807 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:59.432306 [debug] [MainThread]: On master: BEGIN
[0m14:04:59.432758 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:59.438358 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:59.438847 [debug] [MainThread]: On master: COMMIT
[0m14:04:59.439297 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:59.439731 [debug] [MainThread]: On master: COMMIT
[0m14:04:59.440450 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:59.440927 [debug] [MainThread]: On master: Close
[0m14:04:59.442728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:59.443190 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:04:59.443616 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:04:59.444108 [info ] [MainThread]: 
[0m14:04:59.444676 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.07 seconds (8.07s).
[0m14:04:59.445726 [debug] [MainThread]: Command end result
[0m14:04:59.474063 [info ] [MainThread]: 
[0m14:04:59.474746 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:59.475306 [info ] [MainThread]: 
[0m14:04:59.475871 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:59.476927 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.103377, "process_user_time": 4.900436, "process_kernel_time": 0.362552, "process_mem_max_rss": "279780", "process_in_blocks": "1184", "process_out_blocks": "110112"}
[0m14:04:59.477592 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:59.477479 after 10.10 seconds
[0m14:04:59.478130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f961761f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e494bda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96178ccce0>]}
[0m14:04:59.478632 [debug] [MainThread]: Flushing usage events
[0m14:05:01.214016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86905c9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868e485c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868e4a8d40>]}


============================== 14:05:01.218303 | 2b8dbdf0-993d-4824-b08c-ffe32ddeb3e7 ==============================
[0m14:05:01.218303 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:01.219137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:01.362579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b8dbdf0-993d-4824-b08c-ffe32ddeb3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868dc90500>]}
[0m14:05:01.379181 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21435416, "process_user_time": 1.453879, "process_kernel_time": 0.099854, "process_mem_max_rss": "92024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:01.379782 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:01.379677 after 0.22 seconds
[0m14:05:01.380241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868e013050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86919bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868f69b5c0>]}
[0m14:05:01.380687 [debug] [MainThread]: Flushing usage events
[0m22:06:07.372646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6fa8e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6fa8e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6fa8e300>]}


============================== 22:06:07.417319 | ba4f03b3-c2d4-48bd-98c2-ee36d87ebec1 ==============================
[0m22:06:07.417319 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:07.418073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:07.589245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba4f03b3-c2d4-48bd-98c2-ee36d87ebec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6f9ba2a0>]}
[0m22:06:07.603303 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-gqsxn4x9'
[0m22:06:07.603826 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:07.705182 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:07.705999 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:07.747935 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:07.751990 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:07.825566 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:07.826199 [info ] [MainThread]: Up to date!
[0m22:06:07.826885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ba4f03b3-c2d4-48bd-98c2-ee36d87ebec1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6f5daf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6f6e8590>]}
[0m22:06:07.828427 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.50579476, "process_user_time": 1.694338, "process_kernel_time": 0.116435, "process_mem_max_rss": "93556", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m22:06:07.829170 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:07.829036 after 0.51 seconds
[0m22:06:07.829678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6f9f45f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6ff1a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6f6e8590>]}
[0m22:06:07.830133 [debug] [MainThread]: Flushing usage events
[0m22:06:09.497782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81be8c4dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81befa2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81be8c4ce0>]}


============================== 22:06:09.500867 | b47c094a-a914-4f66-a231-c812e93a964c ==============================
[0m22:06:09.500867 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:09.501612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:09.751325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81bed5ffe0>]}
[0m22:06:09.812401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81bed41700>]}
[0m22:06:09.813363 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:06:09.847763 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:09.848577 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:09.849154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81be77b8f0>]}
[0m22:06:11.078382 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:11.079142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b75bd460>]}
[0m22:06:11.277195 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:11.282546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b74af2c0>]}
[0m22:06:11.435513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81befc44a0>]}
[0m22:06:11.436140 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:11.436717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b731dbe0>]}
[0m22:06:11.438550 [info ] [MainThread]: 
[0m22:06:11.439341 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:11.444324 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:11.480334 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:11.480854 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:06:11.481276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:12.022996 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:12.024527 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:12.026781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:12.027358 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:12.034216 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.034670 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:06:12.035123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:12.040800 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.042149 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.042572 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:12.043453 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.043863 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.044258 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:12.044821 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.045746 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:12.046155 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.046545 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:12.047263 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.047688 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:12.049860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:12.055323 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:12.055753 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:12.056146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:12.061240 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.061664 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:12.062074 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:06:12.082059 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.086886 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:12.088097 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:12.088515 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:12.092349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81bff07ef0>]}
[0m22:06:12.092884 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:12.093297 [debug] [MainThread]: On master: BEGIN
[0m22:06:12.093680 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:12.099021 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:12.099454 [debug] [MainThread]: On master: COMMIT
[0m22:06:12.099862 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:12.100253 [debug] [MainThread]: On master: COMMIT
[0m22:06:12.100895 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:12.101316 [debug] [MainThread]: On master: Close
[0m22:06:12.102833 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:12.103388 [info ] [MainThread]: 
[0m22:06:12.123042 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:12.123661 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:12.124401 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:12.124876 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:12.150750 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:12.151494 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:12.186137 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:12.186911 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:21.299988 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.300531 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:21.301361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.301849 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.302301 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:21.303015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.305793 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.306268 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:21.306978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.327652 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:21.328177 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.328630 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:21.330182 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.335061 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.335550 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:21.337117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.339526 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:21.365226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c012a450>]}
[0m22:06:21.366025 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.24s]
[0m22:06:21.366849 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:21.367889 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:21.368468 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:21.369095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:21.369564 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:21.374620 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:21.375342 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:21.409148 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.409745 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240703220621403201"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:21.410240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:21.424971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.432421 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.432945 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:21.433620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.434094 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.434548 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240703220621403201'
      
      
      order by ordinal_position

  
[0m22:06:21.461316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.466851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.467369 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:21.476053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.484847 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.485346 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:21.499714 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.517706 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:21.518425 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.518950 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240703220621403201"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240703220621403201"
    )
  
[0m22:06:21.533656 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.535563 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:21.536038 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.536489 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:21.545471 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.546415 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:21.737451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47c094a-a914-4f66-a231-c812e93a964c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818b1a5100>]}
[0m22:06:21.738296 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m22:06:21.739088 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:21.740556 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:21.741045 [debug] [MainThread]: On master: BEGIN
[0m22:06:21.741489 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:21.747006 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:21.747496 [debug] [MainThread]: On master: COMMIT
[0m22:06:21.747946 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:21.748381 [debug] [MainThread]: On master: COMMIT
[0m22:06:21.749081 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:21.749554 [debug] [MainThread]: On master: Close
[0m22:06:21.751205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:21.751661 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:21.752087 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:21.752568 [info ] [MainThread]: 
[0m22:06:21.753145 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.31 seconds (10.31s).
[0m22:06:21.754185 [debug] [MainThread]: Command end result
[0m22:06:21.781904 [info ] [MainThread]: 
[0m22:06:21.782547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:21.783116 [info ] [MainThread]: 
[0m22:06:21.783675 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:21.784694 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.336941, "process_user_time": 4.896886, "process_kernel_time": 0.299076, "process_mem_max_rss": "290776", "process_in_blocks": "1184", "process_out_blocks": "111176"}
[0m22:06:21.785343 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:21.785234 after 12.34 seconds
[0m22:06:21.785840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81be96f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c0db6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818b230d70>]}
[0m22:06:21.786334 [debug] [MainThread]: Flushing usage events
[0m22:06:23.470826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53439cf1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5343cfb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5343f2f680>]}


============================== 22:06:23.473679 | e1e27949-4ab0-4052-9bc8-2e28ba272b86 ==============================
[0m22:06:23.473679 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:23.474353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:23.617831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1e27949-4ab0-4052-9bc8-2e28ba272b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53450678f0>]}
[0m22:06:23.635400 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21399531, "process_user_time": 1.42242, "process_kernel_time": 0.119866, "process_mem_max_rss": "91808", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:23.635998 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:23.635895 after 0.21 seconds
[0m22:06:23.636450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5344190da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5343b461e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5346de9c40>]}
[0m22:06:23.636893 [debug] [MainThread]: Flushing usage events
[0m06:02:10.868267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd851722a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd856fb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8529f0b0>]}


============================== 06:02:10.875574 | 19756dd2-f37a-473a-a44b-15478993724a ==============================
[0m06:02:10.875574 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.876288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:11.032851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19756dd2-f37a-473a-a44b-15478993724a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd84f8b050>]}
[0m06:02:11.046894 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-52gl9tnb'
[0m06:02:11.047388 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:11.094947 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:11.095794 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:11.108977 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:11.112862 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:11.173108 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:11.173762 [info ] [MainThread]: Up to date!
[0m06:02:11.174363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '19756dd2-f37a-473a-a44b-15478993724a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8529e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd84fbc800>]}
[0m06:02:11.176021 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35698986, "process_user_time": 1.702331, "process_kernel_time": 0.135866, "process_mem_max_rss": "93596", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m06:02:11.176699 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:11.176565 after 0.36 seconds
[0m06:02:11.177179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd852d6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd852d6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd855c3530>]}
[0m06:02:11.177635 [debug] [MainThread]: Flushing usage events
[0m06:02:12.798543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0a84da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0a4a9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0a4a9b20>]}


============================== 06:02:12.801704 | 7b7093b3-a463-4601-882d-6536e66bf37d ==============================
[0m06:02:12.801704 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.802396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.040386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab09d3b890>]}
[0m06:02:13.100112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0a352b70>]}
[0m06:02:13.101007 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:13.116439 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:13.117228 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:13.117785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab09ed0e30>]}
[0m06:02:14.338837 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:14.339872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab031d3e30>]}
[0m06:02:14.534180 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:14.539414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab02f3e330>]}
[0m06:02:14.672410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab031e5b20>]}
[0m06:02:14.673063 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.673605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab02f7b1d0>]}
[0m06:02:14.675356 [info ] [MainThread]: 
[0m06:02:14.676073 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.681113 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.717257 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.717758 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:14.718166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:15.141634 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.143318 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:15.145877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:15.146492 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:15.153658 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.154129 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:15.154543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.160120 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.161516 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.161936 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:15.162780 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.163193 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.163587 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:15.164157 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.165133 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.165553 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.165947 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.166500 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.166926 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:15.169191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:15.174671 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.175105 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:15.175509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.180775 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.181201 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.181614 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:15.201797 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.206613 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:15.207826 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:15.208244 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:15.211615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab01dae1b0>]}
[0m06:02:15.212158 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.212566 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.212998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:15.218204 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.218642 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.219044 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.219425 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.220054 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.220473 [debug] [MainThread]: On master: Close
[0m06:02:15.222077 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:15.222590 [info ] [MainThread]: 
[0m06:02:15.231843 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:15.232470 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:15.233133 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:15.233590 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:15.259284 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:15.260073 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:15.294580 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:15.295422 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:22.084346 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.084933 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:22.085612 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.086084 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.086542 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:22.087252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.090151 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.090634 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:22.091547 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.112645 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:22.113202 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.113666 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:22.114954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.119966 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.120461 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:22.121682 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.124163 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:22.150513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0b61a330>]}
[0m06:02:22.151351 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.92s]
[0m06:02:22.152270 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:22.153337 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:22.153947 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:22.154676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:22.155169 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:22.160419 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:22.161148 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:22.195093 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.195672 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240704060222189167"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:22.196176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:22.210955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.218515 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.219024 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:22.219665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.220133 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.220591 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240704060222189167'
      
      
      order by ordinal_position

  
[0m06:02:22.247473 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.252888 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.253386 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:22.262475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.271340 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.271843 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:22.281065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.299233 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:22.299985 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.300468 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240704060222189167"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240704060222189167"
    )
  
[0m06:02:22.315795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.317714 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:22.318183 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.318624 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:22.327614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.328545 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:22.525557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b7093b3-a463-4601-882d-6536e66bf37d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad2e053a0>]}
[0m06:02:22.526480 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m06:02:22.527317 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:22.528918 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.529418 [debug] [MainThread]: On master: BEGIN
[0m06:02:22.529884 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:22.535418 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.535907 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.536358 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.536839 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.537545 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.538017 [debug] [MainThread]: On master: Close
[0m06:02:22.539796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:22.540266 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:22.540721 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:22.541218 [info ] [MainThread]: 
[0m06:02:22.541789 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.87 seconds (7.87s).
[0m06:02:22.542837 [debug] [MainThread]: Command end result
[0m06:02:22.571089 [info ] [MainThread]: 
[0m06:02:22.571765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:22.572326 [info ] [MainThread]: 
[0m06:02:22.572920 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:22.573991 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.825212, "process_user_time": 4.931379, "process_kernel_time": 0.228527, "process_mem_max_rss": "272016", "process_in_blocks": "1184", "process_out_blocks": "111152"}
[0m06:02:22.574648 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:22.574536 after 9.83 seconds
[0m06:02:22.575149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0a84da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab031e3e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad2db4260>]}
[0m06:02:22.575658 [debug] [MainThread]: Flushing usage events
[0m06:02:24.261879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa74cbbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa98957c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa74cb8c0>]}


============================== 06:02:24.264973 | 5a70db62-f882-4d93-b03e-703e78693a33 ==============================
[0m06:02:24.264973 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.265688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.417429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a70db62-f882-4d93-b03e-703e78693a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa8444680>]}
[0m06:02:24.434082 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22165042, "process_user_time": 1.42247, "process_kernel_time": 0.119871, "process_mem_max_rss": "91956", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:24.434691 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:24.434578 after 0.22 seconds
[0m06:02:24.435166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa73faf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa74e4800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa7222330>]}
[0m06:02:24.435604 [debug] [MainThread]: Flushing usage events
[0m14:05:16.975955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0549a322a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0549de2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0549828320>]}


============================== 14:05:17.044759 | e8b006ed-7ad4-4957-984c-72801575b4c2 ==============================
[0m14:05:17.044759 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:17.045462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:17.198239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8b006ed-7ad4-4957-984c-72801575b4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0549a301a0>]}
[0m14:05:17.212359 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-15djfvit'
[0m14:05:17.212899 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:17.322628 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:17.323423 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:17.335307 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:17.339465 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:17.550746 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:17.551373 [info ] [MainThread]: Up to date!
[0m14:05:17.551918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e8b006ed-7ad4-4957-984c-72801575b4c2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05497323f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054978b410>]}
[0m14:05:17.553451 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.62645566, "process_user_time": 1.66041, "process_kernel_time": 0.128651, "process_mem_max_rss": "93568", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m14:05:17.554056 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:17.553950 after 0.63 seconds
[0m14:05:17.554506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054a952120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054984d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054ae961e0>]}
[0m14:05:17.554941 [debug] [MainThread]: Flushing usage events
[0m14:05:19.806565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f3cfbc920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f3d0a00e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f3d0a2f30>]}


============================== 14:05:19.809576 | b80fe615-7344-4d4b-8625-5003d4eae201 ==============================
[0m14:05:19.809576 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:19.810282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:20.051363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f3e72b320>]}
[0m14:05:20.115879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f3dda61e0>]}
[0m14:05:20.116887 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:20.176508 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:20.177336 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:20.177886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f35fd9bb0>]}
[0m14:05:21.476033 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:21.476789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f35b3a060>]}
[0m14:05:21.677369 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:21.682974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f35d853a0>]}
[0m14:05:21.827010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f35bf8bf0>]}
[0m14:05:21.827636 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:21.828236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f35a5a780>]}
[0m14:05:21.830122 [info ] [MainThread]: 
[0m14:05:21.830888 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:21.836127 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:21.872700 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:21.873242 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:21.873655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:22.326541 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.328103 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:22.330328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:22.330887 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:22.337673 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.338116 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:22.338530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:22.344228 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.345663 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.346089 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:22.346753 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.347170 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.347565 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:22.348124 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.349107 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:22.349517 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.349948 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:22.350494 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.350915 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:22.353243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:22.358796 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:22.359225 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:22.359627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:22.365031 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.365484 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:22.365905 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:22.386318 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.391412 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:22.392690 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:22.393112 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:22.397115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f3df44800>]}
[0m14:05:22.397666 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.398088 [debug] [MainThread]: On master: BEGIN
[0m14:05:22.398491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:22.403978 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.404474 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.404878 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.405282 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.405938 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.406382 [debug] [MainThread]: On master: Close
[0m14:05:22.408211 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:22.408764 [info ] [MainThread]: 
[0m14:05:22.431893 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:22.432627 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:22.433346 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:22.433810 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:22.460036 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:22.460969 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:22.496400 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:22.497338 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:32.531698 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:32.532290 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:32.533182 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.533661 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:32.534120 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:32.534887 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.537717 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:32.538190 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:32.538945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.559684 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:32.560289 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:32.560752 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:32.562387 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.567425 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:32.567911 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:32.569482 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.571949 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:32.599147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f0a993ec0>]}
[0m14:05:32.600000 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.16s]
[0m14:05:32.600859 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:32.601895 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:32.602491 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:32.603107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:32.603573 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:32.608878 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:32.609580 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:32.643728 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.644373 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240704140532637701"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:32.644891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:32.661626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.669425 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.670006 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:32.670750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.671214 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.671666 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240704140532637701'
      
      
      order by ordinal_position

  
[0m14:05:32.698969 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.704728 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.705284 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:32.714180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.723631 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.724172 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:32.733901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.752738 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:32.753594 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.754101 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240704140532637701"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240704140532637701"
    )
  
[0m14:05:32.769888 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.771939 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:32.772478 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.772923 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:32.784174 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.785275 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:32.974465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b80fe615-7344-4d4b-8625-5003d4eae201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f09896e40>]}
[0m14:05:32.975320 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m14:05:32.976107 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:32.977769 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:32.978291 [debug] [MainThread]: On master: BEGIN
[0m14:05:32.978743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:32.984464 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:32.985006 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.985476 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:32.985928 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.986672 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:32.987163 [debug] [MainThread]: On master: Close
[0m14:05:32.989016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:32.989477 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:32.989902 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:32.990416 [info ] [MainThread]: 
[0m14:05:32.990988 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.16 seconds (11.16s).
[0m14:05:32.992100 [debug] [MainThread]: Command end result
[0m14:05:33.021270 [info ] [MainThread]: 
[0m14:05:33.022037 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:33.022593 [info ] [MainThread]: 
[0m14:05:33.023162 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:33.024327 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.269884, "process_user_time": 5.118934, "process_kernel_time": 0.337512, "process_mem_max_rss": "309572", "process_in_blocks": "1184", "process_out_blocks": "108336"}
[0m14:05:33.024998 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:33.024882 after 13.27 seconds
[0m14:05:33.025522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f3d30ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f3d45d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f098ce360>]}
[0m14:05:33.026043 [debug] [MainThread]: Flushing usage events
[0m14:05:35.287863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba47aef380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba49d514f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba482d29f0>]}


============================== 14:05:35.290930 | 301a8b30-9381-43c3-8380-3ff2b2525b28 ==============================
[0m14:05:35.290930 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:35.291616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:35.449400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '301a8b30-9381-43c3-8380-3ff2b2525b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba47a13bf0>]}
[0m14:05:35.466508 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22811587, "process_user_time": 1.44536, "process_kernel_time": 0.139744, "process_mem_max_rss": "91960", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:35.467144 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:35.467031 after 0.23 seconds
[0m14:05:35.467623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4836ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba47991820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba47a10c80>]}
[0m14:05:35.468087 [debug] [MainThread]: Flushing usage events
[0m22:05:44.855911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595e364e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595f342000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595e364620>]}


============================== 22:05:44.875244 | 20fe16b8-a4a2-43ce-a4b1-97a2ec9391ac ==============================
[0m22:05:44.875244 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:44.875933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:45.013702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20fe16b8-a4a2-43ce-a4b1-97a2ec9391ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595e3bc920>]}
[0m22:05:45.027075 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-npfiadf8'
[0m22:05:45.027536 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:45.194914 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:45.195544 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:45.229670 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:45.233360 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:45.568510 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:45.569111 [info ] [MainThread]: Up to date!
[0m22:05:45.569708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '20fe16b8-a4a2-43ce-a4b1-97a2ec9391ac', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595e2c66f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595e2c5e50>]}
[0m22:05:45.571665 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.76496655, "process_user_time": 1.568242, "process_kernel_time": 0.136021, "process_mem_max_rss": "93700", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m22:05:45.572261 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:45.572156 after 0.77 seconds
[0m22:05:45.572699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595e3bfd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595e3bf1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595ee3e8d0>]}
[0m22:05:45.573125 [debug] [MainThread]: Flushing usage events
[0m22:05:47.375776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894b4df170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894b0cc980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894b03ba40>]}


============================== 22:05:47.378532 | bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e ==============================
[0m22:05:47.378532 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:47.379253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:47.603779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894c793470>]}
[0m22:05:47.663214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894ae78d70>]}
[0m22:05:47.664015 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:47.706343 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:47.707063 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:47.707622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894aea8500>]}
[0m22:05:48.904794 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:48.905475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894bab5e80>]}
[0m22:05:49.095568 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:49.100794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89442f55e0>]}
[0m22:05:49.222001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894402f0e0>]}
[0m22:05:49.222585 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:49.223113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8944025430>]}
[0m22:05:49.224929 [info ] [MainThread]: 
[0m22:05:49.225671 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:49.230585 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:49.266408 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:49.266939 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:49.267350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:50.235044 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:50.236610 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:50.238785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:50.239350 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:50.246065 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:50.246506 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:50.246905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:50.252718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:50.254159 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:50.254577 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:50.255127 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:50.255528 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:50.255955 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:50.256532 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:50.257454 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:50.257864 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:50.258250 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:50.258789 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:50.259207 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:50.261516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:50.266924 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:50.267351 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:50.267786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:50.273164 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:50.273593 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:50.273998 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:50.294273 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:50.299456 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:50.300709 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:50.301126 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:50.305276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894b53d1f0>]}
[0m22:05:50.305820 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:50.306233 [debug] [MainThread]: On master: BEGIN
[0m22:05:50.306619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:50.312044 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:50.312494 [debug] [MainThread]: On master: COMMIT
[0m22:05:50.312903 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:50.313289 [debug] [MainThread]: On master: COMMIT
[0m22:05:50.313929 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:50.314350 [debug] [MainThread]: On master: Close
[0m22:05:50.316082 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:50.316600 [info ] [MainThread]: 
[0m22:05:50.327238 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:50.327917 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:50.328678 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:50.329133 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:50.355357 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:50.356231 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:50.391405 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:50.392300 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:01.772207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:01.772733 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:01.773374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.773827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:01.774264 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:01.774962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.777666 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:01.778133 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:01.778832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.799558 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:01.800079 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:01.800525 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:01.802114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.806850 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:01.807334 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:01.808687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.811008 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:01.837832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8918f30530>]}
[0m22:06:01.838577 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.51s]
[0m22:06:01.839464 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:01.840496 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:01.841074 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:01.841751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:01.842222 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:01.847083 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:01.847811 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:01.881233 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.881779 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240704220601875328"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:01.882259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:01.898297 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.905489 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.905965 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:01.906562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.907015 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.907467 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240704220601875328'
      
      
      order by ordinal_position

  
[0m22:06:01.934026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.939027 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.939531 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:01.948233 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.957060 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.957555 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:01.966830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.984855 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:01.985563 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.986043 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240704220601875328"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240704220601875328"
    )
  
[0m22:06:01.999408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.001214 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:02.001676 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:02.002114 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:02.011078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.012106 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:02.170349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdb7d3b0-cf07-43b4-ac4b-e286eb4ae31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8913fd9790>]}
[0m22:06:02.171184 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m22:06:02.172077 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:02.173402 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:02.173933 [debug] [MainThread]: On master: BEGIN
[0m22:06:02.174371 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:02.179831 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:02.180307 [debug] [MainThread]: On master: COMMIT
[0m22:06:02.180837 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:02.181270 [debug] [MainThread]: On master: COMMIT
[0m22:06:02.181830 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:02.182287 [debug] [MainThread]: On master: Close
[0m22:06:02.183683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:02.184128 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:02.184555 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:02.185038 [info ] [MainThread]: 
[0m22:06:02.185558 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.96 seconds (12.96s).
[0m22:06:02.186540 [debug] [MainThread]: Command end result
[0m22:06:02.214267 [info ] [MainThread]: 
[0m22:06:02.214921 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:02.215440 [info ] [MainThread]: 
[0m22:06:02.215995 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:02.216993 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.890252, "process_user_time": 4.687639, "process_kernel_time": 0.324251, "process_mem_max_rss": "280684", "process_in_blocks": "1184", "process_out_blocks": "108880"}
[0m22:06:02.217636 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:02.217525 after 14.89 seconds
[0m22:06:02.218132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894b142ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894b0a2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8913f652e0>]}
[0m22:06:02.218626 [debug] [MainThread]: Flushing usage events
[0m22:06:04.078535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1955172c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1955a345c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19550b72f0>]}


============================== 22:06:04.081400 | d281fa11-ce58-4c45-9b32-a1560bddbf03 ==============================
[0m22:06:04.081400 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:04.082100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:04.222045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd281fa11-ce58-4c45-9b32-a1560bddbf03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1954ea45c0>]}
[0m22:06:04.238373 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20883004, "process_user_time": 1.43128, "process_kernel_time": 0.111943, "process_mem_max_rss": "92100", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:04.238955 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:04.238852 after 0.21 seconds
[0m22:06:04.239396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19559ff530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19555fad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19555f8d40>]}
[0m22:06:04.239876 [debug] [MainThread]: Flushing usage events
[0m06:02:10.286840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa40476f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa40e33f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa3feb9400>]}


============================== 06:02:10.317496 | 5510b6e0-4988-42cf-9412-a3330d6a2c73 ==============================
[0m06:02:10.317496 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.318302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.482312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5510b6e0-4988-42cf-9412-a3330d6a2c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa3f94bbf0>]}
[0m06:02:10.497237 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zi6jm11e'
[0m06:02:10.497774 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.513495 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.514287 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.525568 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.529540 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.577072 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.577724 [info ] [MainThread]: Up to date!
[0m06:02:10.578374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5510b6e0-4988-42cf-9412-a3330d6a2c73', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa3feb8d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa3f80bc80>]}
[0m06:02:10.585306 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.34853145, "process_user_time": 1.662873, "process_kernel_time": 0.132868, "process_mem_max_rss": "93452", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m06:02:10.585942 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.585833 after 0.35 seconds
[0m06:02:10.586398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa408e3ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa3f8404a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa3fb2e990>]}
[0m06:02:10.586848 [debug] [MainThread]: Flushing usage events
[0m06:02:12.269228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12823f1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1280e79d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f128128bb60>]}


============================== 06:02:12.272340 | 335c1b72-b73b-4ba8-9a67-aae8b2e73a05 ==============================
[0m06:02:12.272340 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.273123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.518479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1282027470>]}
[0m06:02:12.578965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12814e2f60>]}
[0m06:02:12.579930 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:12.605905 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:12.606709 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:12.607240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12807108f0>]}
[0m06:02:13.831834 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:13.832556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1280625460>]}
[0m06:02:14.029372 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:14.034938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1279a9c500>]}
[0m06:02:14.188860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1279a9d970>]}
[0m06:02:14.189530 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.190039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1279af46e0>]}
[0m06:02:14.191821 [info ] [MainThread]: 
[0m06:02:14.192567 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.197751 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.236104 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.236660 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:14.237148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:14.698218 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.699809 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:14.702070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:14.702664 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:14.709794 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.710280 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:14.710704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.716936 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.718525 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.718956 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:14.719642 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.720057 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.720450 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:14.721086 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.722055 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.722467 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.722853 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.723397 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.723826 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:14.726356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:14.732227 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.732722 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:14.733166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.738896 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.739416 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.739833 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:14.760946 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.766324 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:14.767734 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:14.768210 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:14.772206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1280cfd760>]}
[0m06:02:14.772821 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.773351 [debug] [MainThread]: On master: BEGIN
[0m06:02:14.773746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:14.779370 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.779893 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.780303 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.780696 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.781414 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.781845 [debug] [MainThread]: On master: Close
[0m06:02:14.783860 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:14.784378 [info ] [MainThread]: 
[0m06:02:14.804235 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:14.805012 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:14.805747 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:14.806201 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:14.832407 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:14.833393 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:14.869539 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:14.870558 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:22.449209 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.449817 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:22.450746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.451247 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.451707 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:22.452506 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.455528 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.456010 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:22.456777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.478034 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:22.478603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.479063 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:22.481692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.486921 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.487406 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:22.488778 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.491397 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:22.518203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1279950ec0>]}
[0m06:02:22.519074 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.71s]
[0m06:02:22.519975 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:22.521038 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:22.521628 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:22.522342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:22.522817 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:22.528175 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:22.528885 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:22.563207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.563842 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240705060222557217"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:22.564348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:22.581186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.589123 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.589667 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:22.590381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.590844 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.591294 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240705060222557217'
      
      
      order by ordinal_position

  
[0m06:02:22.625028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.630860 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.631403 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:22.644109 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.653488 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.654008 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:22.662858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.681383 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:22.682227 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.682722 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240705060222557217"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240705060222557217"
    )
  
[0m06:02:22.697809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.699891 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:22.700384 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.700826 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:22.710592 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.711637 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:22.882347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '335c1b72-b73b-4ba8-9a67-aae8b2e73a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f124d1c9340>]}
[0m06:02:22.883587 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m06:02:22.884701 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:22.886529 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.887036 [debug] [MainThread]: On master: BEGIN
[0m06:02:22.887492 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:22.893948 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.894453 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.894908 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.895348 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.896039 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.896551 [debug] [MainThread]: On master: Close
[0m06:02:22.898690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:22.899260 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:22.899749 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:22.900297 [info ] [MainThread]: 
[0m06:02:22.901048 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.71 seconds (8.71s).
[0m06:02:22.902348 [debug] [MainThread]: Command end result
[0m06:02:22.932696 [info ] [MainThread]: 
[0m06:02:22.933557 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:22.934169 [info ] [MainThread]: 
[0m06:02:22.934951 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:22.936235 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.716856, "process_user_time": 4.996104, "process_kernel_time": 0.301212, "process_mem_max_rss": "277372", "process_in_blocks": "1184", "process_out_blocks": "108856"}
[0m06:02:22.936925 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:22.936787 after 10.72 seconds
[0m06:02:22.937623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1280d58cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1280d3f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f124e323620>]}
[0m06:02:22.938244 [debug] [MainThread]: Flushing usage events
[0m06:02:24.758095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd4457b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd4457590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd45bb1d0>]}


============================== 06:02:24.761131 | 88b309fc-97a3-41ca-92b7-7fbb042b7e18 ==============================
[0m06:02:24.761131 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.761886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.919931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88b309fc-97a3-41ca-92b7-7fbb042b7e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd4368cb0>]}
[0m06:02:24.937115 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2294497, "process_user_time": 1.489172, "process_kernel_time": 0.092072, "process_mem_max_rss": "92208", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:24.937740 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:24.937634 after 0.23 seconds
[0m06:02:24.938197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd7fbbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd4afde80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd45efdd0>]}
[0m06:02:24.938646 [debug] [MainThread]: Flushing usage events
[0m14:05:23.663375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19ad300dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19af67d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19b0b883b0>]}


============================== 14:05:23.670778 | 31e4bcaf-a209-4537-8701-9680d34f681a ==============================
[0m14:05:23.670778 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.671503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.812261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31e4bcaf-a209-4537-8701-9680d34f681a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19adc23050>]}
[0m14:05:23.825528 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-dgtm92yr'
[0m14:05:23.825991 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:23.854669 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:23.855315 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:23.866017 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:23.869655 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:24.078676 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:24.079237 [info ] [MainThread]: Up to date!
[0m14:05:24.079804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '31e4bcaf-a209-4537-8701-9680d34f681a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19ad34ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19b0fbbd40>]}
[0m14:05:24.081578 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46614787, "process_user_time": 1.552673, "process_kernel_time": 0.138986, "process_mem_max_rss": "93492", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m14:05:24.082224 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:24.082099 after 0.47 seconds
[0m14:05:24.082674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19ae04b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19b0b883b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19adb4f110>]}
[0m14:05:24.083143 [debug] [MainThread]: Flushing usage events
[0m14:05:25.989370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ec11ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16eb7db320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16eb7d9070>]}


============================== 14:05:25.992114 | 4dbc5b2b-7b28-44b6-a160-b5102d82361a ==============================
[0m14:05:25.992114 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:25.992839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:26.217146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16eb893200>]}
[0m14:05:26.276246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16eb61ab70>]}
[0m14:05:26.277123 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:26.344735 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:26.345479 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:26.346052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ebb5fda0>]}
[0m14:05:27.549759 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:27.550492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e4a8f950>]}
[0m14:05:27.746061 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:27.751035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e4970170>]}
[0m14:05:27.873885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e48f7ad0>]}
[0m14:05:27.874519 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:27.875011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e47b2780>]}
[0m14:05:27.876702 [info ] [MainThread]: 
[0m14:05:27.877391 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:27.882357 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:27.917168 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:27.917640 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:27.918153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:28.390216 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.391753 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:28.394115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:28.394685 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:28.401402 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.401846 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:28.402293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:28.407684 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.409060 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.409481 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:28.410348 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.410764 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.411158 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:28.411801 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.412736 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:28.413144 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.413536 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:28.414110 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.414531 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:28.416630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:28.422115 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:28.422548 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:28.422934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:28.428253 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.428685 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:28.429118 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:28.449669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.454610 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:28.455865 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:28.456296 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:28.460386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16eb80ec30>]}
[0m14:05:28.460928 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:28.461337 [debug] [MainThread]: On master: BEGIN
[0m14:05:28.461727 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:28.467122 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:28.467569 [debug] [MainThread]: On master: COMMIT
[0m14:05:28.467986 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:28.468381 [debug] [MainThread]: On master: COMMIT
[0m14:05:28.469028 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:28.469454 [debug] [MainThread]: On master: Close
[0m14:05:28.471052 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:28.471577 [info ] [MainThread]: 
[0m14:05:28.480414 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:28.481056 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:28.481721 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:28.482218 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:28.507926 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:28.508741 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:28.543053 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:28.543880 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:39.128708 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.129246 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:39.129883 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.130387 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.130840 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:39.131538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.134272 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.134748 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:39.135448 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.156019 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:39.156513 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.156967 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:39.158290 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.163052 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:39.163547 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:39.164879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.167244 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:39.194175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ece7a750>]}
[0m14:05:39.194934 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.71s]
[0m14:05:39.195713 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:39.196694 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:39.197271 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:39.197849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:39.198356 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:39.203301 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:39.203978 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:39.237301 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.237927 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240705140539231350"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:39.238451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:39.255110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.262506 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.263014 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:39.263754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.264222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.264676 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240705140539231350'
      
      
      order by ordinal_position

  
[0m14:05:39.291528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.297290 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.297829 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:39.312342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.321835 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.322383 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:39.331763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.349994 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:39.350776 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.351260 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240705140539231350"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240705140539231350"
    )
  
[0m14:05:39.366345 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.368184 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:39.368662 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:39.369106 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:39.378944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:39.379869 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:39.548662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dbc5b2b-7b28-44b6-a160-b5102d82361a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ece7a750>]}
[0m14:05:39.549514 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m14:05:39.550299 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:39.551633 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.552124 [debug] [MainThread]: On master: BEGIN
[0m14:05:39.552567 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:39.557861 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.558383 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.558832 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.559272 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.559984 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.560448 [debug] [MainThread]: On master: Close
[0m14:05:39.561839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:39.562333 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:39.562748 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:39.563219 [info ] [MainThread]: 
[0m14:05:39.563746 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.69 seconds (11.69s).
[0m14:05:39.564767 [debug] [MainThread]: Command end result
[0m14:05:39.592723 [info ] [MainThread]: 
[0m14:05:39.593361 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:39.593885 [info ] [MainThread]: 
[0m14:05:39.594459 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:39.595463 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.654462, "process_user_time": 4.708136, "process_kernel_time": 0.339433, "process_mem_max_rss": "267812", "process_in_blocks": "1184", "process_out_blocks": "109568"}
[0m14:05:39.596130 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:39.596008 after 13.66 seconds
[0m14:05:39.596630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ebfe3a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e3587bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e49ef980>]}
[0m14:05:39.597132 [debug] [MainThread]: Flushing usage events
[0m14:05:41.572755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d7e2d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d7cab530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d7e11580>]}


============================== 14:05:41.575615 | 8e93415c-a9c6-47e7-923d-18b462720011 ==============================
[0m14:05:41.575615 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:41.576321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:41.716708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e93415c-a9c6-47e7-923d-18b462720011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d888c050>]}
[0m14:05:41.733563 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20938076, "process_user_time": 1.459596, "process_kernel_time": 0.095973, "process_mem_max_rss": "91880", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:41.734204 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:41.734096 after 0.21 seconds
[0m14:05:41.734660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d7e12240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d77fe570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d7889c40>]}
[0m14:05:41.735107 [debug] [MainThread]: Flushing usage events
[0m22:06:07.830517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c42b8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c46833b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c68016a0>]}


============================== 22:06:07.851752 | e5912975-844a-41cc-999a-42a470c9d6d3 ==============================
[0m22:06:07.851752 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:07.852500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:07.995322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5912975-844a-41cc-999a-42a470c9d6d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c4120b30>]}
[0m22:06:08.008809 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-n9yzqggc'
[0m22:06:08.009277 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:08.099046 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:08.099785 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:08.123479 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:08.127305 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:08.199778 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:08.200395 [info ] [MainThread]: Up to date!
[0m22:06:08.200975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e5912975-844a-41cc-999a-42a470c9d6d3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c401f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c401fe00>]}
[0m22:06:08.202393 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42020696, "process_user_time": 1.580239, "process_kernel_time": 0.120322, "process_mem_max_rss": "93728", "process_in_blocks": "5752", "process_out_blocks": "3840"}
[0m22:06:08.203006 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:08.202901 after 0.42 seconds
[0m22:06:08.203458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c4a79e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c4044350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c4000e30>]}
[0m22:06:08.203901 [debug] [MainThread]: Flushing usage events
[0m22:06:09.809246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7172b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6f1d13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6f20eb40>]}


============================== 22:06:09.812022 | 4fa23025-4ad4-4216-ad63-bf332f90d57f ==============================
[0m22:06:09.812022 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:09.812756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:10.036968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c67d17680>]}
[0m22:06:10.096294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c70c325d0>]}
[0m22:06:10.097171 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:06:10.112772 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:10.113499 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:10.114071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c67c2cfb0>]}
[0m22:06:11.315298 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:11.315986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c67905940>]}
[0m22:06:11.505771 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:11.510598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c679f3fb0>]}
[0m22:06:11.632799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c67813440>]}
[0m22:06:11.633380 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:11.633890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6f040e90>]}
[0m22:06:11.635625 [info ] [MainThread]: 
[0m22:06:11.636326 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:11.641116 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:11.676136 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:11.676600 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:06:11.677022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:12.169215 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.170829 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:12.173157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:12.173755 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:12.180689 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.181141 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:06:12.181553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:12.187373 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.188769 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.189195 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:12.189866 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.190355 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.190756 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:12.191345 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.192335 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:12.192770 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.193167 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:12.193714 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.194181 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:12.196290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:12.201609 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:12.202074 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:12.202472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:12.207677 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.208106 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:12.208519 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:06:12.229053 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.233743 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:12.234958 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:12.235384 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:12.238627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c67850650>]}
[0m22:06:12.239158 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:12.239561 [debug] [MainThread]: On master: BEGIN
[0m22:06:12.239944 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:12.245015 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:12.245445 [debug] [MainThread]: On master: COMMIT
[0m22:06:12.245843 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:12.246280 [debug] [MainThread]: On master: COMMIT
[0m22:06:12.246787 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:12.247196 [debug] [MainThread]: On master: Close
[0m22:06:12.248563 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:12.249125 [info ] [MainThread]: 
[0m22:06:12.258019 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:12.258631 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:12.259365 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:12.259823 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:12.284998 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:12.285756 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:12.319710 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:12.320463 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:20.098943 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:20.099503 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:20.100296 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.100766 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:20.101214 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:20.101934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.104629 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:20.105102 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:20.105816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.126552 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:20.127051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:20.127496 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:20.128693 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.133468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:20.133983 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:20.135164 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.137527 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:20.163673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c4c1c8dd0>]}
[0m22:06:20.164476 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.90s]
[0m22:06:20.165269 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:20.166312 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:20.166910 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:20.167594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:20.168061 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:20.173108 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:20.173770 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:20.207183 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.207722 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240705220620201169"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:20.208210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:20.224865 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.232400 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.232908 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:20.233564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.234046 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.234498 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240705220620201169'
      
      
      order by ordinal_position

  
[0m22:06:20.261062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.266490 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.267001 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:20.275773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.284690 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.285183 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:20.294677 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.312621 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:20.313343 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.313834 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240705220620201169"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240705220620201169"
    )
  
[0m22:06:20.328138 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.329887 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:20.330381 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.330817 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:20.341352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.342318 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:20.514923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fa23025-4ad4-4216-ad63-bf332f90d57f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c3772f410>]}
[0m22:06:20.515760 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m22:06:20.516513 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:20.517973 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:20.518481 [debug] [MainThread]: On master: BEGIN
[0m22:06:20.518923 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:20.524246 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:20.524732 [debug] [MainThread]: On master: COMMIT
[0m22:06:20.525177 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:20.525607 [debug] [MainThread]: On master: COMMIT
[0m22:06:20.526361 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:20.526826 [debug] [MainThread]: On master: Close
[0m22:06:20.528184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:20.528632 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:20.529049 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:20.529532 [info ] [MainThread]: 
[0m22:06:20.530106 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.89 seconds (8.89s).
[0m22:06:20.531100 [debug] [MainThread]: Command end result
[0m22:06:20.558837 [info ] [MainThread]: 
[0m22:06:20.559447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:20.559954 [info ] [MainThread]: 
[0m22:06:20.560475 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:20.561449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.80099, "process_user_time": 4.685303, "process_kernel_time": 0.354886, "process_mem_max_rss": "273532", "process_in_blocks": "1184", "process_out_blocks": "109600"}
[0m22:06:20.562147 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:20.562031 after 10.80 seconds
[0m22:06:20.562655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6e9a2ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c679c1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6658b140>]}
[0m22:06:20.563149 [debug] [MainThread]: Flushing usage events
[0m22:06:22.260584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd5732930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4fa7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4dd72c0>]}


============================== 22:06:22.263394 | 6e92c1ca-adbd-41f6-83fb-c60c82c9c6c9 ==============================
[0m22:06:22.263394 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:22.264120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:22.405284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e92c1ca-adbd-41f6-83fb-c60c82c9c6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd53408c0>]}
[0m22:06:22.421802 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21014805, "process_user_time": 1.405213, "process_kernel_time": 0.12811, "process_mem_max_rss": "92076", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:22.422469 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:22.422362 after 0.21 seconds
[0m22:06:22.422932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd51aaae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd5f7ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4ca1820>]}
[0m22:06:22.423381 [debug] [MainThread]: Flushing usage events
[0m06:02:09.942246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7386a1d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7384a96750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73858f07d0>]}


============================== 06:02:09.949155 | 6cb6ac62-d221-4327-8ee1-9ff09c76701d ==============================
[0m06:02:09.949155 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.949819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.108079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cb6ac62-d221-4327-8ee1-9ff09c76701d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7384511010>]}
[0m06:02:10.123762 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4z_gz1vs'
[0m06:02:10.124348 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.165956 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.166766 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.179227 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.183129 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.398732 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.399261 [info ] [MainThread]: Up to date!
[0m06:02:10.399806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6cb6ac62-d221-4327-8ee1-9ff09c76701d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73843b5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7385472f30>]}
[0m06:02:10.401287 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5071558, "process_user_time": 1.603147, "process_kernel_time": 0.116228, "process_mem_max_rss": "93196", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m06:02:10.401890 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.401784 after 0.51 seconds
[0m06:02:10.402333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7388367da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7384b17170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7384e66fc0>]}
[0m06:02:10.402767 [debug] [MainThread]: Flushing usage events
[0m06:02:12.198763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee619f0da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee61a6b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee61a6b0b0>]}


============================== 06:02:12.201540 | c8be9ef3-95a5-45bc-a750-464758da8db1 ==============================
[0m06:02:12.201540 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.202186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.428006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5af7ce90>]}
[0m06:02:12.487142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6312b4d0>]}
[0m06:02:12.487912 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:12.503684 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:12.504407 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:12.505006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee61a6b230>]}
[0m06:02:13.720099 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:13.720816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5aeee9f0>]}
[0m06:02:13.910930 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:13.916932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5abd7e30>]}
[0m06:02:14.043299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5abd5fd0>]}
[0m06:02:14.043871 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.044387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5aa75d00>]}
[0m06:02:14.046152 [info ] [MainThread]: 
[0m06:02:14.046881 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.051666 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.087262 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.087768 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:14.088187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:14.447304 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.448891 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:14.451244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:14.451857 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:14.458713 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.459161 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:14.459562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.464962 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.466310 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.466725 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:14.467285 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.467763 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.468153 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:14.468726 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.469664 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.470075 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.470466 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.471130 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.471555 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:14.473665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:14.478922 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.479345 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:14.479727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.484736 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.485157 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.485565 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:14.505070 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.509800 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:14.510982 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:14.511577 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:14.515402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5ab38140>]}
[0m06:02:14.515931 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.516339 [debug] [MainThread]: On master: BEGIN
[0m06:02:14.516783 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:14.521871 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.522306 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.522713 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.523105 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.523615 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.524036 [debug] [MainThread]: On master: Close
[0m06:02:14.525486 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:14.526037 [info ] [MainThread]: 
[0m06:02:14.535008 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:14.535632 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:14.536378 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:14.536885 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:14.562348 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:14.563124 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:14.597144 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:14.597896 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:26.231584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.232109 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:26.232793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.233259 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.233710 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:26.234490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.237191 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.237666 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:26.238375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.258979 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:26.259471 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.259922 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:26.261048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.265817 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.266298 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:26.267461 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.269789 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:26.294845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2af58ef0>]}
[0m06:02:26.295594 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.76s]
[0m06:02:26.296380 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:26.297419 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:26.298009 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:26.298630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:26.299092 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:26.303992 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:26.304704 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:26.337980 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.338502 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240706060226332087"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:26.338984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:26.353852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.360829 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.361315 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:26.361918 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.362379 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.362829 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240706060226332087'
      
      
      order by ordinal_position

  
[0m06:02:26.388782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.393802 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.394303 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:26.402648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.411191 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.411693 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:26.419999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.437957 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:26.438657 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.439140 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240706060226332087"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240706060226332087"
    )
  
[0m06:02:26.454923 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.456785 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:26.457261 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.457699 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:26.467448 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.468342 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:26.646488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8be9ef3-95a5-45bc-a750-464758da8db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2a8cf590>]}
[0m06:02:26.647356 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m06:02:26.648256 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:26.649753 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.650256 [debug] [MainThread]: On master: BEGIN
[0m06:02:26.650721 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:26.656126 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.656677 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.657144 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.657601 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.658177 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.658643 [debug] [MainThread]: On master: Close
[0m06:02:26.660408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:26.660907 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:26.661335 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:26.661814 [info ] [MainThread]: 
[0m06:02:26.662431 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.62 seconds (12.62s).
[0m06:02:26.663574 [debug] [MainThread]: Command end result
[0m06:02:26.692247 [info ] [MainThread]: 
[0m06:02:26.692970 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:26.693574 [info ] [MainThread]: 
[0m06:02:26.694187 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:26.695292 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.544912, "process_user_time": 4.780916, "process_kernel_time": 0.263609, "process_mem_max_rss": "278252", "process_in_blocks": "1184", "process_out_blocks": "110072"}
[0m06:02:26.695947 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:26.695832 after 14.55 seconds
[0m06:02:26.696459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee61dc3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee619f0ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee61e95580>]}
[0m06:02:26.697010 [debug] [MainThread]: Flushing usage events
[0m06:02:28.595920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8764d3f770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87649c7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f876492f4d0>]}


============================== 06:02:28.598745 | ce2b2932-20ad-46d0-a942-1e0ecc6339af ==============================
[0m06:02:28.598745 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:28.599485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:28.743338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce2b2932-20ad-46d0-a942-1e0ecc6339af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87648b8290>]}
[0m06:02:28.759937 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21273965, "process_user_time": 1.424759, "process_kernel_time": 0.092049, "process_mem_max_rss": "92204", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:28.760529 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:28.760426 after 0.21 seconds
[0m06:02:28.761024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87653aac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8764994260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8764cda660>]}
[0m06:02:28.761466 [debug] [MainThread]: Flushing usage events
[0m14:04:57.499345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5c882450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5c882000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5de952e0>]}


============================== 14:04:57.534404 | f0941742-5993-4e44-9777-876632896acb ==============================
[0m14:04:57.534404 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:57.535099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:57.682682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0941742-5993-4e44-9777-876632896acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5bfb42c0>]}
[0m14:04:57.696251 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-unkmjs1m'
[0m14:04:57.696741 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:57.805567 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:57.806281 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:57.830461 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:57.834180 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:57.907205 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:57.907819 [info ] [MainThread]: Up to date!
[0m14:04:57.908446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f0941742-5993-4e44-9777-876632896acb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5b878e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5b87b980>]}
[0m14:04:57.910384 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4594648, "process_user_time": 1.583588, "process_kernel_time": 0.111688, "process_mem_max_rss": "93572", "process_in_blocks": "5752", "process_out_blocks": "3840"}
[0m14:04:57.911001 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:57.910897 after 0.46 seconds
[0m14:04:57.911440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5c335d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5b919250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5bb6aea0>]}
[0m14:04:57.911886 [debug] [MainThread]: Flushing usage events
[0m14:04:59.463428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa739757170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73971d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa738d68b90>]}


============================== 14:04:59.466219 | 39fccebe-4b67-4583-abbf-32398542557f ==============================
[0m14:04:59.466219 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:59.466990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:59.698335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73a47f830>]}
[0m14:04:59.757400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73a47f830>]}
[0m14:04:59.758229 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:59.862880 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:59.864043 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:59.864741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa738b94260>]}
[0m14:05:01.095443 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:01.096137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7320cdeb0>]}
[0m14:05:01.286185 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:01.291252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa738c1d5b0>]}
[0m14:05:01.415337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa731eef950>]}
[0m14:05:01.415897 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:01.416426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa731daaba0>]}
[0m14:05:01.418160 [info ] [MainThread]: 
[0m14:05:01.418928 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:01.423804 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:01.457978 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:01.458455 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:01.458865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:02.011315 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:02.012857 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:02.015078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:02.015667 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:02.022431 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:02.022875 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:02.023274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:02.028776 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:02.030144 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:02.030604 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:02.031254 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:02.031660 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:02.032049 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:02.032619 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:02.033533 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:02.033942 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:02.034369 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:02.035055 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:02.035503 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:02.037517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:02.043008 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:02.043434 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:02.043822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:02.048912 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:02.049332 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:02.049737 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:02.069862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:02.074634 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:02.075835 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:02.076251 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:02.079497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73a7743b0>]}
[0m14:05:02.080031 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:02.080433 [debug] [MainThread]: On master: BEGIN
[0m14:05:02.080806 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:02.085988 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:02.086454 [debug] [MainThread]: On master: COMMIT
[0m14:05:02.086899 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:02.087289 [debug] [MainThread]: On master: COMMIT
[0m14:05:02.087912 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:02.088327 [debug] [MainThread]: On master: Close
[0m14:05:02.089784 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:02.090324 [info ] [MainThread]: 
[0m14:05:02.132314 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:02.132976 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:02.133660 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:02.134107 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:02.159310 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:02.160077 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:02.194663 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:02.195441 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:16.902704 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.903233 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:16.903835 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.904292 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.904740 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:16.905410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.908131 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.908598 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:16.909284 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.929463 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:16.929951 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.930432 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:16.932493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.937263 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:16.937746 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:16.940768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.943166 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:16.968768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa73a47e7e0>]}
[0m14:05:16.969497 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 14.83s]
[0m14:05:16.970277 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:16.971325 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:16.971912 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:16.972523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:16.972989 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:16.977830 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:16.978526 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:17.011616 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.012209 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240706140517005796"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:17.012700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:17.028991 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.035893 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.036371 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:17.036964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.037422 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.037867 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240706140517005796'
      
      
      order by ordinal_position

  
[0m14:05:17.064738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.070378 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.070908 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:17.085290 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.094668 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.095183 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:17.103947 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.121784 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:17.122535 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.123020 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240706140517005796"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240706140517005796"
    )
  
[0m14:05:17.138272 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.140170 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:17.140661 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.141110 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:17.150768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.151718 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:17.347473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39fccebe-4b67-4583-abbf-32398542557f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa705c54e30>]}
[0m14:05:17.348293 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m14:05:17.349051 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:17.350380 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:17.350859 [debug] [MainThread]: On master: BEGIN
[0m14:05:17.351298 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:17.356489 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:17.356959 [debug] [MainThread]: On master: COMMIT
[0m14:05:17.357398 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:17.357822 [debug] [MainThread]: On master: COMMIT
[0m14:05:17.358392 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:17.358848 [debug] [MainThread]: On master: Close
[0m14:05:17.360168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:17.360607 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:17.361018 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:17.361476 [info ] [MainThread]: 
[0m14:05:17.362021 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 15.94 seconds (15.94s).
[0m14:05:17.363108 [debug] [MainThread]: Command end result
[0m14:05:17.390575 [info ] [MainThread]: 
[0m14:05:17.391214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:17.391758 [info ] [MainThread]: 
[0m14:05:17.392321 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:17.393339 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.978561, "process_user_time": 4.789821, "process_kernel_time": 0.310046, "process_mem_max_rss": "279336", "process_in_blocks": "1184", "process_out_blocks": "111096"}
[0m14:05:17.393980 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:17.393870 after 17.98 seconds
[0m14:05:17.394512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7399933b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7390d9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa705c31610>]}
[0m14:05:17.395020 [debug] [MainThread]: Flushing usage events
[0m14:05:19.023830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0721a7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0725d6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0725d70b0>]}


============================== 14:05:19.026661 | 71bd17ff-c12a-4806-bca0-f25d6552e951 ==============================
[0m14:05:19.026661 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:19.027390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:19.174267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71bd17ff-c12a-4806-bca0-f25d6552e951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff071af7a40>]}
[0m14:05:19.191338 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2159999, "process_user_time": 1.415083, "process_kernel_time": 0.095937, "process_mem_max_rss": "91844", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:19.191939 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:19.191835 after 0.22 seconds
[0m14:05:19.192391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0721a7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0720a2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff071af7a40>]}
[0m14:05:19.192832 [debug] [MainThread]: Flushing usage events
[0m22:05:30.700450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236de8f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236d4ca000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236d486600>]}


============================== 22:05:30.759456 | cbe274b2-5895-4280-872c-9d6670032a5f ==============================
[0m22:05:30.759456 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:30.760111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:30.897539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbe274b2-5895-4280-872c-9d6670032a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236d0b7e60>]}
[0m22:05:30.910675 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yusukxht'
[0m22:05:30.911129 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:30.985874 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:30.986598 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:31.010030 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:31.013674 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:31.085057 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:31.085562 [info ] [MainThread]: Up to date!
[0m22:05:31.086090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cbe274b2-5895-4280-872c-9d6670032a5f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236d4de7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236ce1f590>]}
[0m22:05:31.087592 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43505037, "process_user_time": 1.555033, "process_kernel_time": 0.116226, "process_mem_max_rss": "93540", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m22:05:31.088182 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:31.088080 after 0.44 seconds
[0m22:05:31.088619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236d101970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236cebb2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236da330b0>]}
[0m22:05:31.089042 [debug] [MainThread]: Flushing usage events
[0m22:05:32.632743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104126d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1041676120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1041676510>]}


============================== 22:05:32.635437 | 44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684 ==============================
[0m22:05:32.635437 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:32.636179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:32.860175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1041fd34a0>]}
[0m22:05:32.919021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1041e39040>]}
[0m22:05:32.919747 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:32.943625 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:32.944336 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:32.944884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10405ed070>]}
[0m22:05:34.156256 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:34.156949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1039c7f680>]}
[0m22:05:34.348962 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:34.353866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1039a87380>]}
[0m22:05:34.471450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10399433e0>]}
[0m22:05:34.472086 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:34.472636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10425de540>]}
[0m22:05:34.474316 [info ] [MainThread]: 
[0m22:05:34.475066 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:34.479994 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:34.514426 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:34.514901 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:34.515308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:34.886100 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.887695 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:34.889697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:34.890256 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:34.896887 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:34.897328 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:34.897728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:34.903012 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.904285 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:34.904690 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:34.905545 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.905945 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:34.906338 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:34.907025 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.907932 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:34.908340 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:34.908719 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:34.909256 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.909662 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:34.911649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:34.916848 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:34.917276 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:34.917667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:34.922567 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.922996 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:34.923408 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:34.943626 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.948396 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:34.949562 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:34.949974 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:34.953130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10399abf20>]}
[0m22:05:34.953642 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:34.954042 [debug] [MainThread]: On master: BEGIN
[0m22:05:34.954417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:34.959441 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:34.959870 [debug] [MainThread]: On master: COMMIT
[0m22:05:34.960263 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:34.960647 [debug] [MainThread]: On master: COMMIT
[0m22:05:34.961156 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:34.961571 [debug] [MainThread]: On master: Close
[0m22:05:34.962971 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:34.963493 [info ] [MainThread]: 
[0m22:05:34.972104 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:34.972702 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:34.973365 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:34.973818 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:34.998912 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:34.999658 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:35.034908 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:35.035671 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:41.989683 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.990203 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:41.990893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.991372 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.991824 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:41.992518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.995218 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.995696 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:41.996391 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.016998 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:42.017489 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.017944 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:42.019203 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.023941 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.024431 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:42.026121 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.028454 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:42.054277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1041fd2570>]}
[0m22:05:42.055025 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.08s]
[0m22:05:42.055798 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:42.056774 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:42.057336 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:42.057899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:42.058359 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:42.063151 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:42.063796 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:42.097564 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.098106 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240706220542091338"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:42.098641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:42.114696 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.121606 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.122085 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:42.122703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.123166 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.123619 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240706220542091338'
      
      
      order by ordinal_position

  
[0m22:05:42.156178 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.161075 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.161571 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:42.170346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.178854 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.179352 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:42.188570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.206524 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:42.207229 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.207713 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240706220542091338"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240706220542091338"
    )
  
[0m22:05:42.222186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.223909 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:42.224375 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.224825 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:42.234301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.235214 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:42.425354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44f1fc7c-fcfe-47a0-ac85-e25d9d5b1684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f100d198530>]}
[0m22:05:42.426214 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m22:05:42.426999 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:42.428336 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:42.428822 [debug] [MainThread]: On master: BEGIN
[0m22:05:42.429269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:42.434719 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:42.435200 [debug] [MainThread]: On master: COMMIT
[0m22:05:42.435645 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:42.436081 [debug] [MainThread]: On master: COMMIT
[0m22:05:42.436726 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:42.437194 [debug] [MainThread]: On master: Close
[0m22:05:42.438652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:42.439102 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:42.439519 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:42.439991 [info ] [MainThread]: 
[0m22:05:42.440521 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.97 seconds (7.97s).
[0m22:05:42.441538 [debug] [MainThread]: Command end result
[0m22:05:42.469385 [info ] [MainThread]: 
[0m22:05:42.470006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:42.470539 [info ] [MainThread]: 
[0m22:05:42.471069 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:42.472058 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.888197, "process_user_time": 4.698295, "process_kernel_time": 0.317235, "process_mem_max_rss": "279424", "process_in_blocks": "1184", "process_out_blocks": "111136"}
[0m22:05:42.472711 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:42.472599 after 9.89 seconds
[0m22:05:42.473211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10406e3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104089f6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f100d24b320>]}
[0m22:05:42.473704 [debug] [MainThread]: Flushing usage events
[0m22:05:44.121029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88848d7170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8885eb1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8886f61f40>]}


============================== 22:05:44.123931 | 90cd82ad-4054-4545-a344-4b99bea01ced ==============================
[0m22:05:44.123931 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:44.124672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:05:44.266381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90cd82ad-4054-4545-a344-4b99bea01ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f888494a030>]}
[0m22:05:44.282854 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21048708, "process_user_time": 1.408753, "process_kernel_time": 0.128068, "process_mem_max_rss": "91984", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:44.283459 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:44.283348 after 0.21 seconds
[0m22:05:44.283910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f888490a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8885231820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8885262c00>]}
[0m22:05:44.284350 [debug] [MainThread]: Flushing usage events
[0m06:01:57.778367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d85e5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d82fe600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d82fe300>]}


============================== 06:01:57.785535 | 98215c8b-fe36-4a69-b7f9-9c4107f9eb68 ==============================
[0m06:01:57.785535 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:01:57.786237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:01:57.925809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98215c8b-fe36-4a69-b7f9-9c4107f9eb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d81bbbf0>]}
[0m06:01:57.939207 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-dtqi3adu'
[0m06:01:57.939685 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:01:58.038561 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:01:58.039197 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:01:58.062735 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:01:58.066655 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:01:58.140262 [info ] [MainThread]: Installed from version 1.2.0
[0m06:01:58.140776 [info ] [MainThread]: Up to date!
[0m06:01:58.141303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '98215c8b-fe36-4a69-b7f9-9c4107f9eb68', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d7ff0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d92894f0>]}
[0m06:01:58.142951 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41277158, "process_user_time": 1.539866, "process_kernel_time": 0.138905, "process_mem_max_rss": "93484", "process_in_blocks": "5752", "process_out_blocks": "3840"}
[0m06:01:58.143561 [debug] [MainThread]: Command `dbt deps` succeeded at 06:01:58.143455 after 0.41 seconds
[0m06:01:58.144017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d89bc2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d8396240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d83961b0>]}
[0m06:01:58.144453 [debug] [MainThread]: Flushing usage events
[0m06:01:59.725014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f93ba8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f93c1dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f93c1f230>]}


============================== 06:01:59.727774 | c0d39a50-9c87-4828-9bd7-2d71a5adf5a6 ==============================
[0m06:01:59.727774 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:01:59.728419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:01:59.951445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f93a5deb0>]}
[0m06:02:00.010863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f93abeed0>]}
[0m06:02:00.011776 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:00.027460 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:00.028211 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:00.028769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8d1e5040>]}
[0m06:02:01.235326 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:01.235984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8cf58770>]}
[0m06:02:01.425438 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:01.430414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8ce70ce0>]}
[0m06:02:01.551736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8ceb0290>]}
[0m06:02:01.552307 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:01.552811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8cc0a2a0>]}
[0m06:02:01.554536 [info ] [MainThread]: 
[0m06:02:01.555229 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:01.560000 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:01.594899 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:01.595349 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:01.595754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:02.009780 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:02.011381 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:02.013595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:02.014202 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:02.021076 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:02.021523 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:02.021924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:02.027285 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:02.028640 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:02.029055 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:02.029871 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:02.030323 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:02.030715 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:02.031333 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:02.032274 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:02.032681 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:02.033064 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:02.033602 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:02.034020 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:02.036264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:02.041560 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:02.041980 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:02.042400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:02.047218 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:02.047637 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:02.048040 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:02.067390 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:02.074080 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:02.075307 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:02.075725 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:02.079296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8cc08650>]}
[0m06:02:02.079848 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:02.080251 [debug] [MainThread]: On master: BEGIN
[0m06:02:02.080644 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:02.086034 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:02.086518 [debug] [MainThread]: On master: COMMIT
[0m06:02:02.086926 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:02.087315 [debug] [MainThread]: On master: COMMIT
[0m06:02:02.087951 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:02.088376 [debug] [MainThread]: On master: Close
[0m06:02:02.090182 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:02.090691 [info ] [MainThread]: 
[0m06:02:02.100374 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:02.100993 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:02.101651 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:02.102131 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:02.127887 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:02.128647 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:02.162911 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:02.163667 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:11.015089 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:11.015613 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:11.016258 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.016726 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:11.017176 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:11.017853 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.020583 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:11.021069 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:11.021754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.042331 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:11.042835 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:11.043287 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:11.045574 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.050392 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:11.050887 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:11.052352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.054767 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:11.080906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f604d3350>]}
[0m06:02:11.081713 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.98s]
[0m06:02:11.082540 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:11.083540 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:11.084111 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:11.084721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:11.085197 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:11.090240 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:11.090941 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:11.124476 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:11.124999 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240707060211118645"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:11.125491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:11.141601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.148549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:11.149034 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:11.149648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.150125 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:11.150589 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240707060211118645'
      
      
      order by ordinal_position

  
[0m06:02:11.176586 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.181630 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:11.182151 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:11.190448 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.199008 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:11.199520 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:11.207946 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.225882 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:11.226621 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:11.227107 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240707060211118645"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240707060211118645"
    )
  
[0m06:02:11.242846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.244691 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:11.245160 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:11.245616 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:11.257795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:11.259045 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:11.467188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0d39a50-9c87-4828-9bd7-2d71a5adf5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f60515400>]}
[0m06:02:11.468015 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m06:02:11.468868 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:11.470390 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:11.470865 [debug] [MainThread]: On master: BEGIN
[0m06:02:11.471299 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:11.476583 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:11.477062 [debug] [MainThread]: On master: COMMIT
[0m06:02:11.477502 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:11.477941 [debug] [MainThread]: On master: COMMIT
[0m06:02:11.478679 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:11.479144 [debug] [MainThread]: On master: Close
[0m06:02:11.480517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:11.480963 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:11.481380 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:11.481846 [info ] [MainThread]: 
[0m06:02:11.482450 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.93 seconds (9.93s).
[0m06:02:11.483490 [debug] [MainThread]: Command end result
[0m06:02:11.513228 [info ] [MainThread]: 
[0m06:02:11.513930 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:11.514574 [info ] [MainThread]: 
[0m06:02:11.515190 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:11.516262 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.839974, "process_user_time": 4.882793, "process_kernel_time": 0.324451, "process_mem_max_rss": "291032", "process_in_blocks": "1184", "process_out_blocks": "109056"}
[0m06:02:11.516923 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:11.516811 after 11.84 seconds
[0m06:02:11.517423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f93f731a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f93bcfb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8ceb2c00>]}
[0m06:02:11.517918 [debug] [MainThread]: Flushing usage events
[0m06:02:13.168552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023d6f1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023bda1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023bf5a330>]}


============================== 06:02:13.171367 | 06ee74cb-3712-405c-b51a-a9cba1c383d3 ==============================
[0m06:02:13.171367 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:13.172027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.312992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06ee74cb-3712-405c-b51a-a9cba1c383d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023c7dc5c0>]}
[0m06:02:13.329592 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20961884, "process_user_time": 1.409637, "process_kernel_time": 0.095839, "process_mem_max_rss": "92096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:13.330224 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:13.330086 after 0.21 seconds
[0m06:02:13.330675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023c03e5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023bb9b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023bbff0b0>]}
[0m06:02:13.331125 [debug] [MainThread]: Flushing usage events
[0m14:04:30.740608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26ded2fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26dfe61910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26debca000>]}


============================== 14:04:30.761187 | 98bc3c35-543d-45aa-a772-865ea2560327 ==============================
[0m14:04:30.761187 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:30.761842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:30.907436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98bc3c35-543d-45aa-a772-865ea2560327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26de21d640>]}
[0m14:04:30.920882 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ag97hule'
[0m14:04:30.921343 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:30.966332 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:30.967033 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:30.979698 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:30.983408 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:31.124132 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:31.124754 [info ] [MainThread]: Up to date!
[0m14:04:31.125317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '98bc3c35-543d-45aa-a772-865ea2560327', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26de3fe990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26de0c1040>]}
[0m14:04:31.127178 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43434957, "process_user_time": 1.541247, "process_kernel_time": 0.152917, "process_mem_max_rss": "93452", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m14:04:31.127783 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:31.127677 after 0.44 seconds
[0m14:04:31.128291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e1dbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26df4a2f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26de1401a0>]}
[0m14:04:31.128732 [debug] [MainThread]: Flushing usage events
[0m14:04:32.743295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3bababd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3bab8ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3bab8d10>]}


============================== 14:04:32.746147 | a75cf497-4bbf-42a6-bc21-190069e46385 ==============================
[0m14:04:32.746147 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:32.746880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:32.983057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3d2273b0>]}
[0m14:04:33.042409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3b96e300>]}
[0m14:04:33.043288 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:33.094550 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:33.095344 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:33.095888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3b927f20>]}
[0m14:04:34.303986 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:34.304680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3c3e8fb0>]}
[0m14:04:34.498485 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:34.503772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb348192e0>]}
[0m14:04:34.670603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3455be90>]}
[0m14:04:34.671192 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:34.671727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb34585d90>]}
[0m14:04:34.673535 [info ] [MainThread]: 
[0m14:04:34.674275 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:34.679154 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:34.714162 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:34.714623 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:34.715033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:35.401401 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:35.403000 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:35.405338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:35.405928 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:35.412800 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:35.413251 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:35.413665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:35.419438 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:35.420825 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:35.421248 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:35.422104 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:35.422521 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:35.422919 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:35.423541 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:35.424528 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:35.424944 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:35.425331 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:35.425860 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:35.426283 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:35.428528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:35.433928 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:35.434370 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:35.434760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:35.439818 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:35.440285 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:35.440701 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:35.460659 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:35.465464 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:35.466680 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:35.467106 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:35.470972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3b915700>]}
[0m14:04:35.471506 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:35.471910 [debug] [MainThread]: On master: BEGIN
[0m14:04:35.472350 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:35.477631 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:35.478068 [debug] [MainThread]: On master: COMMIT
[0m14:04:35.478468 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:35.478857 [debug] [MainThread]: On master: COMMIT
[0m14:04:35.479365 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:35.479782 [debug] [MainThread]: On master: Close
[0m14:04:35.481556 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:35.482074 [info ] [MainThread]: 
[0m14:04:35.496076 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:35.496715 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:35.497397 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:35.497853 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:35.523544 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:35.524386 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:35.558559 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:35.559380 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:44.627177 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:44.627704 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:04:44.628347 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.628813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:44.629263 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:04:44.629942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.632623 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:44.633089 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:04:44.633922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.654132 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:44.654611 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:44.655052 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:44.657491 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.662172 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:44.662656 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:04:44.664578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.666888 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:04:44.693086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb309c2e10>]}
[0m14:04:44.693843 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.19s]
[0m14:04:44.694642 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:04:44.695679 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:04:44.696310 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:04:44.696935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:04:44.697403 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:04:44.702312 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:04:44.702992 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:04:44.736290 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:44.736816 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240707140444730468"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:04:44.737306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:44.752220 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.759404 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:44.759891 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:04:44.760538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.760997 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:44.761438 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240707140444730468'
      
      
      order by ordinal_position

  
[0m14:04:44.787434 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.792467 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:44.792958 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:44.806972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.815690 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:44.816230 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:44.825294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.842875 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:04:44.843587 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:44.844105 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240707140444730468"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240707140444730468"
    )
  
[0m14:04:44.859355 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.861264 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:44.861747 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:44.862207 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:44.872064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:44.872986 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:04:45.040624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a75cf497-4bbf-42a6-bc21-190069e46385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb08396720>]}
[0m14:04:45.041477 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m14:04:45.042272 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:04:45.043717 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:45.044274 [debug] [MainThread]: On master: BEGIN
[0m14:04:45.044743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:45.050133 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:45.050624 [debug] [MainThread]: On master: COMMIT
[0m14:04:45.051075 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:45.051515 [debug] [MainThread]: On master: COMMIT
[0m14:04:45.052240 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:45.052713 [debug] [MainThread]: On master: Close
[0m14:04:45.054556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:45.055004 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:04:45.055426 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:04:45.055924 [info ] [MainThread]: 
[0m14:04:45.056536 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.38 seconds (10.38s).
[0m14:04:45.057614 [debug] [MainThread]: Command end result
[0m14:04:45.085970 [info ] [MainThread]: 
[0m14:04:45.086616 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:45.087167 [info ] [MainThread]: 
[0m14:04:45.087735 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:45.088797 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.39346, "process_user_time": 4.788215, "process_kernel_time": 0.275782, "process_mem_max_rss": "271340", "process_in_blocks": "1184", "process_out_blocks": "109568"}
[0m14:04:45.089449 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:45.089338 after 12.39 seconds
[0m14:04:45.089950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb3bfd3a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb181eab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb083bce90>]}
[0m14:04:45.090441 [debug] [MainThread]: Flushing usage events
[0m14:04:46.813686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc375d74860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc375e9f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc375c49790>]}


============================== 14:04:46.816468 | 678cf81a-7506-419d-ad44-d24a81b75c17 ==============================
[0m14:04:46.816468 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:46.817149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:04:46.961553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '678cf81a-7506-419d-ad44-d24a81b75c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37587ffb0>]}
[0m14:04:46.977970 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21309517, "process_user_time": 1.417512, "process_kernel_time": 0.092359, "process_mem_max_rss": "92364", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:04:46.978567 [debug] [MainThread]: Command `dbt clean` succeeded at 14:04:46.978461 after 0.21 seconds
[0m14:04:46.979014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc377e21610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc376b5ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37718f6e0>]}
[0m14:04:46.979470 [debug] [MainThread]: Flushing usage events
[0m22:05:13.359088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ebd2a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ec512a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ec13e240>]}


============================== 22:05:13.366070 | 1f5dbaad-9387-45bf-bdb0-65100214eb08 ==============================
[0m22:05:13.366070 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:13.366824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:13.510794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f5dbaad-9387-45bf-bdb0-65100214eb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ebd27bc0>]}
[0m22:05:13.523931 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jh09s47w'
[0m22:05:13.524397 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:13.597527 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:13.598166 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:13.622632 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:13.626402 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:13.697386 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:13.697885 [info ] [MainThread]: Up to date!
[0m22:05:13.698419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1f5dbaad-9387-45bf-bdb0-65100214eb08', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ec512a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3eba833e0>]}
[0m22:05:13.699805 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38946906, "process_user_time": 1.572785, "process_kernel_time": 0.123747, "process_mem_max_rss": "93368", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m22:05:13.700401 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:13.700296 after 0.39 seconds
[0m22:05:13.700837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ec1c5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ec152c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ebd27bc0>]}
[0m22:05:13.701265 [debug] [MainThread]: Flushing usage events
[0m22:05:15.272709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c86db3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c86db1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c86db2cc0>]}


============================== 22:05:15.275437 | 7d7f8fba-18c6-4006-be6d-da807cc28b48 ==============================
[0m22:05:15.275437 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:15.276174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:15.499612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7f928440>]}
[0m22:05:15.558642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c863002f0>]}
[0m22:05:15.559436 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:15.574781 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:15.575495 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:15.576050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c86244e60>]}
[0m22:05:16.786542 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:16.787232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c862a0050>]}
[0m22:05:16.976079 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:16.981318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7f450bf0>]}
[0m22:05:17.103032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7f49d0d0>]}
[0m22:05:17.103596 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:17.104131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7f5a1280>]}
[0m22:05:17.105898 [info ] [MainThread]: 
[0m22:05:17.106650 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:17.111404 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:17.145764 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:17.146213 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:17.146621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:17.669975 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:17.671567 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:17.673833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:17.674415 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:17.681317 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:17.681767 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:17.682173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:17.687878 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:17.689208 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:17.689625 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:17.690490 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:17.690958 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:17.691355 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:17.691986 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:17.692922 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:17.693333 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:17.693736 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:17.694280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:17.694727 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:17.696831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:17.702136 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:17.702562 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:17.702987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:17.708019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:17.708443 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:17.708859 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:17.728937 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:17.733631 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:17.734827 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:17.735323 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:17.738981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c873132f0>]}
[0m22:05:17.739508 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:17.739917 [debug] [MainThread]: On master: BEGIN
[0m22:05:17.740306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:17.745665 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:17.746115 [debug] [MainThread]: On master: COMMIT
[0m22:05:17.746521 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:17.746962 [debug] [MainThread]: On master: COMMIT
[0m22:05:17.747575 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:17.748002 [debug] [MainThread]: On master: Close
[0m22:05:17.749469 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:17.749983 [info ] [MainThread]: 
[0m22:05:17.758937 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:17.759537 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:17.760200 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:17.760644 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:17.786402 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:17.787181 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:17.821568 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:17.822304 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:25.325399 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.325921 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:25.326551 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.327052 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.327502 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:25.328189 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.330890 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.331374 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:25.332063 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.352496 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:25.352985 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.353436 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:25.354621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.359389 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:25.359878 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:25.361087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.363420 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:25.390357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4eccf500>]}
[0m22:05:25.391121 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.63s]
[0m22:05:25.391889 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:25.392845 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:25.393417 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:25.393986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:25.394451 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:25.399357 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:25.400008 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:25.433349 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.433875 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240707220525427422"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:25.434357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:25.450127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.456980 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.457454 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:25.458046 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.458512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.458994 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240707220525427422'
      
      
      order by ordinal_position

  
[0m22:05:25.491034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.495917 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.496469 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:25.505026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.513395 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.513901 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:25.522562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.540405 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:25.541082 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.541559 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240707220525427422"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240707220525427422"
    )
  
[0m22:05:25.556679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.558431 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:25.558966 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:25.559409 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:25.569067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:25.569955 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:25.743518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d7f8fba-18c6-4006-be6d-da807cc28b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4ec86090>]}
[0m22:05:25.744344 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m22:05:25.745111 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:25.746501 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:25.747027 [debug] [MainThread]: On master: BEGIN
[0m22:05:25.747476 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:25.752740 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:25.753224 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.753674 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:25.754118 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.754669 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:25.755165 [debug] [MainThread]: On master: Close
[0m22:05:25.756713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:25.757158 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:25.757586 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:25.758056 [info ] [MainThread]: 
[0m22:05:25.758598 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.65 seconds (8.65s).
[0m22:05:25.759717 [debug] [MainThread]: Command end result
[0m22:05:25.788106 [info ] [MainThread]: 
[0m22:05:25.788758 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:25.789284 [info ] [MainThread]: 
[0m22:05:25.789827 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:25.790858 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.566594, "process_user_time": 4.771006, "process_kernel_time": 0.281593, "process_mem_max_rss": "294400", "process_in_blocks": "1184", "process_out_blocks": "109600"}
[0m22:05:25.791517 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:25.791407 after 10.57 seconds
[0m22:05:25.792019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c89dbbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c863f0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c86894c80>]}
[0m22:05:25.792512 [debug] [MainThread]: Flushing usage events
[0m22:05:27.429338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcd6637d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcf065b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcf91d730>]}


============================== 22:05:27.432077 | 166f47f0-c022-4dfc-a985-d25e7d8f0242 ==============================
[0m22:05:27.432077 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:27.432806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:05:27.575134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '166f47f0-c022-4dfc-a985-d25e7d8f0242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcd537d70>]}
[0m22:05:27.591636 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21132627, "process_user_time": 1.420173, "process_kernel_time": 0.091752, "process_mem_max_rss": "91836", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:27.592215 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:27.592109 after 0.21 seconds
[0m22:05:27.592666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcd747140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcd552c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcea266f0>]}
[0m22:05:27.593113 [debug] [MainThread]: Flushing usage events
[0m06:02:19.097336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29059a6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2905b37f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29057a5190>]}


============================== 06:02:19.125443 | f4ba2c50-7859-4bf3-b0ec-6d01f2266d8c ==============================
[0m06:02:19.125443 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:19.126155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:19.277742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4ba2c50-7859-4bf3-b0ec-6d01f2266d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29057fc920>]}
[0m06:02:19.291699 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-w6m1lsjc'
[0m06:02:19.292197 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:19.351677 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:19.352438 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:19.364790 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:19.368661 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:19.503462 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:19.504116 [info ] [MainThread]: Up to date!
[0m06:02:19.504771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f4ba2c50-7859-4bf3-b0ec-6d01f2266d8c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29063f3200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f290570b1a0>]}
[0m06:02:19.506654 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45810413, "process_user_time": 1.611276, "process_kernel_time": 0.132268, "process_mem_max_rss": "93516", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m06:02:19.507274 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:19.507164 after 0.46 seconds
[0m06:02:19.507723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2905b37f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2905ad2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2905730410>]}
[0m06:02:19.508170 [debug] [MainThread]: Flushing usage events
[0m06:02:21.167780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd870fc1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8744f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd874a38c0>]}


============================== 06:02:21.170822 | e63b5757-0d88-4d2a-b457-7c21100ee448 ==============================
[0m06:02:21.170822 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:21.171513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:21.410700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e63b5757-0d88-4d2a-b457-7c21100ee448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd86fb3890>]}
[0m06:02:21.471402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e63b5757-0d88-4d2a-b457-7c21100ee448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd881ffbc0>]}
[0m06:02:21.472312 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:21.514043 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:21.514825 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:21.515371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e63b5757-0d88-4d2a-b457-7c21100ee448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd87542e10>]}
[0m06:02:22.726893 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:22.727637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e63b5757-0d88-4d2a-b457-7c21100ee448', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd86f42f90>]}
[0m06:02:22.922339 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:22.927667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e63b5757-0d88-4d2a-b457-7c21100ee448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd80540770>]}
[0m06:02:23.064099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e63b5757-0d88-4d2a-b457-7c21100ee448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd80293e30>]}
[0m06:02:23.064714 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:23.065330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e63b5757-0d88-4d2a-b457-7c21100ee448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd80153ec0>]}
[0m06:02:23.067150 [info ] [MainThread]: 
[0m06:02:23.067918 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:23.072884 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:23.108809 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:23.109453 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:23.109868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:23.814426 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:23.816004 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:23.818313 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:23.818883 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:23.825660 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:23.826118 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:23.826521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:23.832304 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.833747 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:23.834167 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:23.834703 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.835106 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:23.835492 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:23.836055 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.836984 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:23.837417 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:23.837805 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:23.838344 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.838760 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:23.841014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:23.846472 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:23.846898 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:23.847285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:23.852514 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.852944 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:23.853399 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:23.873603 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.878754 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:23.880009 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:23.880432 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:23.884109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e63b5757-0d88-4d2a-b457-7c21100ee448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd80152ed0>]}
[0m06:02:23.884647 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.885089 [debug] [MainThread]: On master: BEGIN
[0m06:02:23.885485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:23.890824 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.891280 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.891681 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.892067 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.892868 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.893322 [debug] [MainThread]: On master: Close
[0m06:02:23.894958 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:23.895473 [info ] [MainThread]: 
[0m06:02:23.906036 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:23.906664 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:23.907332 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:23.907778 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:23.933310 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:23.934130 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:23.968361 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:23.969251 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:33.000879 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:33.001477 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:33.002451 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.002914 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:33.003362 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:33.004315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.007148 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:33.007619 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:33.008335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.029095 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:33.029615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:33.030065 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:33.031701 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.036581 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:33.037094 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:33.038680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.041106 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:33.068473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e63b5757-0d88-4d2a-b457-7c21100ee448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd4fa21400>]}
[0m06:02:33.069341 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.16s]
[0m06:02:33.070234 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:33.071257 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:33.071838 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:33.072429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:33.072891 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:33.077988 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:33.078647 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:33.111952 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.112537 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240708060233106058"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:33.113046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:33.129718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.137264 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.137760 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:33.138400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.138856 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.139311 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240708060233106058'
      
      
      order by ordinal_position

  
[0m06:02:33.165892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.171431 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.171939 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:33.181377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.190448 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.190947 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:33.199797 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.217878 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:33.218627 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.219106 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240708060233106058"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240708060233106058"
    )
  
[0m06:02:33.236534 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.238487 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:33.238957 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:33.239397 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:33.249156 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:33.250116 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:33.433142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e63b5757-0d88-4d2a-b457-7c21100ee448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd4faf87d0>]}
[0m06:02:33.433983 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m06:02:33.434742 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:33.436091 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:33.436592 [debug] [MainThread]: On master: BEGIN
[0m06:02:33.437071 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:33.442663 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:33.443354 [debug] [MainThread]: On master: COMMIT
[0m06:02:33.443815 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:33.444253 [debug] [MainThread]: On master: COMMIT
[0m06:02:33.444916 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:33.445423 [debug] [MainThread]: On master: Close
[0m06:02:33.447093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:33.447535 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:33.447947 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:33.448428 [info ] [MainThread]: 
[0m06:02:33.449074 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.38 seconds (10.38s).
[0m06:02:33.450221 [debug] [MainThread]: Command end result
[0m06:02:33.478231 [info ] [MainThread]: 
[0m06:02:33.478989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:33.479598 [info ] [MainThread]: 
[0m06:02:33.480205 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:33.481338 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.363045, "process_user_time": 4.851247, "process_kernel_time": 0.316734, "process_mem_max_rss": "270372", "process_in_blocks": "1184", "process_out_blocks": "110112"}
[0m06:02:33.481993 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:33.481882 after 12.36 seconds
[0m06:02:33.482500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8744f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd55bd0d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd4fa31fd0>]}
[0m06:02:33.482993 [debug] [MainThread]: Flushing usage events
[0m06:02:35.245867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9010802060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90128cab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9010c7dd00>]}


============================== 06:02:35.248849 | 818cd7f2-a0b3-4c1c-872c-b7d0463b72bd ==============================
[0m06:02:35.248849 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:35.249645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:35.399446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '818cd7f2-a0b3-4c1c-872c-b7d0463b72bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901009b050>]}
[0m06:02:35.416340 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21974096, "process_user_time": 1.444204, "process_kernel_time": 0.108315, "process_mem_max_rss": "92196", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:35.416952 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:35.416843 after 0.22 seconds
[0m06:02:35.417476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90102bb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9010227920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901100a4b0>]}
[0m06:02:35.417922 [debug] [MainThread]: Flushing usage events
[0m14:05:02.272340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff51df71c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff51c5c7740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff51ce3e390>]}


============================== 14:05:02.279944 | eae9c4ce-d59c-4141-ac2e-c74055b1412f ==============================
[0m14:05:02.279944 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:02.280655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:02.432955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eae9c4ce-d59c-4141-ac2e-c74055b1412f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff51c383050>]}
[0m14:05:02.446887 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9igyleft'
[0m14:05:02.447385 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:02.569818 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:02.570605 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:02.637361 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:02.641537 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:02.777752 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:02.778366 [info ] [MainThread]: Up to date!
[0m14:05:02.778941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'eae9c4ce-d59c-4141-ac2e-c74055b1412f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff51c22bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff51c22be60>]}
[0m14:05:02.780820 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.55726033, "process_user_time": 1.656103, "process_kernel_time": 0.088218, "process_mem_max_rss": "93352", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m14:05:02.781461 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:02.781352 after 0.56 seconds
[0m14:05:02.781912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff51d2ea000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff51c8b54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff51c5c6240>]}
[0m14:05:02.782437 [debug] [MainThread]: Flushing usage events
[0m14:05:04.460871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac450a8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac46c70980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac4617b830>]}


============================== 14:05:04.463779 | 5fe7d2c4-6488-457b-ac5e-52c26c10bad6 ==============================
[0m14:05:04.463779 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:04.464472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:04.699875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fe7d2c4-6488-457b-ac5e-52c26c10bad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac467d31d0>]}
[0m14:05:04.767174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fe7d2c4-6488-457b-ac5e-52c26c10bad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac46634e00>]}
[0m14:05:04.768055 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:04.783880 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:04.784606 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:04.785178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5fe7d2c4-6488-457b-ac5e-52c26c10bad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac44db08f0>]}
[0m14:05:05.990109 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:05.990843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5fe7d2c4-6488-457b-ac5e-52c26c10bad6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3e4872f0>]}
[0m14:05:06.181450 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:06.186549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fe7d2c4-6488-457b-ac5e-52c26c10bad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3e150200>]}
[0m14:05:06.318172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fe7d2c4-6488-457b-ac5e-52c26c10bad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3e203650>]}
[0m14:05:06.318746 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:06.319253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fe7d2c4-6488-457b-ac5e-52c26c10bad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac44eff3e0>]}
[0m14:05:06.320925 [info ] [MainThread]: 
[0m14:05:06.321673 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:06.326452 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:06.362076 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:06.362621 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:06.363038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:07.082104 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:07.083697 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:07.086136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:07.086744 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:07.093642 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:07.094092 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:07.094497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:07.100763 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.102212 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:07.102629 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:07.103442 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.103852 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:07.104244 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:07.104882 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.105866 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:07.106283 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:07.106677 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:07.107217 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.107643 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:07.109821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:07.115368 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:07.115815 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:07.116203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:07.121439 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.121869 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:07.122281 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:07.142683 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.147540 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:07.148752 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:07.149211 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:07.153452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fe7d2c4-6488-457b-ac5e-52c26c10bad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3e1507a0>]}
[0m14:05:07.153997 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:07.154409 [debug] [MainThread]: On master: BEGIN
[0m14:05:07.154797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:07.160118 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:07.160566 [debug] [MainThread]: On master: COMMIT
[0m14:05:07.160978 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:07.161412 [debug] [MainThread]: On master: COMMIT
[0m14:05:07.162062 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:07.162488 [debug] [MainThread]: On master: Close
[0m14:05:07.164027 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:07.164539 [info ] [MainThread]: 
[0m14:05:07.173577 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:07.174200 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:07.174891 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:07.175340 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:07.201260 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:07.202105 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:07.236587 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:07.237501 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:15.914494 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:15.915039 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:15.915689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:15.916162 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:15.916615 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:15.917342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:15.920081 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:15.920558 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:15.921459 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:15.941947 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:15.942448 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:15.942911 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:15.944800 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:15.949643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:15.950132 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:15.951608 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:15.954024 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:15.980143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe7d2c4-6488-457b-ac5e-52c26c10bad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac11fd7530>]}
[0m14:05:15.980917 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.80s]
[0m14:05:15.981838 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:15.982840 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:15.983415 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:15.984102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:15.984573 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:15.989669 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:15.990346 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:16.023977 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.024587 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240708140516018002"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:16.025117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:16.040027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.047500 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.048003 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:16.048629 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.049119 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.049583 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240708140516018002'
      
      
      order by ordinal_position

  
[0m14:05:16.076503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.082297 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.082842 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:16.091760 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.101121 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.101667 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:16.116578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.135246 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:16.136048 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.136554 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240708140516018002"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240708140516018002"
    )
  
[0m14:05:16.152377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.154507 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:16.155018 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.155471 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:16.165385 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.166343 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:16.357834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe7d2c4-6488-457b-ac5e-52c26c10bad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac11a41520>]}
[0m14:05:16.358736 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m14:05:16.359701 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:16.361296 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:16.361793 [debug] [MainThread]: On master: BEGIN
[0m14:05:16.362229 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:16.367783 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:16.368291 [debug] [MainThread]: On master: COMMIT
[0m14:05:16.368732 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:16.369223 [debug] [MainThread]: On master: COMMIT
[0m14:05:16.369912 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:16.370385 [debug] [MainThread]: On master: Close
[0m14:05:16.372133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:16.372584 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:16.373050 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:16.373562 [info ] [MainThread]: 
[0m14:05:16.374124 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.05 seconds (10.05s).
[0m14:05:16.375170 [debug] [MainThread]: Command end result
[0m14:05:16.403823 [info ] [MainThread]: 
[0m14:05:16.404512 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:16.405071 [info ] [MainThread]: 
[0m14:05:16.405619 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:16.406659 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.994773, "process_user_time": 4.790808, "process_kernel_time": 0.361418, "process_mem_max_rss": "288712", "process_in_blocks": "1184", "process_out_blocks": "111088"}
[0m14:05:16.407316 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:16.407203 after 12.00 seconds
[0m14:05:16.407827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac46c70980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1273aab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac119f6ea0>]}
[0m14:05:16.408330 [debug] [MainThread]: Flushing usage events
[0m14:05:18.225639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd64895d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd647346300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6479e9340>]}


============================== 14:05:18.228648 | 4ac93c8d-2394-4a54-80e0-42b6d069c712 ==============================
[0m14:05:18.228648 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:18.229352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:18.380373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ac93c8d-2394-4a54-80e0-42b6d069c712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd646b97ec0>]}
[0m14:05:18.397575 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22135971, "process_user_time": 1.443365, "process_kernel_time": 0.115948, "process_mem_max_rss": "92212", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:18.398192 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:18.398084 after 0.22 seconds
[0m14:05:18.398654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd648063e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6478b2330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd646e68b30>]}
[0m14:05:18.399105 [debug] [MainThread]: Flushing usage events
[0m22:05:52.423468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2dc861e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2fe353a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2e0387a0>]}


============================== 22:05:52.484454 | 89ec69db-28ac-4d51-9a2f-86579dd2bb30 ==============================
[0m22:05:52.484454 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:52.485153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:52.633225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89ec69db-28ac-4d51-9a2f-86579dd2bb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2e039b20>]}
[0m22:05:52.646990 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-27cqn_47'
[0m22:05:52.647510 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:52.728339 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:52.729077 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:52.739559 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:52.743391 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:52.792957 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:52.793609 [info ] [MainThread]: Up to date!
[0m22:05:52.794254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '89ec69db-28ac-4d51-9a2f-86579dd2bb30', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2da82990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2d814740>]}
[0m22:05:52.795860 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.420598, "process_user_time": 1.550444, "process_kernel_time": 0.172271, "process_mem_max_rss": "93448", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m22:05:52.796482 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:52.796370 after 0.42 seconds
[0m22:05:52.796941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2fe353a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2dc861e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2e039b20>]}
[0m22:05:52.797388 [debug] [MainThread]: Flushing usage events
[0m22:05:54.470814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dc8362e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dc7e2b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dcaf883b0>]}


============================== 22:05:54.473788 | 29eb938f-e5ed-460a-beeb-58c8d8766ba9 ==============================
[0m22:05:54.473788 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:54.474461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:54.713783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29eb938f-e5ed-460a-beeb-58c8d8766ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dc7e47ec0>]}
[0m22:05:54.773635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29eb938f-e5ed-460a-beeb-58c8d8766ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dc8fc7770>]}
[0m22:05:54.774545 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:54.790915 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:54.791755 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:54.792333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '29eb938f-e5ed-460a-beeb-58c8d8766ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dc0f78e30>]}
[0m22:05:56.006273 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:56.007095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '29eb938f-e5ed-460a-beeb-58c8d8766ba9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dc0b493a0>]}
[0m22:05:56.203820 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:56.209030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29eb938f-e5ed-460a-beeb-58c8d8766ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dc0abbf80>]}
[0m22:05:56.421170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29eb938f-e5ed-460a-beeb-58c8d8766ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dc0ce4560>]}
[0m22:05:56.421786 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:56.422311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29eb938f-e5ed-460a-beeb-58c8d8766ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dc0ba4890>]}
[0m22:05:56.424106 [info ] [MainThread]: 
[0m22:05:56.424805 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:56.429747 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:56.465821 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:56.466356 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:56.466771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:56.987771 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:56.989348 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:56.991650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:56.992217 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:56.998981 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:56.999461 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:56.999868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:57.005410 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.006757 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:57.007218 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:57.008083 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.008493 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:57.008886 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:57.009464 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.010394 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:57.010803 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:57.011244 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:57.011774 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.012197 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:57.014196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:57.019625 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:57.020052 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:57.020442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:57.025794 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.026244 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:57.026655 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:57.046832 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.051762 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:57.052983 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:57.053413 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:57.056990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29eb938f-e5ed-460a-beeb-58c8d8766ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dc0cf9490>]}
[0m22:05:57.057528 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:57.057931 [debug] [MainThread]: On master: BEGIN
[0m22:05:57.058320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:57.063734 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:57.064170 [debug] [MainThread]: On master: COMMIT
[0m22:05:57.064566 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:57.064956 [debug] [MainThread]: On master: COMMIT
[0m22:05:57.065585 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:57.066011 [debug] [MainThread]: On master: Close
[0m22:05:57.067684 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:57.068183 [info ] [MainThread]: 
[0m22:05:57.077771 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:57.078412 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:57.079161 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:57.079649 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:57.105398 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:57.106247 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:57.140355 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:57.141165 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:04.982171 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:04.982716 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:04.983423 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:04.983880 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:04.984322 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:04.985208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:04.987986 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:04.988462 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:04.989164 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:05.009681 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:05.010189 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:05.010652 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:05.011776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:05.016560 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:05.017045 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:05.018393 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:05.020782 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:05.046966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29eb938f-e5ed-460a-beeb-58c8d8766ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dc90c68d0>]}
[0m22:06:05.047781 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.97s]
[0m22:06:05.048569 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:05.049554 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:05.050127 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:05.050713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:05.051214 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:05.056400 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:05.057083 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:05.091630 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:05.092265 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240708220605085536"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:05.092784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:05.110070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:05.117746 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:05.118255 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:05.118892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:05.119407 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:05.119861 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240708220605085536'
      
      
      order by ordinal_position

  
[0m22:06:05.147133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:05.152601 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:05.153119 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:05.161675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:05.170824 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:05.171357 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:05.180076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:05.198154 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:05.198897 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:05.199429 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240708220605085536"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240708220605085536"
    )
  
[0m22:06:05.217460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:05.219590 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:05.220111 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:05.220568 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:05.234009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:05.235003 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:05.435819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29eb938f-e5ed-460a-beeb-58c8d8766ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d94252210>]}
[0m22:06:05.436699 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m22:06:05.437503 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:05.438977 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:05.439499 [debug] [MainThread]: On master: BEGIN
[0m22:06:05.439941 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:05.445632 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:05.446117 [debug] [MainThread]: On master: COMMIT
[0m22:06:05.446556 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:05.446982 [debug] [MainThread]: On master: COMMIT
[0m22:06:05.447718 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:05.448180 [debug] [MainThread]: On master: Close
[0m22:06:05.449927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:05.450370 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:05.450784 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:05.451310 [info ] [MainThread]: 
[0m22:06:05.451912 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.03 seconds (9.03s).
[0m22:06:05.453039 [debug] [MainThread]: Command end result
[0m22:06:05.480790 [info ] [MainThread]: 
[0m22:06:05.481505 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:05.482135 [info ] [MainThread]: 
[0m22:06:05.482736 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:05.483856 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.062019, "process_user_time": 4.88019, "process_kernel_time": 0.316012, "process_mem_max_rss": "276800", "process_in_blocks": "1184", "process_out_blocks": "111112"}
[0m22:06:05.484496 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:05.484388 after 11.06 seconds
[0m22:06:05.484993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dc81e0b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da41a0c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dc0c52b10>]}
[0m22:06:05.485483 [debug] [MainThread]: Flushing usage events
[0m22:06:07.249757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ecf3238f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ecf86cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ecfa8c830>]}


============================== 22:06:07.252851 | 3d60d18f-0ecb-413b-a8d2-5037e71b3434 ==============================
[0m22:06:07.252851 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:07.253561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:07.411988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d60d18f-0ecb-413b-a8d2-5037e71b3434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ecf842c00>]}
[0m22:06:07.428965 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22902857, "process_user_time": 1.488123, "process_kernel_time": 0.119688, "process_mem_max_rss": "92104", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:07.429588 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:07.429479 after 0.23 seconds
[0m22:06:07.430062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ecf6c3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed05df1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ecef309b0>]}
[0m22:06:07.430529 [debug] [MainThread]: Flushing usage events
[0m06:02:05.788779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c8f8a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c93db110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c9511cd0>]}


============================== 06:02:05.796005 | 17ff44f2-1ed4-4bb3-bd07-1e07522ea58a ==============================
[0m06:02:05.796005 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:05.796737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:05.938703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17ff44f2-1ed4-4bb3-bd07-1e07522ea58a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c8deb050>]}
[0m06:02:05.952118 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8_stpc6a'
[0m06:02:05.952581 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:05.987598 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:05.988483 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:06.001411 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:06.007287 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:06.213621 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:06.214187 [info ] [MainThread]: Up to date!
[0m06:02:06.214703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '17ff44f2-1ed4-4bb3-bd07-1e07522ea58a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c8eefc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c8eefe30>]}
[0m06:02:06.216258 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47507796, "process_user_time": 1.574513, "process_kernel_time": 0.121116, "process_mem_max_rss": "93452", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m06:02:06.216856 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:06.216753 after 0.48 seconds
[0m06:02:06.217318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46cb4f7c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c93b2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c942ae10>]}
[0m06:02:06.217754 [debug] [MainThread]: Flushing usage events
[0m06:02:08.093445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af401af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af3ebe480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af401ade0>]}


============================== 06:02:08.096340 | d6c44d14-51b4-4f3f-a1c7-35123750cf87 ==============================
[0m06:02:08.096340 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:08.097077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:08.325454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6c44d14-51b4-4f3f-a1c7-35123750cf87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aecb74e90>]}
[0m06:02:08.383927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6c44d14-51b4-4f3f-a1c7-35123750cf87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af37b15b0>]}
[0m06:02:08.384755 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:08.400175 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:08.400901 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:08.401447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd6c44d14-51b4-4f3f-a1c7-35123750cf87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af3706630>]}
[0m06:02:09.604421 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:09.605119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd6c44d14-51b4-4f3f-a1c7-35123750cf87', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aeca7d940>]}
[0m06:02:09.795894 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:09.801061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6c44d14-51b4-4f3f-a1c7-35123750cf87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aec650bf0>]}
[0m06:02:09.921137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6c44d14-51b4-4f3f-a1c7-35123750cf87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aec6877a0>]}
[0m06:02:09.921694 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:09.922200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6c44d14-51b4-4f3f-a1c7-35123750cf87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aec64f710>]}
[0m06:02:09.923927 [info ] [MainThread]: 
[0m06:02:09.924649 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:09.929378 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:09.963796 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:09.964251 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:09.964656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:10.336525 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.338076 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:10.340333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:10.340933 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:10.347846 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.348293 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:10.348742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.354315 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.355686 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.356150 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:10.356802 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.357213 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.357602 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:10.358175 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.359101 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.359508 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.359940 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.360574 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.361003 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:10.363062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:10.368343 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.368764 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:10.369148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.374096 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.374514 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.374917 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:10.394355 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.399002 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:10.400179 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:10.400598 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:10.403690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6c44d14-51b4-4f3f-a1c7-35123750cf87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aec717980>]}
[0m06:02:10.404250 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.404649 [debug] [MainThread]: On master: BEGIN
[0m06:02:10.405023 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:10.410033 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.410459 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.410857 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.411235 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.411877 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.412293 [debug] [MainThread]: On master: Close
[0m06:02:10.413706 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:10.414223 [info ] [MainThread]: 
[0m06:02:10.423169 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:10.423799 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:10.424458 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:10.424902 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:10.450144 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:10.450909 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:10.484935 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:10.485687 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:23.590358 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.590884 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:23.591521 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.592030 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.592486 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:23.593156 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.595834 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.596302 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:23.596988 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.617316 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.617808 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.618253 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.620536 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.625212 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.625692 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:23.627006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.629361 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:23.656720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6c44d14-51b4-4f3f-a1c7-35123750cf87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af4da6360>]}
[0m06:02:23.657446 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.23s]
[0m06:02:23.658223 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:23.659207 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:23.659804 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:23.660424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:23.660883 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:23.665616 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:23.666265 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:23.699167 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.699680 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240709060223693409"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:23.700194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:23.713843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.720644 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.721116 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:23.721713 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.722167 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.722620 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240709060223693409'
      
      
      order by ordinal_position

  
[0m06:02:23.748310 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.753069 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.753552 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.762088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.770373 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.770871 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.779331 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.797122 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:23.797799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.798279 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240709060223693409"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240709060223693409"
    )
  
[0m06:02:23.815547 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.817286 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.817753 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.818193 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.830615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.831548 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:24.051807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6c44d14-51b4-4f3f-a1c7-35123750cf87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac05bdc40>]}
[0m06:02:24.052645 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.39s]
[0m06:02:24.053499 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:24.054894 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:24.055406 [debug] [MainThread]: On master: BEGIN
[0m06:02:24.055925 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:24.061191 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:24.061664 [debug] [MainThread]: On master: COMMIT
[0m06:02:24.062104 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:24.062551 [debug] [MainThread]: On master: COMMIT
[0m06:02:24.063104 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:24.063559 [debug] [MainThread]: On master: Close
[0m06:02:24.064921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:24.065362 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:24.065777 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:24.066242 [info ] [MainThread]: 
[0m06:02:24.066780 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.14 seconds (14.14s).
[0m06:02:24.067839 [debug] [MainThread]: Command end result
[0m06:02:24.095661 [info ] [MainThread]: 
[0m06:02:24.096299 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:24.096809 [info ] [MainThread]: 
[0m06:02:24.097333 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:24.098313 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.053509, "process_user_time": 4.975229, "process_kernel_time": 0.285101, "process_mem_max_rss": "296232", "process_in_blocks": "1184", "process_out_blocks": "109560"}
[0m06:02:24.098950 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:24.098842 after 16.05 seconds
[0m06:02:24.099480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af73bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aeb477dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac057f140>]}
[0m06:02:24.099997 [debug] [MainThread]: Flushing usage events
[0m06:02:25.981385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00d20be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00d372ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00d20ba70>]}


============================== 06:02:25.984148 | db34c3e6-1cc3-4e43-8f24-3cff4fb2e19c ==============================
[0m06:02:25.984148 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.985136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:26.128715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db34c3e6-1cc3-4e43-8f24-3cff4fb2e19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00d02b050>]}
[0m06:02:26.145168 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21228303, "process_user_time": 1.389711, "process_kernel_time": 0.116143, "process_mem_max_rss": "91976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:26.145748 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:26.145646 after 0.21 seconds
[0m06:02:26.146199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00d6a1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00d6a38c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00d6a3650>]}
[0m06:02:26.146647 [debug] [MainThread]: Flushing usage events
[0m14:04:54.457019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9132afb020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9133c2d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91325716d0>]}


============================== 14:04:54.464468 | 1db74d71-a142-486d-8be7-575f4399fac1 ==============================
[0m14:04:54.464468 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:54.465178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:54.608746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1db74d71-a142-486d-8be7-575f4399fac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913348c110>]}
[0m14:04:54.622244 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-42zi20xs'
[0m14:04:54.622759 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:54.690892 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:54.691605 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:54.699421 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:54.703155 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:54.749733 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:54.750298 [info ] [MainThread]: Up to date!
[0m14:04:54.750881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1db74d71-a142-486d-8be7-575f4399fac1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91321c7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91321c6a50>]}
[0m14:04:54.752295 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3438606, "process_user_time": 1.615069, "process_kernel_time": 0.13797, "process_mem_max_rss": "93280", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m14:04:54.752896 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:54.752792 after 0.34 seconds
[0m14:04:54.753341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9131f941d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91325716d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91325707a0>]}
[0m14:04:54.753784 [debug] [MainThread]: Flushing usage events
[0m14:04:56.408719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f822d1595e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f822ae27470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f822acc3a70>]}


============================== 14:04:56.411826 | 793221ab-ce26-44a5-803e-c152ece6e471 ==============================
[0m14:04:56.411826 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:56.412611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:04:56.653480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '793221ab-ce26-44a5-803e-c152ece6e471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8224334e90>]}
[0m14:04:56.714039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '793221ab-ce26-44a5-803e-c152ece6e471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f822ac1e1e0>]}
[0m14:04:56.715032 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:56.791116 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:56.791939 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:56.792499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '793221ab-ce26-44a5-803e-c152ece6e471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f822b0d1d00>]}
[0m14:04:58.001884 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:58.002701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '793221ab-ce26-44a5-803e-c152ece6e471', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82241ac350>]}
[0m14:04:58.198018 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:58.203242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '793221ab-ce26-44a5-803e-c152ece6e471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8223fe42c0>]}
[0m14:04:58.337803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '793221ab-ce26-44a5-803e-c152ece6e471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f822b0d2660>]}
[0m14:04:58.338388 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:58.338936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '793221ab-ce26-44a5-803e-c152ece6e471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8223e7c890>]}
[0m14:04:58.340698 [info ] [MainThread]: 
[0m14:04:58.341443 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:58.346249 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:58.381848 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:58.382358 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:58.382866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:59.019952 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:59.021494 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:59.023729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:59.024303 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:59.031124 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:59.031565 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:59.031966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:59.037524 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:59.038936 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:59.039355 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:59.039884 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:59.040292 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:59.040685 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:59.041246 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:59.042163 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:59.042577 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:59.042991 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:59.043614 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:59.044035 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:59.046044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:59.051361 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:59.051787 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:59.052170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:59.057236 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:59.057659 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:59.058065 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:59.077611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:59.082276 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:59.083511 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:59.083944 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:59.087255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '793221ab-ce26-44a5-803e-c152ece6e471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8222cb1fd0>]}
[0m14:04:59.087775 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:59.088173 [debug] [MainThread]: On master: BEGIN
[0m14:04:59.088552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:59.093818 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:59.094259 [debug] [MainThread]: On master: COMMIT
[0m14:04:59.094657 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:59.095092 [debug] [MainThread]: On master: COMMIT
[0m14:04:59.095595 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:59.096001 [debug] [MainThread]: On master: Close
[0m14:04:59.097498 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:59.097997 [info ] [MainThread]: 
[0m14:04:59.107570 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:59.108205 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:59.108952 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:59.109416 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:59.135006 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:59.135785 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:59.170272 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:59.171089 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:07.553355 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:07.553942 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:07.554833 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.555313 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:07.555764 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:07.556478 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.559369 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:07.559843 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:07.560681 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.581690 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:07.582285 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:07.582786 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:07.584154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.589468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:07.589995 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:07.591397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.593984 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:07.620813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793221ab-ce26-44a5-803e-c152ece6e471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81f3f64d70>]}
[0m14:05:07.621742 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.51s]
[0m14:05:07.622632 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:07.623793 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:07.624430 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:07.625101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:07.625600 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:07.631085 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:07.631800 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:07.667064 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.667710 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240709140507660831"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:07.668207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:07.683359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.691275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.691838 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:07.692570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.693037 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.693492 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240709140507660831'
      
      
      order by ordinal_position

  
[0m14:05:07.720313 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.726235 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.726821 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:07.735853 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.745385 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.745976 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:07.755418 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.773963 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:07.774806 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.775300 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240709140507660831"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240709140507660831"
    )
  
[0m14:05:07.791183 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.793215 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:07.793694 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.794138 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:07.803773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.804801 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:07.981804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793221ab-ce26-44a5-803e-c152ece6e471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81f3fb35f0>]}
[0m14:05:07.982760 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m14:05:07.983607 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:07.985075 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:07.985623 [debug] [MainThread]: On master: BEGIN
[0m14:05:07.986075 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:07.991877 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:07.992412 [debug] [MainThread]: On master: COMMIT
[0m14:05:07.992869 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:07.993304 [debug] [MainThread]: On master: COMMIT
[0m14:05:07.993991 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:07.994459 [debug] [MainThread]: On master: Close
[0m14:05:07.996471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:07.996917 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:07.997323 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:07.997811 [info ] [MainThread]: 
[0m14:05:07.998376 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.66 seconds (9.66s).
[0m14:05:07.999466 [debug] [MainThread]: Command end result
[0m14:05:08.028697 [info ] [MainThread]: 
[0m14:05:08.029434 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:08.029948 [info ] [MainThread]: 
[0m14:05:08.030474 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:08.031543 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.67319, "process_user_time": 4.825981, "process_kernel_time": 0.315084, "process_mem_max_rss": "267764", "process_in_blocks": "1184", "process_out_blocks": "109576"}
[0m14:05:08.032201 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:08.032088 after 11.67 seconds
[0m14:05:08.032738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f822c3d34a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f822aefb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f822b2482f0>]}
[0m14:05:08.033241 [debug] [MainThread]: Flushing usage events
[0m14:05:09.771466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f841856ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8418d7bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8418d7a5a0>]}


============================== 14:05:09.774584 | 9888a5ae-4687-4402-b4e8-1ee85e2a0fbc ==============================
[0m14:05:09.774584 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:09.775298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:09.933171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9888a5ae-4687-4402-b4e8-1ee85e2a0fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84183ca1e0>]}
[0m14:05:09.951133 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22984476, "process_user_time": 1.434816, "process_kernel_time": 0.131891, "process_mem_max_rss": "91988", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:09.951777 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:09.951665 after 0.23 seconds
[0m14:05:09.952247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84184db980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f841aa88920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f841856ddc0>]}
[0m14:05:09.952714 [debug] [MainThread]: Flushing usage events
[0m22:05:33.471119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb80279db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb801117350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb800c3be90>]}


============================== 22:05:33.478833 | e3e71a65-775a-418a-8fb9-af080ffb7be8 ==============================
[0m22:05:33.478833 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:33.479507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:33.621035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3e71a65-775a-418a-8fb9-af080ffb7be8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8023a5f70>]}
[0m22:05:33.634459 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-cr8ommvi'
[0m22:05:33.634930 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:33.682077 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:33.682724 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:33.695070 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:33.699160 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:33.874359 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:33.875018 [info ] [MainThread]: Up to date!
[0m22:05:33.875647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e3e71a65-775a-418a-8fb9-af080ffb7be8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8018250a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb800a2d340>]}
[0m22:05:33.891027 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4704558, "process_user_time": 1.653527, "process_kernel_time": 0.124114, "process_mem_max_rss": "93680", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m22:05:33.891756 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:33.891649 after 0.47 seconds
[0m22:05:33.892230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb800d177d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb803231070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb801c045c0>]}
[0m22:05:33.892700 [debug] [MainThread]: Flushing usage events
[0m22:05:35.573830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3873f674d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38744cd7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3876590a40>]}


============================== 22:05:35.576669 | 75ebd0d8-3e48-4bcd-a43b-d8abd3d1fbf7 ==============================
[0m22:05:35.576669 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:35.577317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:35.799727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75ebd0d8-3e48-4bcd-a43b-d8abd3d1fbf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387438fda0>]}
[0m22:05:35.858812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75ebd0d8-3e48-4bcd-a43b-d8abd3d1fbf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38754bd100>]}
[0m22:05:35.859707 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:35.899734 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:35.900541 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:35.901086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '75ebd0d8-3e48-4bcd-a43b-d8abd3d1fbf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3873d12c30>]}
[0m22:05:37.153453 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:37.154165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '75ebd0d8-3e48-4bcd-a43b-d8abd3d1fbf7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f386d136570>]}
[0m22:05:37.333337 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:37.338707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75ebd0d8-3e48-4bcd-a43b-d8abd3d1fbf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f386cf0d6d0>]}
[0m22:05:37.465054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75ebd0d8-3e48-4bcd-a43b-d8abd3d1fbf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f386cf0d7f0>]}
[0m22:05:37.465632 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:37.466134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75ebd0d8-3e48-4bcd-a43b-d8abd3d1fbf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38748ecf80>]}
[0m22:05:37.467840 [info ] [MainThread]: 
[0m22:05:37.468524 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:37.473231 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:37.508311 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:37.508776 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:37.509185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:38.129377 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:38.131047 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:38.133211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:38.133820 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:38.140666 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:38.141115 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:38.141518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:38.147124 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:38.148460 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:38.148874 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:38.149536 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:38.149951 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:38.150351 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:38.151005 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:38.151946 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:38.152357 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:38.152754 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:38.153299 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:38.153723 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:38.155962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:38.161300 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:38.161725 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:38.162116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:38.167153 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:38.167575 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:38.167985 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:38.188068 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:38.192702 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:38.193880 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:38.194301 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:38.197454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75ebd0d8-3e48-4bcd-a43b-d8abd3d1fbf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3875021c70>]}
[0m22:05:38.197993 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:38.198429 [debug] [MainThread]: On master: BEGIN
[0m22:05:38.198816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:38.203952 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:38.204387 [debug] [MainThread]: On master: COMMIT
[0m22:05:38.204787 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:38.205172 [debug] [MainThread]: On master: COMMIT
[0m22:05:38.205811 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:38.206237 [debug] [MainThread]: On master: Close
[0m22:05:38.207931 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:38.208437 [info ] [MainThread]: 
[0m22:05:38.223077 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:38.223718 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:38.224390 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:38.224842 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:38.250453 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:38.251255 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:38.285300 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:38.286072 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:48.522844 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.523394 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:48.524059 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.524535 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.524990 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:48.525936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.528751 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.529229 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:48.529935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.550609 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:48.551109 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.551566 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:48.553242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.558144 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.558660 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:48.560136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.562616 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:48.589554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75ebd0d8-3e48-4bcd-a43b-d8abd3d1fbf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3875656630>]}
[0m22:05:48.590426 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.36s]
[0m22:05:48.591241 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:48.592265 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:48.592844 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:48.593446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:48.593921 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:48.599104 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:48.599766 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:48.632927 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.633505 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240709220548627038"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:48.633993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:48.649256 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.656809 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.657350 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:48.658032 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.658524 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.658981 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240709220548627038'
      
      
      order by ordinal_position

  
[0m22:05:48.686099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.691745 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.692273 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:48.706870 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.716055 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.716573 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:48.725580 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.743683 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:48.744401 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.744885 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240709220548627038"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240709220548627038"
    )
  
[0m22:05:48.760122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.762005 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:48.762498 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.762948 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:48.772815 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.773802 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:48.968571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75ebd0d8-3e48-4bcd-a43b-d8abd3d1fbf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3840e31070>]}
[0m22:05:48.969436 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m22:05:48.970225 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:48.971716 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:48.972245 [debug] [MainThread]: On master: BEGIN
[0m22:05:48.972728 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:48.978286 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:48.978859 [debug] [MainThread]: On master: COMMIT
[0m22:05:48.979310 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:48.979751 [debug] [MainThread]: On master: COMMIT
[0m22:05:48.980348 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:48.980809 [debug] [MainThread]: On master: Close
[0m22:05:48.982449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:48.982897 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:48.983311 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:48.983782 [info ] [MainThread]: 
[0m22:05:48.984344 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.52 seconds (11.52s).
[0m22:05:48.985394 [debug] [MainThread]: Command end result
[0m22:05:49.013603 [info ] [MainThread]: 
[0m22:05:49.014285 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:49.014878 [info ] [MainThread]: 
[0m22:05:49.015436 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:49.016468 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.491484, "process_user_time": 4.851395, "process_kernel_time": 0.31596, "process_mem_max_rss": "273196", "process_in_blocks": "1184", "process_out_blocks": "111136"}
[0m22:05:49.017112 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:49.017001 after 13.49 seconds
[0m22:05:49.017615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3873f96750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f385846aea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3840ed8110>]}
[0m22:05:49.018107 [debug] [MainThread]: Flushing usage events
[0m22:05:50.817727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ff4ac440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ff0a57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ff34a330>]}


============================== 22:05:50.820759 | 21b095fc-5e17-4eee-a225-431270d78641 ==============================
[0m22:05:50.820759 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:50.821556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:50.975939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21b095fc-5e17-4eee-a225-431270d78641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37feb9e5d0>]}
[0m22:05:50.993341 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22539604, "process_user_time": 1.45712, "process_kernel_time": 0.127747, "process_mem_max_rss": "92048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:50.993994 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:50.993886 after 0.23 seconds
[0m22:05:50.994514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ff0a57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fe963710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37fece3a70>]}
[0m22:05:50.994984 [debug] [MainThread]: Flushing usage events
[0m06:02:31.431096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87821c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87821f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc878033ec0>]}


============================== 06:02:31.465477 | c5464595-7532-42cf-8cc5-a5442d5c246e ==============================
[0m06:02:31.465477 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:31.466152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:31.603998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5464595-7532-42cf-8cc5-a5442d5c246e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc878b3c0b0>]}
[0m06:02:31.617349 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-v6yk74ah'
[0m06:02:31.617816 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:31.708309 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:31.709106 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:31.743299 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:31.747032 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:31.961821 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:31.962377 [info ] [MainThread]: Up to date!
[0m06:02:31.962905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c5464595-7532-42cf-8cc5-a5442d5c246e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc877922840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc877c42cc0>]}
[0m06:02:31.964323 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5810901, "process_user_time": 1.558564, "process_kernel_time": 0.115596, "process_mem_max_rss": "93184", "process_in_blocks": "5736", "process_out_blocks": "3840"}
[0m06:02:31.964936 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:31.964832 after 0.58 seconds
[0m06:02:31.965373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc878181f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc877c42cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87753a450>]}
[0m06:02:31.965807 [debug] [MainThread]: Flushing usage events
[0m06:02:33.808813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa4332780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa4303200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa43030e0>]}


============================== 06:02:33.811548 | 1fdfb7fa-5649-47da-b0f1-9e965a43f91c ==============================
[0m06:02:33.811548 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:33.812213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:34.038338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fdfb7fa-5649-47da-b0f1-9e965a43f91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa42d2150>]}
[0m06:02:34.097045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fdfb7fa-5649-47da-b0f1-9e965a43f91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa4723d70>]}
[0m06:02:34.097827 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:34.147743 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:34.148495 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:34.149036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1fdfb7fa-5649-47da-b0f1-9e965a43f91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f9d715850>]}
[0m06:02:35.352038 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:35.352748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1fdfb7fa-5649-47da-b0f1-9e965a43f91c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa40b1580>]}
[0m06:02:35.541229 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:35.546235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fdfb7fa-5649-47da-b0f1-9e965a43f91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f9d34d070>]}
[0m06:02:35.673016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fdfb7fa-5649-47da-b0f1-9e965a43f91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f9d332360>]}
[0m06:02:35.673577 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:35.674068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fdfb7fa-5649-47da-b0f1-9e965a43f91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f9d34c530>]}
[0m06:02:35.675767 [info ] [MainThread]: 
[0m06:02:35.676450 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:35.681143 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:35.715822 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:35.716295 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:35.716779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:36.245166 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:36.246716 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:36.248960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:36.249557 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:36.256349 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.256832 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:36.257235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:36.262884 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.264268 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.264721 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:36.265578 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.265986 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.266375 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:36.266943 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.267874 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:36.268283 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:36.268741 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:36.269394 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.269814 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:36.271914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:36.277271 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:36.277695 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:36.278084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:36.282975 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.283394 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:36.283797 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:36.303660 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:36.308323 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:36.309532 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:36.309949 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:36.313344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fdfb7fa-5649-47da-b0f1-9e965a43f91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f9d4ad8b0>]}
[0m06:02:36.313869 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:36.314266 [debug] [MainThread]: On master: BEGIN
[0m06:02:36.314648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:36.319541 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:36.319968 [debug] [MainThread]: On master: COMMIT
[0m06:02:36.320397 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:36.320808 [debug] [MainThread]: On master: COMMIT
[0m06:02:36.321321 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:36.321727 [debug] [MainThread]: On master: Close
[0m06:02:36.323070 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:36.323562 [info ] [MainThread]: 
[0m06:02:36.332203 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:36.332834 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:36.333465 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:36.333923 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:36.359579 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:36.360337 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:36.394692 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:36.395452 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:47.911041 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:47.911570 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:47.912400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:47.912885 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:47.913342 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:47.914172 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:47.916898 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:47.917375 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:47.918084 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:47.938777 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:47.939279 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:47.939735 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:47.940931 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:47.945686 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:47.946169 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:47.947410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:47.949740 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:47.975735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fdfb7fa-5649-47da-b0f1-9e965a43f91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f724c8a40>]}
[0m06:02:47.976513 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.64s]
[0m06:02:47.977290 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:47.978277 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:47.978846 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:47.979426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:47.979896 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:47.984807 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:47.985464 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:48.018640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:48.019171 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240710060248012795"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:48.019657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:48.034202 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:48.041499 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:48.042007 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:48.042643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:48.043106 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:48.043556 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240710060248012795'
      
      
      order by ordinal_position

  
[0m06:02:48.070122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:48.075253 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:48.075757 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:48.084515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:48.093262 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:48.093755 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:48.102310 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:48.120176 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:48.120907 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:48.121395 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240710060248012795"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240710060248012795"
    )
  
[0m06:02:48.137407 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:48.139254 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:48.139730 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:48.140171 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:48.150422 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:48.151321 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:48.347794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fdfb7fa-5649-47da-b0f1-9e965a43f91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f711c3ad0>]}
[0m06:02:48.348650 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m06:02:48.349401 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:48.350710 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:48.351202 [debug] [MainThread]: On master: BEGIN
[0m06:02:48.351643 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:48.357033 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:48.357505 [debug] [MainThread]: On master: COMMIT
[0m06:02:48.357940 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:48.358363 [debug] [MainThread]: On master: COMMIT
[0m06:02:48.359052 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:48.359510 [debug] [MainThread]: On master: Close
[0m06:02:48.361010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:48.361462 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:48.361871 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:48.362336 [info ] [MainThread]: 
[0m06:02:48.362929 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.69 seconds (12.69s).
[0m06:02:48.364034 [debug] [MainThread]: Command end result
[0m06:02:48.391589 [info ] [MainThread]: 
[0m06:02:48.392279 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:48.392902 [info ] [MainThread]: 
[0m06:02:48.393507 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:48.394579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.634368, "process_user_time": 4.767721, "process_kernel_time": 0.309801, "process_mem_max_rss": "287640", "process_in_blocks": "1184", "process_out_blocks": "111112"}
[0m06:02:48.395222 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:48.395112 after 14.64 seconds
[0m06:02:48.395716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f945629f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f9d377f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa4bd9b20>]}
[0m06:02:48.396214 [debug] [MainThread]: Flushing usage events
[0m06:02:50.242660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e9455b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e7c75160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e7c74f80>]}


============================== 06:02:50.245376 | fae2bb47-8b28-494d-a84b-d791a0955497 ==============================
[0m06:02:50.245376 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:50.246059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:50.387490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fae2bb47-8b28-494d-a84b-d791a0955497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e7cf7230>]}
[0m06:02:50.403524 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20952038, "process_user_time": 1.395438, "process_kernel_time": 0.107956, "process_mem_max_rss": "92188", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:50.404098 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:50.403994 after 0.21 seconds
[0m06:02:50.404558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e9d20f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e89237a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e89ff830>]}
[0m06:02:50.404993 [debug] [MainThread]: Flushing usage events
[0m14:04:45.664436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d44cd9b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d45ea4c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d46c54ef0>]}


============================== 14:04:45.672033 | 93d9ef58-4161-4728-aab2-241aac1ebd9b ==============================
[0m14:04:45.672033 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:45.672714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:45.821693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93d9ef58-4161-4728-aab2-241aac1ebd9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d446c4200>]}
[0m14:04:45.835167 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ny7krl7m'
[0m14:04:45.835627 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:45.935406 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:45.936243 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:45.977529 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:45.981311 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:46.073046 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:46.073670 [info ] [MainThread]: Up to date!
[0m14:04:46.074300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '93d9ef58-4161-4728-aab2-241aac1ebd9b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d448a7bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d44ced6a0>]}
[0m14:04:46.076025 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4598198, "process_user_time": 1.569236, "process_kernel_time": 0.132441, "process_mem_max_rss": "93444", "process_in_blocks": "5736", "process_out_blocks": "3848"}
[0m14:04:46.076632 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:46.076527 after 0.46 seconds
[0m14:04:46.077071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d44ced6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d44a5a3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d45903890>]}
[0m14:04:46.077501 [debug] [MainThread]: Flushing usage events
[0m14:04:47.865033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff116cb3bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1168aa000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff116cb39e0>]}


============================== 14:04:47.868006 | dc664fe7-f46f-4a48-8820-45b1c556c862 ==============================
[0m14:04:47.868006 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:47.868709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:48.104418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc664fe7-f46f-4a48-8820-45b1c556c862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff116053020>]}
[0m14:04:48.164336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc664fe7-f46f-4a48-8820-45b1c556c862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff117a57860>]}
[0m14:04:48.165254 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:48.181183 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:48.181919 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:48.182480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dc664fe7-f46f-4a48-8820-45b1c556c862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1161b6ff0>]}
[0m14:04:49.397680 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:49.398455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dc664fe7-f46f-4a48-8820-45b1c556c862', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1161a5700>]}
[0m14:04:49.591534 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:49.597574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc664fe7-f46f-4a48-8820-45b1c556c862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10f5b0170>]}
[0m14:04:49.731520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc664fe7-f46f-4a48-8820-45b1c556c862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10f30d370>]}
[0m14:04:49.732131 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:49.732701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc664fe7-f46f-4a48-8820-45b1c556c862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10f3531d0>]}
[0m14:04:49.734456 [info ] [MainThread]: 
[0m14:04:49.735201 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:49.740043 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:49.774889 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:49.775363 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:49.775769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:50.322654 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:50.324252 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:50.326275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:50.326843 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:50.333550 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:50.333995 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:50.334398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:50.340018 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:50.341376 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:50.341786 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:50.342306 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:50.342731 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:50.343121 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:50.343918 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:50.344886 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:50.345295 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:50.345680 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:50.346221 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:50.346638 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:50.348608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:50.353922 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:50.354415 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:50.354805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:50.359886 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:50.360347 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:50.360754 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:50.380782 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:50.387770 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:50.388999 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:50.389417 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:50.392699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc664fe7-f46f-4a48-8820-45b1c556c862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1164734d0>]}
[0m14:04:50.393237 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:50.393646 [debug] [MainThread]: On master: BEGIN
[0m14:04:50.394041 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:50.399314 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:50.399765 [debug] [MainThread]: On master: COMMIT
[0m14:04:50.400210 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:50.400609 [debug] [MainThread]: On master: COMMIT
[0m14:04:50.401244 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:50.401672 [debug] [MainThread]: On master: Close
[0m14:04:50.403234 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:50.403732 [info ] [MainThread]: 
[0m14:04:50.412917 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:50.413561 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:50.414228 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:50.414688 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:50.440902 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:50.441694 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:50.476525 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:50.477426 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:58.562301 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:58.562834 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:04:58.563485 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.563954 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:58.564435 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:04:58.565139 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.567815 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:58.568325 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:04:58.569012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.589693 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:58.590199 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:58.590658 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:58.591837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.596673 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:58.597154 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:04:58.598701 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.601083 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:04:58.627028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc664fe7-f46f-4a48-8820-45b1c556c862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10f4f02c0>]}
[0m14:04:58.627808 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.21s]
[0m14:04:58.628685 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:04:58.629727 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:04:58.630300 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:04:58.630881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:04:58.631346 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:04:58.636460 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:04:58.637118 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:04:58.670728 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.671329 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240710140458664825"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:04:58.671824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:58.686634 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.694071 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.694553 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:04:58.695204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.695676 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.696154 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240710140458664825'
      
      
      order by ordinal_position

  
[0m14:04:58.723176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.728745 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.729254 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:58.737478 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.746430 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.746941 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:58.761455 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.780216 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:04:58.780960 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.781444 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240710140458664825"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240710140458664825"
    )
  
[0m14:04:58.799768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.801718 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:58.802188 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.802631 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:58.813570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.814511 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:04:59.041976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc664fe7-f46f-4a48-8820-45b1c556c862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0df220110>]}
[0m14:04:59.042833 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.41s]
[0m14:04:59.043597 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:04:59.045048 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:59.045531 [debug] [MainThread]: On master: BEGIN
[0m14:04:59.045976 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:59.051527 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:59.052040 [debug] [MainThread]: On master: COMMIT
[0m14:04:59.052490 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:59.052928 [debug] [MainThread]: On master: COMMIT
[0m14:04:59.053584 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:59.054051 [debug] [MainThread]: On master: Close
[0m14:04:59.055657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:59.056195 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:04:59.056629 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:04:59.057115 [info ] [MainThread]: 
[0m14:04:59.057650 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.32 seconds (9.32s).
[0m14:04:59.058683 [debug] [MainThread]: Command end result
[0m14:04:59.086561 [info ] [MainThread]: 
[0m14:04:59.087274 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:59.087849 [info ] [MainThread]: 
[0m14:04:59.088400 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:59.089404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.274058, "process_user_time": 5.079941, "process_kernel_time": 0.279996, "process_mem_max_rss": "320136", "process_in_blocks": "1184", "process_out_blocks": "110600"}
[0m14:04:59.090056 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:59.089944 after 11.27 seconds
[0m14:04:59.090557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff117d0f500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10f353f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10f5a6b70>]}
[0m14:04:59.091070 [debug] [MainThread]: Flushing usage events
[0m14:05:00.867329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf7301910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf55230e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf53eb230>]}


============================== 14:05:00.870377 | 4e1ff249-8ad4-451b-8f57-19c2262d4888 ==============================
[0m14:05:00.870377 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:00.871101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:01.025584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e1ff249-8ad4-451b-8f57-19c2262d4888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf50f2810>]}
[0m14:05:01.042634 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2251007, "process_user_time": 1.448767, "process_kernel_time": 0.091795, "process_mem_max_rss": "92076", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:01.043235 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:01.043130 after 0.23 seconds
[0m14:05:01.043688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf5017dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf4ddac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf5aefda0>]}
[0m14:05:01.044188 [debug] [MainThread]: Flushing usage events
[0m22:05:13.696315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8865e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c88a555e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8977d280>]}


============================== 22:05:13.703683 | 3f1bb8f3-0d33-4109-aceb-1e583b5bbe7e ==============================
[0m22:05:13.703683 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:13.704351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:13.848375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f1bb8f3-0d33-4109-aceb-1e583b5bbe7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c883ac9e0>]}
[0m22:05:13.861895 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4ugpsqg_'
[0m22:05:13.862382 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:14.170317 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:14.171135 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:14.219799 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:14.223607 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:14.602065 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:14.602634 [info ] [MainThread]: Up to date!
[0m22:05:14.603171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3f1bb8f3-0d33-4109-aceb-1e583b5bbe7e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c88315070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c88298260>]}
[0m22:05:14.625869 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9775893, "process_user_time": 1.551781, "process_kernel_time": 0.144725, "process_mem_max_rss": "93572", "process_in_blocks": "5752", "process_out_blocks": "3840"}
[0m22:05:14.626499 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:14.626393 after 0.98 seconds
[0m22:05:14.626955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8865e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c88d5b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8821e0f0>]}
[0m22:05:14.627394 [debug] [MainThread]: Flushing usage events
[0m22:05:16.521097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe48434b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4839171a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4838e71d0>]}


============================== 22:05:16.524094 | 86d048f7-62ff-4a31-8af1-a34480fa6ee9 ==============================
[0m22:05:16.524094 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:16.524804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:16.762945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86d048f7-62ff-4a31-8af1-a34480fa6ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe483653bf0>]}
[0m22:05:16.823016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86d048f7-62ff-4a31-8af1-a34480fa6ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe483947020>]}
[0m22:05:16.823931 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:16.840053 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:16.840853 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:16.841450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '86d048f7-62ff-4a31-8af1-a34480fa6ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe483650e30>]}
[0m22:05:18.059027 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:18.059810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '86d048f7-62ff-4a31-8af1-a34480fa6ee9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47cbad040>]}
[0m22:05:18.244259 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:18.249777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86d048f7-62ff-4a31-8af1-a34480fa6ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47cb36930>]}
[0m22:05:18.392111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86d048f7-62ff-4a31-8af1-a34480fa6ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47c9b3e00>]}
[0m22:05:18.392706 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:18.393201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86d048f7-62ff-4a31-8af1-a34480fa6ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47c9d6b40>]}
[0m22:05:18.394936 [info ] [MainThread]: 
[0m22:05:18.395645 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:18.400634 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:18.437019 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:18.437692 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:18.438103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:19.138204 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:19.139723 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:19.141957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:19.142533 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:19.149237 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:19.149726 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:19.150139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:19.155895 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:19.157372 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:19.157794 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:19.158341 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:19.158772 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:19.159162 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:19.159784 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:19.160731 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:19.161143 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:19.161581 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:19.162125 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:19.162552 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:19.165050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:19.170704 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:19.171162 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:19.171561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:19.177321 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:19.177818 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:19.178234 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:19.198273 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:19.203202 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:19.204418 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:19.204831 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:19.208573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86d048f7-62ff-4a31-8af1-a34480fa6ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47c9abf20>]}
[0m22:05:19.209111 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:19.209576 [debug] [MainThread]: On master: BEGIN
[0m22:05:19.209961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:19.215259 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:19.215700 [debug] [MainThread]: On master: COMMIT
[0m22:05:19.216109 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:19.216493 [debug] [MainThread]: On master: COMMIT
[0m22:05:19.217000 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:19.217449 [debug] [MainThread]: On master: Close
[0m22:05:19.218967 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:19.219472 [info ] [MainThread]: 
[0m22:05:19.228717 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:19.229403 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:19.230057 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:19.230505 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:19.256420 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:19.257266 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:19.291505 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:19.292353 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:31.719408 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:31.719973 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:31.720852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:31.721343 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:31.721790 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:31.722497 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:31.725392 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:31.725862 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:31.726553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:31.747314 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:31.747818 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:31.748275 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:31.749641 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:31.754524 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:31.755009 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:31.756289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:31.758725 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:31.786197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86d048f7-62ff-4a31-8af1-a34480fa6ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45027c3b0>]}
[0m22:05:31.787100 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.56s]
[0m22:05:31.788024 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:31.789089 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:31.789742 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:31.790407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:31.790883 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:31.796140 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:31.796844 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:31.830427 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:31.831006 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240710220531824483"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:31.831508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:31.847902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:31.855140 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:31.855618 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:31.856218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:31.856679 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:31.857123 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240710220531824483'
      
      
      order by ordinal_position

  
[0m22:05:31.883536 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:31.888584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:31.889073 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:31.897575 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:31.906358 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:31.906865 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:31.915847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:31.933671 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:31.934399 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:31.934877 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240710220531824483"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240710220531824483"
    )
  
[0m22:05:31.952814 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:31.954723 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:31.955194 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:31.955632 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:31.966444 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:31.967364 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:32.158142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86d048f7-62ff-4a31-8af1-a34480fa6ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4501befc0>]}
[0m22:05:32.158979 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m22:05:32.159837 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:32.161223 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:32.161744 [debug] [MainThread]: On master: BEGIN
[0m22:05:32.162183 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:32.167636 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:32.168118 [debug] [MainThread]: On master: COMMIT
[0m22:05:32.168566 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:32.169002 [debug] [MainThread]: On master: COMMIT
[0m22:05:32.169718 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:32.170178 [debug] [MainThread]: On master: Close
[0m22:05:32.171772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:32.172215 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:32.172629 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:32.173099 [info ] [MainThread]: 
[0m22:05:32.173739 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.78 seconds (13.78s).
[0m22:05:32.174864 [debug] [MainThread]: Command end result
[0m22:05:32.203110 [info ] [MainThread]: 
[0m22:05:32.203872 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:32.204490 [info ] [MainThread]: 
[0m22:05:32.205118 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:32.206277 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.7343235, "process_user_time": 4.842752, "process_kernel_time": 0.317491, "process_mem_max_rss": "275700", "process_in_blocks": "1184", "process_out_blocks": "111136"}
[0m22:05:32.206938 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:32.206825 after 15.74 seconds
[0m22:05:32.207445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe483a22ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47cc00da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe450a826f0>]}
[0m22:05:32.207943 [debug] [MainThread]: Flushing usage events
[0m22:05:34.110982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9fde356d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9fc4199a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9fc41b350>]}


============================== 22:05:34.113971 | 0da82f55-a7fd-43fa-b862-0bea8f41ccd6 ==============================
[0m22:05:34.113971 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:34.114704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:34.263135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0da82f55-a7fd-43fa-b862-0bea8f41ccd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9fb8c3bf0>]}
[0m22:05:34.279858 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21800092, "process_user_time": 1.412402, "process_kernel_time": 0.132037, "process_mem_max_rss": "92100", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:34.280464 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:34.280358 after 0.22 seconds
[0m22:05:34.280915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9fbe28650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9fb8855b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9fde356d0>]}
[0m22:05:34.281404 [debug] [MainThread]: Flushing usage events
[0m06:02:02.006949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b81d6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b85a3bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b85a3b30>]}


============================== 06:02:02.057748 | 3b1f822a-97a3-4057-a25c-e34d55684c49 ==============================
[0m06:02:02.057748 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:02.058412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:02.195246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b1f822a-97a3-4057-a25c-e34d55684c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b803c470>]}
[0m06:02:02.208280 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-b6hqju53'
[0m06:02:02.208746 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:02.298263 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:02.298975 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:02.322660 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:02.326365 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:02.397309 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:02.397803 [info ] [MainThread]: Up to date!
[0m06:02:02.398321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3b1f822a-97a3-4057-a25c-e34d55684c49', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b8382f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b899b170>]}
[0m06:02:02.409523 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4503311, "process_user_time": 1.567159, "process_kernel_time": 0.100717, "process_mem_max_rss": "93432", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m06:02:02.410170 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:02.410066 after 0.45 seconds
[0m06:02:02.410647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b81d3a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b8382f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b8758440>]}
[0m06:02:02.411085 [debug] [MainThread]: Flushing usage events
[0m06:02:04.016631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68be19ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68be0acb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68be9e9580>]}


============================== 06:02:04.019382 | 442dc072-34fb-4c49-877c-d61cbe0a0140 ==============================
[0m06:02:04.019382 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:04.020097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:04.243035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '442dc072-34fb-4c49-877c-d61cbe0a0140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68b6354e90>]}
[0m06:02:04.301045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '442dc072-34fb-4c49-877c-d61cbe0a0140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68bdd87950>]}
[0m06:02:04.301765 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:04.339157 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:04.339877 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:04.340432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '442dc072-34fb-4c49-877c-d61cbe0a0140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68bdfc1820>]}
[0m06:02:05.541465 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:05.542130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '442dc072-34fb-4c49-877c-d61cbe0a0140', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68b625a480>]}
[0m06:02:05.719080 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:05.725178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '442dc072-34fb-4c49-877c-d61cbe0a0140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68b6075430>]}
[0m06:02:05.846728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '442dc072-34fb-4c49-877c-d61cbe0a0140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68b60c09e0>]}
[0m06:02:05.847271 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:05.847758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '442dc072-34fb-4c49-877c-d61cbe0a0140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68b5e531d0>]}
[0m06:02:05.849408 [info ] [MainThread]: 
[0m06:02:05.850087 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:05.854772 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:05.889423 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:05.889875 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:05.890286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:06.385157 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.386814 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:06.389111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:06.389707 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:06.396497 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.396940 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:06.397351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:06.402786 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.404109 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.404522 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:06.405399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.405817 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.406213 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:06.406876 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.407818 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:06.408225 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.408612 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:06.409257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.409683 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:06.411881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:06.417085 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:06.417508 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:06.417893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:06.422831 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.423257 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:06.423668 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:06.443752 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.448612 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:06.449765 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:06.450179 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:06.453782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '442dc072-34fb-4c49-877c-d61cbe0a0140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68b6075310>]}
[0m06:02:06.454292 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.454747 [debug] [MainThread]: On master: BEGIN
[0m06:02:06.455133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:06.460171 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.460602 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.460999 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.461376 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.462005 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.462417 [debug] [MainThread]: On master: Close
[0m06:02:06.463864 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:06.464371 [info ] [MainThread]: 
[0m06:02:06.479361 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:06.479962 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:06.480626 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:06.481079 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:06.506476 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:06.507228 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:06.541113 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:06.541842 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:14.814086 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.814641 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:14.815280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.815755 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.816200 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:14.816881 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.819558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.820036 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:14.820725 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.841103 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:14.841587 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.842033 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:14.843271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.847958 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.848445 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:14.849620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.851949 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:14.877291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '442dc072-34fb-4c49-877c-d61cbe0a0140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6889caf530>]}
[0m06:02:14.877999 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.40s]
[0m06:02:14.878900 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:14.879863 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:14.880433 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:14.881110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:14.881576 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:14.886320 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:14.887002 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:14.920106 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:14.920674 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240711060214914211"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:14.921174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:14.936978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.943786 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:14.944268 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:14.944919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.945383 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:14.945842 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240711060214914211'
      
      
      order by ordinal_position

  
[0m06:02:14.978183 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.983033 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:14.983527 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:14.992161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.000474 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.000979 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:15.010063 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.027695 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:15.028371 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.028856 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240711060214914211"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240711060214914211"
    )
  
[0m06:02:15.045928 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.047654 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:15.048130 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.048570 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:15.057987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.058902 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:15.254620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '442dc072-34fb-4c49-877c-d61cbe0a0140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6889c9f1a0>]}
[0m06:02:15.255435 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m06:02:15.256208 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:15.257692 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.258185 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.258679 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:15.264028 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.264523 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.264965 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.265405 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.266099 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.266644 [debug] [MainThread]: On master: Close
[0m06:02:15.268073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:15.268525 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:15.268936 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:15.269410 [info ] [MainThread]: 
[0m06:02:15.269959 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.42 seconds (9.42s).
[0m06:02:15.271035 [debug] [MainThread]: Command end result
[0m06:02:15.298705 [info ] [MainThread]: 
[0m06:02:15.299344 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:15.299885 [info ] [MainThread]: 
[0m06:02:15.300431 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:15.301448 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.333251, "process_user_time": 4.688562, "process_kernel_time": 0.330629, "process_mem_max_rss": "285908", "process_in_blocks": "1184", "process_out_blocks": "111120"}
[0m06:02:15.302101 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:15.301992 after 11.33 seconds
[0m06:02:15.302639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68be9e9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68bd857860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6889d48140>]}
[0m06:02:15.303130 [debug] [MainThread]: Flushing usage events
[0m06:02:16.927358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c423cf770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c42138200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c4213b0e0>]}


============================== 06:02:16.930042 | 69ed25a3-426f-4214-8513-7900267335fb ==============================
[0m06:02:16.930042 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:16.930794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.068947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69ed25a3-426f-4214-8513-7900267335fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c43155b80>]}
[0m06:02:17.085270 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2059603, "process_user_time": 1.374998, "process_kernel_time": 0.12427, "process_mem_max_rss": "92100", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:17.085844 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:17.085741 after 0.21 seconds
[0m06:02:17.086285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c41ecac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c42138200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c4213a4b0>]}
[0m06:02:17.086809 [debug] [MainThread]: Flushing usage events
[0m14:05:04.697312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8246625670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824700b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8246b2b020>]}


============================== 14:05:04.725150 | 38e000af-680e-4961-beb1-3cd37b572230 ==============================
[0m14:05:04.725150 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:04.725912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:04.877919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38e000af-680e-4961-beb1-3cd37b572230', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8245feb1d0>]}
[0m14:05:04.892665 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mj3zkbuh'
[0m14:05:04.893278 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:04.923788 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:04.924608 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:04.935677 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:04.939591 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:05.114232 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:05.114867 [info ] [MainThread]: Up to date!
[0m14:05:05.115471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '38e000af-680e-4961-beb1-3cd37b572230', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8245edb1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82461dacc0>]}
[0m14:05:05.134175 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4856954, "process_user_time": 1.591665, "process_kernel_time": 0.150831, "process_mem_max_rss": "93576", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m14:05:05.134991 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:05.134871 after 0.49 seconds
[0m14:05:05.135536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82467632f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8246b2be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8246b2ade0>]}
[0m14:05:05.136008 [debug] [MainThread]: Flushing usage events
[0m14:05:07.243465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6dca6da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6de4556d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6ddba6030>]}


============================== 14:05:07.246453 | 8b9b0985-d4a6-470c-a8ce-e63581e9b6a1 ==============================
[0m14:05:07.246453 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:07.247203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:07.481073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b9b0985-d4a6-470c-a8ce-e63581e9b6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6dbeb4950>]}
[0m14:05:07.540752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b9b0985-d4a6-470c-a8ce-e63581e9b6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6dbf66060>]}
[0m14:05:07.541715 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:07.580859 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:07.582120 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:07.582867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b9b0985-d4a6-470c-a8ce-e63581e9b6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6dd12ac30>]}
[0m14:05:08.802118 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:08.802847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8b9b0985-d4a6-470c-a8ce-e63581e9b6a1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6d53c7bf0>]}
[0m14:05:08.985864 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:08.991294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b9b0985-d4a6-470c-a8ce-e63581e9b6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6d51bbd40>]}
[0m14:05:09.131226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b9b0985-d4a6-470c-a8ce-e63581e9b6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6d5136f60>]}
[0m14:05:09.131839 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:09.132385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b9b0985-d4a6-470c-a8ce-e63581e9b6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6d518eb40>]}
[0m14:05:09.134253 [info ] [MainThread]: 
[0m14:05:09.135098 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:09.140111 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:09.176769 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:09.177450 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:09.177869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:09.731500 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:09.733038 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:09.735125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:09.735701 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:09.742477 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:09.742925 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:09.743326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:09.748818 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:09.750252 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:09.750669 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:09.751290 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:09.751705 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:09.752095 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:09.752633 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:09.753622 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:09.754039 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:09.754429 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:09.755075 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:09.755517 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:09.757924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:09.763475 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:09.763905 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:09.764298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:09.769435 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:09.769878 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:09.770290 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:09.790470 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:09.795720 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:09.797062 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:09.797574 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:09.801858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b9b0985-d4a6-470c-a8ce-e63581e9b6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6dc3fb560>]}
[0m14:05:09.802421 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:09.802843 [debug] [MainThread]: On master: BEGIN
[0m14:05:09.803235 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:09.808742 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:09.809246 [debug] [MainThread]: On master: COMMIT
[0m14:05:09.809662 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:09.810062 [debug] [MainThread]: On master: COMMIT
[0m14:05:09.810714 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:09.811153 [debug] [MainThread]: On master: Close
[0m14:05:09.812887 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:09.813439 [info ] [MainThread]: 
[0m14:05:09.837072 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:09.837827 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:09.838546 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:09.839014 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:09.864805 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:09.865729 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:09.900277 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:09.901235 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:22.386867 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.387439 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:22.388170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.388641 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.389099 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:22.389906 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.392851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.393366 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:22.394099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.414901 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:22.415504 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.415964 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:22.418206 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.423371 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.423877 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:22.425256 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.427752 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:22.454243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9b0985-d4a6-470c-a8ce-e63581e9b6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a98f6690>]}
[0m14:05:22.455118 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.61s]
[0m14:05:22.456028 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:22.457062 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:22.457699 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:22.458408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:22.458892 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:22.464141 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:22.464856 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:22.499443 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.500097 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240711140522493352"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:22.500596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:22.517630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.525420 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.525960 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:22.526723 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.527189 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.527647 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240711140522493352'
      
      
      order by ordinal_position

  
[0m14:05:22.554640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.560497 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.561062 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:22.575770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.585563 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.586163 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:22.600355 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.619133 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:22.619963 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.620465 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240711140522493352"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240711140522493352"
    )
  
[0m14:05:22.637537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.639601 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:22.640093 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.640546 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:22.652722 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.653859 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:22.897514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9b0985-d4a6-470c-a8ce-e63581e9b6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a902d430>]}
[0m14:05:22.898425 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.44s]
[0m14:05:22.899319 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:22.900829 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.901422 [debug] [MainThread]: On master: BEGIN
[0m14:05:22.901936 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:22.907613 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.908122 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.908572 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.909017 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.909767 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.910245 [debug] [MainThread]: On master: Close
[0m14:05:22.911977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:22.912427 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:22.912839 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:22.913369 [info ] [MainThread]: 
[0m14:05:22.913928 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.78 seconds (13.78s).
[0m14:05:22.914988 [debug] [MainThread]: Command end result
[0m14:05:22.946485 [info ] [MainThread]: 
[0m14:05:22.947191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:22.947708 [info ] [MainThread]: 
[0m14:05:22.948247 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:22.949312 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.754848, "process_user_time": 5.162796, "process_kernel_time": 0.276578, "process_mem_max_rss": "297620", "process_in_blocks": "1184", "process_out_blocks": "111104"}
[0m14:05:22.949971 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:22.949859 after 15.76 seconds
[0m14:05:22.950482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6dc8de480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6dc3d4cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6d55299a0>]}
[0m14:05:22.950982 [debug] [MainThread]: Flushing usage events
[0m14:05:24.964716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05dcc071a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05de3991f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05de3997f0>]}


============================== 14:05:24.968014 | 6a489416-0469-47a2-b809-04aa3fc5294e ==============================
[0m14:05:24.968014 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:24.968734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:25.127797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a489416-0469-47a2-b809-04aa3fc5294e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05dcf3cb00>]}
[0m14:05:25.145383 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23225202, "process_user_time": 1.490967, "process_kernel_time": 0.123582, "process_mem_max_rss": "92088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:25.146018 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:25.145910 after 0.23 seconds
[0m14:05:25.146484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05dc13b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05dc05fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05dbe22c00>]}
[0m14:05:25.146947 [debug] [MainThread]: Flushing usage events
[0m22:05:22.823988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173f962540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173f960c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173f961f40>]}


============================== 22:05:22.851058 | 419675ad-7a9a-45ea-b946-a2b64e3322ca ==============================
[0m22:05:22.851058 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:22.851834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:05:23.001740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '419675ad-7a9a-45ea-b946-a2b64e3322ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173f7802f0>]}
[0m22:05:23.015503 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vi67pnup'
[0m22:05:23.016086 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:23.179104 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:23.179961 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:23.271313 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:23.275293 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:23.411412 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:23.412071 [info ] [MainThread]: Up to date!
[0m22:05:23.412635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '419675ad-7a9a-45ea-b946-a2b64e3322ca', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173f910440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173f9102f0>]}
[0m22:05:23.437359 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.66300416, "process_user_time": 1.610127, "process_kernel_time": 0.132835, "process_mem_max_rss": "93324", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m22:05:23.438175 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:23.438035 after 0.66 seconds
[0m22:05:23.438669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17407bb5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173fd41820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173f810380>]}
[0m22:05:23.439139 [debug] [MainThread]: Flushing usage events
[0m22:05:25.137058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e59f1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e588ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e549da90>]}


============================== 22:05:25.140102 | 38a22e6f-9cfb-4e02-99bc-c0361123be16 ==============================
[0m22:05:25.140102 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:25.140828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:25.365545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38a22e6f-9cfb-4e02-99bc-c0361123be16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e5045340>]}
[0m22:05:25.424742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38a22e6f-9cfb-4e02-99bc-c0361123be16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e51edb20>]}
[0m22:05:25.425687 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:25.479473 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:25.480301 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:25.480855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '38a22e6f-9cfb-4e02-99bc-c0361123be16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e59b87a0>]}
[0m22:05:26.710300 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:26.711027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '38a22e6f-9cfb-4e02-99bc-c0361123be16', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e4eadd90>]}
[0m22:05:26.892486 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:26.897851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38a22e6f-9cfb-4e02-99bc-c0361123be16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74de0643b0>]}
[0m22:05:27.032064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38a22e6f-9cfb-4e02-99bc-c0361123be16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74de2e8410>]}
[0m22:05:27.032652 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:27.033168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38a22e6f-9cfb-4e02-99bc-c0361123be16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74de0ca7b0>]}
[0m22:05:27.034936 [info ] [MainThread]: 
[0m22:05:27.035709 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:27.040537 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:27.076322 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:27.076848 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:27.077261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:27.617500 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:27.619021 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:27.621110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:27.621679 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:27.628461 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:27.628907 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:27.629308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:27.634836 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.636269 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:27.636686 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:27.637343 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.637751 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:27.638141 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:27.638764 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.639720 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:27.640138 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:27.640532 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:27.641061 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.641477 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:27.643596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:27.648961 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:27.649383 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:27.649768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:27.654666 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.655085 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:27.655491 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:27.676148 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.681065 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:27.682284 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:27.682703 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:27.686521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38a22e6f-9cfb-4e02-99bc-c0361123be16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74de064410>]}
[0m22:05:27.687068 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:27.687470 [debug] [MainThread]: On master: BEGIN
[0m22:05:27.687896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:27.693212 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:27.693658 [debug] [MainThread]: On master: COMMIT
[0m22:05:27.694060 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:27.694447 [debug] [MainThread]: On master: COMMIT
[0m22:05:27.695098 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:27.695520 [debug] [MainThread]: On master: Close
[0m22:05:27.697317 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:27.697830 [info ] [MainThread]: 
[0m22:05:27.731845 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:27.732521 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:27.733252 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:27.733716 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:27.759266 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:27.760080 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:27.795218 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:27.796151 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:37.636505 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.637192 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:37.638285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.638806 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.639284 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:37.640132 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.643350 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.643887 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:37.644757 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.666031 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:37.666635 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.667123 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:37.668613 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.673705 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.674209 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:37.675735 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.678220 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:37.705764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38a22e6f-9cfb-4e02-99bc-c0361123be16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74dce09790>]}
[0m22:05:37.706629 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.97s]
[0m22:05:37.707565 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:37.708658 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:37.709278 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:37.709933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:37.710407 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:37.715453 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:37.716145 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:37.749504 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.750120 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240711220537743572"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:37.750618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:37.767696 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.775301 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.775861 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:37.776552 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.777018 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.777473 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240711220537743572'
      
      
      order by ordinal_position

  
[0m22:05:37.804626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.810438 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.810953 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:37.819747 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.828895 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.829433 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:37.838327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.856752 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:37.857600 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.858092 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240711220537743572"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240711220537743572"
    )
  
[0m22:05:37.876297 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.878155 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:37.878626 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.879067 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:37.894390 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.895477 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:38.127441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38a22e6f-9cfb-4e02-99bc-c0361123be16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74b1fac080>]}
[0m22:05:38.128331 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.42s]
[0m22:05:38.129206 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:38.130571 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:38.131047 [debug] [MainThread]: On master: BEGIN
[0m22:05:38.131489 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:38.136955 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:38.137436 [debug] [MainThread]: On master: COMMIT
[0m22:05:38.137881 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:38.138309 [debug] [MainThread]: On master: COMMIT
[0m22:05:38.139001 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:38.139470 [debug] [MainThread]: On master: Close
[0m22:05:38.141118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:38.141562 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:38.141977 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:38.142466 [info ] [MainThread]: 
[0m22:05:38.143069 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.11 seconds (11.11s).
[0m22:05:38.144226 [debug] [MainThread]: Command end result
[0m22:05:38.172432 [info ] [MainThread]: 
[0m22:05:38.173209 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:38.173815 [info ] [MainThread]: 
[0m22:05:38.174423 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:38.175552 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.087224, "process_user_time": 5.082449, "process_kernel_time": 0.317653, "process_mem_max_rss": "298296", "process_in_blocks": "1184", "process_out_blocks": "111144"}
[0m22:05:38.176246 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:38.176132 after 13.09 seconds
[0m22:05:38.176754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e89bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74de096780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e549d970>]}
[0m22:05:38.177264 [debug] [MainThread]: Flushing usage events
[0m22:05:39.998338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f829e8a67b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f829e8a6b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f829daf8e60>]}


============================== 22:05:40.001366 | 38a61b63-4184-43b7-9100-a8fcb1855017 ==============================
[0m22:05:40.001366 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:40.002029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:40.152693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38a61b63-4184-43b7-9100-a8fcb1855017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f829d81d1c0>]}
[0m22:05:40.169686 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22162227, "process_user_time": 1.458282, "process_kernel_time": 0.107872, "process_mem_max_rss": "92224", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:40.170351 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:40.170231 after 0.22 seconds
[0m22:05:40.170837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f829e09ce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f829db708c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f829d84f3b0>]}
[0m22:05:40.171315 [debug] [MainThread]: Flushing usage events
[0m06:01:59.499535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f647936e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6479e9b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64793bb800>]}


============================== 06:01:59.506906 | d9a66acb-9239-4d45-ab72-3e964d67a1e6 ==============================
[0m06:01:59.506906 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:01:59.507568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:01:59.646297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9a66acb-9239-4d45-ab72-3e964d67a1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6479b5aae0>]}
[0m06:01:59.659598 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-920tnffk'
[0m06:01:59.660074 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:01:59.701879 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:01:59.702564 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:01:59.723852 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:01:59.727562 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:01:59.939003 [info ] [MainThread]: Installed from version 1.2.0
[0m06:01:59.939610 [info ] [MainThread]: Up to date!
[0m06:01:59.940246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd9a66acb-9239-4d45-ab72-3e964d67a1e6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64791ce870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f647906f980>]}
[0m06:01:59.972014 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5203732, "process_user_time": 1.548999, "process_kernel_time": 0.128082, "process_mem_max_rss": "93464", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m06:01:59.972744 [debug] [MainThread]: Command `dbt deps` succeeded at 06:01:59.972638 after 0.52 seconds
[0m06:01:59.973255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6479e9b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64790bc1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64794da000>]}
[0m06:01:59.973729 [debug] [MainThread]: Flushing usage events
[0m06:02:01.801155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264182f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2641c3a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2643b998b0>]}


============================== 06:02:01.804013 | 43f836e8-476a-45b9-9c67-315a8dc10ecc ==============================
[0m06:02:01.804013 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:01.804813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:02.031498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43f836e8-476a-45b9-9c67-315a8dc10ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264167f890>]}
[0m06:02:02.090558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43f836e8-476a-45b9-9c67-315a8dc10ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2641693860>]}
[0m06:02:02.091405 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:02.110962 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:02.111686 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:02.112246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '43f836e8-476a-45b9-9c67-315a8dc10ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26423c0e30>]}
[0m06:02:03.333044 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:03.333764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '43f836e8-476a-45b9-9c67-315a8dc10ecc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263aca3710>]}
[0m06:02:03.514912 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:03.520419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43f836e8-476a-45b9-9c67-315a8dc10ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263aa75640>]}
[0m06:02:03.661735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43f836e8-476a-45b9-9c67-315a8dc10ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263a9bb590>]}
[0m06:02:03.662311 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:03.662812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43f836e8-476a-45b9-9c67-315a8dc10ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263a895940>]}
[0m06:02:03.664535 [info ] [MainThread]: 
[0m06:02:03.665251 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:03.669940 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:03.705130 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:03.705606 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:03.706012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:04.352478 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:04.354078 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:04.356109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:04.356661 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:04.363295 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:04.363732 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:04.364126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:04.369642 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:04.370950 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:04.371356 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:04.371958 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:04.372359 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:04.372751 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:04.373364 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:04.374277 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:04.374684 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:04.375084 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:04.375620 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:04.376043 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:04.378172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:04.383569 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:04.383992 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:04.384395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:04.389301 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:04.389721 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:04.390123 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:04.410291 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:04.415008 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:04.416186 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:04.416605 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:04.419739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43f836e8-476a-45b9-9c67-315a8dc10ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264259e480>]}
[0m06:02:04.420269 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:04.420672 [debug] [MainThread]: On master: BEGIN
[0m06:02:04.421091 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:04.426195 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:04.426623 [debug] [MainThread]: On master: COMMIT
[0m06:02:04.427020 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:04.427402 [debug] [MainThread]: On master: COMMIT
[0m06:02:04.428029 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:04.428444 [debug] [MainThread]: On master: Close
[0m06:02:04.429944 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:04.430491 [info ] [MainThread]: 
[0m06:02:04.439918 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:04.440516 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:04.441294 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:04.441742 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:04.467084 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:04.467864 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:04.502011 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:04.502775 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:15.187051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.187614 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:15.188293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.188759 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.189240 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:15.189964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.192794 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.193300 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:15.194187 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.215040 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:15.215561 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.216026 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:15.217612 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.222526 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.223010 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:15.224322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.226721 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:15.252452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43f836e8-476a-45b9-9c67-315a8dc10ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260e256900>]}
[0m06:02:15.253283 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.81s]
[0m06:02:15.254076 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:15.255087 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:15.255676 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:15.256312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:15.256780 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:15.261998 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:15.262683 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:15.296362 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.296925 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240712060215290448"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:15.297436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:15.311631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.318993 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.319479 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:15.320105 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.320568 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.321043 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240712060215290448'
      
      
      order by ordinal_position

  
[0m06:02:15.348342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.353752 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.354276 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:15.369050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.378315 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.378826 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:15.387802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.405957 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:15.406677 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.407157 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240712060215290448"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240712060215290448"
    )
  
[0m06:02:15.423654 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.425543 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:15.426037 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.426484 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:15.437833 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.438732 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:15.686586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43f836e8-476a-45b9-9c67-315a8dc10ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260e1152e0>]}
[0m06:02:15.687447 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.43s]
[0m06:02:15.688334 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:15.689845 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.690375 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.690819 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:15.696233 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.696714 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.697207 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.697659 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.698346 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.698823 [debug] [MainThread]: On master: Close
[0m06:02:15.700274 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:15.700719 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:15.701194 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:15.701671 [info ] [MainThread]: 
[0m06:02:15.702196 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.04 seconds (12.04s).
[0m06:02:15.703197 [debug] [MainThread]: Command end result
[0m06:02:15.731080 [info ] [MainThread]: 
[0m06:02:15.731709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:15.732233 [info ] [MainThread]: 
[0m06:02:15.732763 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:15.733783 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.981574, "process_user_time": 5.011539, "process_kernel_time": 0.328756, "process_mem_max_rss": "301392", "process_in_blocks": "1184", "process_out_blocks": "111120"}
[0m06:02:15.734425 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:15.734316 after 13.98 seconds
[0m06:02:15.734918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26419077a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2642d87920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2641c554f0>]}
[0m06:02:15.735403 [debug] [MainThread]: Flushing usage events
[0m06:02:17.645967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2821ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b26f33b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b28a42000>]}


============================== 06:02:17.648779 | 489ab87c-f015-4202-a07d-10d5845ffba5 ==============================
[0m06:02:17.648779 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:17.649501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.797587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '489ab87c-f015-4202-a07d-10d5845ffba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2620bbf0>]}
[0m06:02:17.814980 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21774808, "process_user_time": 1.430192, "process_kernel_time": 0.092141, "process_mem_max_rss": "92224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:17.815580 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:17.815475 after 0.22 seconds
[0m06:02:17.816065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2621a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b26937f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b269366f0>]}
[0m06:02:17.816532 [debug] [MainThread]: Flushing usage events
[0m14:05:02.387709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e7b0f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e79518b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e79527b0>]}


============================== 14:05:02.394842 | cf29ba99-c09b-4183-bedc-7e2e97862a56 ==============================
[0m14:05:02.394842 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:02.395570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:02.530263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf29ba99-c09b-4183-bedc-7e2e97862a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e8861e50>]}
[0m14:05:02.543624 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-__ybae02'
[0m14:05:02.544092 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:02.655299 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:02.655969 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:02.779973 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:02.783786 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:03.144095 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:03.144717 [info ] [MainThread]: Up to date!
[0m14:05:03.145278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cf29ba99-c09b-4183-bedc-7e2e97862a56', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e7d27c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e804cb30>]}
[0m14:05:03.147062 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.80767184, "process_user_time": 1.581593, "process_kernel_time": 0.107564, "process_mem_max_rss": "93312", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m14:05:03.147664 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:03.147558 after 0.81 seconds
[0m14:05:03.148105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e79518b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e7b0db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e8861e50>]}
[0m14:05:03.148541 [debug] [MainThread]: Flushing usage events
[0m14:05:04.884536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b60384bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b60387500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b6065fef0>]}


============================== 14:05:04.887287 | 3e81facc-af3f-40c1-9437-12ec7c0c77b7 ==============================
[0m14:05:04.887287 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:04.887956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:05.110575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e81facc-af3f-40c1-9437-12ec7c0c77b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b601eb5f0>]}
[0m14:05:05.169601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e81facc-af3f-40c1-9437-12ec7c0c77b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b601c67b0>]}
[0m14:05:05.170340 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:05.185439 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:05.186154 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:05.186714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3e81facc-af3f-40c1-9437-12ec7c0c77b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b600bf2c0>]}
[0m14:05:06.395877 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:06.396560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3e81facc-af3f-40c1-9437-12ec7c0c77b7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b600bfe00>]}
[0m14:05:06.576646 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:06.582831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e81facc-af3f-40c1-9437-12ec7c0c77b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b595454f0>]}
[0m14:05:06.703878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e81facc-af3f-40c1-9437-12ec7c0c77b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b61e456d0>]}
[0m14:05:06.704456 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:06.704982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e81facc-af3f-40c1-9437-12ec7c0c77b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b61973500>]}
[0m14:05:06.706651 [info ] [MainThread]: 
[0m14:05:06.707335 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:06.712077 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:06.746894 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:06.747373 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:06.747781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:07.695893 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:07.697408 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:07.699537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:07.700103 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:07.706777 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:07.707221 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:07.707624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:07.713203 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.714539 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:07.714949 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:07.715593 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.715999 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:07.716389 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:07.717011 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.717917 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:07.718325 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:07.718714 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:07.719347 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.719769 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:07.721743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:07.726882 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:07.727306 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:07.727692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:07.732453 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.732913 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:07.733322 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:07.752829 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:07.757493 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:07.758653 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:07.759067 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:07.762165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e81facc-af3f-40c1-9437-12ec7c0c77b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b6274b4d0>]}
[0m14:05:07.762684 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:07.763084 [debug] [MainThread]: On master: BEGIN
[0m14:05:07.763458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:07.768488 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:07.768949 [debug] [MainThread]: On master: COMMIT
[0m14:05:07.769350 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:07.769734 [debug] [MainThread]: On master: COMMIT
[0m14:05:07.770251 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:07.770658 [debug] [MainThread]: On master: Close
[0m14:05:07.772074 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:07.772588 [info ] [MainThread]: 
[0m14:05:07.782428 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:07.783050 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:07.783720 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:07.784175 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:07.809478 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:07.810225 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:07.844262 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:07.845037 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:22.075664 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.076185 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:22.076846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.077312 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.077760 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:22.078434 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.081102 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.081577 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:22.082424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.103081 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:22.103568 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.104019 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:22.105594 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.110306 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.110796 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:22.111910 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.114255 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:22.140363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e81facc-af3f-40c1-9437-12ec7c0c77b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b594f0c80>]}
[0m14:05:22.141184 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 14.36s]
[0m14:05:22.141988 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:22.142997 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:22.143580 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:22.144342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:22.144864 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:22.149858 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:22.150508 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:22.183643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.184174 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240712140522177788"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:22.184679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:22.200887 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.207835 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.208308 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:22.208978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.209441 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.209890 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240712140522177788'
      
      
      order by ordinal_position

  
[0m14:05:22.241543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.246421 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.246915 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:22.255225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.263750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.264253 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:22.272758 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.290744 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:22.291438 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.291922 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240712140522177788"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240712140522177788"
    )
  
[0m14:05:22.307508 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.309344 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:22.309818 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.310262 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:22.321106 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.322017 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:22.573377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e81facc-af3f-40c1-9437-12ec7c0c77b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2d213d10>]}
[0m14:05:22.574206 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.43s]
[0m14:05:22.575103 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:22.576520 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.577051 [debug] [MainThread]: On master: BEGIN
[0m14:05:22.577497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:22.582690 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.583171 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.583620 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.584056 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.584740 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.585206 [debug] [MainThread]: On master: Close
[0m14:05:22.586590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:22.587034 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:22.587448 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:22.587915 [info ] [MainThread]: 
[0m14:05:22.588523 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 15.88 seconds (15.88s).
[0m14:05:22.589687 [debug] [MainThread]: Command end result
[0m14:05:22.617528 [info ] [MainThread]: 
[0m14:05:22.618223 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:22.618834 [info ] [MainThread]: 
[0m14:05:22.619448 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:22.620541 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.78466, "process_user_time": 4.99577, "process_kernel_time": 0.302163, "process_mem_max_rss": "301276", "process_in_blocks": "1184", "process_out_blocks": "111104"}
[0m14:05:22.621230 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:22.621115 after 17.79 seconds
[0m14:05:22.621737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b593031a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b6143ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b607ad940>]}
[0m14:05:22.622234 [debug] [MainThread]: Flushing usage events
[0m14:05:24.512810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1379439a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1377871b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1377b5a000>]}


============================== 14:05:24.515544 | 4298eb82-a9bd-45ec-a90d-9f6828216673 ==============================
[0m14:05:24.515544 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:24.516263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:24.651375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4298eb82-a9bd-45ec-a90d-9f6828216673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1376ee3050>]}
[0m14:05:24.667929 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20356005, "process_user_time": 1.445003, "process_kernel_time": 0.080055, "process_mem_max_rss": "92092", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:24.668514 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:24.668411 after 0.20 seconds
[0m14:05:24.668993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1376f9b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f137742b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13779d67b0>]}
[0m14:05:24.669423 [debug] [MainThread]: Flushing usage events
[0m22:05:43.371536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9fd563bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9fcea0da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9fd5630b0>]}


============================== 22:05:43.389727 | 58550b28-8c83-452d-90f4-b5843ea10e2e ==============================
[0m22:05:43.389727 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:43.390405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:43.532070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58550b28-8c83-452d-90f4-b5843ea10e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9fe0fde80>]}
[0m22:05:43.545402 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-82ni67n5'
[0m22:05:43.545856 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:43.627938 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:43.628581 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:43.640387 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:43.644138 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:43.843365 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:43.843953 [info ] [MainThread]: Up to date!
[0m22:05:43.844494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '58550b28-8c83-452d-90f4-b5843ea10e2e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9fdd2e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9fc8b6000>]}
[0m22:05:43.854715 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.531643, "process_user_time": 1.549123, "process_kernel_time": 0.15017, "process_mem_max_rss": "93460", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m22:05:43.855312 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:43.855207 after 0.53 seconds
[0m22:05:43.855746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9fcbfba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9fcb622a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9fcfd33b0>]}
[0m22:05:43.856177 [debug] [MainThread]: Flushing usage events
[0m22:05:45.495046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad1358d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad2a550d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad106dbe0>]}


============================== 22:05:45.497984 | 9bf6d1b6-e69b-493f-91c3-73e29fdf0316 ==============================
[0m22:05:45.497984 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:45.498727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:45.737770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bf6d1b6-e69b-493f-91c3-73e29fdf0316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad03cc5c0>]}
[0m22:05:45.798241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bf6d1b6-e69b-493f-91c3-73e29fdf0316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad0a4c9b0>]}
[0m22:05:45.799106 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:45.825534 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:45.826277 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:45.826839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9bf6d1b6-e69b-493f-91c3-73e29fdf0316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad03ce1e0>]}
[0m22:05:47.050508 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:47.051203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9bf6d1b6-e69b-493f-91c3-73e29fdf0316', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac9bfa480>]}
[0m22:05:47.237261 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:47.242199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bf6d1b6-e69b-493f-91c3-73e29fdf0316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac9a11430>]}
[0m22:05:47.393796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bf6d1b6-e69b-493f-91c3-73e29fdf0316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad05ad0d0>]}
[0m22:05:47.394523 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:47.395218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bf6d1b6-e69b-493f-91c3-73e29fdf0316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac9797ef0>]}
[0m22:05:47.397284 [info ] [MainThread]: 
[0m22:05:47.397992 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:47.402699 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:47.437883 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:47.438405 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:47.438815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:48.045276 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:48.046843 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:48.048884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:48.049487 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:48.056189 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:48.056629 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:48.057026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:48.062582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:48.063909 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:48.064324 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:48.064846 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:48.065302 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:48.065692 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:48.066257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:48.067165 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:48.067573 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:48.067961 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:48.068533 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:48.069014 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:48.071100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:48.076415 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:48.076839 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:48.077269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:48.082210 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:48.082632 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:48.083038 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:48.103001 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:48.107667 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:48.108842 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:48.109302 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:48.112730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bf6d1b6-e69b-493f-91c3-73e29fdf0316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac97bbdd0>]}
[0m22:05:48.113284 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:48.113700 [debug] [MainThread]: On master: BEGIN
[0m22:05:48.114088 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:48.119194 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:48.119634 [debug] [MainThread]: On master: COMMIT
[0m22:05:48.120038 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:48.120430 [debug] [MainThread]: On master: COMMIT
[0m22:05:48.121062 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:48.121515 [debug] [MainThread]: On master: Close
[0m22:05:48.123069 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:48.123577 [info ] [MainThread]: 
[0m22:05:48.137517 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:48.138163 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:48.138865 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:48.139338 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:48.166861 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:48.167656 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:48.204862 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:48.205706 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:58.460573 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:58.461148 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:58.461955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:58.462448 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:58.462925 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:58.463627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:58.466538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:58.467035 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:58.467920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:58.490395 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:58.490913 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:58.491391 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:58.492901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:58.497973 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:58.498476 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:58.499769 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:58.502265 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:58.528980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf6d1b6-e69b-493f-91c3-73e29fdf0316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a9d5d7530>]}
[0m22:05:58.529762 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.39s]
[0m22:05:58.530674 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:58.531674 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:58.532278 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:58.532990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:58.533520 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:58.538608 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:58.539290 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:58.575879 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:58.576423 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240712220558569545"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:58.576927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:58.591126 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:58.598623 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:58.599122 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:58.599753 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:58.600236 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:58.600716 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240712220558569545'
      
      
      order by ordinal_position

  
[0m22:05:58.627659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:58.632896 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:58.633447 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:58.641995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:58.651029 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:58.651549 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:58.660126 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:58.679464 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:58.680164 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:58.680675 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240712220558569545"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240712220558569545"
    )
  
[0m22:05:58.696225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:58.698073 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:58.698557 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:58.699018 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:58.710175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:58.711094 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:58.950384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf6d1b6-e69b-493f-91c3-73e29fdf0316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a9d575c70>]}
[0m22:05:58.951257 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.42s]
[0m22:05:58.952154 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:58.953549 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:58.954045 [debug] [MainThread]: On master: BEGIN
[0m22:05:58.954497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:58.959861 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:58.960364 [debug] [MainThread]: On master: COMMIT
[0m22:05:58.960826 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:58.961307 [debug] [MainThread]: On master: COMMIT
[0m22:05:58.962007 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:58.962474 [debug] [MainThread]: On master: Close
[0m22:05:58.963886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:58.964343 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:58.964757 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:58.965267 [info ] [MainThread]: 
[0m22:05:58.965885 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.57 seconds (11.57s).
[0m22:05:58.967009 [debug] [MainThread]: Command end result
[0m22:05:58.995126 [info ] [MainThread]: 
[0m22:05:58.995845 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:58.996519 [info ] [MainThread]: 
[0m22:05:58.997176 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:58.998256 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.553344, "process_user_time": 5.094243, "process_kernel_time": 0.255711, "process_mem_max_rss": "300572", "process_in_blocks": "1184", "process_out_blocks": "111136"}
[0m22:05:58.998930 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:58.998819 after 13.55 seconds
[0m22:05:58.999428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad04b7c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad2abf8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac856eb70>]}
[0m22:05:58.999937 [debug] [MainThread]: Flushing usage events
[0m22:06:00.676422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54c135ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54c0b34470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54c03bdbe0>]}


============================== 22:06:00.679120 | 2777d0f7-7ac6-46d5-8342-d1b4acaa8dac ==============================
[0m22:06:00.679120 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:00.679785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:00.814919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2777d0f7-7ac6-46d5-8342-d1b4acaa8dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54c2791850>]}
[0m22:06:00.831037 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20326155, "process_user_time": 1.369089, "process_kernel_time": 0.127728, "process_mem_max_rss": "92104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:00.831617 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:00.831514 after 0.20 seconds
[0m22:06:00.832062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54c3fbbd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54c36e9c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54c1fde6c0>]}
[0m22:06:00.832507 [debug] [MainThread]: Flushing usage events
[0m06:01:52.273720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe011684dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe01192ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe011a17020>]}


============================== 06:01:52.281138 | 119151c7-951f-43a9-bc5c-d56650abe05e ==============================
[0m06:01:52.281138 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:01:52.281888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:01:52.418794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '119151c7-951f-43a9-bc5c-d56650abe05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0151bbd10>]}
[0m06:01:52.431933 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7fcg8abd'
[0m06:01:52.432458 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:01:52.686420 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:01:52.687177 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:01:52.722370 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:01:52.726281 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:01:53.085446 [info ] [MainThread]: Installed from version 1.2.0
[0m06:01:53.086029 [info ] [MainThread]: Up to date!
[0m06:01:53.086586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '119151c7-951f-43a9-bc5c-d56650abe05e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe012236900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe01119d040>]}
[0m06:01:53.096878 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.87152505, "process_user_time": 1.574095, "process_kernel_time": 0.100388, "process_mem_max_rss": "93472", "process_in_blocks": "5752", "process_out_blocks": "3840"}
[0m06:01:53.097546 [debug] [MainThread]: Command `dbt deps` succeeded at 06:01:53.097442 after 0.87 seconds
[0m06:01:53.097986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0125aef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0120c9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe011383320>]}
[0m06:01:53.098429 [debug] [MainThread]: Flushing usage events
[0m06:01:54.843208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178097a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177e403290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177f4b1b80>]}


============================== 06:01:54.845955 | 50237dde-f3a9-4548-a53c-1e55dfaf78f8 ==============================
[0m06:01:54.845955 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:01:54.846603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:01:55.066752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50237dde-f3a9-4548-a53c-1e55dfaf78f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177dfed1c0>]}
[0m06:01:55.125422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50237dde-f3a9-4548-a53c-1e55dfaf78f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177e147d40>]}
[0m06:01:55.126168 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:01:55.141120 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:01:55.141845 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:01:55.142402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '50237dde-f3a9-4548-a53c-1e55dfaf78f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177f7d3f50>]}
[0m06:01:56.354095 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:01:56.354789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '50237dde-f3a9-4548-a53c-1e55dfaf78f8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17771ec140>]}
[0m06:01:56.538897 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:01:56.543918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50237dde-f3a9-4548-a53c-1e55dfaf78f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1776d40bf0>]}
[0m06:01:56.670243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50237dde-f3a9-4548-a53c-1e55dfaf78f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1776fe3c80>]}
[0m06:01:56.670798 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:01:56.671304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50237dde-f3a9-4548-a53c-1e55dfaf78f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1776d40f20>]}
[0m06:01:56.672986 [info ] [MainThread]: 
[0m06:01:56.673670 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:01:56.678471 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:01:56.712564 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:01:56.713021 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:01:56.713429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:01:57.682930 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:01:57.684468 [debug] [ThreadPool]: On list_petro: Close
[0m06:01:57.686531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:01:57.687095 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:01:57.693765 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:01:57.694205 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:01:57.694604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:01:57.699974 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:01:57.701288 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:01:57.701696 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:01:57.702528 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:01:57.702932 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:01:57.703319 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:01:57.703875 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:01:57.704842 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:01:57.705255 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:01:57.705639 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:01:57.706284 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:01:57.706710 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:01:57.708622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:01:57.713739 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:01:57.714158 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:01:57.714541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:01:57.719497 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:01:57.719915 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:01:57.720371 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:01:57.740641 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:01:57.745399 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:01:57.746570 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:01:57.746989 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:01:57.750263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50237dde-f3a9-4548-a53c-1e55dfaf78f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1775bb1f40>]}
[0m06:01:57.750865 [debug] [MainThread]: Using duckdb connection "master"
[0m06:01:57.751267 [debug] [MainThread]: On master: BEGIN
[0m06:01:57.751664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:01:57.756758 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:01:57.757186 [debug] [MainThread]: On master: COMMIT
[0m06:01:57.757585 [debug] [MainThread]: Using duckdb connection "master"
[0m06:01:57.757965 [debug] [MainThread]: On master: COMMIT
[0m06:01:57.758595 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:01:57.759011 [debug] [MainThread]: On master: Close
[0m06:01:57.760692 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:01:57.761237 [info ] [MainThread]: 
[0m06:01:57.770613 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:01:57.771218 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:01:57.771948 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:01:57.772450 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:01:57.797965 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:01:57.798793 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:01:57.833048 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:01:57.833801 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:10.014977 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:10.015533 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:10.016187 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:10.016685 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:10.017139 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:10.017971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:10.020799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:10.021273 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:10.021973 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:10.042492 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:10.042984 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:10.043434 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:10.044642 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:10.049410 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:10.049894 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:10.051724 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:10.054087 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:10.082247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50237dde-f3a9-4548-a53c-1e55dfaf78f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1776fe1cd0>]}
[0m06:02:10.082962 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.31s]
[0m06:02:10.083742 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:10.084732 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:10.085309 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:10.085911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:10.086379 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:10.091159 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:10.091811 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:10.124987 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:10.125538 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240713060210119061"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:10.126022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:10.142195 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:10.149254 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:10.149733 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:10.150328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:10.150792 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:10.151252 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240713060210119061'
      
      
      order by ordinal_position

  
[0m06:02:10.177732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:10.182635 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:10.183124 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:10.197407 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:10.205806 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:10.206296 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:10.215292 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:10.233164 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:10.233854 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:10.234337 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240713060210119061"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240713060210119061"
    )
  
[0m06:02:10.250190 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:10.251954 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:10.252442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:10.252904 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:10.264894 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:10.265827 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:10.460587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50237dde-f3a9-4548-a53c-1e55dfaf78f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1746c46030>]}
[0m06:02:10.461420 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m06:02:10.462189 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:10.463682 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.464164 [debug] [MainThread]: On master: BEGIN
[0m06:02:10.464661 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:10.469998 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.470482 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.470929 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.471363 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.472044 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.472560 [debug] [MainThread]: On master: Close
[0m06:02:10.473925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:10.474372 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:10.474786 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:10.475255 [info ] [MainThread]: 
[0m06:02:10.475811 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.80 seconds (13.80s).
[0m06:02:10.476937 [debug] [MainThread]: Command end result
[0m06:02:10.504362 [info ] [MainThread]: 
[0m06:02:10.504998 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:10.505543 [info ] [MainThread]: 
[0m06:02:10.506098 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:10.507097 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.712112, "process_user_time": 4.827211, "process_kernel_time": 0.254482, "process_mem_max_rss": "287752", "process_in_blocks": "1184", "process_out_blocks": "111624"}
[0m06:02:10.507736 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:10.507626 after 15.71 seconds
[0m06:02:10.508226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f178097a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177e76d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1746baa390>]}
[0m06:02:10.508754 [debug] [MainThread]: Flushing usage events
[0m06:02:12.306618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c433bb6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c419e7680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c419e6c00>]}


============================== 06:02:12.309345 | 40fb6fa9-1de1-4902-8126-52878e7e8e22 ==============================
[0m06:02:12.309345 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.310067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.445720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40fb6fa9-1de1-4902-8126-52878e7e8e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4143c5c0>]}
[0m06:02:12.462830 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2047087, "process_user_time": 1.37327, "process_kernel_time": 0.123753, "process_mem_max_rss": "92092", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:12.463632 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:12.463495 after 0.21 seconds
[0m06:02:12.464125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c433bb6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4190b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4154fa70>]}
[0m06:02:12.464669 [debug] [MainThread]: Flushing usage events
[0m14:04:41.191404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad0097b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbacecb6240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaced0b380>]}


============================== 14:04:41.199247 | 44d0a995-886a-4646-86a4-91fdd905dc8c ==============================
[0m14:04:41.199247 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:41.199968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:41.336465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44d0a995-886a-4646-86a4-91fdd905dc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbace7b6ae0>]}
[0m14:04:41.349858 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-h8zxb7d8'
[0m14:04:41.350320 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:41.440805 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:41.441452 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:41.466554 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:41.470304 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:41.541523 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:41.542039 [info ] [MainThread]: Up to date!
[0m14:04:41.542566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '44d0a995-886a-4646-86a4-91fdd905dc8c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbacec08680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbace0e6f90>]}
[0m14:04:41.553387 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40957704, "process_user_time": 1.56124, "process_kernel_time": 0.119482, "process_mem_max_rss": "93440", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m14:04:41.554007 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:41.553904 after 0.41 seconds
[0m14:04:41.554447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbacf126d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbace8eb5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbace496090>]}
[0m14:04:41.554882 [debug] [MainThread]: Flushing usage events
[0m14:04:43.146347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ccdd3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cd0ab110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ccdd3380>]}


============================== 14:04:43.149131 | b831ca6a-5a4a-45a8-912a-ab533034e425 ==============================
[0m14:04:43.149131 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:43.149836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:43.372299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b831ca6a-5a4a-45a8-912a-ab533034e425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cd1fbd40>]}
[0m14:04:43.431310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b831ca6a-5a4a-45a8-912a-ab533034e425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ccbc6de0>]}
[0m14:04:43.432117 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:43.447850 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:43.448625 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:43.449176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b831ca6a-5a4a-45a8-912a-ab533034e425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c634d070>]}
[0m14:04:44.663599 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:44.664268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b831ca6a-5a4a-45a8-912a-ab533034e425', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c61c0bc0>]}
[0m14:04:44.844396 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:44.849465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b831ca6a-5a4a-45a8-912a-ab533034e425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c5ff43b0>]}
[0m14:04:44.973920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b831ca6a-5a4a-45a8-912a-ab533034e425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c603ecc0>]}
[0m14:04:44.974489 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:44.975020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b831ca6a-5a4a-45a8-912a-ab533034e425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c5e41d00>]}
[0m14:04:44.976750 [info ] [MainThread]: 
[0m14:04:44.977484 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:44.982216 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:45.017798 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:45.018353 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:45.018797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:45.543615 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:45.545185 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:45.547357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:45.547952 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:45.554770 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:45.555217 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:45.555622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:45.561144 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:45.562482 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:45.562893 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:45.563425 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:45.563831 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:45.564221 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:45.565032 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:45.565973 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:45.566378 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:45.566763 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:45.567289 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:45.567704 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:45.569666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:45.575008 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:45.575434 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:45.575818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:45.580816 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:45.581246 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:45.581653 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:45.601590 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:45.606413 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:45.607587 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:45.608005 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:45.610980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b831ca6a-5a4a-45a8-912a-ab533034e425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c63f8dd0>]}
[0m14:04:45.611516 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:45.611920 [debug] [MainThread]: On master: BEGIN
[0m14:04:45.612296 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:45.617517 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:45.617951 [debug] [MainThread]: On master: COMMIT
[0m14:04:45.618348 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:45.618730 [debug] [MainThread]: On master: COMMIT
[0m14:04:45.619367 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:45.619782 [debug] [MainThread]: On master: Close
[0m14:04:45.621320 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:45.621828 [info ] [MainThread]: 
[0m14:04:45.631214 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:45.631825 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:45.632538 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:45.632996 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:45.658438 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:45.659179 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:45.692897 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:45.693630 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:53.517023 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:53.517555 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:04:53.518233 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.518702 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:53.519150 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:04:53.520021 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.522723 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:53.523191 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:04:53.523882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.544465 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:53.544965 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:53.545423 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:53.546916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.551707 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:53.552191 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:04:53.553395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.555713 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:04:53.581024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b831ca6a-5a4a-45a8-912a-ab533034e425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c4c359a0>]}
[0m14:04:53.581774 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.95s]
[0m14:04:53.582568 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:04:53.583555 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:04:53.584125 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:04:53.584753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:04:53.585219 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:04:53.590152 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:04:53.590809 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:04:53.623916 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:53.624464 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240713140453618113"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:04:53.624951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:53.640837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.647862 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:53.648361 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:04:53.649067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.649536 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:53.649984 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240713140453618113'
      
      
      order by ordinal_position

  
[0m14:04:53.676482 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.681405 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:53.681898 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:53.696123 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.704722 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:53.705225 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:53.713951 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.731848 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:04:53.732586 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:53.733081 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240713140453618113"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240713140453618113"
    )
  
[0m14:04:53.749143 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.750917 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:53.751392 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:53.751835 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:53.761029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.761945 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:04:53.796330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b831ca6a-5a4a-45a8-912a-ab533034e425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9499d348c0>]}
[0m14:04:53.797131 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.21s]
[0m14:04:53.797898 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:04:53.799373 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:53.799852 [debug] [MainThread]: On master: BEGIN
[0m14:04:53.800299 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:53.805727 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:53.806218 [debug] [MainThread]: On master: COMMIT
[0m14:04:53.806663 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:53.807098 [debug] [MainThread]: On master: COMMIT
[0m14:04:53.807783 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:53.808245 [debug] [MainThread]: On master: Close
[0m14:04:53.809841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:53.810293 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:04:53.810700 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:04:53.811166 [info ] [MainThread]: 
[0m14:04:53.811772 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.83 seconds (8.83s).
[0m14:04:53.812925 [debug] [MainThread]: Command end result
[0m14:04:53.840860 [info ] [MainThread]: 
[0m14:04:53.841556 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:53.842161 [info ] [MainThread]: 
[0m14:04:53.842767 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:53.843847 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.746037, "process_user_time": 4.68773, "process_kernel_time": 0.235986, "process_mem_max_rss": "271740", "process_in_blocks": "1184", "process_out_blocks": "102904"}
[0m14:04:53.844526 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:53.844381 after 10.75 seconds
[0m14:04:53.845025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cd933c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cd759160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9499ca1970>]}
[0m14:04:53.845519 [debug] [MainThread]: Flushing usage events
[0m14:04:55.493611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e270bad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e26f7f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e267e3110>]}


============================== 14:04:55.496454 | 2ad7fb7b-7502-4535-bdbc-30cf7fbd4bc4 ==============================
[0m14:04:55.496454 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:55.497189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:55.635075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ad7fb7b-7502-4535-bdbc-30cf7fbd4bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e26599970>]}
[0m14:04:55.651696 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2071007, "process_user_time": 1.385222, "process_kernel_time": 0.128113, "process_mem_max_rss": "92012", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:04:55.652306 [debug] [MainThread]: Command `dbt clean` succeeded at 14:04:55.652198 after 0.21 seconds
[0m14:04:55.652798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e268edbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e26491070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e265c5610>]}
[0m14:04:55.653234 [debug] [MainThread]: Flushing usage events
[0m22:05:26.676077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0adb771a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ad9c1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ad9c1280>]}


============================== 22:05:26.693491 | 3469819e-bb12-40bb-b1b3-b5615fff0150 ==============================
[0m22:05:26.693491 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:26.694153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:26.834514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3469819e-bb12-40bb-b1b3-b5615fff0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ad6951c0>]}
[0m22:05:26.847737 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_53ari93'
[0m22:05:26.848199 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:26.943096 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:26.943725 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:26.955033 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:26.958751 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:27.176266 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:27.176828 [info ] [MainThread]: Up to date!
[0m22:05:27.177467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3469819e-bb12-40bb-b1b3-b5615fff0150', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0acf49790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0acefb980>]}
[0m22:05:27.187292 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.55932736, "process_user_time": 1.574711, "process_kernel_time": 0.144248, "process_mem_max_rss": "93464", "process_in_blocks": "5752", "process_out_blocks": "3840"}
[0m22:05:27.187947 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:27.187843 after 0.56 seconds
[0m22:05:27.188389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0adb771a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ad0b8230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0adaed280>]}
[0m22:05:27.188832 [debug] [MainThread]: Flushing usage events
[0m22:05:28.951547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860dca12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860e0ca000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860dca0a10>]}


============================== 22:05:28.954298 | 43675a73-85b6-4a94-89ad-b50d36e41155 ==============================
[0m22:05:28.954298 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:28.955035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:29.179177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43675a73-85b6-4a94-89ad-b50d36e41155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860db5bb30>]}
[0m22:05:29.238388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43675a73-85b6-4a94-89ad-b50d36e41155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860ec29d00>]}
[0m22:05:29.239146 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:29.267462 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:29.268191 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:29.268745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '43675a73-85b6-4a94-89ad-b50d36e41155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860dac5670>]}
[0m22:05:30.483467 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:30.484119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '43675a73-85b6-4a94-89ad-b50d36e41155', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86071ca480>]}
[0m22:05:30.665760 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:30.670673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43675a73-85b6-4a94-89ad-b50d36e41155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8606e52240>]}
[0m22:05:30.791386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43675a73-85b6-4a94-89ad-b50d36e41155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8606d05310>]}
[0m22:05:30.791940 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:30.792428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43675a73-85b6-4a94-89ad-b50d36e41155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8606d60890>]}
[0m22:05:30.794159 [info ] [MainThread]: 
[0m22:05:30.794864 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:30.799656 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:30.834314 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:30.834769 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:30.835178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:31.361477 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:31.363059 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:31.365419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:31.366004 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:31.372842 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:31.373330 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:31.373751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:31.379122 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:31.380452 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:31.380868 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:31.381734 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:31.382147 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:31.382541 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:31.383186 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:31.384145 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:31.384561 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:31.384955 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:31.385541 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:31.385960 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:31.388058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:31.393355 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:31.393779 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:31.394160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:31.399140 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:31.399567 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:31.399977 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:31.419715 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:31.424709 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:31.426444 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:31.427016 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:31.431007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43675a73-85b6-4a94-89ad-b50d36e41155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8611171730>]}
[0m22:05:31.431530 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:31.431933 [debug] [MainThread]: On master: BEGIN
[0m22:05:31.432312 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:31.437514 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:31.437955 [debug] [MainThread]: On master: COMMIT
[0m22:05:31.438357 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:31.438744 [debug] [MainThread]: On master: COMMIT
[0m22:05:31.439374 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:31.439790 [debug] [MainThread]: On master: Close
[0m22:05:31.441229 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:31.441777 [info ] [MainThread]: 
[0m22:05:31.450915 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:31.451529 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:31.452197 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:31.452653 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:31.477836 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:31.478578 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:31.512162 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:31.512898 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:42.826106 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.826638 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:42.827436 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.827911 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.828354 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:42.829053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.831714 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.832179 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:42.832906 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.853363 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:42.853858 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.854306 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:42.856247 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.860934 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.861434 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:42.862823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.865130 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:42.890956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43675a73-85b6-4a94-89ad-b50d36e41155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fcf27470>]}
[0m22:05:42.891669 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.44s]
[0m22:05:42.892571 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:42.893600 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:42.894174 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:42.894833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:42.895304 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:42.900032 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:42.900688 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:42.933541 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.934054 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240713220542927656"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:42.934530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:42.948921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.955850 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.956327 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:42.956912 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.957404 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.957860 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240713220542927656'
      
      
      order by ordinal_position

  
[0m22:05:42.983567 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.988362 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.988857 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:42.997339 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:43.005744 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:43.006235 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:43.014590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:43.032389 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:43.033080 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:43.033599 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240713220542927656"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240713220542927656"
    )
  
[0m22:05:43.052712 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:43.054601 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:43.055071 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:43.055513 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:43.064178 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:43.065091 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:43.108150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43675a73-85b6-4a94-89ad-b50d36e41155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85dac11460>]}
[0m22:05:43.108896 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.21s]
[0m22:05:43.109800 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:43.111291 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:43.111790 [debug] [MainThread]: On master: BEGIN
[0m22:05:43.112234 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:43.117704 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:43.118185 [debug] [MainThread]: On master: COMMIT
[0m22:05:43.118637 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:43.119072 [debug] [MainThread]: On master: COMMIT
[0m22:05:43.119633 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:43.120094 [debug] [MainThread]: On master: Close
[0m22:05:43.121643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:43.122090 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:43.122505 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:43.122976 [info ] [MainThread]: 
[0m22:05:43.123531 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.33 seconds (12.33s).
[0m22:05:43.124578 [debug] [MainThread]: Command end result
[0m22:05:43.152465 [info ] [MainThread]: 
[0m22:05:43.153157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:43.153785 [info ] [MainThread]: 
[0m22:05:43.154406 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:43.155489 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.25266, "process_user_time": 4.617845, "process_kernel_time": 0.306529, "process_mem_max_rss": "275208", "process_in_blocks": "1184", "process_out_blocks": "102936"}
[0m22:05:43.156147 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:43.156036 after 14.25 seconds
[0m22:05:43.156650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860de8f2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85ec1a6240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85dac5ba40>]}
[0m22:05:43.157149 [debug] [MainThread]: Flushing usage events
[0m22:05:45.046506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89ddd129f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89ddd13770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89ddd11940>]}


============================== 22:05:45.049572 | 47e14acd-5a08-4138-bc31-ac38e1504c6c ==============================
[0m22:05:45.049572 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:45.050234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:45.197367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47e14acd-5a08-4138-bc31-ac38e1504c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89dd353050>]}
[0m22:05:45.213886 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21668036, "process_user_time": 1.363596, "process_kernel_time": 0.151955, "process_mem_max_rss": "92100", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:45.214493 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:45.214379 after 0.22 seconds
[0m22:05:45.214941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89dd835ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89dd352c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89e0dbbd40>]}
[0m22:05:45.215377 [debug] [MainThread]: Flushing usage events
[0m06:02:44.542781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd47136a9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd470a37740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd471083bf0>]}


============================== 06:02:44.577882 | 20b4c1f6-f768-4c8e-804a-42fe937c77a0 ==============================
[0m06:02:44.577882 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:44.578676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:44.736759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20b4c1f6-f768-4c8e-804a-42fe937c77a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd47043cda0>]}
[0m06:02:44.751445 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3ae3h8_2'
[0m06:02:44.752000 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:44.888577 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:44.889442 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:44.935871 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:44.939971 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:45.012734 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:45.013370 [info ] [MainThread]: Up to date!
[0m06:02:45.013965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '20b4c1f6-f768-4c8e-804a-42fe937c77a0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4703705f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4715311c0>]}
[0m06:02:45.025244 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.53182745, "process_user_time": 1.645237, "process_kernel_time": 0.152485, "process_mem_max_rss": "93484", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m06:02:45.025922 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:45.025807 after 0.53 seconds
[0m06:02:45.026390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd473fbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd471ce5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd470777170>]}
[0m06:02:45.026919 [debug] [MainThread]: Flushing usage events
[0m06:02:46.692516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dae74b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6daeb131a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dae74b4a0>]}


============================== 06:02:46.695580 | cfd14791-1c5a-48af-89e6-5a8fde6f3f2d ==============================
[0m06:02:46.695580 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:46.696255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:46.954360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfd14791-1c5a-48af-89e6-5a8fde6f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dae5428d0>]}
[0m06:02:47.015617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfd14791-1c5a-48af-89e6-5a8fde6f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6daf17e930>]}
[0m06:02:47.016555 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:47.078503 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:47.079333 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:47.079887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cfd14791-1c5a-48af-89e6-5a8fde6f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dae7fef60>]}
[0m06:02:48.321815 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:48.322596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cfd14791-1c5a-48af-89e6-5a8fde6f3f2d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da7a0d310>]}
[0m06:02:48.508342 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:48.513766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfd14791-1c5a-48af-89e6-5a8fde6f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da79217f0>]}
[0m06:02:48.659220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfd14791-1c5a-48af-89e6-5a8fde6f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da79f2f30>]}
[0m06:02:48.659833 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:48.660379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfd14791-1c5a-48af-89e6-5a8fde6f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da7740ec0>]}
[0m06:02:48.662188 [info ] [MainThread]: 
[0m06:02:48.662979 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:48.668230 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:48.706732 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:48.707266 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:48.707684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:49.193014 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:49.194669 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:49.196866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:49.197449 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:49.204385 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:49.204856 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:49.205264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:49.211307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:49.212854 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:49.213290 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:49.213974 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:49.214389 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:49.214851 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:49.215455 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:49.216408 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:49.216827 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:49.217226 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:49.217879 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:49.218328 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:49.220976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:49.226627 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:49.227073 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:49.227466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:49.232908 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:49.233360 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:49.233782 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:49.253639 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:49.258381 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:49.259696 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:49.260128 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:49.264176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfd14791-1c5a-48af-89e6-5a8fde6f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da77a06b0>]}
[0m06:02:49.264715 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:49.265120 [debug] [MainThread]: On master: BEGIN
[0m06:02:49.265496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:49.270925 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:49.271380 [debug] [MainThread]: On master: COMMIT
[0m06:02:49.271777 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:49.272160 [debug] [MainThread]: On master: COMMIT
[0m06:02:49.272790 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:49.273210 [debug] [MainThread]: On master: Close
[0m06:02:49.275026 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:49.275551 [info ] [MainThread]: 
[0m06:02:49.315283 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:49.315993 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:49.316719 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:49.317181 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:49.344024 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:49.344943 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:49.380192 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:49.381108 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:58.329336 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:58.329923 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:58.330673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.331141 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:58.331596 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:58.332541 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.335547 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:58.336028 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:58.336764 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.357888 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:58.358520 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:58.358990 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:58.360496 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.365648 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:58.366154 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:58.368286 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.370840 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:58.397416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfd14791-1c5a-48af-89e6-5a8fde6f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d7759ff80>]}
[0m06:02:58.398307 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.08s]
[0m06:02:58.399171 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:58.400207 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:58.400807 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:58.401464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:58.401940 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:58.407371 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:58.408130 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:58.442852 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:58.443489 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240714060258436736"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:58.443993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:58.460553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.468417 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:58.468992 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:58.469879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.470351 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:58.470851 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240714060258436736'
      
      
      order by ordinal_position

  
[0m06:02:58.497353 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.503285 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:58.503849 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:58.512533 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.522259 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:58.522841 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:58.531823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.550671 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:58.551540 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:58.552040 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240714060258436736"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240714060258436736"
    )
  
[0m06:02:58.570082 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.572252 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:58.572743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:58.573195 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:58.582441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:58.583443 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:58.633666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfd14791-1c5a-48af-89e6-5a8fde6f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d776326f0>]}
[0m06:02:58.634590 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.23s]
[0m06:02:58.635388 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:58.636961 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:58.637447 [debug] [MainThread]: On master: BEGIN
[0m06:02:58.637888 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:58.643554 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:58.644113 [debug] [MainThread]: On master: COMMIT
[0m06:02:58.644567 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:58.645014 [debug] [MainThread]: On master: COMMIT
[0m06:02:58.645728 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:58.646210 [debug] [MainThread]: On master: Close
[0m06:02:58.648214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:58.648700 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:58.649125 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:58.649626 [info ] [MainThread]: 
[0m06:02:58.650196 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.99 seconds (9.99s).
[0m06:02:58.651301 [debug] [MainThread]: Command end result
[0m06:02:58.680783 [info ] [MainThread]: 
[0m06:02:58.681497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:58.682023 [info ] [MainThread]: 
[0m06:02:58.682620 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:58.683681 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.041633, "process_user_time": 4.87836, "process_kernel_time": 0.302657, "process_mem_max_rss": "287104", "process_in_blocks": "1184", "process_out_blocks": "103264"}
[0m06:02:58.684346 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:58.684231 after 12.04 seconds
[0m06:02:58.684864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dae822330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6daeb6d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d775f2540>]}
[0m06:02:58.685363 [debug] [MainThread]: Flushing usage events
[0m06:03:00.516609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dfdf0b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dfef572f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dfead8350>]}


============================== 06:03:00.519621 | e569699e-6167-4947-af45-1aff91d561db ==============================
[0m06:03:00.519621 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:00.520337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:03:00.673365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e569699e-6167-4947-af45-1aff91d561db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dfde29640>]}
[0m06:03:00.690273 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22363819, "process_user_time": 1.484253, "process_kernel_time": 0.100017, "process_mem_max_rss": "92232", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:03:00.690917 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:00.690809 after 0.22 seconds
[0m06:03:00.691381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dfe287770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dfdcf37a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dfde29640>]}
[0m06:03:00.691833 [debug] [MainThread]: Flushing usage events
[0m14:10:10.126242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33fa3ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33e90c2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33e90c110>]}


============================== 14:10:10.175406 | 784ac148-ef04-4407-bc5c-6a7b4cd48eb8 ==============================
[0m14:10:10.175406 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:10.176141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:10:10.312210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '784ac148-ef04-4407-bc5c-6a7b4cd48eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33eb0ce90>]}
[0m14:10:10.325400 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-eqc___49'
[0m14:10:10.325919 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:10:10.382639 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:10:10.383249 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:10:10.393574 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:10:10.397306 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:10:10.449929 [info ] [MainThread]: Installed from version 1.2.0
[0m14:10:10.450488 [info ] [MainThread]: Up to date!
[0m14:10:10.451064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '784ac148-ef04-4407-bc5c-6a7b4cd48eb8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33edab170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33e6708f0>]}
[0m14:10:10.487128 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40952185, "process_user_time": 1.546331, "process_kernel_time": 0.143844, "process_mem_max_rss": "93388", "process_in_blocks": "5752", "process_out_blocks": "3840"}
[0m14:10:10.487762 [debug] [MainThread]: Command `dbt deps` succeeded at 14:10:10.487642 after 0.41 seconds
[0m14:10:10.488208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3425bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33ed3d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb33e77f530>]}
[0m14:10:10.488649 [debug] [MainThread]: Flushing usage events
[0m14:10:12.025649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd47f185580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd47e54eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd47e912270>]}


============================== 14:10:12.028408 | da94ab27-4f2b-4552-a460-3a2106099f80 ==============================
[0m14:10:12.028408 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:12.029137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:10:12.252392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da94ab27-4f2b-4552-a460-3a2106099f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd47e1ee330>]}
[0m14:10:12.311628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da94ab27-4f2b-4552-a460-3a2106099f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd47e1eeba0>]}
[0m14:10:12.312378 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:10:12.327811 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:10:12.328541 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:10:12.329083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'da94ab27-4f2b-4552-a460-3a2106099f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd47f67d070>]}
[0m14:10:13.549140 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:10:13.549831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'da94ab27-4f2b-4552-a460-3a2106099f80', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd47f437d40>]}
[0m14:10:13.730200 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:10:13.734993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da94ab27-4f2b-4552-a460-3a2106099f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd476f40710>]}
[0m14:10:13.856609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da94ab27-4f2b-4552-a460-3a2106099f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd476f43050>]}
[0m14:10:13.857186 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:10:13.857684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da94ab27-4f2b-4552-a460-3a2106099f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4770eb5f0>]}
[0m14:10:13.859387 [info ] [MainThread]: 
[0m14:10:13.860086 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:10:13.864993 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:10:13.899570 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:10:13.900033 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:10:13.900437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:14.401557 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:10:14.403115 [debug] [ThreadPool]: On list_petro: Close
[0m14:10:14.405285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:10:14.405881 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:10:14.412601 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:10:14.413051 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:10:14.413449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:14.418818 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:14.420126 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:10:14.420540 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:10:14.421166 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:14.421573 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:10:14.422012 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:10:14.422645 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:14.423561 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:10:14.423982 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:10:14.424374 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:10:14.424909 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:14.425324 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:10:14.427315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:10:14.432514 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:10:14.432936 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:10:14.433318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:14.438337 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:14.438760 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:10:14.439193 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:10:14.459296 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:14.463986 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:10:14.465198 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:10:14.465616 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:10:14.468923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da94ab27-4f2b-4552-a460-3a2106099f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd477010e90>]}
[0m14:10:14.469455 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:14.469890 [debug] [MainThread]: On master: BEGIN
[0m14:10:14.470293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:14.475520 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:14.475966 [debug] [MainThread]: On master: COMMIT
[0m14:10:14.476395 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:14.476795 [debug] [MainThread]: On master: COMMIT
[0m14:10:14.477443 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:14.477889 [debug] [MainThread]: On master: Close
[0m14:10:14.479551 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:10:14.480043 [info ] [MainThread]: 
[0m14:10:14.490168 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:10:14.490839 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:10:14.491516 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:10:14.491977 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:10:14.517509 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:10:14.518299 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:10:14.552601 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:10:14.553352 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:10:24.168005 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:24.168556 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:24.169348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:24.169829 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:24.170328 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:24.171031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:24.173713 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:24.174230 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:24.174954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:24.195553 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:24.196058 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:24.196515 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:24.197873 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:24.202673 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:24.203165 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:24.204757 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:24.207114 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:24.233685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da94ab27-4f2b-4552-a460-3a2106099f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4771f1370>]}
[0m14:10:24.234510 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.74s]
[0m14:10:24.235408 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:24.236419 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:24.236989 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:24.237662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:24.238173 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:24.243148 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:24.243820 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:24.277174 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:24.277709 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240714141024271276"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:24.278229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:24.292989 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:24.299933 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:24.300414 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:24.301008 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:24.301475 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:24.301960 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240714141024271276'
      
      
      order by ordinal_position

  
[0m14:10:24.328775 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:24.333653 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:24.334178 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:10:24.348718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:24.357286 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:24.357804 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:10:24.366404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:24.384446 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:24.385149 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:24.385636 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240714141024271276"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240714141024271276"
    )
  
[0m14:10:24.403542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:24.405353 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:24.405832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:24.406321 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:24.413971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:24.414873 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:24.466161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da94ab27-4f2b-4552-a460-3a2106099f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd446e55df0>]}
[0m14:10:24.466892 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.23s]
[0m14:10:24.467686 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:24.469156 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:24.469639 [debug] [MainThread]: On master: BEGIN
[0m14:10:24.470131 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:24.475395 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:24.475877 [debug] [MainThread]: On master: COMMIT
[0m14:10:24.476344 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:24.476781 [debug] [MainThread]: On master: COMMIT
[0m14:10:24.477477 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:24.477990 [debug] [MainThread]: On master: Close
[0m14:10:24.479469 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:24.479935 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:10:24.480350 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:24.480814 [info ] [MainThread]: 
[0m14:10:24.481371 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.62 seconds (10.62s).
[0m14:10:24.482441 [debug] [MainThread]: Command end result
[0m14:10:24.510500 [info ] [MainThread]: 
[0m14:10:24.511111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:24.511632 [info ] [MainThread]: 
[0m14:10:24.512162 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:24.513168 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.5370245, "process_user_time": 4.577027, "process_kernel_time": 0.342878, "process_mem_max_rss": "268016", "process_in_blocks": "1184", "process_out_blocks": "103936"}
[0m14:10:24.513810 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:24.513701 after 12.54 seconds
[0m14:10:24.514350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd47e26d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd446e0e960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd446e0f2f0>]}
[0m14:10:24.514842 [debug] [MainThread]: Flushing usage events
[0m14:10:26.153103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd31aae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd29003b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd32255e0>]}


============================== 14:10:26.155822 | f628689a-8dd6-46de-8261-b16d0dfca030 ==============================
[0m14:10:26.155822 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:26.156503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:10:26.297297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f628689a-8dd6-46de-8261-b16d0dfca030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd33bc770>]}
[0m14:10:26.313838 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20942815, "process_user_time": 1.420178, "process_kernel_time": 0.096012, "process_mem_max_rss": "92232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:26.314476 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:26.314358 after 0.21 seconds
[0m14:10:26.314928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd33e39b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd2294290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd27b7c80>]}
[0m14:10:26.315368 [debug] [MainThread]: Flushing usage events
[0m22:05:19.383257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35db35b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35d9a03b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35db37800>]}


============================== 22:05:19.390423 | 4133a59f-0ff5-4aa0-a2cb-d1e890170725 ==============================
[0m22:05:19.390423 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:19.391162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:19.532259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4133a59f-0ff5-4aa0-a2cb-d1e890170725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35cfe3bf0>]}
[0m22:05:19.545678 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ykiivivl'
[0m22:05:19.546135 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:19.593465 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:19.594125 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:19.607900 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:19.611587 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:19.816108 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:19.816706 [info ] [MainThread]: Up to date!
[0m22:05:19.817325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4133a59f-0ff5-4aa0-a2cb-d1e890170725', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35dae2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35d741bb0>]}
[0m22:05:19.818978 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48355323, "process_user_time": 1.536753, "process_kernel_time": 0.16323, "process_mem_max_rss": "93356", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m22:05:19.819576 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:19.819470 after 0.48 seconds
[0m22:05:19.820055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35d9a03b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35dae2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35e527470>]}
[0m22:05:19.820488 [debug] [MainThread]: Flushing usage events
[0m22:05:21.635887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee0a93440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee2dc9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee0b6b1a0>]}


============================== 22:05:21.638624 | 66f1395e-e428-4480-8ee8-9f24af22b864 ==============================
[0m22:05:21.638624 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:21.639358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:21.863507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66f1395e-e428-4480-8ee8-9f24af22b864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed9f64e90>]}
[0m22:05:21.922674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66f1395e-e428-4480-8ee8-9f24af22b864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed9f64e90>]}
[0m22:05:21.923535 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:21.939139 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:21.939900 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:21.940459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '66f1395e-e428-4480-8ee8-9f24af22b864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee09ffd10>]}
[0m22:05:23.154664 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:23.155300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '66f1395e-e428-4480-8ee8-9f24af22b864', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed9c77230>]}
[0m22:05:23.335550 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:23.341863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66f1395e-e428-4480-8ee8-9f24af22b864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed9acb8f0>]}
[0m22:05:23.463561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66f1395e-e428-4480-8ee8-9f24af22b864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed9b2c290>]}
[0m22:05:23.464150 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:23.464649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66f1395e-e428-4480-8ee8-9f24af22b864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed9b118e0>]}
[0m22:05:23.466327 [info ] [MainThread]: 
[0m22:05:23.466971 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:23.471776 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:23.506422 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:23.506872 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:23.507279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:24.092361 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:24.093933 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:24.096219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:24.096808 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:24.103721 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.104211 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:24.104628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.110107 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.111448 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.111898 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:24.112747 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.113153 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.113542 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:24.114177 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.115116 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.115527 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.115965 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.116522 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.116939 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:24.119115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:24.124499 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.124925 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:24.125309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.130277 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.130708 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.131114 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:24.151306 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.156104 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:24.157300 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:24.157719 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:24.160968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66f1395e-e428-4480-8ee8-9f24af22b864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed9bf0650>]}
[0m22:05:24.161495 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.161891 [debug] [MainThread]: On master: BEGIN
[0m22:05:24.162266 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:24.167434 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.167899 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.168300 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.168682 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.169307 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.169717 [debug] [MainThread]: On master: Close
[0m22:05:24.171292 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:24.171801 [info ] [MainThread]: 
[0m22:05:24.180842 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:24.181461 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:24.182092 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:24.182539 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:24.208077 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:24.208831 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:24.242723 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:24.243456 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:35.917513 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.918043 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:35.918890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.919355 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.919798 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:35.920540 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.923228 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.923692 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:35.924413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.945019 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:35.945526 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.945969 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:35.947419 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.952212 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.952694 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:35.953899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.956274 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:35.982056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66f1395e-e428-4480-8ee8-9f24af22b864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ead977620>]}
[0m22:05:35.982807 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.80s]
[0m22:05:35.983695 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:35.984745 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:35.985318 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:35.985990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:35.986462 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:35.991474 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:35.992164 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:36.025351 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:36.025866 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240714220536019512"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:36.026353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:36.040424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.047413 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:36.047912 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:36.048523 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.048983 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:36.049427 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240714220536019512'
      
      
      order by ordinal_position

  
[0m22:05:36.075804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.080775 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:36.081262 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:36.089844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.098470 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:36.098968 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:36.108042 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.126014 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:36.126708 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:36.127184 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240714220536019512"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240714220536019512"
    )
  
[0m22:05:36.145604 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.147395 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:36.147917 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:36.148373 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:36.157119 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.158008 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:36.217117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66f1395e-e428-4480-8ee8-9f24af22b864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ead95c3b0>]}
[0m22:05:36.217936 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.23s]
[0m22:05:36.218825 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:36.220221 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:36.220726 [debug] [MainThread]: On master: BEGIN
[0m22:05:36.221171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:36.226541 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:36.227019 [debug] [MainThread]: On master: COMMIT
[0m22:05:36.227466 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:36.227937 [debug] [MainThread]: On master: COMMIT
[0m22:05:36.228641 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:36.229107 [debug] [MainThread]: On master: Close
[0m22:05:36.230635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:36.231078 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:36.231490 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:36.232011 [info ] [MainThread]: 
[0m22:05:36.232560 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.77 seconds (12.77s).
[0m22:05:36.233605 [debug] [MainThread]: Command end result
[0m22:05:36.261316 [info ] [MainThread]: 
[0m22:05:36.261951 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:36.262461 [info ] [MainThread]: 
[0m22:05:36.262984 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:36.264001 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.676743, "process_user_time": 4.676128, "process_kernel_time": 0.299495, "process_mem_max_rss": "278812", "process_in_blocks": "1184", "process_out_blocks": "103968"}
[0m22:05:36.264643 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:36.264534 after 14.68 seconds
[0m22:05:36.265137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee2dc9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee203f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ead9997f0>]}
[0m22:05:36.265622 [debug] [MainThread]: Flushing usage events
[0m22:05:38.188321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa346801100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa346ad2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3472d7680>]}


============================== 22:05:38.191100 | da8e205b-e875-4fca-b0d0-ce1bf1719a09 ==============================
[0m22:05:38.191100 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:38.191821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:38.327352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da8e205b-e875-4fca-b0d0-ce1bf1719a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa347e1b8c0>]}
[0m22:05:38.344050 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20427486, "process_user_time": 1.41189, "process_kernel_time": 0.099992, "process_mem_max_rss": "92104", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:38.344639 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:38.344538 after 0.20 seconds
[0m22:05:38.345089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34674f3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3465cb470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa347e1b8c0>]}
[0m22:05:38.345522 [debug] [MainThread]: Flushing usage events
[0m06:02:05.467375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09fed7cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09febf6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09fe94c440>]}


============================== 06:02:05.474132 | 721cc503-b604-42b2-baa9-eead7e93cc16 ==============================
[0m06:02:05.474132 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:05.474800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:05.608656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '721cc503-b604-42b2-baa9-eead7e93cc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09ff110ce0>]}
[0m06:02:05.622005 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0wrwdif6'
[0m06:02:05.622468 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:05.729994 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:05.730789 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:05.741121 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:05.744881 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:05.962016 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:05.962515 [info ] [MainThread]: Up to date!
[0m06:02:05.963035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '721cc503-b604-42b2-baa9-eead7e93cc16', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09fe412960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09fe12ff20>]}
[0m06:02:05.964436 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.54484624, "process_user_time": 1.547753, "process_kernel_time": 0.1389, "process_mem_max_rss": "93420", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m06:02:05.965014 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:05.964911 after 0.55 seconds
[0m06:02:05.965480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09fed7cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09fe7b9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09fe154560>]}
[0m06:02:05.965922 [debug] [MainThread]: Flushing usage events
[0m06:02:07.730104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a02447470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a02d851c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a02c1b0b0>]}


============================== 06:02:07.732818 | 25e515cb-38c2-4d1e-8987-bb14d3563dee ==============================
[0m06:02:07.732818 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:07.733512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.954049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25e515cb-38c2-4d1e-8987-bb14d3563dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a01c5cb90>]}
[0m06:02:08.012727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25e515cb-38c2-4d1e-8987-bb14d3563dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a02058590>]}
[0m06:02:08.013455 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:08.028276 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:08.028992 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:08.029564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '25e515cb-38c2-4d1e-8987-bb14d3563dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a01b159d0>]}
[0m06:02:09.232950 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:09.233606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '25e515cb-38c2-4d1e-8987-bb14d3563dee', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39fad4ff80>]}
[0m06:02:09.410194 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:09.414895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25e515cb-38c2-4d1e-8987-bb14d3563dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39fae827b0>]}
[0m06:02:09.540542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25e515cb-38c2-4d1e-8987-bb14d3563dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39fadf0410>]}
[0m06:02:09.541106 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:09.541674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25e515cb-38c2-4d1e-8987-bb14d3563dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39faca0980>]}
[0m06:02:09.543347 [info ] [MainThread]: 
[0m06:02:09.544034 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:09.548751 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:09.582842 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:09.583294 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:09.583701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:10.068374 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.069987 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:10.072199 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:10.072774 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:10.079466 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.079907 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:10.080307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.085745 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.087027 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.087435 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:10.088104 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.088509 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.089047 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:10.089930 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.091313 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.091900 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.092442 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.093161 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.093620 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:10.095614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:10.100700 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.101120 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:10.101542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.106428 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.106852 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.107258 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:10.127273 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.131974 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:10.133133 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:10.133579 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:10.136599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25e515cb-38c2-4d1e-8987-bb14d3563dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a01cd5b80>]}
[0m06:02:10.137129 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.137568 [debug] [MainThread]: On master: BEGIN
[0m06:02:10.137955 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:10.142989 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.143422 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.143822 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.144210 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.144832 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.145252 [debug] [MainThread]: On master: Close
[0m06:02:10.146959 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:10.147454 [info ] [MainThread]: 
[0m06:02:10.156401 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:10.156997 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:10.157659 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:10.158113 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:10.183108 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:10.183845 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:10.217488 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:10.218225 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:21.536392 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.536913 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:21.537583 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.538055 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.538508 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:21.539205 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.541897 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.542372 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:21.543060 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.563547 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:21.564034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.564487 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:21.565651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.570324 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.570811 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:21.571920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.574258 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:21.599777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e515cb-38c2-4d1e-8987-bb14d3563dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a033820c0>]}
[0m06:02:21.600486 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.44s]
[0m06:02:21.601367 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:21.602386 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:21.602959 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:21.603629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:21.604100 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:21.608797 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:21.609487 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:21.642178 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.642703 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240715060221636379"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:21.643190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:21.658221 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.664984 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.665494 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:21.666103 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.666567 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.667019 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240715060221636379'
      
      
      order by ordinal_position

  
[0m06:02:21.694206 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.699018 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.699507 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.707482 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.715779 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.716284 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.724973 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.742752 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:21.743428 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.743912 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240715060221636379"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240715060221636379"
    )
  
[0m06:02:21.762780 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.764495 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.764967 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.765412 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.774295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.775170 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:21.840720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e515cb-38c2-4d1e-8987-bb14d3563dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ca557c50>]}
[0m06:02:21.841479 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.24s]
[0m06:02:21.842350 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:21.843835 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.844322 [debug] [MainThread]: On master: BEGIN
[0m06:02:21.844771 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:21.850109 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.850593 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.851041 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.851483 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.852056 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.852517 [debug] [MainThread]: On master: Close
[0m06:02:21.854149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:21.854603 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:21.855023 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:21.855498 [info ] [MainThread]: 
[0m06:02:21.856060 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.31 seconds (12.31s).
[0m06:02:21.857116 [debug] [MainThread]: Command end result
[0m06:02:21.885031 [info ] [MainThread]: 
[0m06:02:21.885746 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:21.886356 [info ] [MainThread]: 
[0m06:02:21.886962 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:21.888048 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.206263, "process_user_time": 4.66049, "process_kernel_time": 0.285008, "process_mem_max_rss": "274984", "process_in_blocks": "1184", "process_out_blocks": "104472"}
[0m06:02:21.888696 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:21.888585 after 14.21 seconds
[0m06:02:21.889194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a042b1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a02444e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ca4bf8c0>]}
[0m06:02:21.889727 [debug] [MainThread]: Flushing usage events
[0m06:02:23.800789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f25f3a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f25e4b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f261f88c0>]}


============================== 06:02:23.803532 | 2b2d3524-e542-403d-b5a6-bc3243904863 ==============================
[0m06:02:23.803532 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:23.804198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:23.936982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b2d3524-e542-403d-b5a6-bc3243904863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f25e4bbf0>]}
[0m06:02:23.953069 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2007352, "process_user_time": 1.389517, "process_kernel_time": 0.13975, "process_mem_max_rss": "91864", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:23.953657 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:23.953553 after 0.20 seconds
[0m06:02:23.954092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f25f3a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f26312c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f25f672f0>]}
[0m06:02:23.954520 [debug] [MainThread]: Flushing usage events
[0m14:04:58.549978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566c03e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566c7005c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566bae63c0>]}


============================== 14:04:58.580764 | 086dd255-9814-4bd1-ace9-9e0f1b88ad4c ==============================
[0m14:04:58.580764 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:58.581609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:58.728447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '086dd255-9814-4bd1-ace9-9e0f1b88ad4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566d1a1910>]}
[0m14:04:58.742386 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-j8snlish'
[0m14:04:58.742904 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:58.797027 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:58.797790 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:58.809340 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:58.813169 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:58.967783 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:58.968410 [info ] [MainThread]: Up to date!
[0m14:04:58.968941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '086dd255-9814-4bd1-ace9-9e0f1b88ad4c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566b84b320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566b84af60>]}
[0m14:04:58.970358 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47079077, "process_user_time": 1.61296, "process_kernel_time": 0.111238, "process_mem_max_rss": "93512", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m14:04:58.970967 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:58.970860 after 0.47 seconds
[0m14:04:58.971407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566bbeb3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566bf7b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566bf7ae70>]}
[0m14:04:58.971916 [debug] [MainThread]: Flushing usage events
[0m14:05:00.668342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cbefba2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cbd9f16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cbd9f1a00>]}


============================== 14:05:00.671268 | c11df473-c9dd-4265-ba5c-3076f714c735 ==============================
[0m14:05:00.671268 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:00.671990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:00.906564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c11df473-c9dd-4265-ba5c-3076f714c735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cbd8e6f00>]}
[0m14:05:00.966199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c11df473-c9dd-4265-ba5c-3076f714c735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cbdccf890>]}
[0m14:05:00.967121 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:01.006950 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:01.007738 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:01.008332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c11df473-c9dd-4265-ba5c-3076f714c735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cbd31a180>]}
[0m14:05:02.235221 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:02.235973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c11df473-c9dd-4265-ba5c-3076f714c735', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cbd2a1ac0>]}
[0m14:05:02.420725 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:02.426082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c11df473-c9dd-4265-ba5c-3076f714c735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb6119a00>]}
[0m14:05:02.568806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c11df473-c9dd-4265-ba5c-3076f714c735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cb609faa0>]}
[0m14:05:02.569417 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:02.569936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c11df473-c9dd-4265-ba5c-3076f714c735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cbddcdd30>]}
[0m14:05:02.571676 [info ] [MainThread]: 
[0m14:05:02.572411 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:02.577264 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:02.613425 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:02.613953 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:02.614363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:03.175433 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:03.177019 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:03.179117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:03.179701 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:03.186506 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:03.186952 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:03.187358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:03.193196 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:03.194691 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:03.195114 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:03.195784 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:03.196242 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:03.196638 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:03.197214 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:03.198178 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:03.198600 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:03.198995 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:03.199562 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:03.200031 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:03.202565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:03.208243 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:03.208689 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:03.209080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:03.214328 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:03.214766 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:03.215177 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:03.235377 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:03.240699 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:03.242013 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:03.242467 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:03.246390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c11df473-c9dd-4265-ba5c-3076f714c735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cbf9dd0a0>]}
[0m14:05:03.246925 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:03.247328 [debug] [MainThread]: On master: BEGIN
[0m14:05:03.247715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:03.253184 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:03.253635 [debug] [MainThread]: On master: COMMIT
[0m14:05:03.254044 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:03.254433 [debug] [MainThread]: On master: COMMIT
[0m14:05:03.255081 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:03.255502 [debug] [MainThread]: On master: Close
[0m14:05:03.257329 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:03.257834 [info ] [MainThread]: 
[0m14:05:03.268206 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:03.268851 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:03.269507 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:03.269956 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:03.295602 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:03.296513 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:03.331440 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:03.332377 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:12.192706 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:12.193259 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:12.193993 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:12.194458 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:12.194905 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:12.195637 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:12.198565 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:12.199037 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:12.199749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:12.220628 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:12.221174 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:12.221639 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:12.223175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:12.228181 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:12.228665 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:12.229842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:12.232316 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:12.259230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c11df473-c9dd-4265-ba5c-3076f714c735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c89eaf740>]}
[0m14:05:12.260108 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.99s]
[0m14:05:12.260911 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:12.261976 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:12.262559 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:12.263158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:12.263624 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:12.268837 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:12.269513 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:12.303127 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:12.303737 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240715140512297198"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:12.304266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:12.318921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:12.326427 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:12.326943 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:12.327612 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:12.328117 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:12.328565 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240715140512297198'
      
      
      order by ordinal_position

  
[0m14:05:12.355464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:12.361070 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:12.361581 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:12.376040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:12.385218 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:12.385763 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:12.395286 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:12.413807 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:12.414637 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:12.415130 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240715140512297198"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240715140512297198"
    )
  
[0m14:05:12.432545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:12.434552 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:12.435031 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:12.435477 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:12.444606 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:12.445605 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:12.520788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c11df473-c9dd-4265-ba5c-3076f714c735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c89d20e60>]}
[0m14:05:12.521618 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.26s]
[0m14:05:12.522403 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:12.523909 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:12.524398 [debug] [MainThread]: On master: BEGIN
[0m14:05:12.524848 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:12.530329 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:12.530845 [debug] [MainThread]: On master: COMMIT
[0m14:05:12.531295 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:12.531736 [debug] [MainThread]: On master: COMMIT
[0m14:05:12.532486 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:12.532963 [debug] [MainThread]: On master: Close
[0m14:05:12.534677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:12.535131 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:12.535554 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:12.536106 [info ] [MainThread]: 
[0m14:05:12.536670 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.96 seconds (9.96s).
[0m14:05:12.537704 [debug] [MainThread]: Command end result
[0m14:05:12.566237 [info ] [MainThread]: 
[0m14:05:12.566970 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:12.567506 [info ] [MainThread]: 
[0m14:05:12.568073 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:12.569110 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.950362, "process_user_time": 4.845514, "process_kernel_time": 0.286669, "process_mem_max_rss": "274232", "process_in_blocks": "1184", "process_out_blocks": "104968"}
[0m14:05:12.569775 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:12.569664 after 11.95 seconds
[0m14:05:12.570289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cbe536d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cbe3b3c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cc11bbd70>]}
[0m14:05:12.570790 [debug] [MainThread]: Flushing usage events
[0m14:05:14.378221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd954a271d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd956d59730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd954a27320>]}


============================== 14:05:14.381196 | 61eaf538-488c-4f43-8022-ecdc39151e20 ==============================
[0m14:05:14.381196 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:14.381931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:14.530036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61eaf538-488c-4f43-8022-ecdc39151e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9560cb800>]}
[0m14:05:14.547058 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2183571, "process_user_time": 1.443828, "process_kernel_time": 0.107987, "process_mem_max_rss": "92232", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:14.547656 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:14.547551 after 0.22 seconds
[0m14:05:14.548155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd954d22660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd954a27290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd954f84b30>]}
[0m14:05:14.548605 [debug] [MainThread]: Flushing usage events
[0m22:05:15.806692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a5d429f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a5d43d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a4c7a2a0>]}


============================== 22:05:15.814253 | 5b4d62e9-09be-44c8-9d38-aa346c7f7464 ==============================
[0m22:05:15.814253 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:15.814946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:15.952895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b4d62e9-09be-44c8-9d38-aa346c7f7464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a5b734d0>]}
[0m22:05:15.966212 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-__g1amw8'
[0m22:05:15.966677 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:16.030098 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:16.030836 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:16.042131 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:16.045931 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:16.092663 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:16.093304 [info ] [MainThread]: Up to date!
[0m22:05:16.093952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5b4d62e9-09be-44c8-9d38-aa346c7f7464', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a4ac8e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a49b7050>]}
[0m22:05:16.095729 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.337712, "process_user_time": 1.581573, "process_kernel_time": 0.104633, "process_mem_max_rss": "93824", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m22:05:16.096330 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:16.096225 after 0.34 seconds
[0m22:05:16.096771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a8967d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a4a6c260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a4c7a150>]}
[0m22:05:16.097200 [debug] [MainThread]: Flushing usage events
[0m22:05:17.653648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a823ec860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a823efe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a823ec8f0>]}


============================== 22:05:17.656476 | c966357b-8c4d-4d4d-971e-b540d44cdda7 ==============================
[0m22:05:17.656476 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:17.657215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:17.883385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c966357b-8c4d-4d4d-971e-b540d44cdda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a8288fe60>]}
[0m22:05:17.942395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c966357b-8c4d-4d4d-971e-b540d44cdda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a8224cbf0>]}
[0m22:05:17.943261 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:17.959356 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:17.960079 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:17.960633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c966357b-8c4d-4d4d-971e-b540d44cdda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a7b902e70>]}
[0m22:05:19.173370 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:19.174074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c966357b-8c4d-4d4d-971e-b540d44cdda7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a7b5024e0>]}
[0m22:05:19.354468 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:19.359555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c966357b-8c4d-4d4d-971e-b540d44cdda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a7b792570>]}
[0m22:05:19.483427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c966357b-8c4d-4d4d-971e-b540d44cdda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a7b6b7650>]}
[0m22:05:19.484207 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:19.484751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c966357b-8c4d-4d4d-971e-b540d44cdda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a7b462b10>]}
[0m22:05:19.486525 [info ] [MainThread]: 
[0m22:05:19.487265 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:19.491985 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:19.527481 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:19.527960 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:19.528367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:20.032104 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:20.033741 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:20.036070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:20.036658 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:20.043564 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:20.044017 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:20.044424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:20.050111 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:20.051460 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:20.051878 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:20.052527 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:20.052942 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:20.053334 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:20.053956 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:20.054892 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:20.055304 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:20.055694 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:20.056234 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:20.056682 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:20.058915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:20.064357 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:20.064791 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:20.065180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:20.070404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:20.070843 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:20.071274 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:20.091782 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:20.096816 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:20.098515 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:20.099183 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:20.104609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c966357b-8c4d-4d4d-971e-b540d44cdda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a7b638500>]}
[0m22:05:20.105154 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:20.105604 [debug] [MainThread]: On master: BEGIN
[0m22:05:20.105996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:20.111448 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:20.111890 [debug] [MainThread]: On master: COMMIT
[0m22:05:20.112291 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:20.112682 [debug] [MainThread]: On master: COMMIT
[0m22:05:20.113199 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:20.113658 [debug] [MainThread]: On master: Close
[0m22:05:20.115424 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:20.115940 [info ] [MainThread]: 
[0m22:05:20.125547 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:20.126200 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:20.126900 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:20.127359 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:20.153029 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:20.153833 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:20.187856 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:20.188634 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:35.067184 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.067710 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:35.068338 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.068791 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.069232 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:35.069960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.072652 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.073119 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:35.074008 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.094524 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:35.095021 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.095465 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:35.096693 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.101373 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.101873 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:35.103105 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.105520 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:35.132745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c966357b-8c4d-4d4d-971e-b540d44cdda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a83b5a270>]}
[0m22:05:35.133650 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 15.00s]
[0m22:05:35.134556 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:35.135591 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:35.136184 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:35.136902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:35.137375 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:35.142693 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:35.143407 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:35.178202 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.178827 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240715220535172010"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:35.179337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:35.194765 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.202330 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.202827 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:35.203496 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.203957 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.204409 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240715220535172010'
      
      
      order by ordinal_position

  
[0m22:05:35.231129 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.236709 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.237229 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:35.246277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.255227 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.255730 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:35.263858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.281850 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:35.282592 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.283086 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240715220535172010"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240715220535172010"
    )
  
[0m22:05:35.300139 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.302056 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:35.302547 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.303019 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:35.313146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.314088 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:35.395450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c966357b-8c4d-4d4d-971e-b540d44cdda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a4ad48290>]}
[0m22:05:35.396300 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.26s]
[0m22:05:35.397189 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:35.398715 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:35.399209 [debug] [MainThread]: On master: BEGIN
[0m22:05:35.399648 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:35.405171 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:35.405703 [debug] [MainThread]: On master: COMMIT
[0m22:05:35.406153 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:35.406584 [debug] [MainThread]: On master: COMMIT
[0m22:05:35.407281 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:35.407751 [debug] [MainThread]: On master: Close
[0m22:05:35.409329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:35.409817 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:35.410247 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:35.410727 [info ] [MainThread]: 
[0m22:05:35.411260 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 15.92 seconds (15.92s).
[0m22:05:35.412266 [debug] [MainThread]: Command end result
[0m22:05:35.440146 [info ] [MainThread]: 
[0m22:05:35.440779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:35.441309 [info ] [MainThread]: 
[0m22:05:35.441867 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:35.442899 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.83781, "process_user_time": 4.760686, "process_kernel_time": 0.291307, "process_mem_max_rss": "276864", "process_in_blocks": "1184", "process_out_blocks": "105016"}
[0m22:05:35.443555 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:35.443443 after 17.84 seconds
[0m22:05:35.444060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a823d3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a8288cec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a4aef7680>]}
[0m22:05:35.444562 [debug] [MainThread]: Flushing usage events
[0m22:05:37.157298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a3d297470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a3bdf6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a3bdf59d0>]}


============================== 22:05:37.160341 | 499aac59-8ab1-4f9d-9cd4-a2bc0c8ec7ae ==============================
[0m22:05:37.160341 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:37.161004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:37.306794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '499aac59-8ab1-4f9d-9cd4-a2bc0c8ec7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a3b3143b0>]}
[0m22:05:37.323540 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2156535, "process_user_time": 1.398823, "process_kernel_time": 0.123895, "process_mem_max_rss": "92264", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:37.324158 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:37.324052 after 0.22 seconds
[0m22:05:37.324620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a3b8bd670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a3bdf59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a3b7b4860>]}
[0m22:05:37.325090 [debug] [MainThread]: Flushing usage events
[0m06:02:06.889401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1d590bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1d7f255e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1d632af60>]}


============================== 06:02:06.897337 | 939c19c5-cbde-4b60-ba3a-a89e0fb52444 ==============================
[0m06:02:06.897337 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:06.898095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.037714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '939c19c5-cbde-4b60-ba3a-a89e0fb52444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1d6cdc0b0>]}
[0m06:02:07.051278 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-d2lcwdmd'
[0m06:02:07.051786 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:07.137154 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:07.137931 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:07.152386 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:07.156224 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:07.232124 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:07.232816 [info ] [MainThread]: Up to date!
[0m06:02:07.233486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '939c19c5-cbde-4b60-ba3a-a89e0fb52444', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1d5737c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1d56f7aa0>]}
[0m06:02:07.235280 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.39431247, "process_user_time": 1.560484, "process_kernel_time": 0.145537, "process_mem_max_rss": "93492", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m06:02:07.235908 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:07.235797 after 0.39 seconds
[0m06:02:07.236360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1d62cebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1d8fbc830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1d5de35f0>]}
[0m06:02:07.236850 [debug] [MainThread]: Flushing usage events
[0m06:02:08.825304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eff862d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eff863530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eff863680>]}


============================== 06:02:08.828200 | e02a063f-a5a1-4ff4-a9e1-74ce3150d882 ==============================
[0m06:02:08.828200 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:08.828963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:09.055958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e02a063f-a5a1-4ff4-a9e1-74ce3150d882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eff7fbbf0>]}
[0m06:02:09.116034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e02a063f-a5a1-4ff4-a9e1-74ce3150d882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eff65c860>]}
[0m06:02:09.116974 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:09.148817 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:09.149589 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:09.150129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e02a063f-a5a1-4ff4-a9e1-74ce3150d882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eff53e1e0>]}
[0m06:02:10.376595 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:10.377266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e02a063f-a5a1-4ff4-a9e1-74ce3150d882', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef897c710>]}
[0m06:02:10.559839 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:10.566267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e02a063f-a5a1-4ff4-a9e1-74ce3150d882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef8811730>]}
[0m06:02:10.699000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e02a063f-a5a1-4ff4-a9e1-74ce3150d882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef88cbbf0>]}
[0m06:02:10.699594 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:10.700089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e02a063f-a5a1-4ff4-a9e1-74ce3150d882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef8722360>]}
[0m06:02:10.701834 [info ] [MainThread]: 
[0m06:02:10.702550 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:10.707458 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:10.743339 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:10.743860 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:10.744287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:11.253837 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:11.255402 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:11.257726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:11.258323 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:11.265254 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.265709 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:11.266113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:11.271768 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.273276 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.273705 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:11.274617 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.275029 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.275423 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:11.276052 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.277056 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:11.277473 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.277869 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:11.278405 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.278831 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:11.281152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:11.286811 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:11.287243 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:11.287629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:11.293018 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.293445 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:11.293853 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:11.313887 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.318705 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:11.319909 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:11.320327 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:11.323629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e02a063f-a5a1-4ff4-a9e1-74ce3150d882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef8777ef0>]}
[0m06:02:11.324156 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:11.324560 [debug] [MainThread]: On master: BEGIN
[0m06:02:11.324986 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:11.330122 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:11.330556 [debug] [MainThread]: On master: COMMIT
[0m06:02:11.330955 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:11.331356 [debug] [MainThread]: On master: COMMIT
[0m06:02:11.332003 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:11.332430 [debug] [MainThread]: On master: Close
[0m06:02:11.333967 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:11.334484 [info ] [MainThread]: 
[0m06:02:11.344527 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:11.345193 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:11.345849 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:11.346300 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:11.372083 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:11.372913 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:11.407435 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:11.408300 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:19.543297 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.543846 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:19.544766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.545232 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.545682 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:19.546576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.549397 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.549877 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:19.550624 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.571609 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:19.572165 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.572646 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:19.575354 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.580436 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.580978 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:19.582352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.584814 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:19.611268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e02a063f-a5a1-4ff4-a9e1-74ce3150d882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ecc259910>]}
[0m06:02:19.612072 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.26s]
[0m06:02:19.612905 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:19.613903 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:19.614475 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:19.615057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:19.615535 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:19.620688 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:19.621354 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:19.655231 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.655803 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240716060219649261"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:19.656283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:19.670898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.678234 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.678765 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:19.679395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.679852 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.680298 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240716060219649261'
      
      
      order by ordinal_position

  
[0m06:02:19.707250 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.712654 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.713166 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:19.727777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.736577 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.737097 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:19.745786 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.764015 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:19.764767 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.765261 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240716060219649261"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240716060219649261"
    )
  
[0m06:02:19.784432 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.786465 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:19.786948 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.787418 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:19.796703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.797691 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:19.878252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e02a063f-a5a1-4ff4-a9e1-74ce3150d882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ecc0ffcb0>]}
[0m06:02:19.879115 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.26s]
[0m06:02:19.879885 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:19.881309 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.881793 [debug] [MainThread]: On master: BEGIN
[0m06:02:19.882240 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:19.887624 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.888106 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.888556 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.889081 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.889783 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.890256 [debug] [MainThread]: On master: Close
[0m06:02:19.891738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:19.892189 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:19.892643 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:19.893135 [info ] [MainThread]: 
[0m06:02:19.893680 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.19 seconds (9.19s).
[0m06:02:19.894695 [debug] [MainThread]: Command end result
[0m06:02:19.922801 [info ] [MainThread]: 
[0m06:02:19.923522 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:19.924041 [info ] [MainThread]: 
[0m06:02:19.924575 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:19.925631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.1498375, "process_user_time": 4.91086, "process_kernel_time": 0.228505, "process_mem_max_rss": "274220", "process_in_blocks": "1184", "process_out_blocks": "105496"}
[0m06:02:19.926282 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:19.926169 after 11.15 seconds
[0m06:02:19.926792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ecd15cd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef7b76570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ecc1474a0>]}
[0m06:02:19.927309 [debug] [MainThread]: Flushing usage events
[0m06:02:21.622465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50598a66c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50599aaed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f505984d670>]}


============================== 06:02:21.625497 | ada30299-5410-46b7-b890-a8f7769d5bd2 ==============================
[0m06:02:21.625497 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:21.626168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:21.772728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ada30299-5410-46b7-b890-a8f7769d5bd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f505a78c5c0>]}
[0m06:02:21.789289 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21589234, "process_user_time": 1.43966, "process_kernel_time": 0.099976, "process_mem_max_rss": "92220", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:21.789891 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:21.789787 after 0.22 seconds
[0m06:02:21.790358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f505c5f1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5059ece300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50596b9820>]}
[0m06:02:21.790798 [debug] [MainThread]: Flushing usage events
[0m14:05:19.499785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff351698e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3537f8080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff351e67260>]}


============================== 14:05:19.528554 | 83b89331-88eb-4d6f-9bac-4e31a1593719 ==============================
[0m14:05:19.528554 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:19.529263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:19.674632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83b89331-88eb-4d6f-9bac-4e31a1593719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff351354da0>]}
[0m14:05:19.688218 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7dtbwfr0'
[0m14:05:19.688687 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:19.759668 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:19.760458 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:19.773459 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:19.777541 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:19.991791 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:19.992371 [info ] [MainThread]: Up to date!
[0m14:05:19.992939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '83b89331-88eb-4d6f-9bac-4e31a1593719', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3511e3170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3512038c0>]}
[0m14:05:20.003065 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.55193126, "process_user_time": 1.613944, "process_kernel_time": 0.129115, "process_mem_max_rss": "93452", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m14:05:20.003674 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:20.003569 after 0.55 seconds
[0m14:05:20.004123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3537f8080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff351e2f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff351606240>]}
[0m14:05:20.004567 [debug] [MainThread]: Flushing usage events
[0m14:05:21.803144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19d84a8560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19d836e7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19d88ea270>]}


============================== 14:05:21.806003 | c8f28969-6126-4d9e-bc26-7c2774eda717 ==============================
[0m14:05:21.806003 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:21.806733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:22.029724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8f28969-6126-4d9e-bc26-7c2774eda717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19d92972f0>]}
[0m14:05:22.088738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8f28969-6126-4d9e-bc26-7c2774eda717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19d9f18e60>]}
[0m14:05:22.089639 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:22.105165 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:22.105956 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:22.106513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c8f28969-6126-4d9e-bc26-7c2774eda717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19d7a5c8f0>]}
[0m14:05:23.318575 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:23.319390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c8f28969-6126-4d9e-bc26-7c2774eda717', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19d0d86840>]}
[0m14:05:23.500067 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:23.505037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8f28969-6126-4d9e-bc26-7c2774eda717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19d7ff24e0>]}
[0m14:05:23.624739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8f28969-6126-4d9e-bc26-7c2774eda717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19d0b21eb0>]}
[0m14:05:23.625325 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:23.625848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8f28969-6126-4d9e-bc26-7c2774eda717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19d8bc2060>]}
[0m14:05:23.627567 [info ] [MainThread]: 
[0m14:05:23.628293 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:23.633057 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:23.667437 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:23.667895 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:23.668298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:24.230688 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:24.232231 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:24.234432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:24.235017 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:24.241850 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:24.242300 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:24.242705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:24.248223 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.249630 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:24.250063 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:24.250914 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.251328 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:24.251727 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:24.252289 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.253256 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:24.253667 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:24.254053 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:24.254688 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.255109 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:24.257116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:24.262459 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:24.262889 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:24.263277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:24.268149 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.268572 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:24.268993 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:24.289090 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:24.294043 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:24.295219 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:24.295638 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:24.299125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8f28969-6126-4d9e-bc26-7c2774eda717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19d7b0f3e0>]}
[0m14:05:24.299643 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:24.300055 [debug] [MainThread]: On master: BEGIN
[0m14:05:24.300431 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:24.305550 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:24.305974 [debug] [MainThread]: On master: COMMIT
[0m14:05:24.306366 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:24.306749 [debug] [MainThread]: On master: COMMIT
[0m14:05:24.307370 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:24.307785 [debug] [MainThread]: On master: Close
[0m14:05:24.309256 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:24.309796 [info ] [MainThread]: 
[0m14:05:24.318961 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:24.319572 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:24.320320 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:24.320794 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:24.346339 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:24.347081 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:24.381216 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:24.381982 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:34.583812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.584356 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:34.585048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.585553 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.586008 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:34.586721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.589523 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.590012 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:34.590740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.611681 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:34.612284 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.612756 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:34.614949 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.620039 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.620535 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:34.621812 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.624290 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:34.651523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8f28969-6126-4d9e-bc26-7c2774eda717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19cf983ef0>]}
[0m14:05:34.652344 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.33s]
[0m14:05:34.653282 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:34.654322 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:34.654904 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:34.655600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:34.656084 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:34.661323 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:34.662004 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:34.695473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.696056 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240716140534689586"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:34.696543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:34.713393 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.720852 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.721398 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:34.722098 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.722570 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.723031 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240716140534689586'
      
      
      order by ordinal_position

  
[0m14:05:34.749696 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.754851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.755363 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:34.764439 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.773567 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.774098 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:34.782323 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.800568 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:34.801359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.801852 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240716140534689586"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240716140534689586"
    )
  
[0m14:05:34.820945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.822939 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:34.823433 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:34.823879 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:34.834020 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.834925 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:34.925875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8f28969-6126-4d9e-bc26-7c2774eda717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f199ff04f50>]}
[0m14:05:34.926723 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.27s]
[0m14:05:34.927497 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:34.928897 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.929427 [debug] [MainThread]: On master: BEGIN
[0m14:05:34.929876 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:34.935326 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.935836 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.936288 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.936727 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.937436 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.937905 [debug] [MainThread]: On master: Close
[0m14:05:34.939597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:34.940040 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:34.940451 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:34.940927 [info ] [MainThread]: 
[0m14:05:34.941563 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.31 seconds (11.31s).
[0m14:05:34.942718 [debug] [MainThread]: Command end result
[0m14:05:34.971158 [info ] [MainThread]: 
[0m14:05:34.971931 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:34.972534 [info ] [MainThread]: 
[0m14:05:34.973143 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:34.974279 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.220111, "process_user_time": 4.770349, "process_kernel_time": 0.294908, "process_mem_max_rss": "279532", "process_in_blocks": "1184", "process_out_blocks": "105472"}
[0m14:05:34.974926 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:34.974817 after 13.22 seconds
[0m14:05:34.975430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19d91605c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19d0de54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19d0de5550>]}
[0m14:05:34.975920 [debug] [MainThread]: Flushing usage events
[0m14:05:36.907406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8855857860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8857cf16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8856181b20>]}


============================== 14:05:36.910226 | 43e83008-6173-4e33-8c28-c61f1d85e567 ==============================
[0m14:05:36.910226 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:36.910954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:37.051981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43e83008-6173-4e33-8c28-c61f1d85e567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8855856f00>]}
[0m14:05:37.068819 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21018803, "process_user_time": 1.399315, "process_kernel_time": 0.131935, "process_mem_max_rss": "92212", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:37.069478 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:37.069367 after 0.21 seconds
[0m14:05:37.069938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8855b37020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88559bd970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88559bf4a0>]}
[0m14:05:37.070401 [debug] [MainThread]: Flushing usage events
[0m22:06:11.962837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d75b9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d4c7b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d6aad8b0>]}


============================== 22:06:11.981369 | 05e28e46-ec5d-4dca-9d31-47f85540ca95 ==============================
[0m22:06:11.981369 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:11.982065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:12.127047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05e28e46-ec5d-4dca-9d31-47f85540ca95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d6233a70>]}
[0m22:06:12.140564 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4rbba5hh'
[0m22:06:12.141034 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:12.207327 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:12.208159 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:12.236225 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:12.240369 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:12.311583 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:12.312172 [info ] [MainThread]: Up to date!
[0m22:06:12.312791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '05e28e46-ec5d-4dca-9d31-47f85540ca95', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d48ab170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d4763770>]}
[0m22:06:12.327290 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4132753, "process_user_time": 1.628561, "process_kernel_time": 0.136382, "process_mem_max_rss": "93428", "process_in_blocks": "5752", "process_out_blocks": "3840"}
[0m22:06:12.328033 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:12.327924 after 0.41 seconds
[0m22:06:12.328592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d4840230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d6d93230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d4612540>]}
[0m22:06:12.329083 [debug] [MainThread]: Flushing usage events
[0m22:06:13.958788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36ef427e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36fa36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36ef40da0>]}


============================== 22:06:13.961758 | 57bc4ad4-0221-4898-9c86-d083e86ac1dc ==============================
[0m22:06:13.961758 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:13.962442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:14.194687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57bc4ad4-0221-4898-9c86-d083e86ac1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36e874e90>]}
[0m22:06:14.253774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57bc4ad4-0221-4898-9c86-d083e86ac1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36ff51310>]}
[0m22:06:14.254634 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:06:14.270295 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:14.271044 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:14.271595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '57bc4ad4-0221-4898-9c86-d083e86ac1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36fa61430>]}
[0m22:06:15.482521 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:15.483216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '57bc4ad4-0221-4898-9c86-d083e86ac1dc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc367e860c0>]}
[0m22:06:15.662783 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:15.669464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57bc4ad4-0221-4898-9c86-d083e86ac1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc367b1a0f0>]}
[0m22:06:15.805104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57bc4ad4-0221-4898-9c86-d083e86ac1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc367c9afc0>]}
[0m22:06:15.805724 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:15.806288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57bc4ad4-0221-4898-9c86-d083e86ac1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc367a4b890>]}
[0m22:06:15.808048 [info ] [MainThread]: 
[0m22:06:15.808804 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:15.813675 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:15.849915 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:15.850443 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:06:15.850869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:16.433535 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:16.435231 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:16.437580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:16.438183 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:16.444978 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:16.445417 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:06:16.445815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:16.451230 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:16.452590 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:16.453002 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:16.453649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:16.454056 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:16.454448 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:16.455004 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:16.455915 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:16.456360 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:16.456760 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:16.457398 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:16.457823 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:16.459927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:16.465647 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:16.466078 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:16.466466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:16.471556 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:16.471980 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:16.472437 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:06:16.492140 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:16.498610 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:16.499806 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:16.500247 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:16.504094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57bc4ad4-0221-4898-9c86-d083e86ac1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc367a00860>]}
[0m22:06:16.504730 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:16.505150 [debug] [MainThread]: On master: BEGIN
[0m22:06:16.505538 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:16.510682 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:16.511131 [debug] [MainThread]: On master: COMMIT
[0m22:06:16.511566 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:16.511956 [debug] [MainThread]: On master: COMMIT
[0m22:06:16.512609 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:16.513031 [debug] [MainThread]: On master: Close
[0m22:06:16.514475 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:16.514979 [info ] [MainThread]: 
[0m22:06:16.524262 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:16.524937 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:16.525625 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:16.526086 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:16.551748 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:16.552519 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:16.586689 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:16.587446 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:26.387084 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:26.387611 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:26.388229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:26.388729 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:26.389178 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:26.390069 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:26.392778 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:26.393255 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:26.394081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:26.414522 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:26.415015 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:26.415468 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:26.417198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:26.421929 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:26.422407 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:26.423580 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:26.425959 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:26.452386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57bc4ad4-0221-4898-9c86-d083e86ac1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3375e8cb0>]}
[0m22:06:26.453188 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.93s]
[0m22:06:26.454110 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:26.455125 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:26.455722 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:26.456450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:26.456933 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:26.461989 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:26.462655 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:26.495911 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:26.496496 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240716220626490082"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:26.496986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:26.513977 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:26.521119 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:26.521611 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:26.522212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:26.522671 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:26.523119 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240716220626490082'
      
      
      order by ordinal_position

  
[0m22:06:26.555481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:26.560557 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:26.561051 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:26.574998 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:26.583827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:26.584416 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:26.592874 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:26.610770 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:26.611492 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:26.611979 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240716220626490082"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240716220626490082"
    )
  
[0m22:06:26.628538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:26.630308 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:26.630775 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:26.631213 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:26.639235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:26.640126 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:26.743531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57bc4ad4-0221-4898-9c86-d083e86ac1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33744aff0>]}
[0m22:06:26.744455 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m22:06:26.745269 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:26.746900 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:26.747496 [debug] [MainThread]: On master: BEGIN
[0m22:06:26.748018 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:26.753560 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:26.754049 [debug] [MainThread]: On master: COMMIT
[0m22:06:26.754494 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:26.754928 [debug] [MainThread]: On master: COMMIT
[0m22:06:26.755611 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:26.756085 [debug] [MainThread]: On master: Close
[0m22:06:26.757559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:26.758013 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:26.758436 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:26.758913 [info ] [MainThread]: 
[0m22:06:26.759534 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.95 seconds (10.95s).
[0m22:06:26.760700 [debug] [MainThread]: Command end result
[0m22:06:26.788600 [info ] [MainThread]: 
[0m22:06:26.789301 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:26.789911 [info ] [MainThread]: 
[0m22:06:26.790532 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:26.791641 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.881549, "process_user_time": 4.880896, "process_kernel_time": 0.277186, "process_mem_max_rss": "278280", "process_in_blocks": "1184", "process_out_blocks": "106536"}
[0m22:06:26.792299 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:26.792187 after 12.88 seconds
[0m22:06:26.792840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36fa36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36eef1d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc367c9b5f0>]}
[0m22:06:26.793350 [debug] [MainThread]: Flushing usage events
[0m22:06:28.531320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6681ee510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe667e62060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe667e63260>]}


============================== 22:06:28.534125 | 91bd3661-d5dd-40a7-90bc-3c28941e6a0f ==============================
[0m22:06:28.534125 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:28.534784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:28.674661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91bd3661-d5dd-40a7-90bc-3c28941e6a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe667463a70>]}
[0m22:06:28.690941 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20856719, "process_user_time": 1.42682, "process_kernel_time": 0.091923, "process_mem_max_rss": "92240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:28.691521 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:28.691418 after 0.21 seconds
[0m22:06:28.691965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe667a657c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe667462c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6676a61e0>]}
[0m22:06:28.692440 [debug] [MainThread]: Flushing usage events
[0m06:02:14.243523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb67dd9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb777bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb7303290>]}


============================== 06:02:14.250953 | 65f5c077-93b0-43c5-a5a0-40e9663a9730 ==============================
[0m06:02:14.250953 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.251607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.385477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65f5c077-93b0-43c5-a5a0-40e9663a9730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb7242000>]}
[0m06:02:14.398635 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q837t1co'
[0m06:02:14.399087 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:14.492971 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:14.493576 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:14.516994 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:14.520658 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:14.605863 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:14.606356 [info ] [MainThread]: Up to date!
[0m06:02:14.606884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '65f5c077-93b0-43c5-a5a0-40e9663a9730', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb63f3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb644b890>]}
[0m06:02:14.622669 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42679667, "process_user_time": 1.571593, "process_kernel_time": 0.095731, "process_mem_max_rss": "93496", "process_in_blocks": "5752", "process_out_blocks": "3848"}
[0m06:02:14.623286 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:14.623182 after 0.43 seconds
[0m06:02:14.623749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb6730050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb6733a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb700bb90>]}
[0m06:02:14.624186 [debug] [MainThread]: Flushing usage events
[0m06:02:16.208330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6362bf9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6362b09670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6362bfba40>]}


============================== 06:02:16.211140 | d25edc27-624a-4e91-b9f7-1db7ff18a828 ==============================
[0m06:02:16.211140 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:16.211870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:16.435569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd25edc27-624a-4e91-b9f7-1db7ff18a828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63624cb590>]}
[0m06:02:16.493692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd25edc27-624a-4e91-b9f7-1db7ff18a828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f636450e930>]}
[0m06:02:16.494439 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:16.509890 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:16.510606 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:16.511151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd25edc27-624a-4e91-b9f7-1db7ff18a828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6362531100>]}
[0m06:02:17.723515 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:17.724193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd25edc27-624a-4e91-b9f7-1db7ff18a828', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f635baebb00>]}
[0m06:02:17.902404 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:17.907116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd25edc27-624a-4e91-b9f7-1db7ff18a828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f635b8f8200>]}
[0m06:02:18.031163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd25edc27-624a-4e91-b9f7-1db7ff18a828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f635b9a9ac0>]}
[0m06:02:18.031707 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:18.032205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd25edc27-624a-4e91-b9f7-1db7ff18a828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f635b8f8a70>]}
[0m06:02:18.033890 [info ] [MainThread]: 
[0m06:02:18.034570 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:18.039220 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:18.073467 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:18.073919 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:18.074331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:18.649932 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:18.651450 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:18.653687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:18.654251 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:18.660983 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.661422 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:18.661820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:18.667110 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.668399 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.668858 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:18.669376 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.669777 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.670166 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:18.670949 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.671871 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:18.672277 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.672707 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:18.673235 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.673649 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:18.675590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:18.680665 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:18.681087 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:18.681472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:18.686351 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.686770 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:18.687174 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:18.706503 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.711256 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:18.712417 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:18.712872 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:18.716064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd25edc27-624a-4e91-b9f7-1db7ff18a828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f635b952510>]}
[0m06:02:18.716635 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.717052 [debug] [MainThread]: On master: BEGIN
[0m06:02:18.717441 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:18.722446 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.722877 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.723273 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.723658 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.724173 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.724623 [debug] [MainThread]: On master: Close
[0m06:02:18.726227 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:18.726730 [info ] [MainThread]: 
[0m06:02:18.736075 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:18.736721 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:18.737364 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:18.737813 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:18.763137 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:18.763881 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:18.797676 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:18.798429 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:27.208603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.209137 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:27.209807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.210269 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.210721 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:27.211432 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.214110 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.214581 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:27.215306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.235658 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:27.236147 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.236620 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:27.237915 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.242602 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.243083 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:27.244211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.246542 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:27.275102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25edc27-624a-4e91-b9f7-1db7ff18a828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f632b08dc70>]}
[0m06:02:27.275903 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.54s]
[0m06:02:27.276823 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:27.277811 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:27.278385 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:27.279063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:27.279531 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:27.284437 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:27.285127 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:27.318291 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.318812 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240717060227312479"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:27.319297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:27.335247 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.342222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.342705 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:27.343295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.343757 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.344213 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240717060227312479'
      
      
      order by ordinal_position

  
[0m06:02:27.369948 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.374841 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.375335 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:27.384055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.392621 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.393130 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:27.400974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.418807 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:27.419489 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.419969 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240717060227312479"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240717060227312479"
    )
  
[0m06:02:27.435943 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.437715 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:27.438189 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.438627 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:27.446853 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.447732 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:27.544978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd25edc27-624a-4e91-b9f7-1db7ff18a828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f632b2432f0>]}
[0m06:02:27.545718 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.27s]
[0m06:02:27.546496 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:27.548032 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.548562 [debug] [MainThread]: On master: BEGIN
[0m06:02:27.549026 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:27.554271 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.554750 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.555191 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.555621 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.556309 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.556835 [debug] [MainThread]: On master: Close
[0m06:02:27.558259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:27.558702 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:27.559112 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:27.559578 [info ] [MainThread]: 
[0m06:02:27.560104 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.53 seconds (9.53s).
[0m06:02:27.561153 [debug] [MainThread]: Command end result
[0m06:02:27.588656 [info ] [MainThread]: 
[0m06:02:27.589262 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:27.589769 [info ] [MainThread]: 
[0m06:02:27.590292 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:27.591262 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.43144, "process_user_time": 4.767463, "process_kernel_time": 0.281384, "process_mem_max_rss": "278052", "process_in_blocks": "1184", "process_out_blocks": "105992"}
[0m06:02:27.591905 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:27.591797 after 11.43 seconds
[0m06:02:27.592395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6362bfba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63663bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f635b8b7740>]}
[0m06:02:27.592914 [debug] [MainThread]: Flushing usage events
[0m06:02:29.217309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74b4c4a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74b25fb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74b1b27290>]}


============================== 06:02:29.220042 | 9c2360a8-03f0-4644-89f6-d50bb9c61bc0 ==============================
[0m06:02:29.220042 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:29.220759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:29.356123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c2360a8-03f0-4644-89f6-d50bb9c61bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74b18dc560>]}
[0m06:02:29.372295 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20399252, "process_user_time": 1.396638, "process_kernel_time": 0.100333, "process_mem_max_rss": "92216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:29.372914 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:29.372808 after 0.20 seconds
[0m06:02:29.373362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74b4c4a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74b2459a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74b28e1820>]}
[0m06:02:29.373802 [debug] [MainThread]: Flushing usage events
[0m14:05:00.555608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a16f22330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a16f223c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a171c0bf0>]}


============================== 14:05:00.602971 | 51a96da1-d774-48ff-ba30-7d146af10519 ==============================
[0m14:05:00.602971 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:00.603690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:00.743416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51a96da1-d774-48ff-ba30-7d146af10519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a18402150>]}
[0m14:05:00.756485 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nlq8bx9h'
[0m14:05:00.756950 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:00.802558 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:00.803325 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:00.838815 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:00.842572 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:01.057363 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:01.057945 [info ] [MainThread]: Up to date!
[0m14:05:01.058537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '51a96da1-d774-48ff-ba30-7d146af10519', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a16a80ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a16b8cda0>]}
[0m14:05:01.071191 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.56387746, "process_user_time": 1.594095, "process_kernel_time": 0.116152, "process_mem_max_rss": "93340", "process_in_blocks": "5752", "process_out_blocks": "3840"}
[0m14:05:01.071800 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:01.071695 after 0.56 seconds
[0m14:05:01.072248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a17287ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a16b45a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a177eb860>]}
[0m14:05:01.072706 [debug] [MainThread]: Flushing usage events
[0m14:05:03.110003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f157a2d8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1579da0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1579da1700>]}


============================== 14:05:03.112933 | a2b7a7de-310c-4539-a79a-4d4c37fe5ee6 ==============================
[0m14:05:03.112933 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:03.113576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:03.334608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2b7a7de-310c-4539-a79a-4d4c37fe5ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f157983bb30>]}
[0m14:05:03.394016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2b7a7de-310c-4539-a79a-4d4c37fe5ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1579c98800>]}
[0m14:05:03.394946 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:03.453660 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:03.454467 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:03.455014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a2b7a7de-310c-4539-a79a-4d4c37fe5ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f157990b9e0>]}
[0m14:05:04.719434 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:04.720086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a2b7a7de-310c-4539-a79a-4d4c37fe5ee6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1572c274d0>]}
[0m14:05:04.901309 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:04.906496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2b7a7de-310c-4539-a79a-4d4c37fe5ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1572ae8200>]}
[0m14:05:05.032429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2b7a7de-310c-4539-a79a-4d4c37fe5ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1572974890>]}
[0m14:05:05.033021 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:05.033553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2b7a7de-310c-4539-a79a-4d4c37fe5ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15729c67b0>]}
[0m14:05:05.035409 [info ] [MainThread]: 
[0m14:05:05.036162 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:05.041117 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:05.076580 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:05.077083 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:05.077488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:05.580633 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:05.582164 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:05.584268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:05.584838 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:05.591569 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:05.592011 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:05.592407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:05.597844 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:05.599197 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:05.599609 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:05.600440 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:05.600847 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:05.601239 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:05.601822 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:05.602781 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:05.603191 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:05.603575 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:05.604093 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:05.604508 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:05.606562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:05.611815 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:05.612240 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:05.612623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:05.617672 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:05.618122 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:05.618540 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:05.638662 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:05.643369 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:05.644600 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:05.645039 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:05.648459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2b7a7de-310c-4539-a79a-4d4c37fe5ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15798032c0>]}
[0m14:05:05.649003 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:05.649406 [debug] [MainThread]: On master: BEGIN
[0m14:05:05.649786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:05.654987 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:05.655418 [debug] [MainThread]: On master: COMMIT
[0m14:05:05.655823 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:05.656211 [debug] [MainThread]: On master: COMMIT
[0m14:05:05.656727 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:05.657141 [debug] [MainThread]: On master: Close
[0m14:05:05.658666 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:05.659178 [info ] [MainThread]: 
[0m14:05:05.674643 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:05.675272 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:05.675951 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:05.676399 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:05.701764 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:05.702559 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:05.736746 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:05.737645 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:17.468495 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:17.469066 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:17.469809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.470317 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:17.470771 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:17.471553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.474461 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:17.474936 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:17.475664 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.496330 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:17.496853 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:17.497306 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:17.498625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.503570 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:17.504062 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:17.505378 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.507825 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:17.535415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b7a7de-310c-4539-a79a-4d4c37fe5ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f157b0764b0>]}
[0m14:05:17.536270 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.86s]
[0m14:05:17.537059 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:17.538056 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:17.538665 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:17.539302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:17.539775 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:17.544902 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:17.545564 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:17.578975 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.579586 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240717140517573066"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:17.580071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:17.595042 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.602501 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.603027 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:17.603662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.604119 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.604567 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240717140517573066'
      
      
      order by ordinal_position

  
[0m14:05:17.631109 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.636688 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.637208 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:17.646112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.655232 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.655726 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:17.664887 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.683108 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:17.683858 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.684345 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240717140517573066"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240717140517573066"
    )
  
[0m14:05:17.700633 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.702665 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:17.703156 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:17.703601 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:17.712078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:17.713001 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:17.824603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b7a7de-310c-4539-a79a-4d4c37fe5ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15463de2a0>]}
[0m14:05:17.825477 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.28s]
[0m14:05:17.826416 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:17.828096 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:17.828588 [debug] [MainThread]: On master: BEGIN
[0m14:05:17.829040 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:17.834566 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:17.835046 [debug] [MainThread]: On master: COMMIT
[0m14:05:17.835492 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:17.835922 [debug] [MainThread]: On master: COMMIT
[0m14:05:17.836627 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:17.837095 [debug] [MainThread]: On master: Close
[0m14:05:17.838920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:17.839372 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:17.839787 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:17.840265 [info ] [MainThread]: 
[0m14:05:17.840867 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.80 seconds (12.80s).
[0m14:05:17.842026 [debug] [MainThread]: Command end result
[0m14:05:17.869949 [info ] [MainThread]: 
[0m14:05:17.870687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:17.871283 [info ] [MainThread]: 
[0m14:05:17.871889 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:17.872976 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.811843, "process_user_time": 4.846102, "process_kernel_time": 0.291645, "process_mem_max_rss": "283500", "process_in_blocks": "1184", "process_out_blocks": "106488"}
[0m14:05:17.873619 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:17.873510 after 14.81 seconds
[0m14:05:17.874157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15799249b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f157a9c3c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1579dbcc50>]}
[0m14:05:17.874656 [debug] [MainThread]: Flushing usage events
[0m14:05:20.120854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2a5e7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2a14adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2a1fa270>]}


============================== 14:05:20.123763 | 196849e3-2bf7-4432-a55b-68cb6aeb7465 ==============================
[0m14:05:20.123763 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:20.124447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:20.266508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '196849e3-2bf7-4432-a55b-68cb6aeb7465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2a1fa270>]}
[0m14:05:20.282605 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2106529, "process_user_time": 1.421906, "process_kernel_time": 0.115829, "process_mem_max_rss": "92228", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:20.283193 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:20.283092 after 0.21 seconds
[0m14:05:20.283635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e29c599a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2a3b0200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2a3b35f0>]}
[0m14:05:20.284072 [debug] [MainThread]: Flushing usage events
[0m22:06:25.431981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e166de180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e170f3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e166de390>]}


============================== 22:06:25.478093 | c4664c45-5ee2-4fd9-b73b-41f9681fa2b0 ==============================
[0m22:06:25.478093 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:25.478899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:25.628742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4664c45-5ee2-4fd9-b73b-41f9681fa2b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e1652c650>]}
[0m22:06:25.642767 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-odss8lgo'
[0m22:06:25.643357 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:25.707198 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:25.707990 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:25.721166 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:25.725122 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:25.920880 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:25.921460 [info ] [MainThread]: Up to date!
[0m22:06:25.922005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c4664c45-5ee2-4fd9-b73b-41f9681fa2b0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e1645c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e1645c500>]}
[0m22:06:25.923473 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.54112047, "process_user_time": 1.589401, "process_kernel_time": 0.167305, "process_mem_max_rss": "93816", "process_in_blocks": "5488", "process_out_blocks": "3848"}
[0m22:06:25.924079 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:25.923973 after 0.54 seconds
[0m22:06:25.924541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e16ef5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e16ef4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e163cb7a0>]}
[0m22:06:25.924970 [debug] [MainThread]: Flushing usage events
[0m22:06:27.639661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd384c840b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd385642b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd385642e10>]}


============================== 22:06:27.642610 | bbdc835c-7d14-40e3-8e8f-f2eb8e8b2712 ==============================
[0m22:06:27.642610 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:27.643399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:27.881487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbdc835c-7d14-40e3-8e8f-f2eb8e8b2712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd384ab0ce0>]}
[0m22:06:27.942201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbdc835c-7d14-40e3-8e8f-f2eb8e8b2712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd385473950>]}
[0m22:06:27.943206 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:06:27.988956 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:27.989783 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:27.990356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bbdc835c-7d14-40e3-8e8f-f2eb8e8b2712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37e1ac8f0>]}
[0m22:06:29.232374 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:29.233049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bbdc835c-7d14-40e3-8e8f-f2eb8e8b2712', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37df4a480>]}
[0m22:06:29.416286 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:29.421450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbdc835c-7d14-40e3-8e8f-f2eb8e8b2712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd385d49eb0>]}
[0m22:06:29.569104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbdc835c-7d14-40e3-8e8f-f2eb8e8b2712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37de79f70>]}
[0m22:06:29.569721 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:29.570231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbdc835c-7d14-40e3-8e8f-f2eb8e8b2712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37dc68da0>]}
[0m22:06:29.572030 [info ] [MainThread]: 
[0m22:06:29.572758 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:29.577715 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:29.614631 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:29.615315 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:06:29.615742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:30.027575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.029136 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:30.031272 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:30.031845 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:30.038745 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:30.039246 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:06:30.039664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:30.045689 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.047282 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:30.047722 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:30.048405 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.048819 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:30.049219 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:30.049842 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.050801 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:30.051258 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:30.051658 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:30.052206 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.052636 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:30.055126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:30.060989 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:30.061468 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:30.061860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:30.067493 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.067962 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:30.068372 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:06:30.089203 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.094614 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:30.095962 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:30.096396 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:30.100501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbdc835c-7d14-40e3-8e8f-f2eb8e8b2712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37db85bb0>]}
[0m22:06:30.101100 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:30.101518 [debug] [MainThread]: On master: BEGIN
[0m22:06:30.101903 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:30.107773 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:30.108307 [debug] [MainThread]: On master: COMMIT
[0m22:06:30.108713 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:30.109100 [debug] [MainThread]: On master: COMMIT
[0m22:06:30.109755 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:30.110180 [debug] [MainThread]: On master: Close
[0m22:06:30.112042 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:30.112589 [info ] [MainThread]: 
[0m22:06:30.121873 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:30.122543 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:30.123377 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:30.123842 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:30.149676 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:30.150570 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:30.185250 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:30.186191 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:38.923820 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:38.924559 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:38.925434 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:38.925904 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:38.926351 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:38.927151 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:38.930229 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:38.930734 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:38.931753 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:38.953182 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:38.953781 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:38.954227 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:39.045315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.050890 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:39.051421 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:39.053121 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.055628 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:39.082594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbdc835c-7d14-40e3-8e8f-f2eb8e8b2712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd385643440>]}
[0m22:06:39.083477 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.96s]
[0m22:06:39.084383 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:39.085407 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:39.085975 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:39.086661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:39.087133 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:39.092418 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:39.093094 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:39.129178 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:39.129807 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240717220639123146"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:39.130306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:39.146902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.154562 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:39.155091 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:39.155966 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.156462 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:39.156932 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240717220639123146'
      
      
      order by ordinal_position

  
[0m22:06:39.183867 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.189653 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:39.190221 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:39.205056 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.214678 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:39.215250 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:39.229691 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.249284 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:39.250210 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:39.250751 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240717220639123146"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240717220639123146"
    )
  
[0m22:06:39.268932 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.271086 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:39.271654 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:39.272115 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:39.281759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:39.282831 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:39.396262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbdc835c-7d14-40e3-8e8f-f2eb8e8b2712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3510aed50>]}
[0m22:06:39.397187 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m22:06:39.398014 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:39.399453 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:39.399964 [debug] [MainThread]: On master: BEGIN
[0m22:06:39.400424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:39.406117 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:39.406626 [debug] [MainThread]: On master: COMMIT
[0m22:06:39.407080 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:39.407567 [debug] [MainThread]: On master: COMMIT
[0m22:06:39.408285 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:39.408776 [debug] [MainThread]: On master: Close
[0m22:06:39.410763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:39.411294 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:39.411726 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:39.412228 [info ] [MainThread]: 
[0m22:06:39.412800 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.84 seconds (9.84s).
[0m22:06:39.413885 [debug] [MainThread]: Command end result
[0m22:06:39.443264 [info ] [MainThread]: 
[0m22:06:39.444013 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:39.444592 [info ] [MainThread]: 
[0m22:06:39.445166 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:39.446252 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.855784, "process_user_time": 5.092099, "process_kernel_time": 0.32904, "process_mem_max_rss": "286956", "process_in_blocks": "1184", "process_out_blocks": "107048"}
[0m22:06:39.446913 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:39.446799 after 11.86 seconds
[0m22:06:39.447449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3889bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37ca76f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35116c6b0>]}
[0m22:06:39.447955 [debug] [MainThread]: Flushing usage events
[0m22:06:41.264022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2d9bb2420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2d992d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2d967b560>]}


============================== 22:06:41.266961 | 835e8a89-709a-4554-93fe-7b6cd7eb648d ==============================
[0m22:06:41.266961 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:41.267682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:41.419748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '835e8a89-709a-4554-93fe-7b6cd7eb648d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2da423b30>]}
[0m22:06:41.437004 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.222563, "process_user_time": 1.438171, "process_kernel_time": 0.120181, "process_mem_max_rss": "92088", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:41.437608 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:41.437503 after 0.22 seconds
[0m22:06:41.438066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2d9bb2420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2d9bb23c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2da423b30>]}
[0m22:06:41.438523 [debug] [MainThread]: Flushing usage events
[0m06:02:16.084840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7c59a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7cf58800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7cf5a420>]}


============================== 06:02:16.143581 | 045fa570-ae06-4716-8ff7-e69ddc76b30d ==============================
[0m06:02:16.143581 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:16.144255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:16.290524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '045fa570-ae06-4716-8ff7-e69ddc76b30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7ead55b0>]}
[0m06:02:16.304515 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-w960tymd'
[0m06:02:16.304994 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:16.384091 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:16.384774 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:16.395689 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:16.399426 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:16.449271 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:16.449826 [info ] [MainThread]: Up to date!
[0m06:02:16.450347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '045fa570-ae06-4716-8ff7-e69ddc76b30d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7c5e2c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7c5e1820>]}
[0m06:02:16.451781 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41491503, "process_user_time": 1.652863, "process_kernel_time": 0.120354, "process_mem_max_rss": "93532", "process_in_blocks": "5488", "process_out_blocks": "3840"}
[0m06:02:16.452394 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:16.452289 after 0.42 seconds
[0m06:02:16.452835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7c9baae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7c59a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7c59a2d0>]}
[0m06:02:16.453277 [debug] [MainThread]: Flushing usage events
[0m06:02:18.107953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9365d49a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93642d6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93642d74a0>]}


============================== 06:02:18.110820 | 51a7c7a8-b93b-4a05-8a7b-571b6767ce08 ==============================
[0m06:02:18.110820 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:18.111511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:18.335382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51a7c7a8-b93b-4a05-8a7b-571b6767ce08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93641142f0>]}
[0m06:02:18.395183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51a7c7a8-b93b-4a05-8a7b-571b6767ce08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9365657140>]}
[0m06:02:18.396108 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:18.431164 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:18.431932 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:18.432501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '51a7c7a8-b93b-4a05-8a7b-571b6767ce08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9364085430>]}
[0m06:02:19.657946 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:19.658647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '51a7c7a8-b93b-4a05-8a7b-571b6767ce08', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935d332e10>]}
[0m06:02:19.840985 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:19.846097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51a7c7a8-b93b-4a05-8a7b-571b6767ce08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935d50caa0>]}
[0m06:02:19.971154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51a7c7a8-b93b-4a05-8a7b-571b6767ce08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93646d9910>]}
[0m06:02:19.971742 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:19.972291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51a7c7a8-b93b-4a05-8a7b-571b6767ce08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935d2959d0>]}
[0m06:02:19.974092 [info ] [MainThread]: 
[0m06:02:19.974853 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:19.979582 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:20.015635 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:20.016142 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:20.016569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:20.507622 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.509284 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:20.511434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:20.512009 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:20.519374 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:20.519835 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:20.520400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:20.526155 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.527515 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:20.527935 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:20.528467 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.528885 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:20.529281 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:20.529948 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.530886 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:20.531409 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:20.531978 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:20.532765 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.533196 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:20.535353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:20.541518 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:20.541946 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:20.542335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:20.547215 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.547644 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:20.548057 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:20.569713 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.576226 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:20.577534 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:20.577971 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:20.581759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51a7c7a8-b93b-4a05-8a7b-571b6767ce08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9364181490>]}
[0m06:02:20.582303 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.582721 [debug] [MainThread]: On master: BEGIN
[0m06:02:20.583113 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:20.588938 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.589384 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.589833 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.590230 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.590850 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.591272 [debug] [MainThread]: On master: Close
[0m06:02:20.592766 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:20.593290 [info ] [MainThread]: 
[0m06:02:20.635241 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:20.635944 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:20.636710 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:20.637185 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:20.663340 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:20.664116 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:20.698422 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:20.699169 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:28.712394 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.712934 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:28.713610 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.714084 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.714534 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:28.715367 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.718080 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.718563 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:28.719375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.739984 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:28.740487 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.740950 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:28.742761 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.747503 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.748004 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:28.749282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.751648 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:28.778445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a7c7a8-b93b-4a05-8a7b-571b6767ce08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935d7b0140>]}
[0m06:02:28.779211 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.14s]
[0m06:02:28.780006 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:28.781010 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:28.781613 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:28.782245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:28.782714 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:28.787645 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:28.788307 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:28.821868 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.822402 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240718060228815884"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:28.822890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:28.839427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.846653 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.847149 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:28.847767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.848239 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.848701 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240718060228815884'
      
      
      order by ordinal_position

  
[0m06:02:28.875916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.881218 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.881764 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:28.896315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.905321 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.905854 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:28.915040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.933078 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:28.933832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.934318 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240718060228815884"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240718060228815884"
    )
  
[0m06:02:28.950179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.951998 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:28.952478 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.952924 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:28.961570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.962522 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:29.091080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a7c7a8-b93b-4a05-8a7b-571b6767ce08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9330c98350>]}
[0m06:02:29.091972 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m06:02:29.092783 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:29.094170 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.094672 [debug] [MainThread]: On master: BEGIN
[0m06:02:29.095129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:29.100507 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.100992 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.101498 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.101948 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.102640 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.103107 [debug] [MainThread]: On master: Close
[0m06:02:29.104520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:29.104966 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:29.105379 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:29.105895 [info ] [MainThread]: 
[0m06:02:29.106432 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.13 seconds (9.13s).
[0m06:02:29.107450 [debug] [MainThread]: Command end result
[0m06:02:29.135420 [info ] [MainThread]: 
[0m06:02:29.136102 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:29.136621 [info ] [MainThread]: 
[0m06:02:29.137155 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:29.138198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.079559, "process_user_time": 4.929361, "process_kernel_time": 0.257534, "process_mem_max_rss": "284688", "process_in_blocks": "1184", "process_out_blocks": "107536"}
[0m06:02:29.138856 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:29.138737 after 11.08 seconds
[0m06:02:29.139354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9364c8cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9364a97110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9330ca9310>]}
[0m06:02:29.139849 [debug] [MainThread]: Flushing usage events
[0m06:02:30.776239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f086bc52b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f086b4467b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f086cafa060>]}


============================== 06:02:30.779132 | 7913b3d7-3669-4667-8bd0-6a7c5c0f4995 ==============================
[0m06:02:30.779132 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:30.779872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:30.921578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7913b3d7-3669-4667-8bd0-6a7c5c0f4995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f086bf48800>]}
[0m06:02:30.938626 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21103957, "process_user_time": 1.417896, "process_kernel_time": 0.10784, "process_mem_max_rss": "92088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:30.939227 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:30.939124 after 0.21 seconds
[0m06:02:30.939676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f086bf04440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f086afc2690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f086ae1d610>]}
[0m06:02:30.940119 [debug] [MainThread]: Flushing usage events
[0m14:04:55.870521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb0a045b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb096c2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb096c1d00>]}


============================== 14:04:55.907780 | 15070af0-5d59-401a-a062-313d47bd8a77 ==============================
[0m14:04:55.907780 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:55.908472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:56.058241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15070af0-5d59-401a-a062-313d47bd8a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb0970d100>]}
[0m14:04:56.072612 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zlr8pvf5'
[0m14:04:56.073142 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:56.186316 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:56.187106 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:56.221299 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:56.225249 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:56.587330 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:56.587926 [info ] [MainThread]: Up to date!
[0m14:04:56.588512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '15070af0-5d59-401a-a062-313d47bd8a77', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb093d2840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb0957ee70>]}
[0m14:04:56.590575 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7690504, "process_user_time": 1.617904, "process_kernel_time": 0.144527, "process_mem_max_rss": "93304", "process_in_blocks": "5488", "process_out_blocks": "3848"}
[0m14:04:56.591191 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:56.591082 after 0.77 seconds
[0m14:04:56.591677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb09420380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb09b5ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb09b5ce00>]}
[0m14:04:56.592390 [debug] [MainThread]: Flushing usage events
[0m14:04:58.542771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c48f7d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c46fdd490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c46f9adb0>]}


============================== 14:04:58.545675 | 454ed50f-0856-4e1d-9cef-2720014c25de ==============================
[0m14:04:58.545675 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:58.546368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:58.778011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '454ed50f-0856-4e1d-9cef-2720014c25de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c46c467b0>]}
[0m14:04:58.837904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '454ed50f-0856-4e1d-9cef-2720014c25de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c48145280>]}
[0m14:04:58.838877 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:58.881100 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:58.881918 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:58.882510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '454ed50f-0856-4e1d-9cef-2720014c25de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c46ab09b0>]}
[0m14:05:00.104010 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:00.104724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '454ed50f-0856-4e1d-9cef-2720014c25de', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c3fd2d4c0>]}
[0m14:05:00.287678 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:00.293075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '454ed50f-0856-4e1d-9cef-2720014c25de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c46a55490>]}
[0m14:05:00.426107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '454ed50f-0856-4e1d-9cef-2720014c25de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c47a98da0>]}
[0m14:05:00.426699 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:00.427246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '454ed50f-0856-4e1d-9cef-2720014c25de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c3fc91220>]}
[0m14:05:00.428982 [info ] [MainThread]: 
[0m14:05:00.429708 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:00.434568 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:00.470713 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:00.471236 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:00.471646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:01.201767 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:01.203358 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:01.205767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:01.206400 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:01.213272 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:01.213739 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:01.214202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:01.220027 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:01.221437 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:01.221866 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:01.222806 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:01.223217 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:01.223608 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:01.224234 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:01.225186 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:01.225595 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:01.225983 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:01.226584 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:01.227004 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:01.229252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:01.234826 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:01.235285 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:01.235675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:01.240831 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:01.241255 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:01.241659 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:01.261687 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:01.266435 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:01.267688 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:01.268125 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:01.271602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '454ed50f-0856-4e1d-9cef-2720014c25de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c3fc50560>]}
[0m14:05:01.272160 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:01.272564 [debug] [MainThread]: On master: BEGIN
[0m14:05:01.272954 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:01.278267 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:01.278711 [debug] [MainThread]: On master: COMMIT
[0m14:05:01.279107 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:01.279495 [debug] [MainThread]: On master: COMMIT
[0m14:05:01.280145 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:01.280566 [debug] [MainThread]: On master: Close
[0m14:05:01.282229 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:01.282729 [info ] [MainThread]: 
[0m14:05:01.291694 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:01.292361 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:01.293029 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:01.293488 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:01.319120 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:01.319945 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:01.354213 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:01.355060 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:21.132693 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:21.133224 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:21.133864 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.134394 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:21.134834 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:21.135519 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.138341 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:21.138811 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:21.139492 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.160051 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:21.160554 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:21.160997 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:21.162603 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.167456 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:21.167933 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:21.169216 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.171603 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:21.198421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '454ed50f-0856-4e1d-9cef-2720014c25de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c47556fc0>]}
[0m14:05:21.199229 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 19.90s]
[0m14:05:21.200018 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:21.201034 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:21.201609 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:21.202262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:21.202735 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:21.207802 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:21.208459 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:21.241798 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.242383 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240718140521235936"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:21.242873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:21.259415 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.266826 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.267315 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:21.267929 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.268394 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.268839 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240718140521235936'
      
      
      order by ordinal_position

  
[0m14:05:21.295016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.300221 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.300715 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:21.310243 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.318961 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.319450 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:21.328562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.346407 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:21.347119 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.347597 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240718140521235936"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240718140521235936"
    )
  
[0m14:05:21.364477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.366595 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:21.367108 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.367569 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:21.377424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.378624 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:21.508817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '454ed50f-0856-4e1d-9cef-2720014c25de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0f0c8e90>]}
[0m14:05:21.509680 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m14:05:21.510614 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:21.512209 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.512704 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.513150 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:21.518606 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.519092 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.519534 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.519964 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.520655 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.521128 [debug] [MainThread]: On master: Close
[0m14:05:21.522787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:21.523233 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:21.523647 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:21.524126 [info ] [MainThread]: 
[0m14:05:21.524680 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 21.09 seconds (21.09s).
[0m14:05:21.525718 [debug] [MainThread]: Command end result
[0m14:05:21.553948 [info ] [MainThread]: 
[0m14:05:21.554702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:21.555226 [info ] [MainThread]: 
[0m14:05:21.555760 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:21.556800 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 23.06316, "process_user_time": 4.771384, "process_kernel_time": 0.331401, "process_mem_max_rss": "284836", "process_in_blocks": "1184", "process_out_blocks": "108040"}
[0m14:05:21.557467 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:21.557343 after 23.06 seconds
[0m14:05:21.557978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c48f7d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0f86ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0f018fb0>]}
[0m14:05:21.558521 [debug] [MainThread]: Flushing usage events
[0m14:05:23.866586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7154b59b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715336cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715382a930>]}


============================== 14:05:23.869633 | 930b0e7f-974a-488f-9a01-0dac0ff00e57 ==============================
[0m14:05:23.869633 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.870423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:24.019440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '930b0e7f-974a-488f-9a01-0dac0ff00e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71525bbf20>]}
[0m14:05:24.036393 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21975046, "process_user_time": 1.458071, "process_kernel_time": 0.104147, "process_mem_max_rss": "92096", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:24.037005 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:24.036898 after 0.22 seconds
[0m14:05:24.037459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71527d67b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7152fe21b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7152836cf0>]}
[0m14:05:24.037907 [debug] [MainThread]: Flushing usage events
[0m22:05:35.173517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1111bb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe110ee33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1116c4b90>]}


============================== 22:05:35.180245 | 5ff9b5ef-83bb-486c-9fd9-215398e8f60f ==============================
[0m22:05:35.180245 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:35.180907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:35.317012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ff9b5ef-83bb-486c-9fd9-215398e8f60f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe110c0b050>]}
[0m22:05:35.329896 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1bd1im4d'
[0m22:05:35.330344 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:35.415007 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:35.415645 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:35.428339 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:35.432075 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:35.582142 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:35.582639 [info ] [MainThread]: Up to date!
[0m22:05:35.583167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5ff9b5ef-83bb-486c-9fd9-215398e8f60f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe110ab74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe110ab7320>]}
[0m22:05:35.584491 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45885468, "process_user_time": 1.513863, "process_kernel_time": 0.143797, "process_mem_max_rss": "93464", "process_in_blocks": "5488", "process_out_blocks": "3848"}
[0m22:05:35.585067 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:35.584963 after 0.46 seconds
[0m22:05:35.585499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1116c4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe111512c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe110aac650>]}
[0m22:05:35.585925 [debug] [MainThread]: Flushing usage events
[0m22:05:37.180706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920a31ad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920b445f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9209ca5b20>]}


============================== 22:05:37.183385 | 56215796-3530-4a3f-b96f-c8086b7583eb ==============================
[0m22:05:37.183385 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:37.184061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:37.406633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56215796-3530-4a3f-b96f-c8086b7583eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92097d1dc0>]}
[0m22:05:37.465254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56215796-3530-4a3f-b96f-c8086b7583eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920abe1dc0>]}
[0m22:05:37.465976 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:37.512708 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:37.513419 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:37.513967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '56215796-3530-4a3f-b96f-c8086b7583eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920966f350>]}
[0m22:05:38.714453 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:38.715102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '56215796-3530-4a3f-b96f-c8086b7583eb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9202b0f500>]}
[0m22:05:38.893761 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:38.898605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56215796-3530-4a3f-b96f-c8086b7583eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9202b32690>]}
[0m22:05:39.036101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56215796-3530-4a3f-b96f-c8086b7583eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92029b3e90>]}
[0m22:05:39.036672 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:39.037215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56215796-3530-4a3f-b96f-c8086b7583eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9202a5b680>]}
[0m22:05:39.039407 [info ] [MainThread]: 
[0m22:05:39.040340 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:39.047584 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:39.085371 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:39.085831 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:39.086291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:39.439801 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.441364 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:39.443805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:39.444408 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:39.451266 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.451774 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:39.452179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:39.457573 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.458900 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.459358 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:39.460240 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.460697 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.461096 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:39.461730 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.462671 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:39.463081 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.463513 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:39.464057 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.464478 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:39.466428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:39.471746 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:39.472173 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:39.472562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:39.477563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.477982 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:39.478397 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:39.498257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.504907 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:39.506108 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:39.506520 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:39.509715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56215796-3530-4a3f-b96f-c8086b7583eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920a148fe0>]}
[0m22:05:39.510244 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:39.510643 [debug] [MainThread]: On master: BEGIN
[0m22:05:39.511019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:39.516186 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:39.516620 [debug] [MainThread]: On master: COMMIT
[0m22:05:39.517016 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:39.517404 [debug] [MainThread]: On master: COMMIT
[0m22:05:39.517916 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:39.518326 [debug] [MainThread]: On master: Close
[0m22:05:39.519755 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:39.520300 [info ] [MainThread]: 
[0m22:05:39.529225 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:39.529821 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:39.530548 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:39.531004 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:39.556419 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:39.557167 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:39.591042 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:39.591786 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:48.046807 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.047323 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:48.047899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.048328 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.048741 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:48.049554 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.052204 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.052662 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:48.053427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.073637 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:48.074118 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.074562 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:48.075894 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.080612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.081100 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:48.082153 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.084456 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:48.110459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56215796-3530-4a3f-b96f-c8086b7583eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d5d5cb30>]}
[0m22:05:48.111171 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.58s]
[0m22:05:48.112089 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:48.113060 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:48.113629 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:48.114303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:48.114771 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:48.119568 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:48.120218 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:48.153053 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.153574 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240718220548147256"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:48.154059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:48.167933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.174654 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.175136 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:48.175770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.176231 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.176686 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240718220548147256'
      
      
      order by ordinal_position

  
[0m22:05:48.203314 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.208131 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.208622 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:48.222828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.231228 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.231755 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:48.240259 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.258056 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:48.258734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.259222 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240718220548147256"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240718220548147256"
    )
  
[0m22:05:48.277291 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.279005 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:48.279533 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.279979 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:48.289856 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.290735 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:48.416517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56215796-3530-4a3f-b96f-c8086b7583eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d5ca6a80>]}
[0m22:05:48.417262 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m22:05:48.418131 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:48.419521 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:48.419996 [debug] [MainThread]: On master: BEGIN
[0m22:05:48.420434 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:48.425589 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:48.426068 [debug] [MainThread]: On master: COMMIT
[0m22:05:48.426513 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:48.426945 [debug] [MainThread]: On master: COMMIT
[0m22:05:48.427693 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:48.428152 [debug] [MainThread]: On master: Close
[0m22:05:48.429509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:48.429954 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:48.430375 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:48.430851 [info ] [MainThread]: 
[0m22:05:48.431486 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.39 seconds (9.39s).
[0m22:05:48.432611 [debug] [MainThread]: Command end result
[0m22:05:48.460073 [info ] [MainThread]: 
[0m22:05:48.460755 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:48.461351 [info ] [MainThread]: 
[0m22:05:48.461959 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:48.463024 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.330448, "process_user_time": 4.792788, "process_kernel_time": 0.292292, "process_mem_max_rss": "286964", "process_in_blocks": "1184", "process_out_blocks": "108064"}
[0m22:05:48.463717 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:48.463605 after 11.33 seconds
[0m22:05:48.464218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920a82b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9209cd0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d5cf4fb0>]}
[0m22:05:48.464709 [debug] [MainThread]: Flushing usage events
[0m22:05:50.150623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f6c14f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f6e77b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f6ca21b50>]}


============================== 22:05:50.153232 | 2d2d02b8-6c60-4881-95e8-3b0ce3d74569 ==============================
[0m22:05:50.153232 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:50.153857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:05:50.285221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d2d02b8-6c60-4881-95e8-3b0ce3d74569', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f6bf33a70>]}
[0m22:05:50.301226 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19888134, "process_user_time": 1.395146, "process_kernel_time": 0.095941, "process_mem_max_rss": "92248", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:50.301797 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:50.301696 after 0.20 seconds
[0m22:05:50.302228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f6cecb8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f6bf31610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f6be17d40>]}
[0m22:05:50.302659 [debug] [MainThread]: Flushing usage events
[0m06:02:01.279482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f637ae9fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f637ae9ef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f637ae9ddf0>]}


============================== 06:02:01.337498 | 0c344e21-dde5-46bf-8f4f-1c72ccf0e63e ==============================
[0m06:02:01.337498 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:01.338165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:01.473504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c344e21-dde5-46bf-8f4f-1c72ccf0e63e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f637a383b30>]}
[0m06:02:01.486801 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-f6l0r2_t'
[0m06:02:01.487254 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:01.560279 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:01.560880 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:01.584380 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:01.588091 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:01.659074 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:01.659574 [info ] [MainThread]: Up to date!
[0m06:02:01.660101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0c344e21-dde5-46bf-8f4f-1c72ccf0e63e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f637a221640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f637a20d250>]}
[0m06:02:01.661506 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4301926, "process_user_time": 1.505329, "process_kernel_time": 0.161863, "process_mem_max_rss": "93448", "process_in_blocks": "5488", "process_out_blocks": "3848"}
[0m06:02:01.662084 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:01.661981 after 0.43 seconds
[0m06:02:01.662561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f637a51f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f637a56a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f637a221640>]}
[0m06:02:01.662992 [debug] [MainThread]: Flushing usage events
[0m06:02:03.239239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd77883e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd78254800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd78256cc0>]}


============================== 06:02:03.241935 | 0372d28d-75b0-48ef-8fcc-de96095b6630 ==============================
[0m06:02:03.241935 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:03.242621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:03.463543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0372d28d-75b0-48ef-8fcc-de96095b6630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd79c4d610>]}
[0m06:02:03.522878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0372d28d-75b0-48ef-8fcc-de96095b6630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd777561b0>]}
[0m06:02:03.523669 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:03.565871 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:03.566625 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:03.567170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0372d28d-75b0-48ef-8fcc-de96095b6630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd776c4530>]}
[0m06:02:04.784781 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:04.785497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0372d28d-75b0-48ef-8fcc-de96095b6630', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd70de2480>]}
[0m06:02:04.964655 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:04.969456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0372d28d-75b0-48ef-8fcc-de96095b6630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd70c3d3a0>]}
[0m06:02:05.091005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0372d28d-75b0-48ef-8fcc-de96095b6630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd70950cb0>]}
[0m06:02:05.091616 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:05.092150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0372d28d-75b0-48ef-8fcc-de96095b6630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd709b7e30>]}
[0m06:02:05.093850 [info ] [MainThread]: 
[0m06:02:05.094581 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:05.099420 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:05.133950 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:05.134427 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:05.134838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:05.640593 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:05.642178 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:05.644452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:05.645071 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:05.652028 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.652474 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:05.652873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:05.658249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.659619 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.660026 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:05.660646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.661054 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.661441 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:05.662066 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.663039 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:05.663447 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.663830 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:05.664363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.664773 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:05.666963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:05.672257 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:05.672678 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:05.673058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:05.677911 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.678374 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:05.678781 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:05.698246 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.703245 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:05.704474 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:05.704892 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:05.707704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0372d28d-75b0-48ef-8fcc-de96095b6630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd7ad71700>]}
[0m06:02:05.708214 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:05.708611 [debug] [MainThread]: On master: BEGIN
[0m06:02:05.708989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:05.713996 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:05.714459 [debug] [MainThread]: On master: COMMIT
[0m06:02:05.714858 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:05.715237 [debug] [MainThread]: On master: COMMIT
[0m06:02:05.715864 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:05.716274 [debug] [MainThread]: On master: Close
[0m06:02:05.717746 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:05.718307 [info ] [MainThread]: 
[0m06:02:05.731714 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:05.732319 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:05.733093 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:05.733544 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:05.759553 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:05.760297 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:05.794651 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:05.795382 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:04:27.483824 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:04:27.484426 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:04:27.485463 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:27.485937 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:04:27.486437 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:04:27.487243 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:27.490177 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:04:27.490680 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:04:27.491379 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:27.512123 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:04:27.512608 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:04:27.513059 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:04:27.514242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:27.519051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:04:27.519553 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:04:27.520659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:27.523036 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:04:27.548621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0372d28d-75b0-48ef-8fcc-de96095b6630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd44388200>]}
[0m06:04:27.549375 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 141.81s]
[0m06:04:27.550204 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:04:27.551227 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:04:27.551799 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:04:27.552454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:04:27.552919 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:04:27.557899 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:04:27.558610 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:04:27.591911 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:27.592432 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240719060427586029"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:04:27.592927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:04:27.608817 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:27.615878 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:27.616353 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:04:27.616960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:27.617424 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:27.617889 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240719060427586029'
      
      
      order by ordinal_position

  
[0m06:04:27.644301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:27.649194 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:27.649685 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:04:27.658126 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:27.665390 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:27.665875 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:04:27.674359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:27.693305 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:04:27.694006 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:27.694519 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240719060427586029"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240719060427586029"
    )
  
[0m06:04:27.711840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:27.713754 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:04:27.714222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:27.714718 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:04:27.724832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:27.725723 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:04:27.866426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0372d28d-75b0-48ef-8fcc-de96095b6630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd4421e120>]}
[0m06:04:27.867257 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m06:04:27.868086 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:04:27.869477 [debug] [MainThread]: Using duckdb connection "master"
[0m06:04:27.869954 [debug] [MainThread]: On master: BEGIN
[0m06:04:27.870429 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:04:27.875683 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:04:27.876157 [debug] [MainThread]: On master: COMMIT
[0m06:04:27.876596 [debug] [MainThread]: Using duckdb connection "master"
[0m06:04:27.877024 [debug] [MainThread]: On master: COMMIT
[0m06:04:27.877575 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:04:27.878030 [debug] [MainThread]: On master: Close
[0m06:04:27.879428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:04:27.879865 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:04:27.880270 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:04:27.880731 [info ] [MainThread]: 
[0m06:04:27.881265 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 2 minutes and 22.79 seconds (142.79s).
[0m06:04:27.882369 [debug] [MainThread]: Command end result
[0m06:04:27.910339 [info ] [MainThread]: 
[0m06:04:27.910967 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:04:27.911479 [info ] [MainThread]: 
[0m06:04:27.912002 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:04:27.912982 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 144.7228, "process_user_time": 4.848024, "process_kernel_time": 0.266462, "process_mem_max_rss": "298428", "process_in_blocks": "1184", "process_out_blocks": "108152"}
[0m06:04:27.913619 [debug] [MainThread]: Command `dbt run` succeeded at 06:04:27.913511 after 144.72 seconds
[0m06:04:27.914109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd77be9b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd4497ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd77d39700>]}
[0m06:04:27.914644 [debug] [MainThread]: Flushing usage events
[0m06:04:29.637881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690a34acf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6909a85a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690a34ade0>]}


============================== 06:04:29.640774 | 87ce09b5-f731-4709-a279-16f9ce79ce55 ==============================
[0m06:04:29.640774 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:04:29.641520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:04:29.779385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87ce09b5-f731-4709-a279-16f9ce79ce55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690980b050>]}
[0m06:04:29.797478 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20820664, "process_user_time": 1.401659, "process_kernel_time": 0.103826, "process_mem_max_rss": "92228", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:04:29.798073 [debug] [MainThread]: Command `dbt clean` succeeded at 06:04:29.797969 after 0.21 seconds
[0m06:04:29.798564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6909a85a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69098099a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690d3bbd10>]}
[0m06:04:29.799038 [debug] [MainThread]: Flushing usage events
[0m14:05:46.810564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17c1dee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17c94e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17b9eecc0>]}


============================== 14:05:46.838321 | ea8ece38-1bd3-46a1-a23e-2fd0b9764a74 ==============================
[0m14:05:46.838321 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:46.839042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:46.975906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea8ece38-1bd3-46a1-a23e-2fd0b9764a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17b6b8b00>]}
[0m14:05:46.991295 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-90c4rcul'
[0m14:05:46.991758 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:47.091985 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:47.092621 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:47.115689 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:47.119448 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:47.189741 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:47.190287 [info ] [MainThread]: Up to date!
[0m14:05:47.190860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ea8ece38-1bd3-46a1-a23e-2fd0b9764a74', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17bc2c3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17b5b33e0>]}
[0m14:05:47.477386 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7166094, "process_user_time": 1.611305, "process_kernel_time": 0.11251, "process_mem_max_rss": "93192", "process_in_blocks": "5488", "process_out_blocks": "3848"}
[0m14:05:47.478055 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:47.477948 after 0.72 seconds
[0m14:05:47.478498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17f567d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17bc817c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17b6ba270>]}
[0m14:05:47.478962 [debug] [MainThread]: Flushing usage events
[0m14:05:49.011947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e52459d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e3bcb860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e3bcbda0>]}


============================== 14:05:49.014642 | e9e230ed-8481-4c11-9b3f-f58a90bffbda ==============================
[0m14:05:49.014642 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:49.015371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:49.238426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9e230ed-8481-4c11-9b3f-f58a90bffbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e37c3590>]}
[0m14:05:49.297170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9e230ed-8481-4c11-9b3f-f58a90bffbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e46a0500>]}
[0m14:05:49.297915 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:49.312678 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:49.313393 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:49.313981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e9e230ed-8481-4c11-9b3f-f58a90bffbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64dcb17c50>]}
[0m14:05:50.522745 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:50.523436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e9e230ed-8481-4c11-9b3f-f58a90bffbda', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64dc994620>]}
[0m14:05:50.702199 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:50.706997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9e230ed-8481-4c11-9b3f-f58a90bffbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64dc8f7fe0>]}
[0m14:05:50.827538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9e230ed-8481-4c11-9b3f-f58a90bffbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64dc752060>]}
[0m14:05:50.828088 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:50.828583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9e230ed-8481-4c11-9b3f-f58a90bffbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e5b334a0>]}
[0m14:05:50.830276 [info ] [MainThread]: 
[0m14:05:50.830974 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:50.835776 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:50.870075 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:50.870525 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:50.870939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:51.397438 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:51.399017 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:51.401286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:51.401906 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:51.408669 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:51.409120 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:51.409525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:51.415305 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:51.416635 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:51.417050 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:51.417982 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:51.418393 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:51.418784 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:51.419407 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:51.420342 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:51.420747 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:51.421131 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:51.421700 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:51.422117 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:51.424168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:51.429388 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:51.429850 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:51.430238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:51.435285 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:51.435715 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:51.436122 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:51.456767 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:51.463039 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:51.464210 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:51.464627 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:51.467856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9e230ed-8481-4c11-9b3f-f58a90bffbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e52452e0>]}
[0m14:05:51.468380 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:51.468785 [debug] [MainThread]: On master: BEGIN
[0m14:05:51.469165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:51.474277 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:51.474702 [debug] [MainThread]: On master: COMMIT
[0m14:05:51.475098 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:51.475480 [debug] [MainThread]: On master: COMMIT
[0m14:05:51.476111 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:51.476519 [debug] [MainThread]: On master: Close
[0m14:05:51.477999 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:51.478512 [info ] [MainThread]: 
[0m14:05:51.487190 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:51.487788 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:51.488446 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:51.488893 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:51.514121 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:51.514869 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:51.548571 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:51.549315 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:08:12.068768 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:08:12.069357 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:08:12.070369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:12.070847 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:08:12.071305 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:08:12.072062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:12.074921 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:08:12.075406 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:08:12.076109 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:12.096524 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:08:12.097014 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:08:12.097477 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:08:12.098996 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:12.103651 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:08:12.104126 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:08:12.105289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:12.107592 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:08:12.134348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9e230ed-8481-4c11-9b3f-f58a90bffbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b00768d0>]}
[0m14:08:12.135069 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 140.65s]
[0m14:08:12.135849 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:08:12.136826 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:08:12.137405 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:08:12.138011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:08:12.138480 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:08:12.143199 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:08:12.143854 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:08:12.176628 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:12.177139 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240719140812170897"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:08:12.177639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:12.191821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:12.198576 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:12.199052 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:08:12.199639 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:12.200102 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:12.200548 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240719140812170897'
      
      
      order by ordinal_position

  
[0m14:08:12.232995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:12.237835 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:12.238323 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:08:12.247270 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:12.254581 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:12.255066 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:08:12.263156 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:12.281965 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:08:12.282628 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:12.283101 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240719140812170897"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240719140812170897"
    )
  
[0m14:08:12.299561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:12.301255 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:08:12.301752 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:08:12.302188 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:08:12.312121 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:08:12.313005 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:08:12.459085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9e230ed-8481-4c11-9b3f-f58a90bffbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b01ff110>]}
[0m14:08:12.459836 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m14:08:12.460596 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:08:12.461918 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:12.462400 [debug] [MainThread]: On master: BEGIN
[0m14:08:12.462842 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:12.468182 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:08:12.468665 [debug] [MainThread]: On master: COMMIT
[0m14:08:12.469108 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:12.469538 [debug] [MainThread]: On master: COMMIT
[0m14:08:12.470312 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:08:12.470780 [debug] [MainThread]: On master: Close
[0m14:08:12.472459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:12.472904 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:08:12.473320 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:08:12.473839 [info ] [MainThread]: 
[0m14:08:12.474389 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 2 minutes and 21.64 seconds (141.64s).
[0m14:08:12.475395 [debug] [MainThread]: Command end result
[0m14:08:12.503301 [info ] [MainThread]: 
[0m14:08:12.503930 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:08:12.504440 [info ] [MainThread]: 
[0m14:08:12.504957 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:08:12.505977 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 143.54222, "process_user_time": 4.828935, "process_kernel_time": 0.271154, "process_mem_max_rss": "282228", "process_in_blocks": "1184", "process_out_blocks": "108632"}
[0m14:08:12.506633 [debug] [MainThread]: Command `dbt run` succeeded at 14:08:12.506522 after 143.54 seconds
[0m14:08:12.507134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e38cecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e372bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b015ce60>]}
[0m14:08:12.507629 [debug] [MainThread]: Flushing usage events
[0m14:08:14.199875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2d4ef710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2d4eef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2f4358e0>]}


============================== 14:08:14.202597 | 1fbcaada-2f65-43cd-824c-66fd95a63b7d ==============================
[0m14:08:14.202597 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:08:14.203274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:08:14.338553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fbcaada-2f65-43cd-824c-66fd95a63b7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2e17ce90>]}
[0m14:08:14.356116 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20490262, "process_user_time": 1.330111, "process_kernel_time": 0.163767, "process_mem_max_rss": "92092", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:08:14.356692 [debug] [MainThread]: Command `dbt clean` succeeded at 14:08:14.356589 after 0.21 seconds
[0m14:08:14.357139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2cf419a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2cf417f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2cf8a060>]}
[0m14:08:14.357580 [debug] [MainThread]: Flushing usage events
[0m22:06:13.825720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15689fddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1568037da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1568036210>]}


============================== 22:06:13.833396 | 3e35ef88-afa8-490a-b25d-5e93eb6811fb ==============================
[0m22:06:13.833396 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:13.834065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:13.967384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e35ef88-afa8-490a-b25d-5e93eb6811fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f156891f8f0>]}
[0m22:06:13.980454 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-h634rxnt'
[0m22:06:13.980906 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:14.061628 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:14.062283 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:14.087062 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:14.090792 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:14.163057 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:14.163555 [info ] [MainThread]: Up to date!
[0m22:06:14.164080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3e35ef88-afa8-490a-b25d-5e93eb6811fb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1568bb3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1567d9b3e0>]}
[0m22:06:14.165520 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38760045, "process_user_time": 1.543914, "process_kernel_time": 0.12668, "process_mem_max_rss": "93572", "process_in_blocks": "5488", "process_out_blocks": "3840"}
[0m22:06:14.166106 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:14.166001 after 0.39 seconds
[0m22:06:14.166604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15689fddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1568bb3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1567e9c890>]}
[0m22:06:14.167045 [debug] [MainThread]: Flushing usage events
[0m22:06:15.771899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8dff3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8fc9b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8e512930>]}


============================== 22:06:15.774652 | 1ce7aea9-c8d4-412a-a464-ddd7136767b6 ==============================
[0m22:06:15.774652 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:15.775318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:15.992783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ce7aea9-c8d4-412a-a464-ddd7136767b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8d4a78f0>]}
[0m22:06:16.051210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ce7aea9-c8d4-412a-a464-ddd7136767b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8fc9b050>]}
[0m22:06:16.051938 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:06:16.067021 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:16.067737 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:16.068298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1ce7aea9-c8d4-412a-a464-ddd7136767b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8d43f680>]}
[0m22:06:17.271391 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:17.272069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1ce7aea9-c8d4-412a-a464-ddd7136767b6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8693a480>]}
[0m22:06:17.449487 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:17.454361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ce7aea9-c8d4-412a-a464-ddd7136767b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c86af4aa0>]}
[0m22:06:17.577736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ce7aea9-c8d4-412a-a464-ddd7136767b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8664d430>]}
[0m22:06:17.578307 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:17.578842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ce7aea9-c8d4-412a-a464-ddd7136767b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8668db50>]}
[0m22:06:17.580532 [info ] [MainThread]: 
[0m22:06:17.581261 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:17.586005 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:17.620775 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:17.621222 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:06:17.621638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:18.127652 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:18.129212 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:18.131375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:18.131975 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:18.138787 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:18.139240 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:06:18.139650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:18.145125 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:18.146504 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:18.146925 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:18.147574 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:18.147987 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:18.148383 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:18.148954 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:18.149876 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:18.150346 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:18.150754 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:18.151386 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:18.151810 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:18.153891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:18.159200 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:18.159630 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:18.160020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:18.164934 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:18.165358 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:18.165769 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:06:18.186114 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:18.190717 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:18.191922 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:18.192346 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:18.195679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ce7aea9-c8d4-412a-a464-ddd7136767b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8de7dfd0>]}
[0m22:06:18.196193 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:18.196597 [debug] [MainThread]: On master: BEGIN
[0m22:06:18.196975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:18.202017 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:18.202490 [debug] [MainThread]: On master: COMMIT
[0m22:06:18.202900 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:18.203290 [debug] [MainThread]: On master: COMMIT
[0m22:06:18.203929 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:18.204343 [debug] [MainThread]: On master: Close
[0m22:06:18.205834 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:18.206410 [info ] [MainThread]: 
[0m22:06:18.215958 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:18.216550 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:18.217279 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:18.217731 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:18.243385 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:18.244131 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:18.278235 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:18.278959 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:08:39.985268 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:39.985854 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:08:39.986701 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:39.987185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:39.987653 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:08:39.988432 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:39.991301 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:39.991785 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:08:39.992510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:40.013236 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:08:40.013729 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:40.014208 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:08:40.015555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:40.020293 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:08:40.020778 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:08:40.022294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:40.024609 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:08:40.053399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ce7aea9-c8d4-412a-a464-ddd7136767b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c866d2390>]}
[0m22:08:40.054125 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 141.84s]
[0m22:08:40.055053 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:08:40.056052 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:08:40.056641 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:08:40.057322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:08:40.057809 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:08:40.062700 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:08:40.063368 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:08:40.096528 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:40.097047 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240719220840090730"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:08:40.097536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:40.111099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:40.117956 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:40.118467 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:08:40.119063 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:40.119525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:40.119977 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240719220840090730'
      
      
      order by ordinal_position

  
[0m22:08:40.146646 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:40.151487 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:40.151978 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:08:40.166518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:40.173781 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:40.174290 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:08:40.188620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:40.207496 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:08:40.208184 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:40.208660 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240719220840090730"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240719220840090730"
    )
  
[0m22:08:40.224429 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:40.226222 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:08:40.226700 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:08:40.227137 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:08:40.235375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:40.236395 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:08:40.386550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ce7aea9-c8d4-412a-a464-ddd7136767b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c5a01f080>]}
[0m22:08:40.387342 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m22:08:40.388216 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:08:40.389535 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:40.390032 [debug] [MainThread]: On master: BEGIN
[0m22:08:40.390518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:08:40.395793 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:40.396276 [debug] [MainThread]: On master: COMMIT
[0m22:08:40.396725 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:40.397160 [debug] [MainThread]: On master: COMMIT
[0m22:08:40.397863 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:40.398404 [debug] [MainThread]: On master: Close
[0m22:08:40.399823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:40.400274 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:08:40.400696 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:08:40.401165 [info ] [MainThread]: 
[0m22:08:40.401739 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 2 minutes and 22.82 seconds (142.82s).
[0m22:08:40.402793 [debug] [MainThread]: Command end result
[0m22:08:40.430439 [info ] [MainThread]: 
[0m22:08:40.431115 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:08:40.431707 [info ] [MainThread]: 
[0m22:08:40.432319 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:08:40.433386 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 144.70972, "process_user_time": 4.784459, "process_kernel_time": 0.338335, "process_mem_max_rss": "300192", "process_in_blocks": "1184", "process_out_blocks": "108672"}
[0m22:08:40.434028 [debug] [MainThread]: Command `dbt run` succeeded at 22:08:40.433922 after 144.71 seconds
[0m22:08:40.434575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8d623740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c5aa33f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c5a0d0e90>]}
[0m22:08:40.435061 [debug] [MainThread]: Flushing usage events
[0m22:08:42.176730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa071f196a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa071da2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa072035be0>]}


============================== 22:08:42.179514 | d11ad1ed-b783-4527-aafb-f1f355672c1f ==============================
[0m22:08:42.179514 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:08:42.180177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:08:42.317033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd11ad1ed-b783-4527-aafb-f1f355672c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0718d8a10>]}
[0m22:08:42.334713 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20633854, "process_user_time": 1.375353, "process_kernel_time": 0.123582, "process_mem_max_rss": "92388", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:08:42.335296 [debug] [MainThread]: Command `dbt clean` succeeded at 22:08:42.335192 after 0.21 seconds
[0m22:08:42.335741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa072598da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa071a7c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0718ead50>]}
[0m22:08:42.336180 [debug] [MainThread]: Flushing usage events
[0m06:02:01.376335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab071ea000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab072f2f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab083470b0>]}


============================== 06:02:01.391780 | 534e8065-e226-4d25-a931-203330180daf ==============================
[0m06:02:01.391780 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:01.392550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:01.541460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '534e8065-e226-4d25-a931-203330180daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab06fdc920>]}
[0m06:02:01.555218 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-i7ltdmzj'
[0m06:02:01.555708 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:01.639539 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:01.640309 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:01.663997 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:01.667868 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:01.738945 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:01.739543 [info ] [MainThread]: Up to date!
[0m06:02:01.740100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '534e8065-e226-4d25-a931-203330180daf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab06f68200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab06f68380>]}
[0m06:02:01.748099 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42034155, "process_user_time": 1.613428, "process_kernel_time": 0.096805, "process_mem_max_rss": "93700", "process_in_blocks": "5488", "process_out_blocks": "3848"}
[0m06:02:01.748841 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:01.748712 after 0.42 seconds
[0m06:02:01.749351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab080b2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab07746180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab077459a0>]}
[0m06:02:01.749793 [debug] [MainThread]: Flushing usage events
[0m06:02:03.363511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74006a09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7401633590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74020fd070>]}


============================== 06:02:03.366584 | 13cfccb5-f956-4171-90c9-17b6a30cf0cc ==============================
[0m06:02:03.366584 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:03.367355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:03.600371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13cfccb5-f956-4171-90c9-17b6a30cf0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ffb6bb30>]}
[0m06:02:03.659749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13cfccb5-f956-4171-90c9-17b6a30cf0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ffbe2180>]}
[0m06:02:03.660656 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:03.676695 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:03.677464 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:03.678041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '13cfccb5-f956-4171-90c9-17b6a30cf0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ffbe1df0>]}
[0m06:02:04.894447 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:04.895188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '13cfccb5-f956-4171-90c9-17b6a30cf0cc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f8bc0bc0>]}
[0m06:02:05.076263 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:05.083747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13cfccb5-f956-4171-90c9-17b6a30cf0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f8708470>]}
[0m06:02:05.232078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13cfccb5-f956-4171-90c9-17b6a30cf0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f89a8260>]}
[0m06:02:05.232675 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:05.233208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13cfccb5-f956-4171-90c9-17b6a30cf0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f88af6b0>]}
[0m06:02:05.235023 [info ] [MainThread]: 
[0m06:02:05.235778 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:05.240547 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:05.276741 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:05.277271 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:05.277682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:05.781440 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:05.783529 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:05.786658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:05.787219 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:05.793889 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.794371 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:05.794782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:05.800501 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.801857 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.802270 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:05.803216 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.803629 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.804020 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:05.804593 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.805534 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:05.805946 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.806418 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:05.807057 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.807475 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:05.809642 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:05.815059 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:05.815485 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:05.815868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:05.820903 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.821324 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:05.821728 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:05.841804 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.846730 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:05.847941 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:05.848356 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:05.851841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13cfccb5-f956-4171-90c9-17b6a30cf0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f87455b0>]}
[0m06:02:05.852372 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:05.852775 [debug] [MainThread]: On master: BEGIN
[0m06:02:05.853164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:05.858616 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:05.859060 [debug] [MainThread]: On master: COMMIT
[0m06:02:05.859463 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:05.859847 [debug] [MainThread]: On master: COMMIT
[0m06:02:05.860484 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:05.860909 [debug] [MainThread]: On master: Close
[0m06:02:05.862602 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:05.863160 [info ] [MainThread]: 
[0m06:02:05.872427 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:05.873062 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:05.873818 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:05.874280 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:05.899977 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:05.900842 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:05.935267 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:05.936204 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:04:27.898343 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:04:27.898975 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:04:27.899821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:27.900313 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:04:27.900781 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:04:27.901605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:27.904627 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:04:27.905111 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:04:27.905867 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:27.926676 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:04:27.927178 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:04:27.927630 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:04:27.928937 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:27.933842 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:04:27.934360 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:04:27.935802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:27.938169 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:04:27.964064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13cfccb5-f956-4171-90c9-17b6a30cf0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f740140e5a0>]}
[0m06:04:27.964897 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 142.09s]
[0m06:04:27.965797 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:04:27.966832 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:04:27.967411 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:04:27.968099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:04:27.968569 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:04:27.973663 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:04:27.974393 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:04:28.007985 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:28.008558 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240720060428002066"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:04:28.009047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:04:28.024761 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:28.032144 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:28.032636 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:04:28.033350 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:28.033807 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:28.034269 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240720060428002066'
      
      
      order by ordinal_position

  
[0m06:04:28.061506 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:28.066804 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:28.067313 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:04:28.075962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:28.083484 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:28.083980 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:04:28.092659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:28.111945 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:04:28.112716 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:28.113211 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240720060428002066"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240720060428002066"
    )
  
[0m06:04:28.130164 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:28.132186 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:04:28.132688 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:04:28.133147 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:04:28.142277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:04:28.143237 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:04:28.298631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13cfccb5-f956-4171-90c9-17b6a30cf0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cc090650>]}
[0m06:04:28.299505 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m06:04:28.300404 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:04:28.301864 [debug] [MainThread]: Using duckdb connection "master"
[0m06:04:28.302405 [debug] [MainThread]: On master: BEGIN
[0m06:04:28.302862 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:04:28.308316 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:04:28.308806 [debug] [MainThread]: On master: COMMIT
[0m06:04:28.309254 [debug] [MainThread]: Using duckdb connection "master"
[0m06:04:28.309688 [debug] [MainThread]: On master: COMMIT
[0m06:04:28.310391 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:04:28.310869 [debug] [MainThread]: On master: Close
[0m06:04:28.312372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:04:28.312819 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:04:28.313236 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:04:28.313718 [info ] [MainThread]: 
[0m06:04:28.314283 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 2 minutes and 23.08 seconds (143.08s).
[0m06:04:28.315369 [debug] [MainThread]: Command end result
[0m06:04:28.343395 [info ] [MainThread]: 
[0m06:04:28.344083 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:04:28.344624 [info ] [MainThread]: 
[0m06:04:28.345179 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:04:28.346215 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 145.03207, "process_user_time": 4.979354, "process_kernel_time": 0.235969, "process_mem_max_rss": "284280", "process_in_blocks": "1184", "process_out_blocks": "109144"}
[0m06:04:28.346907 [debug] [MainThread]: Command `dbt run` succeeded at 06:04:28.346794 after 145.03 seconds
[0m06:04:28.347410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ffc87680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f41a71a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73cc116de0>]}
[0m06:04:28.347902 [debug] [MainThread]: Flushing usage events
[0m06:04:30.067350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c04ede80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9bee00e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9bee01400>]}


============================== 06:04:30.070278 | 136c02fd-3abe-41f1-9868-dab98b581560 ==============================
[0m06:04:30.070278 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:04:30.071063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:04:30.213167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '136c02fd-3abe-41f1-9868-dab98b581560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9be825100>]}
[0m06:04:30.231506 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21318057, "process_user_time": 1.454743, "process_kernel_time": 0.068128, "process_mem_max_rss": "91880", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:04:30.232117 [debug] [MainThread]: Command `dbt clean` succeeded at 06:04:30.232011 after 0.21 seconds
[0m06:04:30.232581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c23bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9bed52c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9be733e90>]}
[0m06:04:30.233032 [debug] [MainThread]: Flushing usage events
[0m14:04:41.884307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b96da3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b99805c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b96dbe90>]}


============================== 14:04:41.891574 | e79378f1-591d-4813-92cb-8686608feccf ==============================
[0m14:04:41.891574 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:41.892249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:04:42.028085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e79378f1-591d-4813-92cb-8686608feccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ba45cd40>]}
[0m14:04:42.041316 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mpu9inmn'
[0m14:04:42.041784 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:42.061543 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:42.062205 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:42.076715 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:42.080373 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:42.129654 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:42.130294 [info ] [MainThread]: Up to date!
[0m14:04:42.130809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e79378f1-591d-4813-92cb-8686608feccf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b9ae9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b97276b0>]}
[0m14:04:42.132323 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.2962364, "process_user_time": 1.561826, "process_kernel_time": 0.123511, "process_mem_max_rss": "93576", "process_in_blocks": "5488", "process_out_blocks": "3840"}
[0m14:04:42.132915 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:42.132812 after 0.30 seconds
[0m14:04:42.133363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b9eedb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b9531040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b93e63c0>]}
[0m14:04:42.133793 [debug] [MainThread]: Flushing usage events
[0m14:04:43.734235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7abc65cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ab1fe7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7aad10950>]}


============================== 14:04:43.737140 | 2a94eb65-faab-4f7a-853d-17473b7bc08a ==============================
[0m14:04:43.737140 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:43.737847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:43.959413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a94eb65-faab-4f7a-853d-17473b7bc08a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7aa004ce0>]}
[0m14:04:44.018376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a94eb65-faab-4f7a-853d-17473b7bc08a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ab6da600>]}
[0m14:04:44.019136 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:44.034432 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:44.035165 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:44.035713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2a94eb65-faab-4f7a-853d-17473b7bc08a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7aa0058b0>]}
[0m14:04:45.247388 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:45.248124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2a94eb65-faab-4f7a-853d-17473b7bc08a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7a35dd3d0>]}
[0m14:04:45.435748 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:45.440666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a94eb65-faab-4f7a-853d-17473b7bc08a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7a34dc860>]}
[0m14:04:45.594090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a94eb65-faab-4f7a-853d-17473b7bc08a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7a3125ca0>]}
[0m14:04:45.594671 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:45.595179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a94eb65-faab-4f7a-853d-17473b7bc08a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7a3222ea0>]}
[0m14:04:45.596878 [info ] [MainThread]: 
[0m14:04:45.597579 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:45.602468 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:45.637682 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:45.638176 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:45.638589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:46.129294 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:46.130906 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:46.133076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:46.133642 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:46.140438 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:46.140880 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:46.141284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:46.146949 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:46.148359 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:46.148771 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:46.149300 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:46.149705 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:46.150134 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:46.150705 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:46.151624 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:46.152040 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:46.152428 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:46.152981 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:46.153405 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:46.155594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:46.160984 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:46.161406 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:46.161790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:46.166962 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:46.167458 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:46.167867 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:46.187871 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:46.192614 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:46.193797 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:46.194249 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:46.197462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a94eb65-faab-4f7a-853d-17473b7bc08a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ab223fb0>]}
[0m14:04:46.197996 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:46.198438 [debug] [MainThread]: On master: BEGIN
[0m14:04:46.198816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:46.204018 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:46.204449 [debug] [MainThread]: On master: COMMIT
[0m14:04:46.204846 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:46.205228 [debug] [MainThread]: On master: COMMIT
[0m14:04:46.205869 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:46.206327 [debug] [MainThread]: On master: Close
[0m14:04:46.207816 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:46.208302 [info ] [MainThread]: 
[0m14:04:46.217825 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:46.218494 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:46.219123 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:46.219571 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:46.245038 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:46.245834 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:46.280833 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:46.281723 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:53.534323 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:53.534858 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:04:53.535623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.536094 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:53.536540 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:04:53.537240 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.539961 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:53.540433 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:04:53.541164 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.561530 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:53.562069 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:53.562531 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:53.563797 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.568558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:53.569040 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:04:53.570272 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.572634 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:04:53.599597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a94eb65-faab-4f7a-853d-17473b7bc08a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff777401c70>]}
[0m14:04:53.600382 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.38s]
[0m14:04:53.601169 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:04:53.602201 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:04:53.602782 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:04:53.603401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:04:53.603871 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:04:53.608911 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:04:53.609578 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:04:53.643773 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:53.644323 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240720140453637517"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:04:53.644824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:53.661067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.668253 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:53.668739 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:04:53.669335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.669800 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:53.670278 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240720140453637517'
      
      
      order by ordinal_position

  
[0m14:04:53.696851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.701918 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:53.702444 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:53.711251 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.719898 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:53.720399 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:53.729527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.747564 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:04:53.748284 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:53.748770 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240720140453637517"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240720140453637517"
    )
  
[0m14:04:53.765179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.767169 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:53.767645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:53.768091 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:53.777307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:53.778259 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:04:53.931953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a94eb65-faab-4f7a-853d-17473b7bc08a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff776bac560>]}
[0m14:04:53.932788 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m14:04:53.933658 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:04:53.935139 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:53.935641 [debug] [MainThread]: On master: BEGIN
[0m14:04:53.936095 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:53.941619 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:53.942154 [debug] [MainThread]: On master: COMMIT
[0m14:04:53.942602 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:53.943033 [debug] [MainThread]: On master: COMMIT
[0m14:04:53.943725 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:53.944186 [debug] [MainThread]: On master: Close
[0m14:04:53.945755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:53.946239 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:04:53.946653 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:04:53.947119 [info ] [MainThread]: 
[0m14:04:53.947637 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.35 seconds (8.35s).
[0m14:04:53.948631 [debug] [MainThread]: Command end result
[0m14:04:53.976475 [info ] [MainThread]: 
[0m14:04:53.977092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:53.977600 [info ] [MainThread]: 
[0m14:04:53.978155 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:53.979154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.2933855, "process_user_time": 4.88974, "process_kernel_time": 0.292343, "process_mem_max_rss": "291652", "process_in_blocks": "1184", "process_out_blocks": "109528"}
[0m14:04:53.979804 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:53.979693 after 10.29 seconds
[0m14:04:53.980302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7aa287ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7a31801a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7a31273e0>]}
[0m14:04:53.980802 [debug] [MainThread]: Flushing usage events
[0m14:04:55.629394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a327f9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a30d4f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a30d4de20>]}


============================== 14:04:55.632317 | f742a67f-4a15-40a5-944a-5071d513c153 ==============================
[0m14:04:55.632317 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:55.632980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:55.778522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f742a67f-4a15-40a5-944a-5071d513c153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a30cd4e90>]}
[0m14:04:55.795078 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21455212, "process_user_time": 1.443211, "process_kernel_time": 0.079735, "process_mem_max_rss": "92144", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:04:55.795681 [debug] [MainThread]: Command `dbt clean` succeeded at 14:04:55.795576 after 0.22 seconds
[0m14:04:55.796134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a3154ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a30b43050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a30a17f80>]}
[0m14:04:55.796579 [debug] [MainThread]: Flushing usage events
[0m22:05:12.144464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1141b5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa11132da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa11132e7b0>]}


============================== 22:05:12.151976 | 3d29a6ee-3fb4-40e6-a501-a36c7c7b821b ==============================
[0m22:05:12.151976 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:12.152732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:12.286626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d29a6ee-3fb4-40e6-a501-a36c7c7b821b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1113e1bb0>]}
[0m22:05:12.299869 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wxap2ahb'
[0m22:05:12.300395 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:12.386206 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:12.386845 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:12.408958 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:12.412675 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:12.485555 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:12.486042 [info ] [MainThread]: Up to date!
[0m22:05:12.486584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3d29a6ee-3fb4-40e6-a501-a36c7c7b821b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa11124ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa111c63170>]}
[0m22:05:12.488271 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.39197332, "process_user_time": 1.509843, "process_kernel_time": 0.147788, "process_mem_max_rss": "93324", "process_in_blocks": "5488", "process_out_blocks": "3848"}
[0m22:05:12.488863 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:12.488761 after 0.39 seconds
[0m22:05:12.489300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa11144e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa111134230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa110fea540>]}
[0m22:05:12.489732 [debug] [MainThread]: Flushing usage events
[0m22:05:14.046631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08987f6e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0897ecd7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0898e73a40>]}


============================== 22:05:14.049355 | 14a9f27f-b5be-4917-b22e-f287630e5d69 ==============================
[0m22:05:14.049355 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:14.050023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:14.268594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14a9f27f-b5be-4917-b22e-f287630e5d69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0897b983e0>]}
[0m22:05:14.327275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14a9f27f-b5be-4917-b22e-f287630e5d69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0899467650>]}
[0m22:05:14.328005 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:14.343513 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:14.344264 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:14.344818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '14a9f27f-b5be-4917-b22e-f287630e5d69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0897aefce0>]}
[0m22:05:15.545553 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:15.546208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '14a9f27f-b5be-4917-b22e-f287630e5d69', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f089104bd10>]}
[0m22:05:15.724532 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:15.729285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14a9f27f-b5be-4917-b22e-f287630e5d69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0897baa660>]}
[0m22:05:15.847539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14a9f27f-b5be-4917-b22e-f287630e5d69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0890da0e60>]}
[0m22:05:15.848137 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:15.848652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14a9f27f-b5be-4917-b22e-f287630e5d69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0897d27d10>]}
[0m22:05:15.850373 [info ] [MainThread]: 
[0m22:05:15.851105 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:15.855965 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:15.890765 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:15.891232 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:15.891665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:16.277063 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.278654 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:16.280961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:16.281568 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:16.288451 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:16.288911 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:16.289332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:16.294782 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.296152 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:16.296576 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:16.297431 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.297845 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:16.298241 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:16.298832 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.299754 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:16.300223 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:16.300627 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:16.301298 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.301730 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:16.303807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:16.309095 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:16.309521 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:16.309903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:16.314688 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.315104 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:16.315506 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:16.335139 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:16.340022 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:16.341254 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:16.341675 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:16.344773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14a9f27f-b5be-4917-b22e-f287630e5d69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088fbae210>]}
[0m22:05:16.345292 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:16.345693 [debug] [MainThread]: On master: BEGIN
[0m22:05:16.346061 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:16.351031 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:16.351456 [debug] [MainThread]: On master: COMMIT
[0m22:05:16.351848 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:16.352279 [debug] [MainThread]: On master: COMMIT
[0m22:05:16.352904 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:16.353315 [debug] [MainThread]: On master: Close
[0m22:05:16.354710 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:16.355195 [info ] [MainThread]: 
[0m22:05:16.364333 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:16.364929 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:16.365551 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:16.366009 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:16.392829 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:16.393580 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:16.427840 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:16.428607 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:23.624938 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:23.625454 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:23.626185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:23.626655 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:23.627102 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:23.627774 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:23.630431 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:23.630893 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:23.631700 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:23.652256 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:23.652740 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:23.653183 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:23.655087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:23.659779 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:23.660281 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:23.661583 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:23.663864 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:23.690365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14a9f27f-b5be-4917-b22e-f287630e5d69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0890d98a10>]}
[0m22:05:23.691078 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.32s]
[0m22:05:23.691958 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:23.692994 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:23.693582 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:23.694167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:23.694640 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:23.699426 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:23.700117 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:23.733287 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:23.733801 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240720220523727479"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:23.734275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:23.750191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:23.757067 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:23.757541 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:23.758189 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:23.758643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:23.759087 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240720220523727479'
      
      
      order by ordinal_position

  
[0m22:05:23.785076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:23.789873 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:23.790357 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:23.804469 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:23.812857 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:23.813346 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:23.821735 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:23.839395 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:23.840074 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:23.840591 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240720220523727479"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240720220523727479"
    )
  
[0m22:05:23.859064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:23.860881 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:23.861347 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:23.861784 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:23.871379 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:23.872300 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:24.043066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14a9f27f-b5be-4917-b22e-f287630e5d69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08641457c0>]}
[0m22:05:24.043894 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m22:05:24.044679 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:24.046023 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.046514 [debug] [MainThread]: On master: BEGIN
[0m22:05:24.046957 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:24.052339 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.052830 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.053276 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.053707 [debug] [MainThread]: On master: COMMIT
[0m22:05:24.054401 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:24.054872 [debug] [MainThread]: On master: Close
[0m22:05:24.056438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:24.056883 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:24.057298 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:24.057770 [info ] [MainThread]: 
[0m22:05:24.058380 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.21 seconds (8.21s).
[0m22:05:24.059506 [debug] [MainThread]: Command end result
[0m22:05:24.087200 [info ] [MainThread]: 
[0m22:05:24.087890 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:24.088525 [info ] [MainThread]: 
[0m22:05:24.089138 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:24.090216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.092268, "process_user_time": 4.875645, "process_kernel_time": 0.310702, "process_mem_max_rss": "301988", "process_in_blocks": "1184", "process_out_blocks": "109560"}
[0m22:05:24.090858 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:24.090748 after 10.09 seconds
[0m22:05:24.091364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08987f6e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0898d89d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0890fdda00>]}
[0m22:05:24.091857 [debug] [MainThread]: Flushing usage events
[0m22:05:25.688457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd161e94c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd15f92510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd16aec0e0>]}


============================== 22:05:25.691153 | 69cc08fc-41a7-4813-a430-8f6babb2e283 ==============================
[0m22:05:25.691153 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:25.691835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:05:25.829804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69cc08fc-41a7-4813-a430-8f6babb2e283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd15bccfe0>]}
[0m22:05:25.846262 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20627263, "process_user_time": 1.38802, "process_kernel_time": 0.108001, "process_mem_max_rss": "92232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:25.846855 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:25.846752 after 0.21 seconds
[0m22:05:25.847306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd15deeed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd15f92c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd162405c0>]}
[0m22:05:25.847742 [debug] [MainThread]: Flushing usage events
[0m06:02:06.558833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c0a42000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5be3ca2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5be3c8bc0>]}


============================== 06:02:06.566336 | f70eb26d-4933-494e-a251-2cb0e3556600 ==============================
[0m06:02:06.566336 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:06.567020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:06.701956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f70eb26d-4933-494e-a251-2cb0e3556600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5be333b30>]}
[0m06:02:06.715190 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-udl20cf4'
[0m06:02:06.715646 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:06.804834 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:06.805478 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:06.829393 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:06.833109 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:06.915420 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:06.915910 [info ] [MainThread]: Up to date!
[0m06:02:06.916427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f70eb26d-4933-494e-a251-2cb0e3556600', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5be0d6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5be12fef0>]}
[0m06:02:06.917935 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40717706, "process_user_time": 1.555914, "process_kernel_time": 0.107994, "process_mem_max_rss": "93468", "process_in_blocks": "5488", "process_out_blocks": "3840"}
[0m06:02:06.918522 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:06.918419 after 0.41 seconds
[0m06:02:06.918956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5bfb46060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5be9219a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5be79b5f0>]}
[0m06:02:06.919397 [debug] [MainThread]: Flushing usage events
[0m06:02:08.501726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d035a31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d035a0fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d03650aa0>]}


============================== 06:02:08.504426 | b21007fc-67f3-4703-8bd0-f235309ce3f9 ==============================
[0m06:02:08.504426 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:08.505115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:08.726797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b21007fc-67f3-4703-8bd0-f235309ce3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d035cfec0>]}
[0m06:02:08.785766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b21007fc-67f3-4703-8bd0-f235309ce3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d035a3140>]}
[0m06:02:08.786475 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:08.802037 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:08.802756 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:08.803313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b21007fc-67f3-4703-8bd0-f235309ce3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d033dd070>]}
[0m06:02:10.020000 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:10.020601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b21007fc-67f3-4703-8bd0-f235309ce3f9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cfc655040>]}
[0m06:02:10.200362 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:10.205402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b21007fc-67f3-4703-8bd0-f235309ce3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cfc772690>]}
[0m06:02:10.342462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b21007fc-67f3-4703-8bd0-f235309ce3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cfc6ead20>]}
[0m06:02:10.343007 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:10.343570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b21007fc-67f3-4703-8bd0-f235309ce3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cfc579d00>]}
[0m06:02:10.345292 [info ] [MainThread]: 
[0m06:02:10.346018 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:10.350901 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:10.385351 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:10.385804 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:10.386216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:10.903381 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:10.904918 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:10.907216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:10.907810 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:10.914703 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.915149 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:10.915553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.921218 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.922553 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.922971 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:10.923635 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.924048 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.924440 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:10.925033 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.925958 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.926364 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.926748 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.927290 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.927709 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:10.929700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:10.934982 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.935409 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:10.935796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.940826 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.941289 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.941700 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:10.961504 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.966283 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:10.967467 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:10.967885 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:10.970859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b21007fc-67f3-4703-8bd0-f235309ce3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d03d0ce90>]}
[0m06:02:10.971375 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.971779 [debug] [MainThread]: On master: BEGIN
[0m06:02:10.972164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:10.977268 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.977701 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.978099 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.978486 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.978994 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.979409 [debug] [MainThread]: On master: Close
[0m06:02:10.980807 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:10.981352 [info ] [MainThread]: 
[0m06:02:10.990242 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:10.990842 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:10.991501 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:10.991957 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:11.017242 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:11.017991 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:11.051985 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:11.052728 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:18.714902 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.715423 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:18.716225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.716694 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.717168 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:18.717981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.720665 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.721184 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:18.721899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.742440 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:18.742929 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.743378 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:18.744507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.749223 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.749714 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:18.751248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.753591 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:18.780704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b21007fc-67f3-4703-8bd0-f235309ce3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccb934800>]}
[0m06:02:18.781475 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.79s]
[0m06:02:18.782367 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:18.783353 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:18.783928 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:18.784612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:18.785124 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:18.790001 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:18.790654 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:18.823612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.824135 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240721060218817818"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:18.824621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:18.838346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.845215 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.845700 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:18.846299 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.846761 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.847215 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240721060218817818'
      
      
      order by ordinal_position

  
[0m06:02:18.879585 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.884436 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.884935 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:18.893542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.901939 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.902438 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:18.911109 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.928944 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:18.929649 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.930139 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240721060218817818"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240721060218817818"
    )
  
[0m06:02:18.946535 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.948321 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:18.948788 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.949262 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:18.957302 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.958286 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:19.132862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b21007fc-67f3-4703-8bd0-f235309ce3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccb87e330>]}
[0m06:02:19.133699 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m06:02:19.134474 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:19.135809 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.136320 [debug] [MainThread]: On master: BEGIN
[0m06:02:19.136767 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:19.142115 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.142595 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.143038 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.143470 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.144166 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.144633 [debug] [MainThread]: On master: Close
[0m06:02:19.146122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:19.146568 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:19.146982 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:19.147453 [info ] [MainThread]: 
[0m06:02:19.148056 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.80 seconds (8.80s).
[0m06:02:19.149231 [debug] [MainThread]: Command end result
[0m06:02:19.176897 [info ] [MainThread]: 
[0m06:02:19.177610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:19.178209 [info ] [MainThread]: 
[0m06:02:19.178817 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:19.179900 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.726882, "process_user_time": 4.915788, "process_kernel_time": 0.259988, "process_mem_max_rss": "284804", "process_in_blocks": "1184", "process_out_blocks": "109528"}
[0m06:02:19.180555 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:19.180443 after 10.73 seconds
[0m06:02:19.181088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d035a31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccbb785f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d039bce90>]}
[0m06:02:19.181583 [debug] [MainThread]: Flushing usage events
[0m06:02:20.797221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbee6cf5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbee7f7bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbee5ed06e0>]}


============================== 06:02:20.799871 | f71155ea-e8db-4956-8fa1-48922b8cdece ==============================
[0m06:02:20.799871 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:20.800552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.933112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f71155ea-e8db-4956-8fa1-48922b8cdece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbee565c530>]}
[0m06:02:20.949457 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2008352, "process_user_time": 1.389985, "process_kernel_time": 0.096137, "process_mem_max_rss": "92104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:20.950020 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:20.949920 after 0.20 seconds
[0m06:02:20.950453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbee5a5a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbee5a5b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbee565c530>]}
[0m06:02:20.950880 [debug] [MainThread]: Flushing usage events
[0m14:04:54.196643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90689a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd908f28200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90689a2a0>]}


============================== 14:04:54.203923 | 7d8bea76-45b7-4a6d-9522-adfcd15ae743 ==============================
[0m14:04:54.203923 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:54.204645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:04:54.346882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d8bea76-45b7-4a6d-9522-adfcd15ae743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9097c3050>]}
[0m14:04:54.360268 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nc2mhlpd'
[0m14:04:54.360732 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:54.398969 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:54.399624 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:54.410787 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:54.414483 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:54.567658 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:54.568283 [info ] [MainThread]: Up to date!
[0m14:04:54.568900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7d8bea76-45b7-4a6d-9522-adfcd15ae743', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd906a4b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9066ebc20>]}
[0m14:04:54.570342 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4249453, "process_user_time": 1.631925, "process_kernel_time": 0.095527, "process_mem_max_rss": "93720", "process_in_blocks": "5488", "process_out_blocks": "3848"}
[0m14:04:54.570957 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:54.570851 after 0.43 seconds
[0m14:04:54.571410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd906599550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd907f65c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90668c230>]}
[0m14:04:54.571926 [debug] [MainThread]: Flushing usage events
[0m14:04:56.215391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fc506c230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fc35e5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fc481daf0>]}


============================== 14:04:56.218288 | 0e717fce-d243-4ed8-8e67-692765c00eba ==============================
[0m14:04:56.218288 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:56.219038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:56.445966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e717fce-d243-4ed8-8e67-692765c00eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fc3075040>]}
[0m14:04:56.507679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e717fce-d243-4ed8-8e67-692765c00eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fc314f800>]}
[0m14:04:56.508433 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:04:56.524446 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:56.525194 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:56.525770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0e717fce-d243-4ed8-8e67-692765c00eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fc31290d0>]}
[0m14:04:57.831530 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:57.832223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0e717fce-d243-4ed8-8e67-692765c00eba', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbc531b50>]}
[0m14:04:58.024090 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:58.030364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e717fce-d243-4ed8-8e67-692765c00eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbc532780>]}
[0m14:04:58.165064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e717fce-d243-4ed8-8e67-692765c00eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbc339430>]}
[0m14:04:58.165629 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:58.166123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e717fce-d243-4ed8-8e67-692765c00eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbc2895b0>]}
[0m14:04:58.167838 [info ] [MainThread]: 
[0m14:04:58.168517 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:58.173488 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:58.209129 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:58.209595 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:58.210018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:58.872503 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:58.874075 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:58.876463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:58.877052 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:58.884196 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:58.884663 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:58.885082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:58.890941 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:58.892332 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:58.892750 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:58.893651 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:58.894066 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:58.894462 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:58.895095 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:58.896068 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:58.896480 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:58.896869 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:58.897420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:58.897841 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:58.900069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:58.905420 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:58.905855 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:58.906258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:58.911389 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:58.911845 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:58.912258 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:58.932195 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:58.936843 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:58.938024 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:58.938444 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:58.941970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e717fce-d243-4ed8-8e67-692765c00eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbb0c2030>]}
[0m14:04:58.942482 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:58.942880 [debug] [MainThread]: On master: BEGIN
[0m14:04:58.943260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:58.948378 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:58.948803 [debug] [MainThread]: On master: COMMIT
[0m14:04:58.949197 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:58.949583 [debug] [MainThread]: On master: COMMIT
[0m14:04:58.950205 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:58.950622 [debug] [MainThread]: On master: Close
[0m14:04:58.952115 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:58.952600 [info ] [MainThread]: 
[0m14:04:58.961378 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:58.961977 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:58.962602 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:58.963065 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:58.989523 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:58.990302 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:59.026332 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:59.027093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:09.176960 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:09.177518 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:09.178211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:09.178689 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:09.179152 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:09.179914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:09.182690 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:09.183182 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:09.183926 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:09.205657 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:09.206168 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:09.206640 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:09.208107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:09.213131 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:09.213650 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:09.214984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:09.217389 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:09.243544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e717fce-d243-4ed8-8e67-692765c00eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fa8d6bbc0>]}
[0m14:05:09.244333 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.28s]
[0m14:05:09.245117 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:09.246104 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:09.246675 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:09.247279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:09.247804 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:09.252838 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:09.253514 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:09.287735 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:09.288272 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240721140509281532"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:09.288781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:09.304673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:09.311734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:09.312227 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:09.312898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:09.313351 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:09.313803 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240721140509281532'
      
      
      order by ordinal_position

  
[0m14:05:09.339963 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:09.344919 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:09.345425 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:09.353922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:09.362597 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:09.363115 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:09.371651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:09.389640 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:09.390358 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:09.390915 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240721140509281532"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240721140509281532"
    )
  
[0m14:05:09.407430 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:09.409464 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:09.409932 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:09.410371 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:09.421078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:09.422492 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:09.607004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e717fce-d243-4ed8-8e67-692765c00eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f8b590680>]}
[0m14:05:09.607900 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m14:05:09.608767 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:09.610052 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:09.610532 [debug] [MainThread]: On master: BEGIN
[0m14:05:09.610974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:09.616333 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:09.616812 [debug] [MainThread]: On master: COMMIT
[0m14:05:09.617257 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:09.617705 [debug] [MainThread]: On master: COMMIT
[0m14:05:09.618389 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:09.618853 [debug] [MainThread]: On master: Close
[0m14:05:09.620254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:09.620701 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:09.621161 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:09.621781 [info ] [MainThread]: 
[0m14:05:09.622388 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.45 seconds (11.45s).
[0m14:05:09.623554 [debug] [MainThread]: Command end result
[0m14:05:09.651259 [info ] [MainThread]: 
[0m14:05:09.651981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:09.652576 [info ] [MainThread]: 
[0m14:05:09.653187 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:09.654262 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.491118, "process_user_time": 5.092658, "process_kernel_time": 0.319288, "process_mem_max_rss": "290972", "process_in_blocks": "1184", "process_out_blocks": "110056"}
[0m14:05:09.654912 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:09.654800 after 13.49 seconds
[0m14:05:09.655405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fc5619910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f9076ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbc32ddf0>]}
[0m14:05:09.655934 [debug] [MainThread]: Flushing usage events
[0m14:05:11.400742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7424fe9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74254f0ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7424feb110>]}


============================== 14:05:11.403446 | 541534cd-02cf-4529-8a9b-049b9b179eeb ==============================
[0m14:05:11.403446 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:11.404149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:11.546219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '541534cd-02cf-4529-8a9b-049b9b179eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7425ec00b0>]}
[0m14:05:11.562800 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21313602, "process_user_time": 1.478486, "process_kernel_time": 0.092154, "process_mem_max_rss": "92120", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:11.563393 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:11.563286 after 0.21 seconds
[0m14:05:11.563913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74259a5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7424f53cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7424cad9d0>]}
[0m14:05:11.564361 [debug] [MainThread]: Flushing usage events
[0m22:05:20.937761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5482d49e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f548233ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5481c23980>]}


============================== 22:05:20.945017 | 66f2e348-7c35-4daa-b381-d1fb7a923217 ==============================
[0m22:05:20.945017 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:20.945734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:21.079848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66f2e348-7c35-4daa-b381-d1fb7a923217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5482c70cb0>]}
[0m22:05:21.093120 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2grsm5oo'
[0m22:05:21.093577 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:21.140445 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:21.141059 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:21.151674 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:21.155353 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:21.365799 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:21.366294 [info ] [MainThread]: Up to date!
[0m22:05:21.366825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '66f2e348-7c35-4daa-b381-d1fb7a923217', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54810fc0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54810fc230>]}
[0m22:05:21.368213 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47860298, "process_user_time": 1.518707, "process_kernel_time": 0.143877, "process_mem_max_rss": "93452", "process_in_blocks": "5488", "process_out_blocks": "3840"}
[0m22:05:21.368806 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:21.368701 after 0.48 seconds
[0m22:05:21.369248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54817f51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54812f3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f548233ba10>]}
[0m22:05:21.369678 [debug] [MainThread]: Flushing usage events
[0m22:05:23.141535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06df3bdac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06de55b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06de55a270>]}


============================== 22:05:23.144277 | 2427158a-0583-4b97-9654-64b4d0186727 ==============================
[0m22:05:23.144277 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:23.144999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:23.370985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2427158a-0583-4b97-9654-64b4d0186727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06dd7a20f0>]}
[0m22:05:23.429919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2427158a-0583-4b97-9654-64b4d0186727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06de7254c0>]}
[0m22:05:23.430641 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:23.445480 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:23.446194 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:23.446750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2427158a-0583-4b97-9654-64b4d0186727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06dd8b8890>]}
[0m22:05:24.656492 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:24.657121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2427158a-0583-4b97-9654-64b4d0186727', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06d6c77c50>]}
[0m22:05:24.836740 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:24.841605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2427158a-0583-4b97-9654-64b4d0186727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06d6af8200>]}
[0m22:05:24.968212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2427158a-0583-4b97-9654-64b4d0186727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06de98dd60>]}
[0m22:05:24.968765 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:24.969315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2427158a-0583-4b97-9654-64b4d0186727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06de296c00>]}
[0m22:05:24.971015 [info ] [MainThread]: 
[0m22:05:24.971744 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:24.976477 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:25.010805 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:25.011248 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:25.011649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:25.458744 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.460371 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:25.462739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:25.463325 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:25.470169 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:25.470614 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:25.471017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:25.476596 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.477924 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:25.478337 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:25.478864 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.479267 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:25.479656 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:25.480238 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.481161 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:25.481567 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:25.481948 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:25.482791 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.483208 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:25.485353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:25.490582 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:25.491002 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:25.491384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:25.496454 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.496873 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:25.497279 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:25.517229 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.521870 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:25.523052 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:25.523464 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:25.526581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2427158a-0583-4b97-9654-64b4d0186727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06d6b1eed0>]}
[0m22:05:25.527102 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:25.527493 [debug] [MainThread]: On master: BEGIN
[0m22:05:25.527865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:25.532950 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:25.533370 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.533761 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:25.534138 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.534748 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:25.535157 [debug] [MainThread]: On master: Close
[0m22:05:25.536605 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:25.537114 [info ] [MainThread]: 
[0m22:05:25.546193 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:25.546791 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:25.547446 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:25.547891 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:25.573323 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:25.574069 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:25.608388 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:25.609146 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:36.610809 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:36.611344 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:36.611975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.612462 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:36.612909 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:36.613595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.616270 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:36.616741 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:36.617434 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.637964 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:36.638459 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:36.638910 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:36.639986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.644697 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:36.645175 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:36.646468 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.648798 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:36.674547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2427158a-0583-4b97-9654-64b4d0186727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06de233680>]}
[0m22:05:36.675256 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.13s]
[0m22:05:36.676173 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:36.677144 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:36.677713 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:36.678382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:36.678849 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:36.683557 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:36.684243 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:36.717071 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:36.717588 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240721220536711257"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:36.718065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:36.733932 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.740734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:36.741212 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:36.741800 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.742264 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:36.742716 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240721220536711257'
      
      
      order by ordinal_position

  
[0m22:05:36.769207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.774044 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:36.774540 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:36.783127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.791490 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:36.791990 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:36.806329 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.824088 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:36.824769 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:36.825252 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240721220536711257"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240721220536711257"
    )
  
[0m22:05:36.843105 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.844903 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:36.845368 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:36.845804 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:36.854267 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.855131 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:37.041599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2427158a-0583-4b97-9654-64b4d0186727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06aa195d00>]}
[0m22:05:37.042400 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m22:05:37.043277 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:37.044905 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:37.045382 [debug] [MainThread]: On master: BEGIN
[0m22:05:37.045824 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:37.051352 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:37.051829 [debug] [MainThread]: On master: COMMIT
[0m22:05:37.052341 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:37.052775 [debug] [MainThread]: On master: COMMIT
[0m22:05:37.053466 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:37.053925 [debug] [MainThread]: On master: Close
[0m22:05:37.055706 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:37.056188 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:37.056601 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:37.057068 [info ] [MainThread]: 
[0m22:05:37.057662 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.09 seconds (12.09s).
[0m22:05:37.058786 [debug] [MainThread]: Command end result
[0m22:05:37.086849 [info ] [MainThread]: 
[0m22:05:37.087535 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:37.088169 [info ] [MainThread]: 
[0m22:05:37.088787 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:37.089877 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.996977, "process_user_time": 4.91095, "process_kernel_time": 0.309699, "process_mem_max_rss": "292668", "process_in_blocks": "1184", "process_out_blocks": "110584"}
[0m22:05:37.090529 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:37.090419 after 14.00 seconds
[0m22:05:37.091030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06de1cb020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06ddce73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06aa14d850>]}
[0m22:05:37.091526 [debug] [MainThread]: Flushing usage events
[0m22:05:38.980750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe313bfb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe314011d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe313bfb7a0>]}


============================== 22:05:38.983448 | f4b6debc-2d16-4d3c-983d-ecd8b5bc7930 ==============================
[0m22:05:38.983448 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:38.984139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:39.120504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4b6debc-2d16-4d3c-983d-ecd8b5bc7930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe313bb56a0>]}
[0m22:05:39.136481 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20475641, "process_user_time": 1.436798, "process_kernel_time": 0.088048, "process_mem_max_rss": "92076", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:39.137057 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:39.136955 after 0.21 seconds
[0m22:05:39.137488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3149c2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3145065d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe313bb61e0>]}
[0m22:05:39.137917 [debug] [MainThread]: Flushing usage events
[0m06:02:17.152361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f18da2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f186ef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f1c6b1a0>]}


============================== 06:02:17.188399 | 6cf06fc0-65e3-491e-98dc-7daed352d9a7 ==============================
[0m06:02:17.188399 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:17.189451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.358237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cf06fc0-65e3-491e-98dc-7daed352d9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f15449e0>]}
[0m06:02:17.372219 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-iheld90l'
[0m06:02:17.372715 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:17.635407 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:17.636189 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:17.692854 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:17.696741 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:18.062554 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:18.063198 [info ] [MainThread]: Up to date!
[0m06:02:18.063838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6cf06fc0-65e3-491e-98dc-7daed352d9a7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f1403f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f1402150>]}
[0m06:02:18.065399 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.96207434, "process_user_time": 1.656661, "process_kernel_time": 0.123157, "process_mem_max_rss": "93184", "process_in_blocks": "5488", "process_out_blocks": "3848"}
[0m06:02:18.066063 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:18.065951 after 0.96 seconds
[0m06:02:18.066511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f186ef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f1c6b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f1596ea0>]}
[0m06:02:18.066961 [debug] [MainThread]: Flushing usage events
[0m06:02:19.939005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bafd582f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0baff46960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bb01dd7c0>]}


============================== 06:02:19.941836 | bb59cfe5-beb9-4a0f-abb2-a99ce16766a7 ==============================
[0m06:02:19.941836 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:19.942575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.165403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb59cfe5-beb9-4a0f-abb2-a99ce16766a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bafc12db0>]}
[0m06:02:20.224815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb59cfe5-beb9-4a0f-abb2-a99ce16766a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bafc6c980>]}
[0m06:02:20.225719 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:20.256258 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:20.256997 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:20.257553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bb59cfe5-beb9-4a0f-abb2-a99ce16766a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ba93227e0>]}
[0m06:02:21.475947 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:21.476639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bb59cfe5-beb9-4a0f-abb2-a99ce16766a7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ba92c4290>]}
[0m06:02:21.660317 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:21.665626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb59cfe5-beb9-4a0f-abb2-a99ce16766a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ba8e0a0f0>]}
[0m06:02:21.813356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb59cfe5-beb9-4a0f-abb2-a99ce16766a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ba8e0a690>]}
[0m06:02:21.813989 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:21.814487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb59cfe5-beb9-4a0f-abb2-a99ce16766a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ba8ff4530>]}
[0m06:02:21.816247 [info ] [MainThread]: 
[0m06:02:21.816957 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:21.821989 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:21.858214 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:21.858739 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:21.859145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:22.809416 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:22.811024 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:22.813227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:22.813834 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:22.820601 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.821051 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:22.821464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:22.827684 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.829215 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.829632 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:22.830561 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.830984 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.831373 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:22.832005 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.832959 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:22.833370 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.833763 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:22.834349 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.834770 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:22.837358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:22.843182 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.843670 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:22.844139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:22.849566 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.850064 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.850475 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:22.870962 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.876200 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:22.877466 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:22.877915 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:22.882036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb59cfe5-beb9-4a0f-abb2-a99ce16766a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bb0239610>]}
[0m06:02:22.882580 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.882982 [debug] [MainThread]: On master: BEGIN
[0m06:02:22.883363 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:22.889028 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.889517 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.889965 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.890354 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.890861 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.891287 [debug] [MainThread]: On master: Close
[0m06:02:22.893113 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:22.893660 [info ] [MainThread]: 
[0m06:02:22.912962 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:22.913652 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:22.914538 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:22.915004 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:22.940941 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:22.941902 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:22.976703 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:22.977628 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:37.382154 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:37.382721 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:37.383429 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.383897 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:37.384347 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:37.385096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.388031 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:37.388498 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:37.389213 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.409860 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:37.410354 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:37.410799 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:37.412414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.417355 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:37.417870 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:37.419124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.421550 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:37.448615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb59cfe5-beb9-4a0f-abb2-a99ce16766a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ba8d48a70>]}
[0m06:02:37.449466 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 14.53s]
[0m06:02:37.450343 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:37.451343 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:37.451915 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:37.452587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:37.453047 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:37.458300 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:37.458969 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:37.492844 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.493465 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240722060237486898"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:37.493993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:37.508671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.516107 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.516591 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:37.517206 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.517665 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.518141 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240722060237486898'
      
      
      order by ordinal_position

  
[0m06:02:37.545118 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.550653 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.551160 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:37.559894 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.569103 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.569613 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:37.578301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.596539 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:37.597295 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.597815 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240722060237486898"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240722060237486898"
    )
  
[0m06:02:37.614108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.616122 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:37.616595 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:37.617038 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:37.627684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:37.628633 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:37.922834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb59cfe5-beb9-4a0f-abb2-a99ce16766a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7c744ef0>]}
[0m06:02:37.923674 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.47s]
[0m06:02:37.924583 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:37.926003 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:37.926489 [debug] [MainThread]: On master: BEGIN
[0m06:02:37.926932 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:37.932228 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:37.932713 [debug] [MainThread]: On master: COMMIT
[0m06:02:37.933162 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:37.933596 [debug] [MainThread]: On master: COMMIT
[0m06:02:37.934398 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:37.934863 [debug] [MainThread]: On master: Close
[0m06:02:37.936229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:37.936674 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:37.937091 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:37.937567 [info ] [MainThread]: 
[0m06:02:37.938216 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 16.12 seconds (16.12s).
[0m06:02:37.939352 [debug] [MainThread]: Command end result
[0m06:02:37.967034 [info ] [MainThread]: 
[0m06:02:37.967720 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:37.968320 [info ] [MainThread]: 
[0m06:02:37.968924 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:37.970017 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.079613, "process_user_time": 5.16121, "process_kernel_time": 0.295154, "process_mem_max_rss": "324964", "process_in_blocks": "1184", "process_out_blocks": "114680"}
[0m06:02:37.970672 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:37.970559 after 18.08 seconds
[0m06:02:37.971177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0baff46960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7da85be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ba90ab5f0>]}
[0m06:02:37.971669 [debug] [MainThread]: Flushing usage events
[0m06:02:39.989890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b14a793d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b1284f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b13d6c830>]}


============================== 06:02:39.993122 | d0a2aa76-f3e2-4833-8f1d-b844edbf248a ==============================
[0m06:02:39.993122 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:39.993955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:40.159163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0a2aa76-f3e2-4833-8f1d-b844edbf248a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b12ae6a80>]}
[0m06:02:40.178271 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23955953, "process_user_time": 1.502599, "process_kernel_time": 0.099641, "process_mem_max_rss": "92228", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:40.178931 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:40.178816 after 0.24 seconds
[0m06:02:40.179418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b14a793d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b12662c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b13036cc0>]}
[0m06:02:40.179891 [debug] [MainThread]: Flushing usage events
[0m14:05:29.055280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e25dc2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e261ce480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e25eebf20>]}


============================== 14:05:29.106877 | 0bea3efc-2214-4a88-8c36-6fea61f427a0 ==============================
[0m14:05:29.106877 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:29.107552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:29.247580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bea3efc-2214-4a88-8c36-6fea61f427a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e25c1ba70>]}
[0m14:05:29.260687 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-td18g1ca'
[0m14:05:29.261148 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:29.340528 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:29.341141 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:29.353835 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:29.357553 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:29.419993 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:29.420523 [info ] [MainThread]: Up to date!
[0m14:05:29.421058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0bea3efc-2214-4a88-8c36-6fea61f427a0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e25be1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e25b25b20>]}
[0m14:05:29.422737 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41601077, "process_user_time": 1.592102, "process_kernel_time": 0.110892, "process_mem_max_rss": "93456", "process_in_blocks": "5488", "process_out_blocks": "3848"}
[0m14:05:29.423325 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:29.423224 after 0.42 seconds
[0m14:05:29.423762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e25d2bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e25b1c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e25b1c530>]}
[0m14:05:29.424190 [debug] [MainThread]: Flushing usage events
[0m14:05:30.965288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa865203380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8655aa000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa866ca6210>]}


============================== 14:05:30.968001 | c73348a1-410b-4bd2-b460-16cc7d94a652 ==============================
[0m14:05:30.968001 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:30.968735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:31.196832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c73348a1-410b-4bd2-b460-16cc7d94a652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85e724e90>]}
[0m14:05:31.258917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c73348a1-410b-4bd2-b460-16cc7d94a652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8654a8b00>]}
[0m14:05:31.259681 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:31.328449 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:31.329194 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:31.329786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c73348a1-410b-4bd2-b460-16cc7d94a652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa865b3dc40>]}
[0m14:05:32.550300 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:32.551096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c73348a1-410b-4bd2-b460-16cc7d94a652', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85e628e60>]}
[0m14:05:32.741410 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:32.746512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c73348a1-410b-4bd2-b460-16cc7d94a652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85e235280>]}
[0m14:05:32.870098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c73348a1-410b-4bd2-b460-16cc7d94a652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85e3f69f0>]}
[0m14:05:32.870664 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:32.871169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c73348a1-410b-4bd2-b460-16cc7d94a652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85e3dc530>]}
[0m14:05:32.872830 [info ] [MainThread]: 
[0m14:05:32.873547 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:32.878261 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:32.912935 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:32.913422 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:32.913833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:33.316788 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.318361 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:33.320579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:33.321166 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:33.327998 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:33.328447 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:33.328852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:33.334438 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.335845 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:33.336258 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:33.336922 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.337381 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:33.337785 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:33.338362 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.339276 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:33.339694 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:33.340113 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:33.340776 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.341236 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:33.343372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:33.348705 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:33.349130 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:33.349558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:33.354556 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.354994 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:33.355402 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:33.375363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.380167 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:33.381380 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:33.381816 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:33.385424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c73348a1-410b-4bd2-b460-16cc7d94a652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85e2715b0>]}
[0m14:05:33.385951 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:33.386359 [debug] [MainThread]: On master: BEGIN
[0m14:05:33.386740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:33.392001 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:33.392434 [debug] [MainThread]: On master: COMMIT
[0m14:05:33.392834 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:33.393218 [debug] [MainThread]: On master: COMMIT
[0m14:05:33.393889 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:33.394304 [debug] [MainThread]: On master: Close
[0m14:05:33.395866 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:33.396377 [info ] [MainThread]: 
[0m14:05:33.416046 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:33.416669 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:33.417344 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:33.417806 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:33.443743 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:33.444545 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:33.478829 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:33.479576 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:45.771546 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:45.772064 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:45.772708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.773170 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:45.773656 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:45.774337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.777011 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:45.777511 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:45.778226 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.798672 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:45.799157 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:45.799602 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:45.801423 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.806128 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:45.806610 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:45.808175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.810513 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:45.835935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c73348a1-410b-4bd2-b460-16cc7d94a652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85e6e0380>]}
[0m14:05:45.836660 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.42s]
[0m14:05:45.837487 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:45.838452 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:45.839032 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:45.839607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:45.840072 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:45.844849 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:45.845530 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:45.878520 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:45.879043 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240722140545872680"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:45.879528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:45.894599 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.901728 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:45.902212 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:45.902846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.903312 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:45.903764 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240722140545872680'
      
      
      order by ordinal_position

  
[0m14:05:45.930261 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.935109 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:45.935611 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:45.944006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.952464 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:45.952967 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:45.961055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.978929 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:45.979650 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:45.980135 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240722140545872680"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240722140545872680"
    )
  
[0m14:05:45.995643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.997392 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:45.997862 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:45.998299 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:46.012195 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:46.013086 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:46.097850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c73348a1-410b-4bd2-b460-16cc7d94a652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa831c383e0>]}
[0m14:05:46.098681 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.26s]
[0m14:05:46.099438 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:46.100831 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:46.101340 [debug] [MainThread]: On master: BEGIN
[0m14:05:46.101797 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:46.107129 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:46.107612 [debug] [MainThread]: On master: COMMIT
[0m14:05:46.108060 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:46.108496 [debug] [MainThread]: On master: COMMIT
[0m14:05:46.109056 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:46.109555 [debug] [MainThread]: On master: Close
[0m14:05:46.110908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:46.111361 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:46.111778 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:46.112260 [info ] [MainThread]: 
[0m14:05:46.112789 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.24 seconds (13.24s).
[0m14:05:46.113882 [debug] [MainThread]: Command end result
[0m14:05:46.141474 [info ] [MainThread]: 
[0m14:05:46.142100 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:46.142610 [info ] [MainThread]: 
[0m14:05:46.143132 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:46.144113 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.227704, "process_user_time": 4.76449, "process_kernel_time": 0.304286, "process_mem_max_rss": "294296", "process_in_blocks": "1184", "process_out_blocks": "104952"}
[0m14:05:46.144758 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:46.144647 after 15.23 seconds
[0m14:05:46.145254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85e28e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa867559790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa85e30d310>]}
[0m14:05:46.145774 [debug] [MainThread]: Flushing usage events
[0m14:05:47.782474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd177a45e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd176913500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd176912ed0>]}


============================== 14:05:47.785509 | c2230c0b-62de-43ed-b26b-940d03ab08c0 ==============================
[0m14:05:47.785509 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:47.786198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:47.935697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2230c0b-62de-43ed-b26b-940d03ab08c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd176007ef0>]}
[0m14:05:47.952578 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22108793, "process_user_time": 1.400557, "process_kernel_time": 0.136054, "process_mem_max_rss": "92040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:47.953185 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:47.953081 after 0.22 seconds
[0m14:05:47.953697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17767b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd175f5c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd175dbb080>]}
[0m14:05:47.954147 [debug] [MainThread]: Flushing usage events
[0m22:05:28.591602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269ae57ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269ac2fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269acc61e0>]}


============================== 22:05:28.598886 | f8b624e8-9ba1-4077-89b1-572629c5d88d ==============================
[0m22:05:28.598886 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:28.599612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:05:28.746643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8b624e8-9ba1-4077-89b1-572629c5d88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269c379b50>]}
[0m22:05:28.760238 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ucm4z8la'
[0m22:05:28.760708 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:28.858015 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:28.858779 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:28.992939 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:28.996842 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:29.067141 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:29.067735 [info ] [MainThread]: Up to date!
[0m22:05:29.068402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f8b624e8-9ba1-4077-89b1-572629c5d88d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269b742e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269aa2bc50>]}
[0m22:05:29.070231 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5268312, "process_user_time": 1.58529, "process_kernel_time": 0.112091, "process_mem_max_rss": "93472", "process_in_blocks": "5488", "process_out_blocks": "3848"}
[0m22:05:29.070848 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:29.070741 after 0.53 seconds
[0m22:05:29.071295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269d01d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269aac3170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269aae8380>]}
[0m22:05:29.071741 [debug] [MainThread]: Flushing usage events
[0m22:05:30.707814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dec79910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e06557f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48de30b2c0>]}


============================== 22:05:30.712899 | 88682212-af20-4db2-a663-f89a341874f2 ==============================
[0m22:05:30.712899 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:30.713826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:30.938263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88682212-af20-4db2-a663-f89a341874f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48de72ff20>]}
[0m22:05:30.997509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88682212-af20-4db2-a663-f89a341874f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48de7173e0>]}
[0m22:05:30.998343 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:05:31.013645 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:31.014362 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:31.014923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '88682212-af20-4db2-a663-f89a341874f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48de02d940>]}
[0m22:05:32.231945 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:32.232670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '88682212-af20-4db2-a663-f89a341874f2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d7722480>]}
[0m22:05:32.412956 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:32.417933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88682212-af20-4db2-a663-f89a341874f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d74dcaa0>]}
[0m22:05:32.568305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88682212-af20-4db2-a663-f89a341874f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48de16cb90>]}
[0m22:05:32.568888 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:32.569410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88682212-af20-4db2-a663-f89a341874f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48de3a3890>]}
[0m22:05:32.571107 [info ] [MainThread]: 
[0m22:05:32.571813 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:32.576571 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:32.611559 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:32.612029 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:32.612443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:33.174943 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:33.176532 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:33.178945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:33.179534 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:33.186394 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.186847 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:33.187255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:33.192800 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.194177 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.194595 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:33.195431 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.195842 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.196232 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:33.196796 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.197763 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:33.198170 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.198554 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:33.199210 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.199630 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:33.201701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:33.206903 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:33.207327 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:33.207708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:33.212663 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.213117 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:33.213545 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:33.233915 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.238690 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:33.239889 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:33.240324 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:33.244270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88682212-af20-4db2-a663-f89a341874f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d761a510>]}
[0m22:05:33.244790 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.245229 [debug] [MainThread]: On master: BEGIN
[0m22:05:33.245613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:33.250768 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.251204 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.251600 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.251984 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.252612 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.253023 [debug] [MainThread]: On master: Close
[0m22:05:33.254520 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:33.255086 [info ] [MainThread]: 
[0m22:05:33.264444 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:33.265064 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:33.265851 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:33.266307 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:33.291822 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:33.292580 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:33.326533 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:33.327280 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:41.629511 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.630053 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:41.630721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.631194 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.631642 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:41.632570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.635346 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.635829 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:41.636538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.657298 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:41.657804 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.658250 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:41.659510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.664304 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.664792 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:41.666013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.668374 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:41.694658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88682212-af20-4db2-a663-f89a341874f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48a7161430>]}
[0m22:05:41.695517 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.43s]
[0m22:05:41.696312 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:41.697410 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:41.697995 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:41.698626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:41.699089 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:41.704257 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:41.704933 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:41.738670 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.739257 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240722220541732663"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:41.739777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:41.757333 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.764794 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.765330 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:41.765963 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.766432 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.766886 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240722220541732663'
      
      
      order by ordinal_position

  
[0m22:05:41.793640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.798988 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.799493 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:41.808323 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.817323 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.817843 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:41.826024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.844115 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:41.844896 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.845437 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240722220541732663"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240722220541732663"
    )
  
[0m22:05:41.862672 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.864619 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:41.865135 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.865605 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:41.874703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.875624 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:41.966029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88682212-af20-4db2-a663-f89a341874f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48a6be9d00>]}
[0m22:05:41.966877 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.27s]
[0m22:05:41.967760 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:41.969311 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:41.969802 [debug] [MainThread]: On master: BEGIN
[0m22:05:41.970244 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:41.975711 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:41.976206 [debug] [MainThread]: On master: COMMIT
[0m22:05:41.976664 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:41.977146 [debug] [MainThread]: On master: COMMIT
[0m22:05:41.977874 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:41.978341 [debug] [MainThread]: On master: Close
[0m22:05:41.979894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:41.980338 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:41.980755 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:41.981263 [info ] [MainThread]: 
[0m22:05:41.981828 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.41 seconds (9.41s).
[0m22:05:41.982898 [debug] [MainThread]: Command end result
[0m22:05:42.010800 [info ] [MainThread]: 
[0m22:05:42.011475 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:42.012018 [info ] [MainThread]: 
[0m22:05:42.012585 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:42.013655 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.354419, "process_user_time": 4.776924, "process_kernel_time": 0.322711, "process_mem_max_rss": "286608", "process_in_blocks": "1184", "process_out_blocks": "105488"}
[0m22:05:42.014300 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:42.014190 after 11.36 seconds
[0m22:05:42.014802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48de72cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d75fa750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d75fbc50>]}
[0m22:05:42.015301 [debug] [MainThread]: Flushing usage events
[0m22:05:43.744980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f46dd0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f47257f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f4726d50>]}


============================== 22:05:43.747937 | 4354e83d-9b7d-4def-8f6b-9109a4a4551f ==============================
[0m22:05:43.747937 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:43.748660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:43.897121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4354e83d-9b7d-4def-8f6b-9109a4a4551f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f3bcba70>]}
[0m22:05:43.913431 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2181969, "process_user_time": 1.388007, "process_kernel_time": 0.131621, "process_mem_max_rss": "92088", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:43.914021 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:43.913916 after 0.22 seconds
[0m22:05:43.914477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f42f2420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f43219a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f3b9ce90>]}
[0m22:05:43.914922 [debug] [MainThread]: Flushing usage events
[0m06:02:10.524537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb959d00e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb959d02540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb959d024b0>]}


============================== 06:02:10.531356 | f490f70c-b5fc-4275-b24a-16be53d54690 ==============================
[0m06:02:10.531356 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.532058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.671593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f490f70c-b5fc-4275-b24a-16be53d54690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb959afc2c0>]}
[0m06:02:10.684777 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-l7j4yg0u'
[0m06:02:10.685246 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.777054 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.777725 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.793139 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.796912 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:11.006771 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:11.007356 [info ] [MainThread]: Up to date!
[0m06:02:11.008002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f490f70c-b5fc-4275-b24a-16be53d54690', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb959b5a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb959afd1f0>]}
[0m06:02:11.010693 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.53471273, "process_user_time": 1.566818, "process_kernel_time": 0.124862, "process_mem_max_rss": "93440", "process_in_blocks": "5488", "process_out_blocks": "3848"}
[0m06:02:11.011323 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:11.011198 after 0.54 seconds
[0m06:02:11.011869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb959eaf0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95aa5ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95af361b0>]}
[0m06:02:11.012309 [debug] [MainThread]: Flushing usage events
[0m06:02:12.792965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6efd60f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6efd6ea1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eff055e20>]}


============================== 06:02:12.795896 | 82fc3802-e308-49c3-9514-9b074ba3b6a5 ==============================
[0m06:02:12.795896 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.796549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.020388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82fc3802-e308-49c3-9514-9b074ba3b6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6efd294b30>]}
[0m06:02:13.079175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82fc3802-e308-49c3-9514-9b074ba3b6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6efd99fec0>]}
[0m06:02:13.080005 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:13.095366 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:13.096134 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:13.096684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '82fc3802-e308-49c3-9514-9b074ba3b6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6efd4fe1e0>]}
[0m06:02:14.307895 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:14.308577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '82fc3802-e308-49c3-9514-9b074ba3b6a5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef61bd4c0>]}
[0m06:02:14.488216 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:14.493146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82fc3802-e308-49c3-9514-9b074ba3b6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef61e5400>]}
[0m06:02:14.617835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82fc3802-e308-49c3-9514-9b074ba3b6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef619ff80>]}
[0m06:02:14.618435 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.618929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82fc3802-e308-49c3-9514-9b074ba3b6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef5f2b890>]}
[0m06:02:14.620660 [info ] [MainThread]: 
[0m06:02:14.621367 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.626172 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.661500 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.661963 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:14.662362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:15.094781 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.096444 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:15.098662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:15.099253 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:15.106185 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.106632 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:15.107032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.112513 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.113839 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.114247 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:15.115060 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.115469 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.115901 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:15.116535 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.117462 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.117868 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.118247 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.118786 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.119194 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:15.121189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:15.126481 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.126901 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:15.127282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.132289 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.132705 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.133111 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:15.153188 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.158007 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:15.159210 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:15.159649 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:15.162735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82fc3802-e308-49c3-9514-9b074ba3b6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef60d8080>]}
[0m06:02:15.163262 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.163697 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.164076 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:15.169241 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.169661 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.170055 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.170428 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.171057 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.171467 [debug] [MainThread]: On master: Close
[0m06:02:15.172941 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:15.173483 [info ] [MainThread]: 
[0m06:02:15.182633 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:15.183245 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:15.183995 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:15.184460 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:15.210013 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:15.210753 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:15.244568 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:15.245297 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:25.111540 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.112092 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:25.112718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.113190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.113638 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:25.114341 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.117022 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.117495 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:25.118193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.138779 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:25.139275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.139750 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:25.141324 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.146039 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.146517 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:25.147974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.150273 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:25.176139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82fc3802-e308-49c3-9514-9b074ba3b6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ecef89c70>]}
[0m06:02:25.176861 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.99s]
[0m06:02:25.177742 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:25.178742 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:25.179378 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:25.180061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:25.180593 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:25.185362 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:25.186010 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:25.219112 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.219652 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240723060225213257"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:25.220140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:25.236987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.243965 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.244471 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:25.245141 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.245599 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.246050 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240723060225213257'
      
      
      order by ordinal_position

  
[0m06:02:25.272661 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.277617 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.278109 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:25.292358 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.300905 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.301405 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:25.310567 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.328507 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:25.329260 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.329746 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240723060225213257"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240723060225213257"
    )
  
[0m06:02:25.348298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.350081 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:25.350550 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.350990 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:25.368461 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.369375 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:25.470152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82fc3802-e308-49c3-9514-9b074ba3b6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ec995bb60>]}
[0m06:02:25.471003 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m06:02:25.471830 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:25.473317 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.473875 [debug] [MainThread]: On master: BEGIN
[0m06:02:25.474331 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:25.479845 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.480324 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.480764 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.481195 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.481919 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.482383 [debug] [MainThread]: On master: Close
[0m06:02:25.484110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:25.484553 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:25.484966 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:25.485435 [info ] [MainThread]: 
[0m06:02:25.486039 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.86 seconds (10.86s).
[0m06:02:25.487168 [debug] [MainThread]: Command end result
[0m06:02:25.514824 [info ] [MainThread]: 
[0m06:02:25.515511 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:25.516141 [info ] [MainThread]: 
[0m06:02:25.516757 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:25.517836 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.773647, "process_user_time": 4.779407, "process_kernel_time": 0.296211, "process_mem_max_rss": "285360", "process_in_blocks": "1184", "process_out_blocks": "105976"}
[0m06:02:25.518481 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:25.518373 after 12.77 seconds
[0m06:02:25.518974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6efd4fcc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eff91d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6efd99d0a0>]}
[0m06:02:25.519458 [debug] [MainThread]: Flushing usage events
[0m06:02:27.383276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76c2e47980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76c2e477a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76c308b3b0>]}


============================== 06:02:27.386113 | 275fd1af-f8f0-44a1-b3ca-96cf5b995598 ==============================
[0m06:02:27.386113 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.386872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.527486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '275fd1af-f8f0-44a1-b3ca-96cf5b995598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76c33d7a10>]}
[0m06:02:27.544063 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20954315, "process_user_time": 1.39754, "process_kernel_time": 0.10781, "process_mem_max_rss": "91984", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:27.544649 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:27.544547 after 0.21 seconds
[0m06:02:27.545100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76c426e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76c5378860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76c33d7a10>]}
[0m06:02:27.545545 [debug] [MainThread]: Flushing usage events
[0m14:05:08.973669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6860dca390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f686125f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68611a3530>]}


============================== 14:05:08.981264 | f981119d-5975-4fbb-acd4-d2fa24095bb4 ==============================
[0m14:05:08.981264 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:08.981968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:09.141552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f981119d-5975-4fbb-acd4-d2fa24095bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6860bec620>]}
[0m14:05:09.156264 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-dwioxnuv'
[0m14:05:09.156812 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:09.213565 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:09.214351 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:09.224770 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:09.228609 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:09.435149 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:09.435820 [info ] [MainThread]: Up to date!
[0m14:05:09.436459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f981119d-5975-4fbb-acd4-d2fa24095bb4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6860b2fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6860b2dac0>]}
[0m14:05:09.438079 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.513753, "process_user_time": 1.688431, "process_kernel_time": 0.111763, "process_mem_max_rss": "93468", "process_in_blocks": "5488", "process_out_blocks": "3840"}
[0m14:05:09.438748 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:09.438624 after 0.51 seconds
[0m14:05:09.439227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6861320e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f686178d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68624a5cd0>]}
[0m14:05:09.439704 [debug] [MainThread]: Flushing usage events
[0m14:05:12.790595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f705bba11f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f705ce9e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f705b8373e0>]}


============================== 14:05:12.793733 | b9c88db2-2ea1-4f23-95ac-7570de617bfd ==============================
[0m14:05:12.793733 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:12.794508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:13.039229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9c88db2-2ea1-4f23-95ac-7570de617bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f705b3ac4a0>]}
[0m14:05:13.100089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9c88db2-2ea1-4f23-95ac-7570de617bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f705b3acb90>]}
[0m14:05:13.101046 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:13.139188 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:13.140027 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:13.140609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9c88db2-2ea1-4f23-95ac-7570de617bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f705480fdd0>]}
[0m14:05:14.376177 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:14.376873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b9c88db2-2ea1-4f23-95ac-7570de617bfd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70548e8bc0>]}
[0m14:05:14.565111 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:14.570735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9c88db2-2ea1-4f23-95ac-7570de617bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7054565640>]}
[0m14:05:14.742327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9c88db2-2ea1-4f23-95ac-7570de617bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70545e8380>]}
[0m14:05:14.742947 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:14.743433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9c88db2-2ea1-4f23-95ac-7570de617bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7054474890>]}
[0m14:05:14.745240 [info ] [MainThread]: 
[0m14:05:14.745965 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:14.751050 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:14.788232 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:14.788925 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:14.789541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:15.147888 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.149519 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:15.151832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:15.152409 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:15.159343 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.159836 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:15.160245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:15.166224 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.167735 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.168165 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:15.169048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.169500 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.169894 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:15.170527 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.171485 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:15.171900 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.172289 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:15.172836 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.173285 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:15.175804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:15.181460 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:15.181901 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:15.182289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:15.187900 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.188374 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:15.188787 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:15.209077 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.214422 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:15.215697 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:15.216152 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:15.219966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9c88db2-2ea1-4f23-95ac-7570de617bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f705c30c3e0>]}
[0m14:05:15.220513 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:15.220919 [debug] [MainThread]: On master: BEGIN
[0m14:05:15.221347 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:15.227296 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:15.227799 [debug] [MainThread]: On master: COMMIT
[0m14:05:15.228202 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:15.228588 [debug] [MainThread]: On master: COMMIT
[0m14:05:15.229279 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:15.229706 [debug] [MainThread]: On master: Close
[0m14:05:15.231524 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:15.232038 [info ] [MainThread]: 
[0m14:05:15.241879 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:15.242547 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:15.243233 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:15.243783 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:15.270146 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:15.271059 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:15.305887 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:15.306855 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:25.711012 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.711568 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:25.712295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.712762 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.713231 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:25.714169 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.717142 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.717694 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:25.718510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.739415 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:25.739993 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.740448 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:25.742140 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.747311 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.747817 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:25.749397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.751862 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:25.778904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c88db2-2ea1-4f23-95ac-7570de617bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7023fa6cc0>]}
[0m14:05:25.779786 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.53s]
[0m14:05:25.780605 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:25.781669 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:25.782261 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:25.782903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:25.783370 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:25.788622 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:25.789388 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:25.823658 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.824294 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240723140525817522"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:25.824780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:25.839524 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.847569 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.848110 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:25.848834 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.849326 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.849773 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240723140525817522'
      
      
      order by ordinal_position

  
[0m14:05:25.876922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.882773 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.883320 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:25.892497 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.902149 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.902704 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:25.912211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.930816 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:25.931653 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.932160 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240723140525817522"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240723140525817522"
    )
  
[0m14:05:25.949584 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.951692 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:25.952179 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.952626 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:25.963185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.964241 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:26.077200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c88db2-2ea1-4f23-95ac-7570de617bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7023f36ab0>]}
[0m14:05:26.078078 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m14:05:26.078970 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:26.080472 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.080957 [debug] [MainThread]: On master: BEGIN
[0m14:05:26.081449 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:26.087271 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.087795 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.088247 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.088684 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.089405 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.089876 [debug] [MainThread]: On master: Close
[0m14:05:26.091727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:26.092179 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:26.092596 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:26.093082 [info ] [MainThread]: 
[0m14:05:26.093675 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.35 seconds (11.35s).
[0m14:05:26.094682 [debug] [MainThread]: Command end result
[0m14:05:26.123031 [info ] [MainThread]: 
[0m14:05:26.123805 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:26.124459 [info ] [MainThread]: 
[0m14:05:26.125001 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:26.126077 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.3862505, "process_user_time": 4.870075, "process_kernel_time": 0.347577, "process_mem_max_rss": "276344", "process_in_blocks": "1184", "process_out_blocks": "105976"}
[0m14:05:26.126733 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:26.126621 after 13.39 seconds
[0m14:05:26.127241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f705b42a8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7023fab2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7023fa8fb0>]}
[0m14:05:26.127734 [debug] [MainThread]: Flushing usage events
[0m14:05:28.665341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb293ca9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29229b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb292b30bf0>]}


============================== 14:05:28.668864 | 789e5827-8f9c-42db-ace9-8b475b024c48 ==============================
[0m14:05:28.668864 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:28.669673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:28.829590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '789e5827-8f9c-42db-ace9-8b475b024c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb292661bb0>]}
[0m14:05:28.847065 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23306143, "process_user_time": 1.491251, "process_kernel_time": 0.099682, "process_mem_max_rss": "92084", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:28.847712 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:28.847600 after 0.23 seconds
[0m14:05:28.848188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb293ca9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb291fb8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb292c329c0>]}
[0m14:05:28.848651 [debug] [MainThread]: Flushing usage events
[0m22:06:08.443475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5af27eea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5b0177c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5af230170>]}


============================== 22:06:08.464857 | a964af93-8026-4269-a9c9-b10798d17f38 ==============================
[0m22:06:08.464857 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:08.465536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:08.605412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a964af93-8026-4269-a9c9-b10798d17f38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5af02bb30>]}
[0m22:06:08.619034 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6_6jxeui'
[0m22:06:08.619506 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:08.672495 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:08.673159 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:08.683588 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:08.687284 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:08.740210 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:08.740798 [info ] [MainThread]: Up to date!
[0m22:06:08.741338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a964af93-8026-4269-a9c9-b10798d17f38', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5aef35580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5aef8f290>]}
[0m22:06:08.742743 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3478303, "process_user_time": 1.58136, "process_kernel_time": 0.139766, "process_mem_max_rss": "93440", "process_in_blocks": "5488", "process_out_blocks": "3848"}
[0m22:06:08.743355 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:08.743247 after 0.35 seconds
[0m22:06:08.743808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5af3caae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5aef84740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5af087cb0>]}
[0m22:06:08.744291 [debug] [MainThread]: Flushing usage events
[0m22:06:10.418515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304f7a0920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304f8f57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304fb20aa0>]}


============================== 22:06:10.421484 | 88c3211e-4e95-4a06-adff-1d03076ac883 ==============================
[0m22:06:10.421484 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:10.422157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:10.649405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88c3211e-4e95-4a06-adff-1d03076ac883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304f84ef00>]}
[0m22:06:10.709050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88c3211e-4e95-4a06-adff-1d03076ac883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304fc47c20>]}
[0m22:06:10.709878 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:06:10.725179 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:10.725918 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:10.726468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '88c3211e-4e95-4a06-adff-1d03076ac883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3048c16990>]}
[0m22:06:11.948943 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:11.949636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '88c3211e-4e95-4a06-adff-1d03076ac883', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304f84e6c0>]}
[0m22:06:12.133975 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:12.139074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88c3211e-4e95-4a06-adff-1d03076ac883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30489dfe30>]}
[0m22:06:12.285228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88c3211e-4e95-4a06-adff-1d03076ac883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30489dc890>]}
[0m22:06:12.285891 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:12.286459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88c3211e-4e95-4a06-adff-1d03076ac883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30488359a0>]}
[0m22:06:12.288375 [info ] [MainThread]: 
[0m22:06:12.289118 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:12.294216 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:12.332812 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:12.333333 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:06:12.333868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:12.886933 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:12.888558 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:12.890699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:12.891268 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:12.898106 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.898573 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:06:12.898976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:12.904362 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.905724 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.906140 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:12.906665 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.907070 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.907460 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:12.908048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.909010 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:12.909474 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.909869 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:12.910389 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.910807 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:12.912948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:12.918412 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:12.918845 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:12.919231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:12.924288 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.924718 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:12.925125 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:06:12.945235 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.950529 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:12.951759 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:12.952222 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:12.955585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88c3211e-4e95-4a06-adff-1d03076ac883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3048887ef0>]}
[0m22:06:12.956158 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:12.956567 [debug] [MainThread]: On master: BEGIN
[0m22:06:12.956976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:12.962310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:12.962742 [debug] [MainThread]: On master: COMMIT
[0m22:06:12.963144 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:12.963530 [debug] [MainThread]: On master: COMMIT
[0m22:06:12.964204 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:12.964623 [debug] [MainThread]: On master: Close
[0m22:06:12.966241 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:12.966752 [info ] [MainThread]: 
[0m22:06:12.976027 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:12.976655 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:12.977334 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:12.977819 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:13.003894 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:13.004808 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:13.039809 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:13.040760 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:20.469551 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:20.470119 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:20.470935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.471394 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:20.471832 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:20.472567 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.475243 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:20.475705 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:20.476452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.496897 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:20.497393 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:20.497847 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:20.499726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.504471 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:20.504973 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:20.506179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.508600 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:20.534251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88c3211e-4e95-4a06-adff-1d03076ac883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f301796a780>]}
[0m22:06:20.535051 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.56s]
[0m22:06:20.535993 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:20.537043 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:20.537647 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:20.538274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:20.538763 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:20.543797 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:20.544517 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:20.578622 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.579166 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240723220620572786"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:20.579643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:20.595754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.603120 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.603605 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:20.604315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.604789 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.605245 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240723220620572786'
      
      
      order by ordinal_position

  
[0m22:06:20.631394 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.636543 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.637045 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:20.645402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.654183 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.654687 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:20.662388 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.680330 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:20.681050 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.681534 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240723220620572786"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240723220620572786"
    )
  
[0m22:06:20.698167 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.700159 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:20.700634 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:20.701076 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:20.710982 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:20.711928 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:20.841206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88c3211e-4e95-4a06-adff-1d03076ac883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3017a35040>]}
[0m22:06:20.842078 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m22:06:20.842970 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:20.844453 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:20.844945 [debug] [MainThread]: On master: BEGIN
[0m22:06:20.845399 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:20.850887 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:20.851384 [debug] [MainThread]: On master: COMMIT
[0m22:06:20.851835 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:20.852332 [debug] [MainThread]: On master: COMMIT
[0m22:06:20.853034 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:20.853502 [debug] [MainThread]: On master: Close
[0m22:06:20.855095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:20.855545 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:20.855999 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:20.856487 [info ] [MainThread]: 
[0m22:06:20.857058 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.57 seconds (8.57s).
[0m22:06:20.858126 [debug] [MainThread]: Command end result
[0m22:06:20.886154 [info ] [MainThread]: 
[0m22:06:20.886830 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:20.887390 [info ] [MainThread]: 
[0m22:06:20.887968 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:20.889016 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.520403, "process_user_time": 4.916236, "process_kernel_time": 0.321848, "process_mem_max_rss": "285480", "process_in_blocks": "1184", "process_out_blocks": "106520"}
[0m22:06:20.889666 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:20.889555 after 10.52 seconds
[0m22:06:20.890170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30531bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f304fd811c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3017af95e0>]}
[0m22:06:20.890668 [debug] [MainThread]: Flushing usage events
[0m22:06:22.591005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9e222e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9e222a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9e09cda0>]}


============================== 22:06:22.593959 | 47761a04-fa28-4291-aed6-a20329bca4f7 ==============================
[0m22:06:22.593959 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:22.594736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:22.738396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47761a04-fa28-4291-aed6-a20329bca4f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9d6bb050>]}
[0m22:06:22.756122 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21411417, "process_user_time": 1.44749, "process_kernel_time": 0.091714, "process_mem_max_rss": "92088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:22.756724 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:22.756620 after 0.21 seconds
[0m22:06:22.757197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9e38fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9d722c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f9d6a9610>]}
[0m22:06:22.757652 [debug] [MainThread]: Flushing usage events
[0m06:02:12.705524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbee077fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbee2f2330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbee6c8800>]}


============================== 06:02:12.740578 | 60f671cd-8dde-45ed-83e9-4a8730d43a2a ==============================
[0m06:02:12.740578 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.741256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.887196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60f671cd-8dde-45ed-83e9-4a8730d43a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbeea87350>]}
[0m06:02:12.900808 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8eolor4i'
[0m06:02:12.901371 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:12.975380 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:12.976175 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:12.987420 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:12.991202 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:13.041056 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:13.041697 [info ] [MainThread]: Up to date!
[0m06:02:13.042319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '60f671cd-8dde-45ed-83e9-4a8730d43a2a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbedfedca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbedfeee40>]}
[0m06:02:13.043744 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38685057, "process_user_time": 1.566146, "process_kernel_time": 0.162562, "process_mem_max_rss": "93420", "process_in_blocks": "5488", "process_out_blocks": "3840"}
[0m06:02:13.044346 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:13.044240 after 0.39 seconds
[0m06:02:13.044786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbee25e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbede3ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbede3dc70>]}
[0m06:02:13.045257 [debug] [MainThread]: Flushing usage events
[0m06:02:14.641864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b042f9c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0412dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b04020fb0>]}


============================== 06:02:14.644889 | 3acc6ff8-0daf-4733-a71e-b1c0f5e55a00 ==============================
[0m06:02:14.644889 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.645711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.884851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3acc6ff8-0daf-4733-a71e-b1c0f5e55a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b04d925a0>]}
[0m06:02:14.944274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3acc6ff8-0daf-4733-a71e-b1c0f5e55a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b04f31b20>]}
[0m06:02:14.945219 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:14.991523 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:14.992315 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:14.992865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3acc6ff8-0daf-4733-a71e-b1c0f5e55a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b052ac350>]}
[0m06:02:16.231348 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:16.232055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3acc6ff8-0daf-4733-a71e-b1c0f5e55a00', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4afd23a480>]}
[0m06:02:16.416286 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:16.421659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3acc6ff8-0daf-4733-a71e-b1c0f5e55a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4afd1f41a0>]}
[0m06:02:16.570460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3acc6ff8-0daf-4733-a71e-b1c0f5e55a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b03e84530>]}
[0m06:02:16.571063 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:16.571548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3acc6ff8-0daf-4733-a71e-b1c0f5e55a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4afd047200>]}
[0m06:02:16.573322 [info ] [MainThread]: 
[0m06:02:16.574040 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:16.578819 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:16.614399 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:16.614877 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:16.615283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:17.131049 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:17.132693 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:17.134945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:17.135514 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:17.142396 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.142844 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:17.143247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.149079 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.150490 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.150900 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:17.151428 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.151841 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.152240 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:17.152816 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.153789 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.154201 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.154593 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.155142 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.155560 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:17.157912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:17.163489 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.163919 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:17.164304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.169579 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.170021 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.170433 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:17.191040 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.196266 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:17.197619 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:17.198086 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:17.201956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3acc6ff8-0daf-4733-a71e-b1c0f5e55a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4afd240890>]}
[0m06:02:17.202523 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.202930 [debug] [MainThread]: On master: BEGIN
[0m06:02:17.203310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:17.208894 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.209397 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.209799 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.210180 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.210817 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.211230 [debug] [MainThread]: On master: Close
[0m06:02:17.213027 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:17.213532 [info ] [MainThread]: 
[0m06:02:17.222844 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:17.223479 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:17.224171 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:17.224618 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:17.250918 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:17.251805 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:17.286764 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:17.287685 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:24.286347 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.286880 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:24.287571 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.288033 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.288476 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:24.289219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.292012 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.292479 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:24.293204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.313797 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:24.314338 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.314780 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:24.316527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.321501 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.321984 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:24.323259 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.325718 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:24.352081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3acc6ff8-0daf-4733-a71e-b1c0f5e55a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad139dc70>]}
[0m06:02:24.352937 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.13s]
[0m06:02:24.353764 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:24.354774 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:24.355357 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:24.355944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:24.356405 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:24.361610 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:24.362271 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:24.395470 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.395994 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240724060224389717"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:24.396470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:24.413131 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.420228 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.420704 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:24.421341 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.421793 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.422236 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240724060224389717'
      
      
      order by ordinal_position

  
[0m06:02:24.448543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.453523 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.454013 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:24.462735 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.471496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.471990 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:24.481071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.498756 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:24.499464 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.499938 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240724060224389717"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240724060224389717"
    )
  
[0m06:02:24.518589 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.520453 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:24.520921 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.521394 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:24.529457 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.530373 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:24.647405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3acc6ff8-0daf-4733-a71e-b1c0f5e55a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad03eb9e0>]}
[0m06:02:24.648260 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m06:02:24.649077 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:24.650570 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:24.651054 [debug] [MainThread]: On master: BEGIN
[0m06:02:24.651492 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:24.656978 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:24.657461 [debug] [MainThread]: On master: COMMIT
[0m06:02:24.657899 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:24.658321 [debug] [MainThread]: On master: COMMIT
[0m06:02:24.659064 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:24.659525 [debug] [MainThread]: On master: Close
[0m06:02:24.661265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:24.661709 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:24.662121 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:24.662592 [info ] [MainThread]: 
[0m06:02:24.663202 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.09 seconds (8.09s).
[0m06:02:24.664208 [debug] [MainThread]: Command end result
[0m06:02:24.692642 [info ] [MainThread]: 
[0m06:02:24.693297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:24.693808 [info ] [MainThread]: 
[0m06:02:24.694328 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:24.695328 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.102741, "process_user_time": 4.924555, "process_kernel_time": 0.311781, "process_mem_max_rss": "292840", "process_in_blocks": "1184", "process_out_blocks": "106992"}
[0m06:02:24.695970 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:24.695861 after 10.10 seconds
[0m06:02:24.696466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b04093380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4af0595d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b04449940>]}
[0m06:02:24.696985 [debug] [MainThread]: Flushing usage events
[0m06:02:26.414342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672266cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6723222f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67232207d0>]}


============================== 06:02:26.417404 | 3936ddb4-93d4-41c7-8368-871426971b08 ==============================
[0m06:02:26.417404 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:26.418080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:26.570026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3936ddb4-93d4-41c7-8368-871426971b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67237bc8c0>]}
[0m06:02:26.586897 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22243877, "process_user_time": 1.496295, "process_kernel_time": 0.096018, "process_mem_max_rss": "91880", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:26.587509 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:26.587404 after 0.22 seconds
[0m06:02:26.587964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6722912a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6722bd8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67226c5610>]}
[0m06:02:26.588412 [debug] [MainThread]: Flushing usage events
[0m14:05:56.818605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ec2f36e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ecc733b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ecb7cfe0>]}


============================== 14:05:56.917158 | f2308a5e-2502-4505-94ab-790e87003d39 ==============================
[0m14:05:56.917158 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:56.918002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:57.063089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2308a5e-2502-4505-94ab-790e87003d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ebeb13a0>]}
[0m14:05:57.076456 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hm6snawp'
[0m14:05:57.076949 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:57.121270 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:57.121971 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:57.144399 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:57.148154 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:57.219775 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:57.220300 [info ] [MainThread]: Up to date!
[0m14:05:57.220873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f2308a5e-2502-4505-94ab-790e87003d39', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ebdbf800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ebdbfe60>]}
[0m14:05:57.230840 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46245608, "process_user_time": 1.615631, "process_kernel_time": 0.111422, "process_mem_max_rss": "93692", "process_in_blocks": "5744", "process_out_blocks": "3848"}
[0m14:05:57.231511 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:57.231393 after 0.46 seconds
[0m14:05:57.231959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ec2f36e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ec5d8fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ed0eba10>]}
[0m14:05:57.232401 [debug] [MainThread]: Flushing usage events
[0m14:05:59.562668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb87157230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb875fab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb875fb560>]}


============================== 14:05:59.565449 | 9efc7649-e2fa-431b-8327-9302bee972bb ==============================
[0m14:05:59.565449 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:59.566113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:59.790224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9efc7649-e2fa-431b-8327-9302bee972bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb86f3c620>]}
[0m14:05:59.849531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9efc7649-e2fa-431b-8327-9302bee972bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb87563950>]}
[0m14:05:59.850288 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:59.903641 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:59.904370 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:59.904964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9efc7649-e2fa-431b-8327-9302bee972bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb86f000e0>]}
[0m14:06:01.116566 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:01.117270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9efc7649-e2fa-431b-8327-9302bee972bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb805ea480>]}
[0m14:06:01.298064 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:01.302993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9efc7649-e2fa-431b-8327-9302bee972bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8028ba70>]}
[0m14:06:01.421369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9efc7649-e2fa-431b-8327-9302bee972bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8032a8a0>]}
[0m14:06:01.421932 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:06:01.422441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9efc7649-e2fa-431b-8327-9302bee972bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8028b140>]}
[0m14:06:01.424115 [info ] [MainThread]: 
[0m14:06:01.424828 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:01.429556 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:01.463980 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:01.464440 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:06:01.464882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:01.964449 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:01.966046 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:01.968314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:01.968936 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:01.975865 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:01.976314 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:06:01.976766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:01.982566 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:01.983914 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:01.984340 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:01.985244 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:01.985655 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:01.986059 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:01.986685 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:01.987622 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:01.988040 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:01.988437 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:01.989027 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:01.989450 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:01.991613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:01.996928 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:01.997355 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:01.997741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:02.002788 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:02.003212 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:02.003616 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:06:02.024018 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:02.028701 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:02.029878 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:02.030299 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:02.033881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9efc7649-e2fa-431b-8327-9302bee972bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb802cfa70>]}
[0m14:06:02.034412 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:02.034851 [debug] [MainThread]: On master: BEGIN
[0m14:06:02.035242 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:02.040360 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:02.040828 [debug] [MainThread]: On master: COMMIT
[0m14:06:02.041230 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:02.041621 [debug] [MainThread]: On master: COMMIT
[0m14:06:02.042137 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:02.042545 [debug] [MainThread]: On master: Close
[0m14:06:02.043970 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:02.044466 [info ] [MainThread]: 
[0m14:06:02.094011 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:02.094620 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:02.095275 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:06:02.095726 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:02.121086 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:02.121828 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:02.156421 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:02.157200 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:06:09.996573 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:09.997145 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:09.997805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:09.998297 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:09.998758 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:09.999464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:10.002185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:10.002659 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:10.003357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:10.023840 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:10.024323 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:10.024793 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:10.025913 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:10.030615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:10.031101 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:06:10.032237 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:10.034574 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:10.060570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9efc7649-e2fa-431b-8327-9302bee972bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8883e9c0>]}
[0m14:06:10.061331 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.96s]
[0m14:06:10.062100 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:10.063059 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:10.063637 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:10.064218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:10.064720 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:10.069490 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:10.070140 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:10.103315 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:10.103835 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240724140610097486"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:10.104326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:10.120429 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:10.128167 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:10.128677 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:10.129376 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:10.129842 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:10.130294 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240724140610097486'
      
      
      order by ordinal_position

  
[0m14:06:10.157222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:10.162090 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:10.162580 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:06:10.171280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:10.178530 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:10.179021 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:06:10.187609 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:10.205463 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:10.206153 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:10.206640 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240724140610097486"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240724140610097486"
    )
  
[0m14:06:10.222875 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:10.224843 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:10.225317 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:10.225759 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:10.234034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:10.234931 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:10.358058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9efc7649-e2fa-431b-8327-9302bee972bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4f40be90>]}
[0m14:06:10.358876 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m14:06:10.359735 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:10.361055 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:10.361543 [debug] [MainThread]: On master: BEGIN
[0m14:06:10.361988 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:10.367517 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:10.368037 [debug] [MainThread]: On master: COMMIT
[0m14:06:10.368489 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:10.369013 [debug] [MainThread]: On master: COMMIT
[0m14:06:10.369582 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:10.370137 [debug] [MainThread]: On master: Close
[0m14:06:10.371750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:10.372195 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:06:10.372620 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:10.373146 [info ] [MainThread]: 
[0m14:06:10.373747 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.95 seconds (8.95s).
[0m14:06:10.374857 [debug] [MainThread]: Command end result
[0m14:06:10.403013 [info ] [MainThread]: 
[0m14:06:10.403703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:10.404301 [info ] [MainThread]: 
[0m14:06:10.404941 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:10.406015 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.892083, "process_user_time": 4.770097, "process_kernel_time": 0.297629, "process_mem_max_rss": "281888", "process_in_blocks": "1184", "process_out_blocks": "107000"}
[0m14:06:10.406664 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:10.406556 after 10.89 seconds
[0m14:06:10.407157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb882103b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb803cdbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8757d850>]}
[0m14:06:10.407642 [debug] [MainThread]: Flushing usage events
[0m14:06:14.736494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f18a4da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f18cc1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f18880b60>]}


============================== 14:06:14.739270 | 4b6f3351-a848-41eb-be7b-02f5f058955e ==============================
[0m14:06:14.739270 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:14.740031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:14.888222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b6f3351-a848-41eb-be7b-02f5f058955e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f17ef4a40>]}
[0m14:06:14.904554 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21705255, "process_user_time": 1.431477, "process_kernel_time": 0.103962, "process_mem_max_rss": "92204", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:06:14.905186 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:14.905083 after 0.22 seconds
[0m14:06:14.905641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f18138da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f17f799a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f17f7baa0>]}
[0m14:06:14.906088 [debug] [MainThread]: Flushing usage events
[0m22:06:05.289571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51b18f320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51b93ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51bcb77a0>]}


============================== 22:06:05.296877 | bffa067a-ce93-4509-a836-3f8e5d066a8e ==============================
[0m22:06:05.296877 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:05.297547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:05.447167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bffa067a-ce93-4509-a836-3f8e5d066a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51b00a7e0>]}
[0m22:06:05.460787 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r29q_wal'
[0m22:06:05.461263 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:05.502374 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:05.503051 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:05.514334 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:05.518147 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:05.729020 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:05.729600 [info ] [MainThread]: Up to date!
[0m22:06:05.730145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bffa067a-ce93-4509-a836-3f8e5d066a8e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51ad4a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51a91fcb0>]}
[0m22:06:05.732063 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49114785, "process_user_time": 1.570459, "process_kernel_time": 0.146089, "process_mem_max_rss": "93732", "process_in_blocks": "5744", "process_out_blocks": "3840"}
[0m22:06:05.732671 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:05.732565 after 0.49 seconds
[0m22:06:05.733116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51b16a900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51b05be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51b00a7e0>]}
[0m22:06:05.733553 [debug] [MainThread]: Flushing usage events
[0m22:06:07.553542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7442a9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e748c7a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e748c4530>]}


============================== 22:06:07.556289 | 1abb52d6-432e-45ab-adb5-3fe742289712 ==============================
[0m22:06:07.556289 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:07.556958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:07.789251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1abb52d6-432e-45ab-adb5-3fe742289712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6cfa0290>]}
[0m22:06:07.849001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1abb52d6-432e-45ab-adb5-3fe742289712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e74984380>]}
[0m22:06:07.849725 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m22:06:07.864753 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:07.865465 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:07.866027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1abb52d6-432e-45ab-adb5-3fe742289712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e73924440>]}
[0m22:06:09.078725 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:09.079405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1abb52d6-432e-45ab-adb5-3fe742289712', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e73927ad0>]}
[0m22:06:09.261875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:09.266842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1abb52d6-432e-45ab-adb5-3fe742289712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6ce401a0>]}
[0m22:06:09.386872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1abb52d6-432e-45ab-adb5-3fe742289712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6ccd3830>]}
[0m22:06:09.387449 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:09.388016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1abb52d6-432e-45ab-adb5-3fe742289712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e739836e0>]}
[0m22:06:09.389838 [info ] [MainThread]: 
[0m22:06:09.390572 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:09.395186 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:09.430118 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:09.430597 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:06:09.431024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:09.747883 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:09.749442 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:09.751721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:09.752355 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:09.759245 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:09.759700 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:06:09.760156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:09.765612 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:09.766943 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:09.767365 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:09.767969 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:09.768461 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:09.768863 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:09.769422 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:09.770368 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:09.770786 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:09.771175 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:09.771840 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:09.772274 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:09.774447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:09.779864 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:09.780293 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:09.780684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:09.785672 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:09.786102 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:09.786512 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:06:09.806806 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:09.811679 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:09.812949 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:09.813373 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:09.817331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1abb52d6-432e-45ab-adb5-3fe742289712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e6cacf770>]}
[0m22:06:09.817866 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:09.818284 [debug] [MainThread]: On master: BEGIN
[0m22:06:09.818679 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:09.823928 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:09.824366 [debug] [MainThread]: On master: COMMIT
[0m22:06:09.824772 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:09.825161 [debug] [MainThread]: On master: COMMIT
[0m22:06:09.825808 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:09.826229 [debug] [MainThread]: On master: Close
[0m22:06:09.827706 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:09.828256 [info ] [MainThread]: 
[0m22:06:09.837464 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:09.838086 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:09.838763 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:09.839214 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:09.865049 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:09.865816 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:09.900796 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:09.901550 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:19.447291 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.447844 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:19.448493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.448961 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.449414 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:19.450118 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.452817 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.453292 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:19.454136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.474619 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:19.475110 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.475562 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:19.477100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.481825 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.482315 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:19.484150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.486481 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:19.512332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1abb52d6-432e-45ab-adb5-3fe742289712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e74fa1e80>]}
[0m22:06:19.513083 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.67s]
[0m22:06:19.513887 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:19.514894 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:19.515471 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:19.516106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:19.516570 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:19.521541 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:19.522199 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:19.555729 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.556282 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240724220619549805"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:19.556774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:19.572892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.580904 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.581393 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:19.582067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.582536 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.582996 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240724220619549805'
      
      
      order by ordinal_position

  
[0m22:06:19.615445 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.620369 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.620866 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:19.634543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.641852 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.642358 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:19.650746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.668708 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:19.669407 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.669900 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240724220619549805"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240724220619549805"
    )
  
[0m22:06:19.686139 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.687988 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:19.688469 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.688914 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:19.699178 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.700095 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:19.829746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1abb52d6-432e-45ab-adb5-3fe742289712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e4045fbc0>]}
[0m22:06:19.830620 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m22:06:19.831514 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:19.832937 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:19.833458 [debug] [MainThread]: On master: BEGIN
[0m22:06:19.833908 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:19.839241 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:19.839724 [debug] [MainThread]: On master: COMMIT
[0m22:06:19.840211 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:19.840649 [debug] [MainThread]: On master: COMMIT
[0m22:06:19.841321 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:19.841788 [debug] [MainThread]: On master: Close
[0m22:06:19.843151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:19.843608 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:19.844111 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:19.844594 [info ] [MainThread]: 
[0m22:06:19.845127 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.45 seconds (10.45s).
[0m22:06:19.846129 [debug] [MainThread]: Command end result
[0m22:06:19.874978 [info ] [MainThread]: 
[0m22:06:19.875617 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:19.876177 [info ] [MainThread]: 
[0m22:06:19.876722 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:19.877751 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.372915, "process_user_time": 4.892204, "process_kernel_time": 0.261507, "process_mem_max_rss": "285136", "process_in_blocks": "1184", "process_out_blocks": "107536"}
[0m22:06:19.878422 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:19.878312 after 12.37 seconds
[0m22:06:19.878925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7442a720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e410aff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e403dc500>]}
[0m22:06:19.879420 [debug] [MainThread]: Flushing usage events
[0m22:06:21.772069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bbfc8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bc579400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bbf35160>]}


============================== 22:06:21.774821 | 573f3e61-ae68-410d-a822-5f52feff98be ==============================
[0m22:06:21.774821 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:21.775668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:21.920719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '573f3e61-ae68-410d-a822-5f52feff98be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bbec7680>]}
[0m22:06:21.936914 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2143696, "process_user_time": 1.436341, "process_kernel_time": 0.080019, "process_mem_max_rss": "92260", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:21.937494 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:21.937390 after 0.22 seconds
[0m22:06:21.937939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bc0933b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bce0f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54bb5399a0>]}
[0m22:06:21.938373 [debug] [MainThread]: Flushing usage events
[0m06:02:05.392529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2fa81b140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2fa036ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2fa81b170>]}


============================== 06:02:05.400027 | dbc4f4a6-e93b-4fbe-bd25-597abd4a7931 ==============================
[0m06:02:05.400027 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:05.400759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:05.544748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbc4f4a6-e93b-4fbe-bd25-597abd4a7931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2f9cfd0a0>]}
[0m06:02:05.558979 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-p11aa69c'
[0m06:02:05.559459 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:05.662958 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:05.663634 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:05.738357 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:05.742196 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:05.878669 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:05.879274 [info ] [MainThread]: Up to date!
[0m06:02:05.879839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'dbc4f4a6-e93b-4fbe-bd25-597abd4a7931', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2f9bb1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2f9bb3b00>]}
[0m06:02:05.905757 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.56223714, "process_user_time": 1.564987, "process_kernel_time": 0.135738, "process_mem_max_rss": "93452", "process_in_blocks": "5744", "process_out_blocks": "3848"}
[0m06:02:05.906496 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:05.906369 after 0.56 seconds
[0m06:02:05.907007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2fa036ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2fa26f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2f9ca3a70>]}
[0m06:02:05.907463 [debug] [MainThread]: Flushing usage events
[0m06:02:07.601212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7a380e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7a8e57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb79357110>]}


============================== 06:02:07.604162 | a683927e-a6df-4c84-98eb-d1d2d1402dbf ==============================
[0m06:02:07.604162 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:07.604834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.840751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a683927e-a6df-4c84-98eb-d1d2d1402dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb79076db0>]}
[0m06:02:07.900865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a683927e-a6df-4c84-98eb-d1d2d1402dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb790210a0>]}
[0m06:02:07.901773 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m06:02:07.918652 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:07.919432 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:07.919979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a683927e-a6df-4c84-98eb-d1d2d1402dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb78ff0d70>]}
[0m06:02:09.141340 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:09.142057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a683927e-a6df-4c84-98eb-d1d2d1402dbf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb726ca690>]}
[0m06:02:09.323989 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:09.328971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a683927e-a6df-4c84-98eb-d1d2d1402dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7262d520>]}
[0m06:02:09.453861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a683927e-a6df-4c84-98eb-d1d2d1402dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7255f770>]}
[0m06:02:09.454445 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:09.454998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a683927e-a6df-4c84-98eb-d1d2d1402dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7245e600>]}
[0m06:02:09.456795 [info ] [MainThread]: 
[0m06:02:09.457498 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:09.462099 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:09.497235 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:09.497727 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:09.498134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:10.060145 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:10.061691 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:10.063865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:10.064443 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:10.071310 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.071765 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:10.072171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.077931 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.079396 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.079815 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:10.080470 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.080880 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.081268 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:10.081843 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.082759 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.083210 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.083606 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.084257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.084690 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:10.086962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:10.092333 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.092764 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:10.093157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.098257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.098697 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.099145 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:10.119390 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.124279 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:10.125535 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:10.125965 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:10.129509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a683927e-a6df-4c84-98eb-d1d2d1402dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb725eb290>]}
[0m06:02:10.130048 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.130456 [debug] [MainThread]: On master: BEGIN
[0m06:02:10.130873 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:10.136247 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.136681 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.137081 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.137470 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.138110 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.138528 [debug] [MainThread]: On master: Close
[0m06:02:10.140393 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:10.140909 [info ] [MainThread]: 
[0m06:02:10.150654 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:10.151320 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:10.151994 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:10.152442 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:10.178757 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:10.179580 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:10.215542 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:10.216501 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:18.493121 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.493648 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:18.494304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.494778 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.495276 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:18.496096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.498777 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.499289 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:18.500096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.520716 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:18.521215 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.521665 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:18.522774 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.527555 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.528043 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:18.529338 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.531694 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:18.557745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a683927e-a6df-4c84-98eb-d1d2d1402dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb725f2180>]}
[0m06:02:18.558510 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.40s]
[0m06:02:18.559425 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:18.560432 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:18.561073 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:18.561759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:18.562227 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:18.567187 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:18.567850 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:18.601424 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.601966 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240725060218595432"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:18.602472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:18.618890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.626981 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.627470 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:18.628068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.628540 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.629004 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240725060218595432'
      
      
      order by ordinal_position

  
[0m06:02:18.655155 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.660109 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.660610 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:18.674590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.681927 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.682420 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:18.691006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.709027 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:18.709732 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.710214 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240725060218595432"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240725060218595432"
    )
  
[0m06:02:18.727470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.729381 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:18.729849 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.730286 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:18.741117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.742038 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:18.878792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a683927e-a6df-4c84-98eb-d1d2d1402dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb725ea3f0>]}
[0m06:02:18.879679 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m06:02:18.880557 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:18.881895 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.882396 [debug] [MainThread]: On master: BEGIN
[0m06:02:18.882894 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:18.888317 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.888808 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.889261 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.889705 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.890391 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.890899 [debug] [MainThread]: On master: Close
[0m06:02:18.892378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:18.892825 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:18.893243 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:18.893741 [info ] [MainThread]: 
[0m06:02:18.894292 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.44 seconds (9.44s).
[0m06:02:18.895344 [debug] [MainThread]: Command end result
[0m06:02:18.924453 [info ] [MainThread]: 
[0m06:02:18.925079 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:18.925596 [info ] [MainThread]: 
[0m06:02:18.926120 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:18.927142 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.375302, "process_user_time": 4.92, "process_kernel_time": 0.284231, "process_mem_max_rss": "283968", "process_in_blocks": "1184", "process_out_blocks": "108032"}
[0m06:02:18.927799 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:18.927689 after 11.38 seconds
[0m06:02:18.928296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7962c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7a3e8fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb45e52a50>]}
[0m06:02:18.928784 [debug] [MainThread]: Flushing usage events
[0m06:02:20.701909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec7e67ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec6df0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec726e1b0>]}


============================== 06:02:20.704741 | 1518924c-c154-48c9-b98f-129a081b3d5c ==============================
[0m06:02:20.704741 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:20.705479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.851908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1518924c-c154-48c9-b98f-129a081b3d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec81433e0>]}
[0m06:02:20.868753 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2155639, "process_user_time": 1.429627, "process_kernel_time": 0.143761, "process_mem_max_rss": "92104", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:20.869355 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:20.869250 after 0.22 seconds
[0m06:02:20.869810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec6e16a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec6741fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec68718e0>]}
[0m06:02:20.870258 [debug] [MainThread]: Flushing usage events
[0m14:05:05.425050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29dec30860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29dfa718e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29dec308c0>]}


============================== 14:05:05.447340 | 897a614e-82e5-46dc-b292-eff2b5cf3906 ==============================
[0m14:05:05.447340 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:05.448172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:05.610974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '897a614e-82e5-46dc-b292-eff2b5cf3906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29dfa71f40>]}
[0m14:05:05.625482 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8cx36ytq'
[0m14:05:05.626006 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:05.669843 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:05.670584 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:05.681348 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:05.685644 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:05.909712 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:05.910439 [info ] [MainThread]: Up to date!
[0m14:05:05.911070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '897a614e-82e5-46dc-b292-eff2b5cf3906', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29de148260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29de1484a0>]}
[0m14:05:05.929828 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5559898, "process_user_time": 1.679725, "process_kernel_time": 0.135333, "process_mem_max_rss": "93460", "process_in_blocks": "5744", "process_out_blocks": "3840"}
[0m14:05:05.930704 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:05.930590 after 0.56 seconds
[0m14:05:05.931192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29de915be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29de852c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29de4054c0>]}
[0m14:05:05.931669 [debug] [MainThread]: Flushing usage events
[0m14:05:08.427306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc652349b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc64c82e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc64c81100>]}


============================== 14:05:08.430560 | ad39b965-cc0c-42ba-807b-dd6d154c2dc2 ==============================
[0m14:05:08.430560 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:08.431355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:08.685194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad39b965-cc0c-42ba-807b-dd6d154c2dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc647a2930>]}
[0m14:05:08.747147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad39b965-cc0c-42ba-807b-dd6d154c2dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc65e54fb0>]}
[0m14:05:08.748104 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:05:08.770983 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:08.771870 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:08.772478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ad39b965-cc0c-42ba-807b-dd6d154c2dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc66721550>]}
[0m14:05:10.088878 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:10.089637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ad39b965-cc0c-42ba-807b-dd6d154c2dc2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5dc372f0>]}
[0m14:05:10.287024 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:10.292489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad39b965-cc0c-42ba-807b-dd6d154c2dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5db448c0>]}
[0m14:05:10.432399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad39b965-cc0c-42ba-807b-dd6d154c2dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5db6a780>]}
[0m14:05:10.432992 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:10.433549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad39b965-cc0c-42ba-807b-dd6d154c2dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5d93e540>]}
[0m14:05:10.435495 [info ] [MainThread]: 
[0m14:05:10.436214 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:10.441036 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:10.479964 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:10.480545 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:10.480974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:11.004016 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:11.005844 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:11.008677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:11.009447 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:11.018409 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:11.018999 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:11.019493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:11.026670 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.028460 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:11.028915 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:11.029668 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.030093 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:11.030555 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:11.031420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.032514 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:11.032933 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:11.033326 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:11.033943 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.034458 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:11.037435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:11.043943 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:11.044455 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:11.044844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:11.051236 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.051877 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:11.052438 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:11.074222 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.081066 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:11.082472 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:11.083005 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:11.086826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad39b965-cc0c-42ba-807b-dd6d154c2dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5dbbd5b0>]}
[0m14:05:11.087391 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:11.087801 [debug] [MainThread]: On master: BEGIN
[0m14:05:11.088184 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:11.094613 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:11.095195 [debug] [MainThread]: On master: COMMIT
[0m14:05:11.095649 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:11.096185 [debug] [MainThread]: On master: COMMIT
[0m14:05:11.096927 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:11.097485 [debug] [MainThread]: On master: Close
[0m14:05:11.099784 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:11.100323 [info ] [MainThread]: 
[0m14:05:11.150761 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:11.151509 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:11.152390 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:11.152959 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:11.180594 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:11.181535 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:11.220434 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:11.221378 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:22.159150 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.159777 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:22.160591 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.161089 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.161604 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:22.162679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.165830 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.166326 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:22.167113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.189004 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:22.189671 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.190176 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:22.192117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.197599 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.198122 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:22.199702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.202399 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:22.229365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad39b965-cc0c-42ba-807b-dd6d154c2dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc65ff2390>]}
[0m14:05:22.230255 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.08s]
[0m14:05:22.231150 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:22.232266 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:22.232906 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:22.233651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:22.234131 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:22.239392 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:22.240098 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:22.274724 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.275331 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240725140522268600"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:22.275827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:22.292375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.301047 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.301601 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:22.302328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.302794 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.303256 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240725140522268600'
      
      
      order by ordinal_position

  
[0m14:05:22.336157 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.341991 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.342522 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:22.357902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.366444 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.367042 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:22.376418 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.395691 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:22.396565 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.397104 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240725140522268600"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240725140522268600"
    )
  
[0m14:05:22.413976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.416068 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:22.416578 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.417034 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:22.427672 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.428774 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:22.571464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad39b965-cc0c-42ba-807b-dd6d154c2dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc312c6c90>]}
[0m14:05:22.572343 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m14:05:22.573234 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:22.574776 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.575259 [debug] [MainThread]: On master: BEGIN
[0m14:05:22.575703 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:22.581505 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.582083 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.582562 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.583013 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.583748 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.584247 [debug] [MainThread]: On master: Close
[0m14:05:22.586255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:22.586735 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:22.587162 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:22.587670 [info ] [MainThread]: 
[0m14:05:22.588238 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.15 seconds (12.15s).
[0m14:05:22.589306 [debug] [MainThread]: Command end result
[0m14:05:22.619721 [info ] [MainThread]: 
[0m14:05:22.620471 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:22.621045 [info ] [MainThread]: 
[0m14:05:22.621639 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:22.622716 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.247715, "process_user_time": 5.201165, "process_kernel_time": 0.36008, "process_mem_max_rss": "285600", "process_in_blocks": "1184", "process_out_blocks": "108528"}
[0m14:05:22.623368 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:22.623256 after 14.25 seconds
[0m14:05:22.623872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc649eaae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc64d05790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc312e9730>]}
[0m14:05:22.624376 [debug] [MainThread]: Flushing usage events
[0m14:05:25.055926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f18b9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f0225b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6efe1ecc0>]}


============================== 14:05:25.059177 | dada3b90-88b9-4a83-9142-7da856479218 ==============================
[0m14:05:25.059177 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:25.059867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:25.220576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dada3b90-88b9-4a83-9142-7da856479218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6eff93050>]}
[0m14:05:25.238623 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23693103, "process_user_time": 1.543701, "process_kernel_time": 0.1077, "process_mem_max_rss": "92156", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:25.239297 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:25.239181 after 0.24 seconds
[0m14:05:25.239784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6efe1ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6efe1f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6efada060>]}
[0m14:05:25.240259 [debug] [MainThread]: Flushing usage events
[0m22:05:37.122134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57bedcda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57bdc9f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57bdc9f0e0>]}


============================== 22:05:37.129475 | 8464f948-2e4c-4217-b721-1b1e49769fd4 ==============================
[0m22:05:37.129475 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:37.130172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:05:37.270272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8464f948-2e4c-4217-b721-1b1e49769fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57bd116900>]}
[0m22:05:37.283401 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ren22fqk'
[0m22:05:37.283861 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:37.346138 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:37.346757 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:37.357736 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:37.361494 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:37.490706 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:37.491299 [info ] [MainThread]: Up to date!
[0m22:05:37.491851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8464f948-2e4c-4217-b721-1b1e49769fd4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57bd07ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57bd07bce0>]}
[0m22:05:37.493622 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41973138, "process_user_time": 1.62731, "process_kernel_time": 0.112783, "process_mem_max_rss": "93468", "process_in_blocks": "5744", "process_out_blocks": "3848"}
[0m22:05:37.494368 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:37.494238 after 0.42 seconds
[0m22:05:37.494822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57bd7b8da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57bd116900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57bd74a600>]}
[0m22:05:37.495263 [debug] [MainThread]: Flushing usage events
[0m22:05:39.148122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc454f5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc46c7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc454f560>]}


============================== 22:05:39.151122 | 303f203d-4a13-4209-8ccc-c78a36b82f58 ==============================
[0m22:05:39.151122 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:39.151828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:39.388125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '303f203d-4a13-4209-8ccc-c78a36b82f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc427f4d0>]}
[0m22:05:39.447956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '303f203d-4a13-4209-8ccc-c78a36b82f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc5431d30>]}
[0m22:05:39.448802 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m22:05:39.464272 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:39.465006 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:39.465579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '303f203d-4a13-4209-8ccc-c78a36b82f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc42afe90>]}
[0m22:05:40.681461 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:40.682186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '303f203d-4a13-4209-8ccc-c78a36b82f58', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbd9a03b0>]}
[0m22:05:40.863697 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:40.868640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '303f203d-4a13-4209-8ccc-c78a36b82f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbd6c39b0>]}
[0m22:05:40.995129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '303f203d-4a13-4209-8ccc-c78a36b82f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbd7a1e20>]}
[0m22:05:40.995694 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:40.996210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '303f203d-4a13-4209-8ccc-c78a36b82f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbd5a43e0>]}
[0m22:05:40.998014 [info ] [MainThread]: 
[0m22:05:40.998703 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:41.003267 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:41.037930 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:41.038394 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:41.038801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:41.683840 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:41.685433 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:41.687784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:41.688373 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:41.695295 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:41.695760 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:41.696171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:41.701972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.703351 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:41.703769 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:41.704442 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.704855 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:41.705290 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:41.705886 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.706802 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:41.707222 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:41.707617 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:41.708154 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.708575 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:41.710713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:41.716013 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:41.716443 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:41.716831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:41.721750 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.722175 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:41.722584 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:41.742434 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.747049 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:41.748256 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:41.748683 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:41.752017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '303f203d-4a13-4209-8ccc-c78a36b82f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbd7d0740>]}
[0m22:05:41.752538 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:41.752945 [debug] [MainThread]: On master: BEGIN
[0m22:05:41.753361 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:41.758449 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:41.758879 [debug] [MainThread]: On master: COMMIT
[0m22:05:41.759280 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:41.759661 [debug] [MainThread]: On master: COMMIT
[0m22:05:41.760300 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:41.760716 [debug] [MainThread]: On master: Close
[0m22:05:41.762215 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:41.762716 [info ] [MainThread]: 
[0m22:05:41.771559 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:41.772161 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:41.772806 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:41.773284 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:41.798830 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:41.799586 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:41.834613 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:41.835350 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:51.401730 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.402248 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:51.403022 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.403501 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.403958 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:51.404846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.407574 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.408052 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:51.408780 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.429534 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.430026 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.430480 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.431670 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.436456 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.436947 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:51.438200 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.440522 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:51.467341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '303f203d-4a13-4209-8ccc-c78a36b82f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c908488c0>]}
[0m22:05:51.468125 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.69s]
[0m22:05:51.468903 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:51.469974 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:51.470547 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:51.471129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:51.471607 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:51.476547 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:51.477227 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:51.510870 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.511398 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240725220551504912"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:51.511894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:51.525986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.533855 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.534339 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:51.534945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.535414 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.535880 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240725220551504912'
      
      
      order by ordinal_position

  
[0m22:05:51.562251 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.567153 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.567657 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:51.576405 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.583725 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.584221 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:51.598621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.617121 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:51.617868 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.618357 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240725220551504912"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240725220551504912"
    )
  
[0m22:05:51.634966 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.636761 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:51.637230 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.637706 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:51.646068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.646971 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:51.798412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '303f203d-4a13-4209-8ccc-c78a36b82f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cbd7f3740>]}
[0m22:05:51.799276 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m22:05:51.800040 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:51.801501 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:51.802007 [debug] [MainThread]: On master: BEGIN
[0m22:05:51.802458 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:51.807796 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:51.808284 [debug] [MainThread]: On master: COMMIT
[0m22:05:51.808735 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:51.809174 [debug] [MainThread]: On master: COMMIT
[0m22:05:51.809922 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:51.810396 [debug] [MainThread]: On master: Close
[0m22:05:51.811803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:51.812255 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:51.812677 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:51.813145 [info ] [MainThread]: 
[0m22:05:51.813810 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.81 seconds (10.81s).
[0m22:05:51.814941 [debug] [MainThread]: Command end result
[0m22:05:51.843522 [info ] [MainThread]: 
[0m22:05:51.844219 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:51.844832 [info ] [MainThread]: 
[0m22:05:51.845481 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:51.846570 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.750079, "process_user_time": 4.947604, "process_kernel_time": 0.259559, "process_mem_max_rss": "287332", "process_in_blocks": "1184", "process_out_blocks": "108568"}
[0m22:05:51.847221 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:51.847111 after 12.75 seconds
[0m22:05:51.847721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc48d9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c90985070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c9084b350>]}
[0m22:05:51.848216 [debug] [MainThread]: Flushing usage events
[0m22:05:53.638239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5bf4b0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c06e7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5bf20b3e0>]}


============================== 22:05:53.641157 | 192453ec-2f1e-4eb3-abcc-fff7b2409fa6 ==============================
[0m22:05:53.641157 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:53.641924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:05:53.794430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '192453ec-2f1e-4eb3-abcc-fff7b2409fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5bfb70c50>]}
[0m22:05:53.811230 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22489454, "process_user_time": 1.475705, "process_kernel_time": 0.119976, "process_mem_max_rss": "92076", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:53.811829 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:53.811725 after 0.23 seconds
[0m22:05:53.812274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5bf4b0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5bf20b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5bf2e37d0>]}
[0m22:05:53.812722 [debug] [MainThread]: Flushing usage events
[0m06:02:12.584601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0978b66060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0978f8b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0978bfa3f0>]}


============================== 06:02:12.606173 | 91aec8da-b84e-447e-bb96-eef7c24969db ==============================
[0m06:02:12.606173 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.606916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.751619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91aec8da-b84e-447e-bb96-eef7c24969db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0979ff52e0>]}
[0m06:02:12.764863 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lxz08pxt'
[0m06:02:12.765327 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:12.849612 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:12.850315 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:12.873103 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:12.876913 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:12.949152 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:12.949703 [info ] [MainThread]: Up to date!
[0m06:02:12.950254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '91aec8da-b84e-447e-bb96-eef7c24969db', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0978bfa420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0979948aa0>]}
[0m06:02:12.970742 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43488857, "process_user_time": 1.573389, "process_kernel_time": 0.133132, "process_mem_max_rss": "93456", "process_in_blocks": "5744", "process_out_blocks": "3848"}
[0m06:02:12.971519 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:12.971389 after 0.44 seconds
[0m06:02:12.972049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0978b2ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0978bfa420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09788226c0>]}
[0m06:02:12.972530 [debug] [MainThread]: Flushing usage events
[0m06:02:14.609694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c34d417f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c34ecdb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c34d40230>]}


============================== 06:02:14.612577 | 28cf127c-da75-4bbd-b41f-a07eaeeb632b ==============================
[0m06:02:14.612577 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.613307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.846885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28cf127c-da75-4bbd-b41f-a07eaeeb632b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c34a74e90>]}
[0m06:02:14.906365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28cf127c-da75-4bbd-b41f-a07eaeeb632b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c34a772c0>]}
[0m06:02:14.907244 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m06:02:14.927949 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:14.928717 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:14.929271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '28cf127c-da75-4bbd-b41f-a07eaeeb632b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c34abd0d0>]}
[0m06:02:16.168823 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:16.170058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '28cf127c-da75-4bbd-b41f-a07eaeeb632b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c34abc3b0>]}
[0m06:02:16.353439 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:16.358535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28cf127c-da75-4bbd-b41f-a07eaeeb632b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c2de55fa0>]}
[0m06:02:16.486517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28cf127c-da75-4bbd-b41f-a07eaeeb632b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c2dd4e600>]}
[0m06:02:16.487130 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:16.487642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28cf127c-da75-4bbd-b41f-a07eaeeb632b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c2dea6ff0>]}
[0m06:02:16.489447 [info ] [MainThread]: 
[0m06:02:16.490147 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:16.494700 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:16.529753 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:16.530234 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:16.530650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:16.991434 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.992996 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:16.995278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:16.995879 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:17.002707 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.003213 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:17.003634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.009387 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.010806 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.011280 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:17.011951 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.012370 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.012769 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:17.013353 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.014290 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.014715 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.015165 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.015712 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.016137 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:17.018228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:17.023557 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.023986 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:17.024379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.029291 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.029723 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.030143 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:17.050404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.056818 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:17.058030 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:17.058459 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:17.062043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28cf127c-da75-4bbd-b41f-a07eaeeb632b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c2ded3530>]}
[0m06:02:17.062565 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.062964 [debug] [MainThread]: On master: BEGIN
[0m06:02:17.063398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:17.068511 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.068945 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.069343 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.069727 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.070236 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.070649 [debug] [MainThread]: On master: Close
[0m06:02:17.072068 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:17.072576 [info ] [MainThread]: 
[0m06:02:17.087140 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:17.087760 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:17.088439 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:17.088890 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:17.114343 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:17.115143 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:17.149932 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:17.150704 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:30.281832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:30.282354 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:30.283154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:30.283630 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:30.284082 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:30.284753 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:30.287464 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:30.287942 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:30.288629 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:30.309143 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:30.309635 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:30.310093 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:30.311316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:30.316043 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:30.316531 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:30.317938 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:30.320296 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:30.346556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28cf127c-da75-4bbd-b41f-a07eaeeb632b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0208e150>]}
[0m06:02:30.347324 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.26s]
[0m06:02:30.348136 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:30.349110 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:30.349704 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:30.350320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:30.350789 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:30.355583 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:30.356244 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:30.389281 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:30.389804 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240726060230383468"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:30.390292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:30.404304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:30.411988 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:30.412473 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:30.413084 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:30.413560 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:30.414017 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240726060230383468'
      
      
      order by ordinal_position

  
[0m06:02:30.440255 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:30.445110 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:30.445617 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:30.454161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:30.461402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:30.461893 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:30.471094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:30.489015 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:30.489690 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:30.490180 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240726060230383468"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240726060230383468"
    )
  
[0m06:02:30.508999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:30.510754 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:30.511271 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:30.511729 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:30.521946 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:30.522847 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:30.676231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28cf127c-da75-4bbd-b41f-a07eaeeb632b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c01707da0>]}
[0m06:02:30.677061 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m06:02:30.677946 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:30.679417 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.679913 [debug] [MainThread]: On master: BEGIN
[0m06:02:30.680360 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:30.685687 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.686175 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.686629 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.687123 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.687696 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.688165 [debug] [MainThread]: On master: Close
[0m06:02:30.689511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:30.689960 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:30.690391 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:30.690866 [info ] [MainThread]: 
[0m06:02:30.691455 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.20 seconds (14.20s).
[0m06:02:30.692503 [debug] [MainThread]: Command end result
[0m06:02:30.720982 [info ] [MainThread]: 
[0m06:02:30.721629 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:30.722175 [info ] [MainThread]: 
[0m06:02:30.722733 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:30.723785 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.162733, "process_user_time": 4.886865, "process_kernel_time": 0.318103, "process_mem_max_rss": "288044", "process_in_blocks": "1184", "process_out_blocks": "109056"}
[0m06:02:30.724440 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:30.724331 after 16.16 seconds
[0m06:02:30.724941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c351e4fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c387bbd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c016bd310>]}
[0m06:02:30.725437 [debug] [MainThread]: Flushing usage events
[0m06:02:32.363972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b959e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b96851c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b9ea8560>]}


============================== 06:02:32.366696 | 1c1e9c07-48c9-4999-8f92-113738601f7b ==============================
[0m06:02:32.366696 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:32.367427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:32.508904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c1e9c07-48c9-4999-8f92-113738601f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b93ab050>]}
[0m06:02:32.525101 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21016848, "process_user_time": 1.387098, "process_kernel_time": 0.116259, "process_mem_max_rss": "92100", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:32.525683 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:32.525579 after 0.21 seconds
[0m06:02:32.526132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b95fe780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b95ffd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b9420110>]}
[0m06:02:32.526582 [debug] [MainThread]: Flushing usage events
[0m14:04:52.859544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e29af5bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e285d2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e285d28d0>]}


============================== 14:04:52.874845 | ede78ce0-b86a-4799-b402-129548dc2580 ==============================
[0m14:04:52.874845 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:52.875626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:04:53.024469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ede78ce0-b86a-4799-b402-129548dc2580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e28047740>]}
[0m14:04:53.038921 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-w9cqayav'
[0m14:04:53.039460 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:53.141789 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:53.142627 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:53.215019 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:53.219052 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:53.391353 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:53.391989 [info ] [MainThread]: Up to date!
[0m14:04:53.392566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ede78ce0-b86a-4799-b402-129548dc2580', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e27ff51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e27d474d0>]}
[0m14:04:53.402573 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5929718, "process_user_time": 1.636497, "process_kernel_time": 0.133015, "process_mem_max_rss": "93444", "process_in_blocks": "5744", "process_out_blocks": "3848"}
[0m14:04:53.403203 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:53.403095 after 0.59 seconds
[0m14:04:53.403657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e28a4a480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e283f2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e28162540>]}
[0m14:04:53.404210 [debug] [MainThread]: Flushing usage events
[0m14:04:55.240651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff98a50050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff99d4e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff99d4c620>]}


============================== 14:04:55.243751 | f35d1ad1-bee6-45b2-b1e9-065bd43af70e ==============================
[0m14:04:55.243751 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:55.244418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:55.506623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f35d1ad1-bee6-45b2-b1e9-065bd43af70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff9218ddc0>]}
[0m14:04:55.568923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f35d1ad1-bee6-45b2-b1e9-065bd43af70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff9904e180>]}
[0m14:04:55.569938 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:04:55.590369 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:55.591198 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:55.591810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f35d1ad1-bee6-45b2-b1e9-065bd43af70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff9203b5c0>]}
[0m14:04:56.832281 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:56.832981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f35d1ad1-bee6-45b2-b1e9-065bd43af70e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff91d14e30>]}
[0m14:04:57.019892 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:57.025129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f35d1ad1-bee6-45b2-b1e9-065bd43af70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff91e340e0>]}
[0m14:04:57.172046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f35d1ad1-bee6-45b2-b1e9-065bd43af70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff91e7ce60>]}
[0m14:04:57.172687 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:57.173222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f35d1ad1-bee6-45b2-b1e9-065bd43af70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff91d2f5c0>]}
[0m14:04:57.175237 [info ] [MainThread]: 
[0m14:04:57.176002 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:57.180890 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:57.218518 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:57.219085 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:57.219505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:57.602787 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:57.604402 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:57.606664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:57.607253 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:57.614243 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:57.614695 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:57.615106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:57.620861 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:57.622214 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:57.622640 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:57.623288 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:57.623789 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:57.624200 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:57.624793 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:57.625767 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:57.626198 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:57.626606 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:57.627180 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:57.627619 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:57.630123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:57.635712 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:57.636150 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:57.636543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:57.642036 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:57.642568 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:57.643000 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:57.662976 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:57.667987 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:57.669261 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:57.669700 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:57.673908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f35d1ad1-bee6-45b2-b1e9-065bd43af70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff91c61760>]}
[0m14:04:57.674455 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:57.674873 [debug] [MainThread]: On master: BEGIN
[0m14:04:57.675259 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:57.680684 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:57.681134 [debug] [MainThread]: On master: COMMIT
[0m14:04:57.681543 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:57.681938 [debug] [MainThread]: On master: COMMIT
[0m14:04:57.682586 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:57.683017 [debug] [MainThread]: On master: Close
[0m14:04:57.684632 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:57.685222 [info ] [MainThread]: 
[0m14:04:57.703535 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:57.704279 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:57.705071 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:57.705534 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:57.731602 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:57.732522 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:57.769128 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:57.770092 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:05.739963 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.740541 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:05.741222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.741700 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.742156 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:05.743078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.745984 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.746464 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:05.747236 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.768539 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:05.769160 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.769657 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:05.771459 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.776594 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.777086 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:05.778343 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.780874 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:05.808291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f35d1ad1-bee6-45b2-b1e9-065bd43af70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff91e7fce0>]}
[0m14:05:05.809167 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.10s]
[0m14:05:05.809975 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:05.811016 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:05.811625 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:05.812297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:05.812774 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:05.818171 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:05.818948 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:05.854272 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.854934 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240726140505847974"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:05.855466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:05.872485 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.881734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.882344 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:05.883132 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.883603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.884156 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240726140505847974'
      
      
      order by ordinal_position

  
[0m14:05:05.911166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.917246 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.917810 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:05.932148 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.939985 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.940520 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:05.949146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.967653 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:05.968532 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.969037 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240726140505847974"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240726140505847974"
    )
  
[0m14:05:05.990770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.992811 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:05.993309 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.993758 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:06.003567 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:06.004779 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:06.162956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f35d1ad1-bee6-45b2-b1e9-065bd43af70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6560e3f0>]}
[0m14:05:06.163858 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m14:05:06.164768 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:06.166264 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:06.166783 [debug] [MainThread]: On master: BEGIN
[0m14:05:06.167243 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:06.172964 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:06.173532 [debug] [MainThread]: On master: COMMIT
[0m14:05:06.174011 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:06.174466 [debug] [MainThread]: On master: COMMIT
[0m14:05:06.175216 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:06.175745 [debug] [MainThread]: On master: Close
[0m14:05:06.177795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:06.178264 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:06.178693 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:06.179225 [info ] [MainThread]: 
[0m14:05:06.179842 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.00 seconds (9.00s).
[0m14:05:06.180890 [debug] [MainThread]: Command end result
[0m14:05:06.210984 [info ] [MainThread]: 
[0m14:05:06.211754 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:06.212311 [info ] [MainThread]: 
[0m14:05:06.212865 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:06.213919 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.023471, "process_user_time": 5.14725, "process_kernel_time": 0.279959, "process_mem_max_rss": "289476", "process_in_blocks": "1184", "process_out_blocks": "109016"}
[0m14:05:06.214584 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:06.214470 after 11.02 seconds
[0m14:05:06.215105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff98cf5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff91ca6a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff990e9970>]}
[0m14:05:06.215614 [debug] [MainThread]: Flushing usage events
[0m14:05:08.330137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a59a27980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a57669e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5766b2f0>]}


============================== 14:05:08.333194 | e10a310f-161c-461e-80f0-9dd667d3c259 ==============================
[0m14:05:08.333194 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:08.333969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:08.483081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e10a310f-161c-461e-80f0-9dd667d3c259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a57e4e3f0>]}
[0m14:05:08.500223 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21984072, "process_user_time": 1.465054, "process_kernel_time": 0.091815, "process_mem_max_rss": "92228", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:08.500889 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:08.500758 after 0.22 seconds
[0m14:05:08.501364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5796a420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5763a300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a57a93f20>]}
[0m14:05:08.501825 [debug] [MainThread]: Flushing usage events
[0m22:05:39.455729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de860edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de76e15e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de81cc680>]}


============================== 22:05:39.463135 | da226aba-ce25-40d3-bfad-281251e29c82 ==============================
[0m22:05:39.463135 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:39.463863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:05:39.617095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da226aba-ce25-40d3-bfad-281251e29c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de74e3440>]}
[0m22:05:39.630859 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ra1d37sm'
[0m22:05:39.631357 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:39.705295 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:39.706125 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:39.729098 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:39.733079 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:39.805096 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:39.805732 [info ] [MainThread]: Up to date!
[0m22:05:39.806371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'da226aba-ce25-40d3-bfad-281251e29c82', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de7231b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de73a2990>]}
[0m22:05:39.808325 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40227824, "process_user_time": 1.575276, "process_kernel_time": 0.140649, "process_mem_max_rss": "93484", "process_in_blocks": "5744", "process_out_blocks": "3848"}
[0m22:05:39.808930 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:39.808825 after 0.40 seconds
[0m22:05:39.809374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de79105c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de761b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de81cc680>]}
[0m22:05:39.809810 [debug] [MainThread]: Flushing usage events
[0m22:05:41.510645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057bdb4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057c36f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057c192000>]}


============================== 22:05:41.513674 | 5df161e7-526e-4cec-a763-ab163503df4e ==============================
[0m22:05:41.513674 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:41.514421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:41.757588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5df161e7-526e-4cec-a763-ab163503df4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057bbdc530>]}
[0m22:05:41.818579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5df161e7-526e-4cec-a763-ab163503df4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057bf3b5f0>]}
[0m22:05:41.819537 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m22:05:41.840806 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:41.841641 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:41.842214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5df161e7-526e-4cec-a763-ab163503df4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057cb764b0>]}
[0m22:05:43.055892 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:43.056656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5df161e7-526e-4cec-a763-ab163503df4e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0574adf890>]}
[0m22:05:43.242127 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:43.247502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5df161e7-526e-4cec-a763-ab163503df4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0574a954f0>]}
[0m22:05:43.385470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5df161e7-526e-4cec-a763-ab163503df4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0574abb200>]}
[0m22:05:43.386081 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:43.386619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5df161e7-526e-4cec-a763-ab163503df4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05749df6e0>]}
[0m22:05:43.388513 [info ] [MainThread]: 
[0m22:05:43.389232 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:43.393896 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:43.429519 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:43.430061 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:43.430473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:43.970746 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:43.972327 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:43.974455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:43.975026 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:43.981858 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.982312 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:43.982720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:43.988586 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.990049 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.990474 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:43.991141 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.991552 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.991947 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:43.992571 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.993504 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:43.993917 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.994308 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:43.994959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.995400 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:43.997691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:44.003189 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:44.003616 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:44.004004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:44.009380 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:44.009822 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:44.010235 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:44.030900 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:44.035839 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:44.037159 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:44.037602 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:44.042549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5df161e7-526e-4cec-a763-ab163503df4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05749df080>]}
[0m22:05:44.043441 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:44.044094 [debug] [MainThread]: On master: BEGIN
[0m22:05:44.044759 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:44.053906 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:44.054713 [debug] [MainThread]: On master: COMMIT
[0m22:05:44.055368 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:44.056011 [debug] [MainThread]: On master: COMMIT
[0m22:05:44.056985 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:44.057611 [debug] [MainThread]: On master: Close
[0m22:05:44.059563 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:44.060083 [info ] [MainThread]: 
[0m22:05:44.069307 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:44.069965 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:44.070642 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:44.071101 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:44.097044 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:44.097966 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:44.133933 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:44.134859 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:51.896228 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.896816 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:51.897727 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.898208 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.898659 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:51.899428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.902429 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.902904 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:51.903669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.924444 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.924986 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.925451 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.927364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.932427 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.932921 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:51.934322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.936895 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:51.964807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5df161e7-526e-4cec-a763-ab163503df4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05489c7860>]}
[0m22:05:51.965689 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.89s]
[0m22:05:51.966606 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:51.967676 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:51.968317 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:51.968978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:51.969457 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:51.974705 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:51.975395 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:52.009131 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:52.009737 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240726220552003181"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:52.010239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:52.025800 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:52.034842 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:52.035387 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:52.036269 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:52.036745 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:52.037204 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240726220552003181'
      
      
      order by ordinal_position

  
[0m22:05:52.064433 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:52.070372 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:52.070929 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:52.085937 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:52.094063 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:52.094591 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:52.103632 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:52.122038 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:52.122839 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:52.123350 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240726220552003181"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240726220552003181"
    )
  
[0m22:05:52.140333 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:52.142442 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:52.142961 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:52.143426 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:52.153559 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:52.154618 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:52.324514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5df161e7-526e-4cec-a763-ab163503df4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0574ae6450>]}
[0m22:05:52.325362 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m22:05:52.326125 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:52.327559 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:52.328078 [debug] [MainThread]: On master: BEGIN
[0m22:05:52.328585 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:52.334105 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:52.334619 [debug] [MainThread]: On master: COMMIT
[0m22:05:52.335080 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:52.335539 [debug] [MainThread]: On master: COMMIT
[0m22:05:52.336280 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:52.336763 [debug] [MainThread]: On master: Close
[0m22:05:52.338597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:52.339057 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:52.339483 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:52.339982 [info ] [MainThread]: 
[0m22:05:52.340637 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.95 seconds (8.95s).
[0m22:05:52.341801 [debug] [MainThread]: Command end result
[0m22:05:52.371372 [info ] [MainThread]: 
[0m22:05:52.372118 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:52.372733 [info ] [MainThread]: 
[0m22:05:52.373305 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:52.374390 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.913624, "process_user_time": 5.025286, "process_kernel_time": 0.334488, "process_mem_max_rss": "290360", "process_in_blocks": "1184", "process_out_blocks": "109568"}
[0m22:05:52.375048 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:52.374936 after 10.91 seconds
[0m22:05:52.375559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057be5dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057ca20d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0548241ca0>]}
[0m22:05:52.376064 [debug] [MainThread]: Flushing usage events
[0m22:05:54.132932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac17938c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac226e7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac19cb800>]}


============================== 22:05:54.135966 | 77966828-7cc9-4a43-8767-ffe7b7cb02ad ==============================
[0m22:05:54.135966 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:54.136721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:54.289548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77966828-7cc9-4a43-8767-ffe7b7cb02ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac16d9850>]}
[0m22:05:54.309951 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22711806, "process_user_time": 1.441539, "process_kernel_time": 0.128136, "process_mem_max_rss": "92344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:54.310661 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:54.310533 after 0.23 seconds
[0m22:05:54.311164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac27d5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac16e9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac16d9a90>]}
[0m22:05:54.311733 [debug] [MainThread]: Flushing usage events
[0m06:01:59.806421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ef49e7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f0522c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f022bec0>]}


============================== 06:01:59.813826 | 8640e2fa-b3c6-4d86-a6fc-200ded976526 ==============================
[0m06:01:59.813826 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:01:59.814507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:01:59.959224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8640e2fa-b3c6-4d86-a6fc-200ded976526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ef2b49e0>]}
[0m06:01:59.972887 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fe6uzp_c'
[0m06:01:59.973377 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:00.058599 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:00.059331 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:00.082810 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:00.086662 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:00.158252 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:00.158812 [info ] [MainThread]: Up to date!
[0m06:02:00.159332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8640e2fa-b3c6-4d86-a6fc-200ded976526', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ef304920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ef306ed0>]}
[0m06:02:00.181230 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42336392, "process_user_time": 1.608993, "process_kernel_time": 0.116071, "process_mem_max_rss": "93332", "process_in_blocks": "5744", "process_out_blocks": "3840"}
[0m06:02:00.181863 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:00.181750 after 0.42 seconds
[0m06:02:00.182312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f054ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ef1d46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ef1d43b0>]}
[0m06:02:00.182755 [debug] [MainThread]: Flushing usage events
[0m06:02:01.809622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ddae1ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ddc8199a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ddacefe30>]}


============================== 06:02:01.812542 | 8e9cea25-6e9d-4c3d-9f50-2bcd8841ca17 ==============================
[0m06:02:01.812542 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:01.813246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:02.051874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e9cea25-6e9d-4c3d-9f50-2bcd8841ca17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dda323890>]}
[0m06:02:02.111643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e9cea25-6e9d-4c3d-9f50-2bcd8841ca17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dda9f1700>]}
[0m06:02:02.112542 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m06:02:02.128321 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:02.129113 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:02.129666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8e9cea25-6e9d-4c3d-9f50-2bcd8841ca17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ddac52f90>]}
[0m06:02:03.335239 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:03.335952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8e9cea25-6e9d-4c3d-9f50-2bcd8841ca17', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dd3768c20>]}
[0m06:02:03.516181 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:03.520873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e9cea25-6e9d-4c3d-9f50-2bcd8841ca17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dd35eb410>]}
[0m06:02:03.640589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e9cea25-6e9d-4c3d-9f50-2bcd8841ca17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dd34a9790>]}
[0m06:02:03.641144 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:03.641633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e9cea25-6e9d-4c3d-9f50-2bcd8841ca17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dd356b470>]}
[0m06:02:03.643394 [info ] [MainThread]: 
[0m06:02:03.644189 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:03.648759 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:03.683101 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:03.683555 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:03.684011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:04.128593 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:04.130163 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:04.132675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:04.133273 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:04.140166 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:04.140615 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:04.141023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:04.147017 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:04.148697 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:04.149152 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:04.149833 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:04.150248 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:04.150647 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:04.151219 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:04.152182 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:04.152601 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:04.152997 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:04.153547 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:04.153968 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:04.156123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:04.161480 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:04.161908 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:04.162300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:04.167408 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:04.167882 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:04.168288 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:04.188227 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:04.193554 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:04.194758 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:04.195181 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:04.198478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e9cea25-6e9d-4c3d-9f50-2bcd8841ca17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dd3569f40>]}
[0m06:02:04.199011 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:04.199413 [debug] [MainThread]: On master: BEGIN
[0m06:02:04.199839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:04.204939 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:04.205373 [debug] [MainThread]: On master: COMMIT
[0m06:02:04.205771 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:04.206158 [debug] [MainThread]: On master: COMMIT
[0m06:02:04.206781 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:04.207201 [debug] [MainThread]: On master: Close
[0m06:02:04.208825 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:04.209332 [info ] [MainThread]: 
[0m06:02:04.219320 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:04.219979 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:04.220626 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:04.221075 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:04.246717 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:04.247485 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:04.282644 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:04.283484 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:15.071177 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.071729 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:15.072502 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.072973 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.073428 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:15.074193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.076891 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.077365 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:15.078096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.098859 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:15.099356 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.099843 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:15.101000 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.105750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.106250 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:15.107369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.109729 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:15.135976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e9cea25-6e9d-4c3d-9f50-2bcd8841ca17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ddae1f5c0>]}
[0m06:02:15.136705 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.91s]
[0m06:02:15.137465 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:15.138434 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:15.139016 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:15.139591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:15.140101 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:15.144876 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:15.145523 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:15.178733 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.179259 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240727060215172907"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:15.179772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:15.194152 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.203914 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.204403 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:15.205137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.205610 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.206069 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240727060215172907'
      
      
      order by ordinal_position

  
[0m06:02:15.232474 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.237368 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.237863 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:15.246375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.253722 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.254220 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:15.262811 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.280869 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:15.281566 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.282055 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240727060215172907"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240727060215172907"
    )
  
[0m06:02:15.298509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.300270 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:15.300740 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.301180 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:15.309972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.310859 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:15.482245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e9cea25-6e9d-4c3d-9f50-2bcd8841ca17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dc0b5ea20>]}
[0m06:02:15.483048 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m06:02:15.483848 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:15.485333 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.485825 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.486281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:15.491489 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.492024 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.492480 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.492923 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.493640 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.494112 [debug] [MainThread]: On master: Close
[0m06:02:15.495457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:15.495984 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:15.496413 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:15.496895 [info ] [MainThread]: 
[0m06:02:15.497428 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.85 seconds (11.85s).
[0m06:02:15.498438 [debug] [MainThread]: Command end result
[0m06:02:15.527114 [info ] [MainThread]: 
[0m06:02:15.527753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:15.528286 [info ] [MainThread]: 
[0m06:02:15.528829 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:15.529821 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.769478, "process_user_time": 4.918354, "process_kernel_time": 0.283904, "process_mem_max_rss": "288076", "process_in_blocks": "1184", "process_out_blocks": "109544"}
[0m06:02:15.530471 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:15.530360 after 13.77 seconds
[0m06:02:15.530965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dda4b2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dd008b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da2ddc680>]}
[0m06:02:15.531460 [debug] [MainThread]: Flushing usage events
[0m06:02:17.151871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe77b137980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe77b134980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe77b135460>]}


============================== 06:02:17.154571 | 3df1deac-a121-410d-9a7d-75ffd9701377 ==============================
[0m06:02:17.154571 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:17.155353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.298479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3df1deac-a121-410d-9a7d-75ffd9701377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe77b2717f0>]}
[0m06:02:17.314879 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21206698, "process_user_time": 1.421884, "process_kernel_time": 0.104137, "process_mem_max_rss": "92100", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:17.315475 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:17.315373 after 0.21 seconds
[0m06:02:17.315976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe77ae1dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe77b11ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe77ae86b40>]}
[0m06:02:17.316416 [debug] [MainThread]: Flushing usage events
[0m14:05:41.120030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39fc319d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39fb9a0bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39fc31b1a0>]}


============================== 14:05:41.127375 | 22a5fcd7-7086-4321-998f-1927dff849a0 ==============================
[0m14:05:41.127375 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:41.128077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:41.273641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22a5fcd7-7086-4321-998f-1927dff849a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39fb7fc440>]}
[0m14:05:41.286960 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yxmofyov'
[0m14:05:41.287436 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:41.373762 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:41.374526 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:41.386112 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:41.390022 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:41.603761 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:41.604345 [info ] [MainThread]: Up to date!
[0m14:05:41.604920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '22a5fcd7-7086-4321-998f-1927dff849a0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39fb85ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39fbe3ae70>]}
[0m14:05:41.606985 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5354557, "process_user_time": 1.602281, "process_kernel_time": 0.104148, "process_mem_max_rss": "93704", "process_in_blocks": "5744", "process_out_blocks": "3848"}
[0m14:05:41.607602 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:41.607495 after 0.54 seconds
[0m14:05:41.608052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ff3bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39fbefac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39fdfd2ed0>]}
[0m14:05:41.608539 [debug] [MainThread]: Flushing usage events
[0m14:05:43.466650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff920e98bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff920e98200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff920e980b0>]}


============================== 14:05:43.469558 | 6baf250f-481e-45a8-8bd2-6ee5a7ed2bdf ==============================
[0m14:05:43.469558 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:43.470239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:43.708186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6baf250f-481e-45a8-8bd2-6ee5a7ed2bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff920cf8500>]}
[0m14:05:43.767371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6baf250f-481e-45a8-8bd2-6ee5a7ed2bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff920c33d10>]}
[0m14:05:43.768191 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:05:43.783663 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:43.784398 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:43.784955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6baf250f-481e-45a8-8bd2-6ee5a7ed2bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff920c24b30>]}
[0m14:05:44.998648 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:44.999379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6baf250f-481e-45a8-8bd2-6ee5a7ed2bdf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff920c279e0>]}
[0m14:05:45.183830 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:45.188948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6baf250f-481e-45a8-8bd2-6ee5a7ed2bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff91a3643e0>]}
[0m14:05:45.324384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6baf250f-481e-45a8-8bd2-6ee5a7ed2bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff91a051c40>]}
[0m14:05:45.324974 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:45.325550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6baf250f-481e-45a8-8bd2-6ee5a7ed2bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff919f73890>]}
[0m14:05:45.327416 [info ] [MainThread]: 
[0m14:05:45.328173 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:45.332780 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:45.367720 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:45.368187 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:45.368601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:45.931355 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:45.932978 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:45.935338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:45.935935 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:45.942869 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:45.943334 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:45.943745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:45.949289 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:45.950632 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:45.951048 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:45.951890 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:45.952308 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:45.952698 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:45.953296 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:45.954245 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:45.954660 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:45.955051 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:45.955601 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:45.956021 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:45.958225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:45.963594 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:45.964023 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:45.964412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:45.969448 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:45.969874 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:45.970287 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:45.990558 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:45.995242 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:45.996457 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:45.996880 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:46.000508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6baf250f-481e-45a8-8bd2-6ee5a7ed2bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff91a0cf380>]}
[0m14:05:46.001053 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:46.001463 [debug] [MainThread]: On master: BEGIN
[0m14:05:46.001844 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:46.006968 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:46.007395 [debug] [MainThread]: On master: COMMIT
[0m14:05:46.007794 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:46.008177 [debug] [MainThread]: On master: COMMIT
[0m14:05:46.008799 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:46.009256 [debug] [MainThread]: On master: Close
[0m14:05:46.010715 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:46.011257 [info ] [MainThread]: 
[0m14:05:46.020194 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:46.020821 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:46.021592 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:46.022053 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:46.047697 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:46.048494 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:46.083763 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:46.084580 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:56.686685 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.687209 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:56.687849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.688315 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.688762 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:56.689510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.692191 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.692663 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:56.693384 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.713815 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:56.714311 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.714767 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:56.716328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.721102 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.721599 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:56.722802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.725174 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:56.750943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6baf250f-481e-45a8-8bd2-6ee5a7ed2bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9225de600>]}
[0m14:05:56.751702 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.73s]
[0m14:05:56.752597 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:56.753665 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:56.754255 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:56.754932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:56.755414 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:56.760382 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:56.761143 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:56.794556 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:56.795078 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240727140556788621"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:56.795563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:56.810018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.818336 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:56.818828 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:56.819469 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.819935 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:56.820389 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240727140556788621'
      
      
      order by ordinal_position

  
[0m14:05:56.847361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.852318 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:56.852814 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:56.861946 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.869328 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:56.869829 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:56.878307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.896367 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:56.897134 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:56.897631 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240727140556788621"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240727140556788621"
    )
  
[0m14:05:56.914463 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.916370 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:56.916850 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:56.917371 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:56.927183 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.928093 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:57.105873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6baf250f-481e-45a8-8bd2-6ee5a7ed2bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ed8ca6f0>]}
[0m14:05:57.106723 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m14:05:57.107489 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:57.108841 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:57.109374 [debug] [MainThread]: On master: BEGIN
[0m14:05:57.109830 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:57.115190 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:57.115685 [debug] [MainThread]: On master: COMMIT
[0m14:05:57.116142 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:57.116586 [debug] [MainThread]: On master: COMMIT
[0m14:05:57.117354 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:57.117835 [debug] [MainThread]: On master: Close
[0m14:05:57.119250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:57.119703 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:57.120124 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:57.120595 [info ] [MainThread]: 
[0m14:05:57.121194 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.79 seconds (11.79s).
[0m14:05:57.122246 [debug] [MainThread]: Command end result
[0m14:05:57.151066 [info ] [MainThread]: 
[0m14:05:57.151735 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:57.152286 [info ] [MainThread]: 
[0m14:05:57.152849 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:57.153932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.73639, "process_user_time": 4.993642, "process_kernel_time": 0.259461, "process_mem_max_rss": "293572", "process_in_blocks": "1184", "process_out_blocks": "109528"}
[0m14:05:57.154595 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:57.154484 after 13.74 seconds
[0m14:05:57.155104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9212da1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff920d75100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ee885ee0>]}
[0m14:05:57.155607 [debug] [MainThread]: Flushing usage events
[0m14:05:59.097136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b260f1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b25daa360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b250d2e40>]}


============================== 14:05:59.100011 | 9d698735-fdcb-4d37-8397-2bd7944889a8 ==============================
[0m14:05:59.100011 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:59.100679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:59.247899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d698735-fdcb-4d37-8397-2bd7944889a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b2672f440>]}
[0m14:05:59.264436 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21685736, "process_user_time": 1.484279, "process_kernel_time": 0.068012, "process_mem_max_rss": "92092", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:59.265085 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:59.264941 after 0.22 seconds
[0m14:05:59.265546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b25f4a180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b25b32c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b273b5370>]}
[0m14:05:59.265995 [debug] [MainThread]: Flushing usage events
[0m22:05:39.556636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc553b49e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5540d2180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc553b49ee0>]}


============================== 22:05:39.576643 | bf146cd2-fa16-446b-b1e8-75316e73d4d0 ==============================
[0m22:05:39.576643 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:39.577309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:05:39.720516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf146cd2-fa16-446b-b1e8-75316e73d4d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc553f71cd0>]}
[0m22:05:39.733910 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-n83ytapf'
[0m22:05:39.734383 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:39.819418 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:39.820171 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:39.831037 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:39.834862 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:39.989971 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:39.990582 [info ] [MainThread]: Up to date!
[0m22:05:39.991160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bf146cd2-fa16-446b-b1e8-75316e73d4d0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc553836cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55477af00>]}
[0m22:05:40.002572 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4944279, "process_user_time": 1.593757, "process_kernel_time": 0.11701, "process_mem_max_rss": "93556", "process_in_blocks": "5744", "process_out_blocks": "3840"}
[0m22:05:40.003366 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:40.003225 after 0.50 seconds
[0m22:05:40.003843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55393c0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc55393e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc553b91f10>]}
[0m22:05:40.004302 [debug] [MainThread]: Flushing usage events
[0m22:05:41.634570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf6a08b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf8d5db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf84adf40>]}


============================== 22:05:41.637312 | a9bdb4a1-03ed-445a-b547-f8bf22608861 ==============================
[0m22:05:41.637312 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:41.637993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:41.867467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9bdb4a1-03ed-445a-b547-f8bf22608861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf686d1c0>]}
[0m22:05:41.928177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9bdb4a1-03ed-445a-b547-f8bf22608861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf799fe00>]}
[0m22:05:41.929100 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m22:05:41.950557 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:41.951372 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:41.951922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a9bdb4a1-03ed-445a-b547-f8bf22608861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf72e3110>]}
[0m22:05:43.162220 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:43.162917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a9bdb4a1-03ed-445a-b547-f8bf22608861', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8befd6b1d0>]}
[0m22:05:43.344911 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:43.349931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9bdb4a1-03ed-445a-b547-f8bf22608861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8beff80e30>]}
[0m22:05:43.477529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9bdb4a1-03ed-445a-b547-f8bf22608861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8befc5ea80>]}
[0m22:05:43.478112 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:43.478645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9bdb4a1-03ed-445a-b547-f8bf22608861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8befbce600>]}
[0m22:05:43.480472 [info ] [MainThread]: 
[0m22:05:43.481168 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:43.485752 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:43.521026 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:43.521523 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:43.521931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:43.976989 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.978553 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:43.980783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:43.981364 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:43.988285 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.988744 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:43.989159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:43.994896 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.996378 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.996801 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:43.997461 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.997880 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.998276 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:43.998845 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.999811 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:44.000233 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:44.000640 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:44.001301 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:44.001749 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:44.003876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:44.009362 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:44.009794 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:44.010189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:44.015512 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:44.015964 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:44.016378 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:44.036826 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:44.041865 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:44.043136 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:44.043604 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:44.047825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9bdb4a1-03ed-445a-b547-f8bf22608861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf6a0bc50>]}
[0m22:05:44.048372 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:44.048779 [debug] [MainThread]: On master: BEGIN
[0m22:05:44.049162 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:44.054464 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:44.054903 [debug] [MainThread]: On master: COMMIT
[0m22:05:44.055344 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:44.055731 [debug] [MainThread]: On master: COMMIT
[0m22:05:44.056368 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:44.056791 [debug] [MainThread]: On master: Close
[0m22:05:44.058431 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:44.058973 [info ] [MainThread]: 
[0m22:05:44.072952 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:44.073602 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:44.074363 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:44.074817 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:44.100495 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:44.101328 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:44.136840 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:44.137762 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:53.186749 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:53.187378 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:53.188371 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:53.188844 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:53.189297 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:53.190066 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:53.193146 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:53.193630 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:53.194365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:53.215404 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:53.215956 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:53.216409 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:53.218071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:53.223096 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:53.223607 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:53.224897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:53.227334 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:53.253132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bdb4a1-03ed-445a-b547-f8bf22608861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbf5f9640>]}
[0m22:05:53.253915 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.18s]
[0m22:05:53.254710 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:53.255751 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:53.256346 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:53.256960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:53.257434 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:53.262552 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:53.263272 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:53.297122 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:53.297676 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240727220553291072"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:53.298175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:53.314407 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:53.322575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:53.323070 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:53.323811 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:53.324285 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:53.324746 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240727220553291072'
      
      
      order by ordinal_position

  
[0m22:05:53.350936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:53.356044 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:53.356552 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:53.364869 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:53.372289 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:53.372782 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:05:53.381124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:53.399225 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:53.399936 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:53.400433 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240727220553291072"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240727220553291072"
    )
  
[0m22:05:53.417184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:53.419074 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:53.419625 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:53.420074 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:53.430854 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:53.432010 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:53.613032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bdb4a1-03ed-445a-b547-f8bf22608861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbf3da780>]}
[0m22:05:53.613887 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m22:05:53.614652 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:53.616124 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:53.616624 [debug] [MainThread]: On master: BEGIN
[0m22:05:53.617080 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:53.622614 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:53.623116 [debug] [MainThread]: On master: COMMIT
[0m22:05:53.623638 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:53.624095 [debug] [MainThread]: On master: COMMIT
[0m22:05:53.624801 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:53.625283 [debug] [MainThread]: On master: Close
[0m22:05:53.627056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:53.627562 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:53.627995 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:53.628480 [info ] [MainThread]: 
[0m22:05:53.629051 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.15 seconds (10.15s).
[0m22:05:53.630143 [debug] [MainThread]: Command end result
[0m22:05:53.659365 [info ] [MainThread]: 
[0m22:05:53.660067 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:53.660619 [info ] [MainThread]: 
[0m22:05:53.661180 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:53.662222 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.075918, "process_user_time": 4.947219, "process_kernel_time": 0.347945, "process_mem_max_rss": "283748", "process_in_blocks": "1184", "process_out_blocks": "110064"}
[0m22:05:53.662883 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:53.662771 after 12.08 seconds
[0m22:05:53.663440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf720f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be4910050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbf4b5d90>]}
[0m22:05:53.663956 [debug] [MainThread]: Flushing usage events
[0m22:05:55.424618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f7a727740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f79f7d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f79faf6b0>]}


============================== 22:05:55.427432 | c0efe312-b028-4a2d-8fa8-a1a78c189f09 ==============================
[0m22:05:55.427432 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:55.428175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:55.575240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0efe312-b028-4a2d-8fa8-a1a78c189f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f79f30a10>]}
[0m22:05:55.591752 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2192038, "process_user_time": 1.454844, "process_kernel_time": 0.091927, "process_mem_max_rss": "92224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:55.592373 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:55.592267 after 0.22 seconds
[0m22:05:55.592846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f7a4f2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f79c785c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f7b466540>]}
[0m22:05:55.593292 [debug] [MainThread]: Flushing usage events
[0m06:02:07.517114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b51ba000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b758a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b597d7c0>]}


============================== 06:02:07.538286 | d409cbd3-66e6-46de-b78c-5046072bc319 ==============================
[0m06:02:07.538286 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:07.538951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.677414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd409cbd3-66e6-46de-b78c-5046072bc319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b627f200>]}
[0m06:02:07.690621 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-t_ghv1uj'
[0m06:02:07.691080 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:07.764218 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:07.764848 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:07.786821 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:07.790528 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:07.860657 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:07.861171 [info ] [MainThread]: Up to date!
[0m06:02:07.861720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd409cbd3-66e6-46de-b78c-5046072bc319', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b4fb7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b4fb4710>]}
[0m06:02:07.874423 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40550342, "process_user_time": 1.558311, "process_kernel_time": 0.13949, "process_mem_max_rss": "93580", "process_in_blocks": "5744", "process_out_blocks": "3848"}
[0m06:02:07.875084 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:07.874979 after 0.41 seconds
[0m06:02:07.875519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b5123d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b5605ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b534ac00>]}
[0m06:02:07.875953 [debug] [MainThread]: Flushing usage events
[0m06:02:09.484802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55e658080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55ea62000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55e980aa0>]}


============================== 06:02:09.487611 | 94867d2a-66c5-41dd-a490-c8dba196f01d ==============================
[0m06:02:09.487611 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.488339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:09.716900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94867d2a-66c5-41dd-a490-c8dba196f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55e51fd70>]}
[0m06:02:09.776572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94867d2a-66c5-41dd-a490-c8dba196f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55e51fd70>]}
[0m06:02:09.777307 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m06:02:09.792034 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:09.792748 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:09.793301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '94867d2a-66c5-41dd-a490-c8dba196f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55f578590>]}
[0m06:02:11.012803 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:11.013478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '94867d2a-66c5-41dd-a490-c8dba196f01d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55fab0d10>]}
[0m06:02:11.197918 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:11.202873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94867d2a-66c5-41dd-a490-c8dba196f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5577c77a0>]}
[0m06:02:11.320437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94867d2a-66c5-41dd-a490-c8dba196f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55761cf80>]}
[0m06:02:11.320983 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:11.321492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94867d2a-66c5-41dd-a490-c8dba196f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa557686720>]}
[0m06:02:11.323292 [info ] [MainThread]: 
[0m06:02:11.323966 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:11.328441 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:11.364428 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:11.364884 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:11.365296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:11.841145 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.842732 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:11.845157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:11.845800 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:11.852753 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.853228 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:11.853687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:11.859333 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.860665 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.861096 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:11.861983 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.862411 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.862809 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:11.863384 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.864301 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:11.864722 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.865121 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:11.865679 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.866107 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:11.868228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:11.873500 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:11.873965 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:11.874358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:11.879332 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.879758 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:11.880166 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:11.899638 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.904331 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:11.905522 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:11.905986 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:11.909102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94867d2a-66c5-41dd-a490-c8dba196f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55fbf52b0>]}
[0m06:02:11.909648 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:11.910062 [debug] [MainThread]: On master: BEGIN
[0m06:02:11.910445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:11.915402 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:11.915837 [debug] [MainThread]: On master: COMMIT
[0m06:02:11.916246 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:11.916645 [debug] [MainThread]: On master: COMMIT
[0m06:02:11.917277 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:11.917734 [debug] [MainThread]: On master: Close
[0m06:02:11.919186 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:11.919686 [info ] [MainThread]: 
[0m06:02:11.929092 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:11.929739 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:11.930480 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:11.930941 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:11.956474 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:11.957218 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:11.991894 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:11.992633 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:21.095729 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.096256 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:21.097072 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.097558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.098062 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:21.098770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.101475 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.101994 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:21.102702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.123281 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:21.123776 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.124251 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:21.125631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.130376 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.130858 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:21.132058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.134413 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:21.160716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94867d2a-66c5-41dd-a490-c8dba196f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa52707d3a0>]}
[0m06:02:21.161465 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.23s]
[0m06:02:21.162286 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:21.163281 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:21.163865 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:21.164481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:21.164947 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:21.169908 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:21.170565 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:21.204174 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.204714 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240728060221198267"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:21.205224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:21.219442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.227452 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.227941 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:21.228555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.229037 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.229491 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240728060221198267'
      
      
      order by ordinal_position

  
[0m06:02:21.256181 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.261052 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.261550 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.270758 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.278078 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.278570 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.292785 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.310843 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:21.311540 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.312023 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240728060221198267"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240728060221198267"
    )
  
[0m06:02:21.330335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.332104 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.332574 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.333016 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.365915 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.367290 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:21.867077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94867d2a-66c5-41dd-a490-c8dba196f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa526fb45c0>]}
[0m06:02:21.867917 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.70s]
[0m06:02:21.868676 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:21.870201 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.870704 [debug] [MainThread]: On master: BEGIN
[0m06:02:21.871162 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:21.876563 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.877059 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.877515 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.878010 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.878713 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.879193 [debug] [MainThread]: On master: Close
[0m06:02:21.880626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:21.881088 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:21.881516 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:21.882043 [info ] [MainThread]: 
[0m06:02:21.882660 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.56 seconds (10.56s).
[0m06:02:21.883807 [debug] [MainThread]: Command end result
[0m06:02:21.912471 [info ] [MainThread]: 
[0m06:02:21.913171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:21.913810 [info ] [MainThread]: 
[0m06:02:21.914434 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:21.915533 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.479227, "process_user_time": 5.073653, "process_kernel_time": 0.259675, "process_mem_max_rss": "288836", "process_in_blocks": "1184", "process_out_blocks": "110560"}
[0m06:02:21.916193 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:21.916082 after 12.48 seconds
[0m06:02:21.916712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55e7ad700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa52c1566f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55eafd7f0>]}
[0m06:02:21.917210 [debug] [MainThread]: Flushing usage events
[0m06:02:23.544924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce35686cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce378594c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce36173260>]}


============================== 06:02:23.547659 | 52e69c6d-f491-4834-913e-2572980c3cd7 ==============================
[0m06:02:23.547659 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:23.548379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:23.687126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52e69c6d-f491-4834-913e-2572980c3cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3536d4f0>]}
[0m06:02:23.703578 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20796187, "process_user_time": 1.404436, "process_kernel_time": 0.095757, "process_mem_max_rss": "92224", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:23.704173 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:23.704069 after 0.21 seconds
[0m06:02:23.704615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3536d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3536e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce351d99a0>]}
[0m06:02:23.705056 [debug] [MainThread]: Flushing usage events
[0m14:04:45.221745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240bc1bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240c06a930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240bfee480>]}


============================== 14:04:45.229184 | 2251c2f4-3a8a-42e8-887f-0c9d1fb74589 ==============================
[0m14:04:45.229184 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:45.229968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:45.381022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2251c2f4-3a8a-42e8-887f-0c9d1fb74589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240d2e5b80>]}
[0m14:04:45.395102 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-skvv7rol'
[0m14:04:45.395631 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:45.456387 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:45.457196 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:45.468723 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:45.472707 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:45.632110 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:45.632766 [info ] [MainThread]: Up to date!
[0m14:04:45.633423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2251c2f4-3a8a-42e8-887f-0c9d1fb74589', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240bfee480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240b968440>]}
[0m14:04:45.635692 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4635567, "process_user_time": 1.596284, "process_kernel_time": 0.158834, "process_mem_max_rss": "93576", "process_in_blocks": "5744", "process_out_blocks": "3840"}
[0m14:04:45.636310 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:45.636202 after 0.46 seconds
[0m14:04:45.636772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240c176c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240bd85e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f240ba78e90>]}
[0m14:04:45.637221 [debug] [MainThread]: Flushing usage events
[0m14:04:47.342179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e1ec5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e3405ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e1ec5cd0>]}


============================== 14:04:47.345172 | 50ba3aec-1d00-4bd7-bbce-1cea9b593ee2 ==============================
[0m14:04:47.345172 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:47.345873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:47.593046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50ba3aec-1d00-4bd7-bbce-1cea9b593ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e2da49e0>]}
[0m14:04:47.654232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50ba3aec-1d00-4bd7-bbce-1cea9b593ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94db39b290>]}
[0m14:04:47.655189 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:04:47.671405 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:47.672171 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:47.672737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '50ba3aec-1d00-4bd7-bbce-1cea9b593ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94db21e210>]}
[0m14:04:48.916442 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:48.917149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '50ba3aec-1d00-4bd7-bbce-1cea9b593ee2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94db10a480>]}
[0m14:04:49.104582 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:49.109987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50ba3aec-1d00-4bd7-bbce-1cea9b593ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94daf5c2f0>]}
[0m14:04:49.249393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50ba3aec-1d00-4bd7-bbce-1cea9b593ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94db0c54f0>]}
[0m14:04:49.250032 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:49.250559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50ba3aec-1d00-4bd7-bbce-1cea9b593ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94daf5c200>]}
[0m14:04:49.252447 [info ] [MainThread]: 
[0m14:04:49.253174 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:49.257938 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:49.293904 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:49.294446 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:04:49.294868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:49.792406 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.793984 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:49.796186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:49.796778 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:49.803640 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:49.804103 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:04:49.804526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:49.810370 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.811736 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:49.812175 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:49.813035 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.813456 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:49.813918 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:49.814529 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.815473 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:49.815899 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:49.816305 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:49.816863 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.817299 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:49.819502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:49.825061 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:49.825499 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:49.825934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:49.831350 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.831784 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:49.832196 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:04:49.852335 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.857233 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:49.858502 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:49.858930 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:49.862636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50ba3aec-1d00-4bd7-bbce-1cea9b593ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94dae8c590>]}
[0m14:04:49.863183 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:49.863590 [debug] [MainThread]: On master: BEGIN
[0m14:04:49.863972 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:49.869397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:49.869878 [debug] [MainThread]: On master: COMMIT
[0m14:04:49.870289 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:49.870680 [debug] [MainThread]: On master: COMMIT
[0m14:04:49.871325 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:49.871746 [debug] [MainThread]: On master: Close
[0m14:04:49.873356 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:49.873885 [info ] [MainThread]: 
[0m14:04:49.883218 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:49.883854 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:49.884520 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:49.884977 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:49.911540 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:49.912416 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:49.948876 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:49.949798 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:58.319786 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:58.320360 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:04:58.321081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.321600 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:58.322067 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:04:58.322909 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.325830 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:58.326313 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:04:58.327031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.348052 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:58.348659 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:58.349131 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:58.350790 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.355951 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:58.356454 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:04:58.357923 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.360464 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:04:58.388032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50ba3aec-1d00-4bd7-bbce-1cea9b593ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94aa7e6240>]}
[0m14:04:58.388924 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.50s]
[0m14:04:58.389774 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:04:58.390825 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:04:58.391421 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:04:58.392039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:04:58.392520 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:04:58.397938 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:04:58.398636 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:04:58.433186 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.433837 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240728140458427051"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:04:58.434331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:58.450921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.459863 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.460414 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:04:58.461120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.461650 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.462131 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240728140458427051'
      
      
      order by ordinal_position

  
[0m14:04:58.489365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.495273 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.495853 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:58.505009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.513595 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.514225 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:04:58.523405 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.542660 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:04:58.543506 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.544003 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240728140458427051"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240728140458427051"
    )
  
[0m14:04:58.564163 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.566354 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:58.566848 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.567301 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:58.579857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.580929 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:04:58.928271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50ba3aec-1d00-4bd7-bbce-1cea9b593ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94aa7e65d0>]}
[0m14:04:58.929556 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.54s]
[0m14:04:58.930614 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:04:58.932566 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:58.933328 [debug] [MainThread]: On master: BEGIN
[0m14:04:58.934058 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:58.941940 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:58.942507 [debug] [MainThread]: On master: COMMIT
[0m14:04:58.943044 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:58.943530 [debug] [MainThread]: On master: COMMIT
[0m14:04:58.944417 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:58.944957 [debug] [MainThread]: On master: Close
[0m14:04:58.947017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:58.947490 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:04:58.947922 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:04:58.948448 [info ] [MainThread]: 
[0m14:04:58.949030 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.70 seconds (9.70s).
[0m14:04:58.950172 [debug] [MainThread]: Command end result
[0m14:04:58.988406 [info ] [MainThread]: 
[0m14:04:58.989216 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:58.989988 [info ] [MainThread]: 
[0m14:04:58.990609 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:58.991966 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.699446, "process_user_time": 5.382111, "process_kernel_time": 0.348395, "process_mem_max_rss": "339400", "process_in_blocks": "1184", "process_out_blocks": "115672"}
[0m14:04:58.992923 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:58.992804 after 11.70 seconds
[0m14:04:58.993437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e1ec5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e1e33d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94aa745fa0>]}
[0m14:04:58.994122 [debug] [MainThread]: Flushing usage events
[0m14:05:00.852309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9285936420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9287b23050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92854981d0>]}


============================== 14:05:00.855414 | 7386bf5d-b989-4ad6-b8be-302e76e2fe44 ==============================
[0m14:05:00.855414 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:00.856124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:01.017141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7386bf5d-b989-4ad6-b8be-302e76e2fe44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9285498a40>]}
[0m14:05:01.035126 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23339394, "process_user_time": 1.496452, "process_kernel_time": 0.091782, "process_mem_max_rss": "92224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:01.035749 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:01.035641 after 0.23 seconds
[0m14:05:01.036212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92854989e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9285a216a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92852f58b0>]}
[0m14:05:01.036673 [debug] [MainThread]: Flushing usage events
[0m22:05:51.588644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a52d34cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a5296f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a53198aa0>]}


============================== 22:05:51.596152 | 8e0289b8-48a0-4255-8f93-b8d75bd5db82 ==============================
[0m22:05:51.596152 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:51.596842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:51.748932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e0289b8-48a0-4255-8f93-b8d75bd5db82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a5291ce90>]}
[0m22:05:51.762899 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4dojmxuv'
[0m22:05:51.763430 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:51.957545 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:51.958342 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:51.992233 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:51.996211 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:52.369549 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:52.370123 [info ] [MainThread]: Up to date!
[0m22:05:52.370666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8e0289b8-48a0-4255-8f93-b8d75bd5db82', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a526b41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a5260cf80>]}
[0m22:05:52.372452 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.83245856, "process_user_time": 1.681818, "process_kernel_time": 0.108374, "process_mem_max_rss": "93540", "process_in_blocks": "5744", "process_out_blocks": "3848"}
[0m22:05:52.373072 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:52.372966 after 0.83 seconds
[0m22:05:52.373519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a52a52ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a55ce5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a52622480>]}
[0m22:05:52.373960 [debug] [MainThread]: Flushing usage events
[0m22:05:54.333359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc186095670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc186928470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc185b7b2c0>]}


============================== 22:05:54.336368 | 3e0afc82-4e3f-4164-b611-719b6c4c19bc ==============================
[0m22:05:54.336368 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:54.337056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:54.575168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e0afc82-4e3f-4164-b611-719b6c4c19bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc185a43c50>]}
[0m22:05:54.636268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e0afc82-4e3f-4164-b611-719b6c4c19bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc185e7acf0>]}
[0m22:05:54.637214 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m22:05:54.653346 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:54.654150 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:54.654711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3e0afc82-4e3f-4164-b611-719b6c4c19bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc185916060>]}
[0m22:05:55.883634 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:55.884385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3e0afc82-4e3f-4164-b611-719b6c4c19bc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc17ed28f20>]}
[0m22:05:56.068563 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:56.073776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e0afc82-4e3f-4164-b611-719b6c4c19bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc17ed59e20>]}
[0m22:05:56.204959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e0afc82-4e3f-4164-b611-719b6c4c19bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc17ed6a7b0>]}
[0m22:05:56.205556 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:56.206072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e0afc82-4e3f-4164-b611-719b6c4c19bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc17eb41700>]}
[0m22:05:56.207963 [info ] [MainThread]: 
[0m22:05:56.208672 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:56.213445 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:56.249569 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:56.250103 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:05:56.250519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:57.272963 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:57.274538 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:57.276881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:57.277467 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:57.284411 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:57.284891 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:05:57.285312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:57.291135 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.292663 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:57.293090 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:57.293768 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.294182 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:57.294579 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:57.295172 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.296159 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:57.296581 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:57.296975 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:57.297631 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.298066 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:57.300544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:57.306089 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:57.306526 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:57.306918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:57.312385 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.312852 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:57.313264 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:05:57.333476 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.338438 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:57.339745 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:57.340177 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:57.343887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e0afc82-4e3f-4164-b611-719b6c4c19bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc17d959a90>]}
[0m22:05:57.344436 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:57.344843 [debug] [MainThread]: On master: BEGIN
[0m22:05:57.345226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:57.350519 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:57.350963 [debug] [MainThread]: On master: COMMIT
[0m22:05:57.351358 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:57.351769 [debug] [MainThread]: On master: COMMIT
[0m22:05:57.352460 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:57.352968 [debug] [MainThread]: On master: Close
[0m22:05:57.354654 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:57.355204 [info ] [MainThread]: 
[0m22:05:57.364807 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:57.365455 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:57.366224 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:57.366681 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:57.392652 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:57.393555 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:57.429542 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:57.430474 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:11.487655 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:11.488271 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:11.488987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.489466 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:11.489928 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:11.490698 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.493664 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:11.494152 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:11.494860 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.515847 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:11.516410 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:11.516877 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:11.518941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.524055 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:11.524559 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:11.525975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.528464 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:11.555521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e0afc82-4e3f-4164-b611-719b6c4c19bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16cbd9a90>]}
[0m22:06:11.556416 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 14.19s]
[0m22:06:11.557333 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:11.558357 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:11.558947 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:11.559643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:11.560165 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:11.565359 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:11.566046 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:11.599940 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:11.600531 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240728220611593924"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:11.601032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:11.616042 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.624836 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:11.625347 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:11.626003 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.626472 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:11.627005 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240728220611593924'
      
      
      order by ordinal_position

  
[0m22:06:11.653279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.658822 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:11.659400 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:11.667773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.675277 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:11.675811 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:11.683637 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.701699 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:11.702413 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:11.702898 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240728220611593924"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240728220611593924"
    )
  
[0m22:06:11.723091 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.725049 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:11.725530 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:11.725993 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:11.735938 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.736918 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:11.862598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e0afc82-4e3f-4164-b611-719b6c4c19bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1521bc080>]}
[0m22:06:11.863490 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m22:06:11.864413 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:11.866119 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:11.866605 [debug] [MainThread]: On master: BEGIN
[0m22:06:11.867046 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:11.872756 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:11.873281 [debug] [MainThread]: On master: COMMIT
[0m22:06:11.873735 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:11.874169 [debug] [MainThread]: On master: COMMIT
[0m22:06:11.874727 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:11.875189 [debug] [MainThread]: On master: Close
[0m22:06:11.877086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:11.877539 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:11.877950 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:11.878436 [info ] [MainThread]: 
[0m22:06:11.878997 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 15.67 seconds (15.67s).
[0m22:06:11.880051 [debug] [MainThread]: Command end result
[0m22:06:11.909830 [info ] [MainThread]: 
[0m22:06:11.910538 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:11.911056 [info ] [MainThread]: 
[0m22:06:11.911587 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:11.912634 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.629107, "process_user_time": 4.85293, "process_kernel_time": 0.289247, "process_mem_max_rss": "287916", "process_in_blocks": "1184", "process_out_blocks": "107008"}
[0m22:06:11.913284 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:11.913173 after 17.63 seconds
[0m22:06:11.913789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc186928470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16cb04ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc15201b680>]}
[0m22:06:11.914284 [debug] [MainThread]: Flushing usage events
[0m22:06:13.811683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244f80ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244f22a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24514e8590>]}


============================== 22:06:13.814681 | 057f5090-0bce-4109-bdd8-fdc7906d8fc5 ==============================
[0m22:06:13.814681 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:13.815423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:13.964523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '057f5090-0bce-4109-bdd8-fdc7906d8fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244ed14e90>]}
[0m22:06:13.981656 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21938616, "process_user_time": 1.463451, "process_kernel_time": 0.095702, "process_mem_max_rss": "92252", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:13.982298 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:13.982189 after 0.22 seconds
[0m22:06:13.982775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244f22a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2451127920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244eec3590>]}
[0m22:06:13.983253 [debug] [MainThread]: Flushing usage events
