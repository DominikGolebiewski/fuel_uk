[0m06:03:06.008204 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:06.009186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.009603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.009990 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251119060305984631'
      
      
      order by ordinal_position

  
[0m06:03:06.012735 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.017942 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.018360 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:06.021191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.028429 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.028857 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:06.031460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.033031 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.033429 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:06.034110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.049220 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:06.049881 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.050280 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251119060305984631"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251119060305984631"
    )
  
[0m06:03:06.115440 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.117464 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:06.117919 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.118372 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:06.124483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.125419 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:06.126102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cde5f77f-5dfe-4b46-88d6-4f8cebaaf83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd64e594fe0>]}
[0m06:03:06.126764 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m06:03:06.127451 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:06.129001 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:06.129385 [debug] [MainThread]: On master: BEGIN
[0m06:03:06.129710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:06.130449 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:06.130803 [debug] [MainThread]: On master: COMMIT
[0m06:03:06.131159 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:06.131471 [debug] [MainThread]: On master: COMMIT
[0m06:03:06.132067 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:06.132435 [debug] [MainThread]: On master: Close
[0m06:03:06.132881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:06.133205 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:06.133559 [info ] [MainThread]: 
[0m06:03:06.133999 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.66 seconds (9.66s).
[0m06:03:06.134829 [debug] [MainThread]: Command end result
[0m06:03:06.160214 [info ] [MainThread]: 
[0m06:03:06.160780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:06.161227 [info ] [MainThread]: 
[0m06:03:06.161596 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:06.162523 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.577324, "process_user_time": 4.874011, "process_kernel_time": 0.274831, "process_mem_max_rss": "327440", "process_in_blocks": "1200", "process_out_blocks": "107304"}
[0m06:03:06.163095 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:06.162998 after 11.58 seconds
[0m06:03:06.163503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd698135fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd698c1a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd648384c80>]}
[0m06:03:06.163908 [debug] [MainThread]: Flushing usage events
[0m06:03:07.861631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947eba2f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947fc083e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947fc0a930>]}


============================== 06:03:07.864866 | 021a097e-f851-4104-b01a-c27421e29f19 ==============================
[0m06:03:07.864866 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:07.865483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:03:07.965958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '021a097e-f851-4104-b01a-c27421e29f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947e0d2750>]}
[0m06:03:07.980671 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16507837, "process_user_time": 1.220228, "process_kernel_time": 0.074952, "process_mem_max_rss": "99364", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:03:07.981252 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:07.981160 after 0.17 seconds
[0m06:03:07.981632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94826d3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947df60c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947e4c0530>]}
[0m06:03:07.982029 [debug] [MainThread]: Flushing usage events
[0m14:06:02.650225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5672555430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5671efc2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5671efdca0>]}


============================== 14:06:02.665396 | 48da9350-70f4-4b6c-86b0-8d9b40083dce ==============================
[0m14:06:02.665396 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:02.666059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:02.847865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48da9350-70f4-4b6c-86b0-8d9b40083dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56722443e0>]}
[0m14:06:02.863425 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kmzgbmsj'
[0m14:06:02.863927 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:02.989852 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:02.991656 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:03.038294 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:03.043539 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:03.155624 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:03.156243 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:06:03.156803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '48da9350-70f4-4b6c-86b0-8d9b40083dce', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5672f63bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56731945f0>]}
[0m14:06:03.157294 [info ] [MainThread]: 
[0m14:06:03.157797 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:03.177816 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5785703, "process_user_time": 1.670071, "process_kernel_time": 0.149469, "process_mem_max_rss": "101120", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m14:06:03.178525 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:03.178385 after 0.58 seconds
[0m14:06:03.179079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5671e984d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56722443e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5672f63bf0>]}
[0m14:06:03.179638 [debug] [MainThread]: Flushing usage events
[0m14:06:04.763805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36ebd3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37023dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36efe6570>]}


============================== 14:06:04.766961 | a879ce7d-82e6-4cb8-83be-fcc809017ca1 ==============================
[0m14:06:04.766961 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:04.767641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:05.001229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36f2fce60>]}
[0m14:06:05.062310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36e0a0a40>]}
[0m14:06:05.064153 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:06:05.089401 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:05.090136 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:05.090664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa370af72f0>]}
[0m14:06:06.463942 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:06.464633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36600eb40>]}
[0m14:06:06.709894 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:06.715483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3661b7050>]}
[0m14:06:06.844227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa366850c80>]}
[0m14:06:06.844862 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:06:06.845373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36de2b0b0>]}
[0m14:06:06.847286 [info ] [MainThread]: 
[0m14:06:06.848016 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:06.852953 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:06.889930 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:06.890392 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:06.890804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:07.317231 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.319033 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:07.319954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:07.320533 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:07.328224 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:07.328662 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:07.329033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:07.330006 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.331292 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:07.331694 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:07.332307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.332709 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:07.333069 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:07.333701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.334614 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:07.334995 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:07.335348 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:07.335928 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.336312 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:07.337606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:07.343549 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:07.343945 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:07.344303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:07.344969 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.345355 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:07.345771 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:07.356998 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.358450 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:07.359750 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:07.360158 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:07.362213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36602ad80>]}
[0m14:06:07.362751 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:07.363132 [debug] [MainThread]: On master: BEGIN
[0m14:06:07.363484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:07.364145 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:07.364562 [debug] [MainThread]: On master: COMMIT
[0m14:06:07.364936 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:07.365301 [debug] [MainThread]: On master: COMMIT
[0m14:06:07.365892 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:07.366279 [debug] [MainThread]: On master: Close
[0m14:06:07.366778 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:07.367248 [info ] [MainThread]: 
[0m14:06:07.388810 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:07.389608 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:07.390296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:07.390772 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:07.418017 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:07.418866 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:07.454283 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:07.455053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:15.646519 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.647083 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:15.647770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.648213 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.648666 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:15.649635 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.650994 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.651438 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:15.652493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.659274 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.659764 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:15.660830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.665051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.665514 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:15.666271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.683240 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:15.683724 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.684138 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:15.686113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.691915 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.692373 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:15.693638 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.696105 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:15.697621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3661b6720>]}
[0m14:06:15.698298 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.31s]
[0m14:06:15.699072 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:15.700220 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:15.700805 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:15.701402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:15.701931 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:15.706985 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:15.707659 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:15.743896 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.744396 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251119140615737863"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:15.744877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:15.751940 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.759490 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.759962 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:15.760621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.761051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.761475 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251119140615737863'
      
      
      order by ordinal_position

  
[0m14:06:15.763981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.769176 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.769646 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:15.772071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.779682 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.780141 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:15.782578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.784262 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.784726 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:06:15.785443 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.802588 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:15.803314 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.803783 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251119140615737863"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251119140615737863"
    )
  
[0m14:06:15.864829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.867154 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:15.867626 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.868035 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:15.874235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.875287 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:15.876086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3661dc2f0>]}
[0m14:06:15.876835 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:06:15.877604 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:15.879305 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:15.879751 [debug] [MainThread]: On master: BEGIN
[0m14:06:15.880129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:15.880907 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:15.881309 [debug] [MainThread]: On master: COMMIT
[0m14:06:15.881721 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:15.882084 [debug] [MainThread]: On master: COMMIT
[0m14:06:15.882682 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:15.883076 [debug] [MainThread]: On master: Close
[0m14:06:15.883574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:15.883944 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:15.884352 [info ] [MainThread]: 
[0m14:06:15.884882 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.04 seconds (9.04s).
[0m14:06:15.885876 [debug] [MainThread]: Command end result
[0m14:06:15.914456 [info ] [MainThread]: 
[0m14:06:15.915089 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:15.915607 [info ] [MainThread]: 
[0m14:06:15.916108 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:15.917219 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.204388, "process_user_time": 5.671275, "process_kernel_time": 0.284364, "process_mem_max_rss": "369444", "process_in_blocks": "1200", "process_out_blocks": "107288"}
[0m14:06:15.917839 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:15.917727 after 11.21 seconds
[0m14:06:15.918289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37023dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa344f67f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36e51bd40>]}
[0m14:06:15.918765 [debug] [MainThread]: Flushing usage events
[0m14:06:17.667653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56374d74a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5637e39d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563755be00>]}


============================== 14:06:17.670832 | e7a7d9a0-fad7-4c9e-afdc-84c8928b5281 ==============================
[0m14:06:17.670832 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:17.671561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:17.786458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7a7d9a0-fad7-4c9e-afdc-84c8928b5281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563755b0b0>]}
[0m14:06:17.805109 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18851323, "process_user_time": 1.334391, "process_kernel_time": 0.115947, "process_mem_max_rss": "99404", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:17.805802 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:17.805691 after 0.19 seconds
[0m14:06:17.806233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5637fd5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563755b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5637534200>]}
[0m14:06:17.806684 [debug] [MainThread]: Flushing usage events
[0m22:06:45.110829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949f7da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949a74b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9495a0050>]}


============================== 22:06:45.125425 | cc9f9267-01c5-435a-8161-1a81059cdac9 ==============================
[0m22:06:45.125425 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:45.126052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:45.272366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc9f9267-01c5-435a-8161-1a81059cdac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9495a0260>]}
[0m22:06:45.287454 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-g212j8i7'
[0m22:06:45.287919 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:45.381560 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:45.383031 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:45.417060 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:45.421677 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:45.512836 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:45.513382 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:06:45.513878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cc9f9267-01c5-435a-8161-1a81059cdac9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949732f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94a605370>]}
[0m22:06:45.514349 [info ] [MainThread]: 
[0m22:06:45.514802 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:45.524056 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46460143, "process_user_time": 1.635375, "process_kernel_time": 0.130392, "process_mem_max_rss": "100928", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m22:06:45.524632 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:45.524528 after 0.47 seconds
[0m22:06:45.525058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949f7da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949a01a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94a7c2600>]}
[0m22:06:45.525499 [debug] [MainThread]: Flushing usage events
[0m22:06:47.110660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1037e8bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035f78dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035f7a180>]}


============================== 22:06:47.113819 | d717296a-b81a-4e0f-afb2-e4ce2efc7e02 ==============================
[0m22:06:47.113819 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:47.114473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:47.348083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035523440>]}
[0m22:06:47.409495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10359b68a0>]}
[0m22:06:47.411285 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:47.432269 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:47.432993 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:47.433562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10355c28a0>]}
[0m22:06:48.821772 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:48.822428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102dd06930>]}
[0m22:06:49.060347 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:49.065610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102d59eea0>]}
[0m22:06:49.159490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102dd445f0>]}
[0m22:06:49.160023 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:49.160566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035597500>]}
[0m22:06:49.162391 [info ] [MainThread]: 
[0m22:06:49.163069 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:49.167895 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:49.203694 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:49.204126 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:49.204536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:49.633325 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.635573 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:49.636727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:49.637563 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:49.647434 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.648045 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:49.648588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:49.649718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.651007 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.651421 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:49.651979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.652382 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.652744 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:49.653410 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.654336 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:49.654730 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.655093 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:49.655696 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.656081 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:49.657286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:49.663035 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:49.663467 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:49.663825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:49.664487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.664870 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:49.665272 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:49.676092 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.677566 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:49.678831 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:49.679253 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:49.681471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10372ddcd0>]}
[0m22:06:49.681976 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.682407 [debug] [MainThread]: On master: BEGIN
[0m22:06:49.682776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:49.683421 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.683814 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.684200 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.684564 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.685135 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.685548 [debug] [MainThread]: On master: Close
[0m22:06:49.686032 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:49.686526 [info ] [MainThread]: 
[0m22:06:49.696601 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:49.697218 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:49.697788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:49.698250 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:49.725626 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:49.726446 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:49.762086 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:49.762894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:58.836721 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.837316 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:58.838016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.838479 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.838905 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:58.839882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.841258 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.841699 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:58.843019 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.850012 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.850537 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:58.851499 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.856078 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.856554 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:58.857392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.874071 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:58.874566 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.874980 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:58.876657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.882514 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.882969 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:58.884456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.886920 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:58.888439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102c138c50>]}
[0m22:06:58.889114 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.19s]
[0m22:06:58.889955 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:58.890880 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:58.891540 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:58.892110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:58.892577 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:58.897594 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:58.898271 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:58.937547 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.938427 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251119220658928571"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:58.939120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:58.947850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.958006 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.958692 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:58.959542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.960111 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.960789 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251119220658928571'
      
      
      order by ordinal_position

  
[0m22:06:58.964373 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.970654 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.971347 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:58.974334 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.982275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.982739 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:58.986049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.988155 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.988775 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:58.989757 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:59.009042 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:59.009779 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:59.010268 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251119220658928571"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251119220658928571"
    )
  
[0m22:06:59.069130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:59.071128 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:59.071591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:59.072007 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:59.089851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:59.090810 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:59.091519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fe56e7c50>]}
[0m22:06:59.092208 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.20s]
[0m22:06:59.093104 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:59.094963 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:59.095417 [debug] [MainThread]: On master: BEGIN
[0m22:06:59.095802 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:59.096528 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:59.096931 [debug] [MainThread]: On master: COMMIT
[0m22:06:59.097378 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:59.097749 [debug] [MainThread]: On master: COMMIT
[0m22:06:59.098343 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:59.098744 [debug] [MainThread]: On master: Close
[0m22:06:59.099241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:59.099614 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:59.100008 [info ] [MainThread]: 
[0m22:06:59.100551 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.94 seconds (9.94s).
[0m22:06:59.101562 [debug] [MainThread]: Command end result
[0m22:06:59.128030 [info ] [MainThread]: 
[0m22:06:59.128639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:59.129118 [info ] [MainThread]: 
[0m22:06:59.129635 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:59.130588 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.071445, "process_user_time": 5.633693, "process_kernel_time": 0.315758, "process_mem_max_rss": "331856", "process_in_blocks": "1200", "process_out_blocks": "107328"}
[0m22:06:59.131139 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:59.131034 after 12.07 seconds
[0m22:06:59.131629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10356f8e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10359b47a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fe56cb350>]}
[0m22:06:59.132050 [debug] [MainThread]: Flushing usage events
[0m22:07:00.849516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa59b354f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa59527ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa594cd0a0>]}


============================== 22:07:00.852642 | aaa10c2d-7541-432c-ad5e-9376a450c0ac ==============================
[0m22:07:00.852642 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:00.853337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:00.969422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaa10c2d-7541-432c-ad5e-9376a450c0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa58f57020>]}
[0m22:07:00.987844 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18902452, "process_user_time": 1.354442, "process_kernel_time": 0.104956, "process_mem_max_rss": "99392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:00.988415 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:00.988308 after 0.19 seconds
[0m22:07:00.988845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa5d6d3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa590a5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa58f6fbc0>]}
[0m22:07:00.989296 [debug] [MainThread]: Flushing usage events
[0m06:02:52.963025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b551fd4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b56a597f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b55fc3440>]}


============================== 06:02:52.975427 | b6315041-664c-4beb-8f51-7b44686fdedb ==============================
[0m06:02:52.975427 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:52.976097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:53.128221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6315041-664c-4beb-8f51-7b44686fdedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b54e3ade0>]}
[0m06:02:53.143838 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-t41c24x8'
[0m06:02:53.144323 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:53.180813 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:53.182591 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:53.215908 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:53.221315 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:53.473828 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:53.474417 [info ] [MainThread]: Updated version available: 1.3.2
[0m06:02:53.474966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b6315041-664c-4beb-8f51-7b44686fdedb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b54f50140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b55e011f0>]}
[0m06:02:53.475421 [info ] [MainThread]: 
[0m06:02:53.475925 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:53.486319 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.57421726, "process_user_time": 1.714649, "process_kernel_time": 0.150319, "process_mem_max_rss": "100944", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m06:02:53.486897 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:53.486790 after 0.57 seconds
[0m06:02:53.487326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b55fc3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b54c30c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b54c30830>]}
[0m06:02:53.487795 [debug] [MainThread]: Flushing usage events
[0m06:02:55.357852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c8635e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c7376000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c706ed80>]}


============================== 06:02:55.361149 | 129e2fa3-d541-4795-b67d-8cefb79b40f2 ==============================
[0m06:02:55.361149 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:55.361821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:55.601432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c6483ce0>]}
[0m06:02:55.664995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c82739e0>]}
[0m06:02:55.666945 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:02:55.688814 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:55.689585 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:55.690122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c6300800>]}
[0m06:02:57.101808 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:57.102480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c625f1d0>]}
[0m06:02:57.358216 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:57.364114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c76b2930>]}
[0m06:02:57.465772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bec29f10>]}
[0m06:02:57.466392 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:02:57.466962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38be5d4d40>]}
[0m06:02:57.468993 [info ] [MainThread]: 
[0m06:02:57.469759 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:57.474880 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:57.512954 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:57.513470 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:57.513898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:58.003362 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.005360 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:58.006362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:58.007061 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:58.016530 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:58.017127 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:58.017513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:58.019224 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.020686 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:58.021082 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:58.021693 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.022077 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:58.022435 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:58.023101 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.024051 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:58.024449 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:58.024840 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:58.025411 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.025840 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:58.027201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:58.033550 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:58.034016 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:58.034379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:58.035282 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.035705 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:58.036093 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:58.047512 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.049235 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:58.050554 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:58.050994 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:58.053290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38be41be60>]}
[0m06:02:58.053855 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:58.054249 [debug] [MainThread]: On master: BEGIN
[0m06:02:58.054616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:58.055397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:58.055837 [debug] [MainThread]: On master: COMMIT
[0m06:02:58.056220 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:58.056581 [debug] [MainThread]: On master: COMMIT
[0m06:02:58.057206 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:58.057605 [debug] [MainThread]: On master: Close
[0m06:02:58.058162 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:58.058701 [info ] [MainThread]: 
[0m06:02:58.078882 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:58.079582 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:58.080315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:58.080779 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:58.108863 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:58.109832 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:58.146876 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:58.147807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:08.287993 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.288570 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:08.289357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.289831 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.290248 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:08.291337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.292832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.293290 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:08.294419 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.301604 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.302130 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:08.303102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.307867 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.308351 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:08.309253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.326886 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:08.327452 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.327914 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:08.329698 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.337237 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.338053 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:08.341010 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.343718 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:08.345340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bd178e60>]}
[0m06:03:08.346096 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.26s]
[0m06:03:08.346992 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:08.348103 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:08.348707 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:08.349381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:08.349850 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:08.357126 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:08.358145 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:08.404398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.405007 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251120060308397904"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:08.405471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:08.412778 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.424442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.425221 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:08.426594 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.427072 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.427528 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251120060308397904'
      
      
      order by ordinal_position

  
[0m06:03:08.430592 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.436607 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.437132 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:08.439966 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.448468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.449037 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:08.451964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.453851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.454310 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:08.455137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.476808 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:08.477619 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.478126 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251120060308397904"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251120060308397904"
    )
  
[0m06:03:08.543630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.545725 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:08.546221 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.546670 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:08.652440 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.653671 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:08.654510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3875d9a240>]}
[0m06:03:08.655279 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m06:03:08.656096 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:08.658097 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:08.658528 [debug] [MainThread]: On master: BEGIN
[0m06:03:08.658962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:08.659813 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:08.660241 [debug] [MainThread]: On master: COMMIT
[0m06:03:08.660632 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:08.661064 [debug] [MainThread]: On master: COMMIT
[0m06:03:08.661707 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:08.662121 [debug] [MainThread]: On master: Close
[0m06:03:08.662609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:08.663011 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:08.663416 [info ] [MainThread]: 
[0m06:03:08.663969 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.19 seconds (11.19s).
[0m06:03:08.664984 [debug] [MainThread]: Command end result
[0m06:03:08.692976 [info ] [MainThread]: 
[0m06:03:08.693661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:08.694200 [info ] [MainThread]: 
[0m06:03:08.694737 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:08.695766 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.390484, "process_user_time": 5.963643, "process_kernel_time": 0.314611, "process_mem_max_rss": "334412", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m06:03:08.696304 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:08.696201 after 13.39 seconds
[0m06:03:08.696787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38cabbb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c691b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c6940200>]}
[0m06:03:08.697251 [debug] [MainThread]: Flushing usage events
[0m06:03:10.830883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb169a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb26c2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb26c2180>]}


============================== 06:03:10.834291 | 15d8f03c-c736-4b71-81f9-827f3ee84702 ==============================
[0m06:03:10.834291 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:10.834994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:10.966984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15d8f03c-c736-4b71-81f9-827f3ee84702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb1f7fc80>]}
[0m06:03:10.986505 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20906797, "process_user_time": 1.459182, "process_kernel_time": 0.107939, "process_mem_max_rss": "99560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:03:10.987108 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:10.986999 after 0.21 seconds
[0m06:03:10.987555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb1b423c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb1354380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb133d550>]}
[0m06:03:10.988038 [debug] [MainThread]: Flushing usage events
[0m14:05:53.179557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a58c7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a62117f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a5abe600>]}


============================== 14:05:53.191610 | 5a672e3c-23f6-4110-bc27-b90d7988f7aa ==============================
[0m14:05:53.191610 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:53.192305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:53.358203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a672e3c-23f6-4110-bc27-b90d7988f7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a56d7d70>]}
[0m14:05:53.373640 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-k_qvy3k2'
[0m14:05:53.374135 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:53.485516 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:53.486960 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:53.521317 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:53.525868 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:53.596609 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:53.597239 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:05:53.597813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5a672e3c-23f6-4110-bc27-b90d7988f7aa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a68d42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a543de80>]}
[0m14:05:53.598270 [info ] [MainThread]: 
[0m14:05:53.598792 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:53.607982 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4789139, "process_user_time": 1.630166, "process_kernel_time": 0.145461, "process_mem_max_rss": "100920", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m14:05:53.608518 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:53.608417 after 0.48 seconds
[0m14:05:53.608958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a5d89970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a68d42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a56d7d70>]}
[0m14:05:53.609364 [debug] [MainThread]: Flushing usage events
[0m14:05:55.230135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06390955b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06383d54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063839dee0>]}


============================== 14:05:55.233197 | d8802396-d66b-4a81-a57e-17063e595344 ==============================
[0m14:05:55.233197 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:55.233852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:55.464047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06382ad310>]}
[0m14:05:55.525264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06385a4ce0>]}
[0m14:05:55.526935 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:05:55.567943 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:55.568651 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:55.569182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06380ef2f0>]}
[0m14:05:56.991250 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:56.991891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06303d6a20>]}
[0m14:05:57.238909 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:57.246488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063876a930>]}
[0m14:05:57.383057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0630a96b40>]}
[0m14:05:57.383651 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:05:57.384226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06381e0260>]}
[0m14:05:57.386195 [info ] [MainThread]: 
[0m14:05:57.386979 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:57.391932 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:57.428666 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:57.429139 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:57.429529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:57.886792 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.888403 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:57.889298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:57.889886 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:57.897451 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:57.897890 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:57.898327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:57.899326 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.900649 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:57.901061 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:57.901645 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.902047 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:57.902410 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:57.903050 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.903979 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:57.904371 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:57.904755 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:57.905339 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.905758 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:57.907052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:57.913119 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:57.913515 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:57.913900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:57.914596 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.915014 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:57.915384 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:57.927360 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.928875 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:57.930122 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:57.930521 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:57.932595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0630a38bf0>]}
[0m14:05:57.933159 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:57.933539 [debug] [MainThread]: On master: BEGIN
[0m14:05:57.933932 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:57.934611 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:57.935045 [debug] [MainThread]: On master: COMMIT
[0m14:05:57.935418 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:57.935816 [debug] [MainThread]: On master: COMMIT
[0m14:05:57.936451 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:57.936878 [debug] [MainThread]: On master: Close
[0m14:05:57.937365 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:57.937848 [info ] [MainThread]: 
[0m14:05:57.956891 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:57.957476 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:57.958057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:57.958494 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:57.985553 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:57.986370 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:58.021870 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:58.022637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:05.384534 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.385116 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:05.385837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.386275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.386714 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:05.387679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.389046 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.389483 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:05.390463 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.397278 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.397752 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:05.398481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.402677 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.403142 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:05.403862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.420336 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:05.420825 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.421329 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:05.423679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.429416 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.429888 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:05.431315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.433753 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:05.435261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062afaf620>]}
[0m14:06:05.435971 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.48s]
[0m14:06:05.436763 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:05.437774 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:05.438326 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:05.438938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:05.439367 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:05.444388 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:05.445054 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:05.481184 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.481674 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251120140605475122"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:05.482145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:05.489088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.496643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.497116 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:05.497775 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.498204 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.498613 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251120140605475122'
      
      
      order by ordinal_position

  
[0m14:06:05.501036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.506129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.506585 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:05.508920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.516500 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.516987 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:05.519275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.520940 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.521379 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:06:05.522096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.539162 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:05.539869 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.540324 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251120140605475122"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251120140605475122"
    )
  
[0m14:06:05.601256 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.603275 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:05.603729 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.604140 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:05.609893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.610797 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:05.611479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06280cc5f0>]}
[0m14:06:05.612166 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:06:05.612912 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:05.614658 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:05.615094 [debug] [MainThread]: On master: BEGIN
[0m14:06:05.615461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:05.616186 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:05.616582 [debug] [MainThread]: On master: COMMIT
[0m14:06:05.617012 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:05.617381 [debug] [MainThread]: On master: COMMIT
[0m14:06:05.617967 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:05.618356 [debug] [MainThread]: On master: Close
[0m14:06:05.618833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:05.619208 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:05.619602 [info ] [MainThread]: 
[0m14:06:05.620106 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.23 seconds (8.23s).
[0m14:06:05.621110 [debug] [MainThread]: Command end result
[0m14:06:05.647878 [info ] [MainThread]: 
[0m14:06:05.648476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:05.649003 [info ] [MainThread]: 
[0m14:06:05.649520 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:05.650514 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.470858, "process_user_time": 5.215342, "process_kernel_time": 0.274859, "process_mem_max_rss": "323848", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m14:06:05.651082 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:05.650977 after 10.47 seconds
[0m14:06:05.651510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063c8d3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063af6c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05e82976b0>]}
[0m14:06:05.651954 [debug] [MainThread]: Flushing usage events
[0m14:06:07.361218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28613bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff284665eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28384cd70>]}


============================== 14:06:07.364281 | c8511478-8494-47d2-bea8-498865bb57db ==============================
[0m14:06:07.364281 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:07.364951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:07.480396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8511478-8494-47d2-bea8-498865bb57db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff283e81f70>]}
[0m14:06:07.498954 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18795969, "process_user_time": 1.33182, "process_kernel_time": 0.106905, "process_mem_max_rss": "99312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:07.499502 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:07.499395 after 0.19 seconds
[0m14:06:07.499972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff287dbb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2838d36e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28364d4c0>]}
[0m14:06:07.500402 [debug] [MainThread]: Flushing usage events
[0m22:06:45.606555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e99e92a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e996a7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9a7ee480>]}


============================== 22:06:45.619893 | 09023abc-f759-4565-a56f-a3a6750e70cb ==============================
[0m22:06:45.619893 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:45.620598 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:45.771352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09023abc-f759-4565-a56f-a3a6750e70cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9952c860>]}
[0m22:06:45.787325 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rb0y47vk'
[0m22:06:45.787810 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:45.945205 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:45.946746 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:45.992172 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:45.996847 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:46.090783 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:46.091433 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:06:46.091971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '09023abc-f759-4565-a56f-a3a6750e70cb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9a50c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9a50c200>]}
[0m22:06:46.092452 [info ] [MainThread]: 
[0m22:06:46.092926 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:46.103317 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.54911476, "process_user_time": 1.702694, "process_kernel_time": 0.134767, "process_mem_max_rss": "101200", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m22:06:46.103867 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:46.103763 after 0.55 seconds
[0m22:06:46.104340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9998a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e99254050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e99fef5c0>]}
[0m22:06:46.104772 [debug] [MainThread]: Flushing usage events
[0m22:06:47.709338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28ae5d7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28af87a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28ae5d7c50>]}


============================== 22:06:47.712881 | 857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186 ==============================
[0m22:06:47.712881 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:47.713594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:47.952091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28aecfcfb0>]}
[0m22:06:48.013942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28adb1a450>]}
[0m22:06:48.015821 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:48.065031 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:48.065771 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:48.066332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28adb033b0>]}
[0m22:06:49.458166 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:49.458877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a6476f00>]}
[0m22:06:49.704552 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:49.710470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a5b8e840>]}
[0m22:06:49.809147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a63621b0>]}
[0m22:06:49.809744 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:49.810332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a6340230>]}
[0m22:06:49.812260 [info ] [MainThread]: 
[0m22:06:49.813018 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:49.818014 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:49.854671 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:49.855165 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:49.855574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:50.247908 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.249612 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:50.250513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:50.251110 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:50.258764 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:50.259217 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:50.259604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:50.260636 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.261983 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:50.262401 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:50.263006 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.263394 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:50.263755 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:50.264378 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.265304 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:50.265698 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:50.266088 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:50.266652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.267063 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:50.268279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:50.274227 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:50.274627 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:50.275005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:50.275689 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.276101 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:50.276475 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:50.287098 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.288558 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:50.289807 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:50.290231 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:50.292433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a5ba36e0>]}
[0m22:06:50.292935 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:50.293375 [debug] [MainThread]: On master: BEGIN
[0m22:06:50.293743 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:50.294429 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:50.294856 [debug] [MainThread]: On master: COMMIT
[0m22:06:50.295257 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:50.295619 [debug] [MainThread]: On master: COMMIT
[0m22:06:50.296248 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:50.296655 [debug] [MainThread]: On master: Close
[0m22:06:50.297170 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:50.297668 [info ] [MainThread]: 
[0m22:06:50.333258 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:50.333855 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:50.334508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:50.334948 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:50.361835 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:50.362583 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:50.397694 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:50.398468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:58.397737 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.398308 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:58.399031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.399479 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.399907 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:58.400877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.402240 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.402688 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:58.403709 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.411518 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.411978 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:58.412737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.415697 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.416169 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:58.416929 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.433574 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:58.434056 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.434487 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:58.436512 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.442274 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.442735 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:58.444185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.446586 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:58.448109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28af87aa80>]}
[0m22:06:58.448805 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.11s]
[0m22:06:58.449587 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:58.450591 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:58.451172 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:58.451745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:58.452210 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:58.457169 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:58.457800 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:58.493906 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.494434 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251120220658487815"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:58.494890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:58.501908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.509436 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.509906 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:58.510627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.511089 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.511517 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251120220658487815'
      
      
      order by ordinal_position

  
[0m22:06:58.514311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.520008 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.520511 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:58.523181 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.531217 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.531691 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:58.534146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.535848 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.536321 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:58.537047 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.555807 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:58.556653 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.557164 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251120220658487815"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251120220658487815"
    )
  
[0m22:06:58.615171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.617209 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:58.617673 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.618099 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:58.624375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.625300 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:58.625970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f285dcff920>]}
[0m22:06:58.626691 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:06:58.627452 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:58.629275 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:58.629689 [debug] [MainThread]: On master: BEGIN
[0m22:06:58.630107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:58.630841 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:58.631273 [debug] [MainThread]: On master: COMMIT
[0m22:06:58.631644 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:58.632027 [debug] [MainThread]: On master: COMMIT
[0m22:06:58.632618 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:58.633048 [debug] [MainThread]: On master: Close
[0m22:06:58.633524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:58.633881 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:58.634309 [info ] [MainThread]: 
[0m22:06:58.634760 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.82 seconds (8.82s).
[0m22:06:58.635701 [debug] [MainThread]: Command end result
[0m22:06:58.661802 [info ] [MainThread]: 
[0m22:06:58.662413 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:58.662874 [info ] [MainThread]: 
[0m22:06:58.663361 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:58.664311 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.008272, "process_user_time": 5.259007, "process_kernel_time": 0.277528, "process_mem_max_rss": "351268", "process_in_blocks": "1200", "process_out_blocks": "107336"}
[0m22:06:58.664849 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:58.664746 after 11.01 seconds
[0m22:06:58.665317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28af87a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a636b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f285dc82f90>]}
[0m22:06:58.665747 [debug] [MainThread]: Flushing usage events
[0m22:07:00.419837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18d504620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18caf17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18d299c40>]}


============================== 22:07:00.423078 | 93ea60b9-8717-46f3-85c7-0305b8fc10d1 ==============================
[0m22:07:00.423078 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:00.423771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:07:00.537786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93ea60b9-8717-46f3-85c7-0305b8fc10d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18e53fe60>]}
[0m22:07:00.556260 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1879157, "process_user_time": 1.327799, "process_kernel_time": 0.112897, "process_mem_max_rss": "99448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:00.556818 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:00.556712 after 0.19 seconds
[0m22:07:00.557269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd190dbb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18e53fe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18d9972f0>]}
[0m22:07:00.557698 [debug] [MainThread]: Flushing usage events
[0m06:02:55.195014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f79f3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f7c9c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f7e88200>]}


============================== 06:02:55.203822 | 0c1ad6c8-aef9-4da0-8a74-36d6c9ec5b31 ==============================
[0m06:02:55.203822 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:55.204459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:55.367564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c1ad6c8-aef9-4da0-8a74-36d6c9ec5b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f77cea80>]}
[0m06:02:55.383061 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lrbn4gex'
[0m06:02:55.383530 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:55.475968 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:55.477622 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:55.511404 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:55.516067 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:55.744004 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:55.744607 [info ] [MainThread]: Updated version available: 1.3.2
[0m06:02:55.745208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0c1ad6c8-aef9-4da0-8a74-36d6c9ec5b31', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f8a05c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f8a053a0>]}
[0m06:02:55.745703 [info ] [MainThread]: 
[0m06:02:55.746188 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:55.748104 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.60558575, "process_user_time": 1.693584, "process_kernel_time": 0.133651, "process_mem_max_rss": "100784", "process_in_blocks": "8760", "process_out_blocks": "5176"}
[0m06:02:55.748661 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:55.748556 after 0.61 seconds
[0m06:02:55.749131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f7a3a930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f7e126c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f7a3c890>]}
[0m06:02:55.749548 [debug] [MainThread]: Flushing usage events
[0m06:02:57.704051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38cfc54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38d0e3680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38d0e3740>]}


============================== 06:02:57.707419 | 0c398430-b643-419c-81bc-6df873ee76ee ==============================
[0m06:02:57.707419 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:57.708141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:57.954026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38c9a17f0>]}
[0m06:02:58.018819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38cad6420>]}
[0m06:02:58.020641 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:02:58.059786 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:58.060510 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:58.061053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38cc77110>]}
[0m06:02:59.461006 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:59.461701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe384c52240>]}
[0m06:02:59.714786 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:59.720357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe384d6a150>]}
[0m06:02:59.822014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe385489940>]}
[0m06:02:59.822600 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:02:59.823116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3854e7d70>]}
[0m06:02:59.825014 [info ] [MainThread]: 
[0m06:02:59.825738 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:59.831001 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:59.869212 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:59.869721 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:59.870139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:00.224249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.226331 [debug] [ThreadPool]: On list_petro: Close
[0m06:03:00.227387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:03:00.227987 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:03:00.237114 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.237728 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:03:00.238289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:00.239974 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.241427 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.241861 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:03:00.242779 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.243171 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.243533 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:03:00.244182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.245105 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:00.245493 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.245903 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:00.246491 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.246907 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:03:00.248168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:03:00.254159 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:00.254578 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:03:00.254978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:00.255938 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.256332 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:00.256729 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:03:00.267418 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.268944 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:03:00.270222 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:03:00.270621 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:03:00.272835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3854e5fd0>]}
[0m06:03:00.273341 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:00.273752 [debug] [MainThread]: On master: BEGIN
[0m06:03:00.274119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:00.274789 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:00.275184 [debug] [MainThread]: On master: COMMIT
[0m06:03:00.275554 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:00.275952 [debug] [MainThread]: On master: COMMIT
[0m06:03:00.276527 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:00.276969 [debug] [MainThread]: On master: Close
[0m06:03:00.277467 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:03:00.277958 [info ] [MainThread]: 
[0m06:03:00.288338 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:03:00.288956 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:03:00.289596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:03:00.290056 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:03:00.317696 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:03:00.318503 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:00.355577 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:00.356383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:12.536913 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.537477 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:12.538184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.538630 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.539083 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:12.540080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.541411 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.541873 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:12.542876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.549775 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.550247 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:12.550999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.555189 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.555636 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:12.556372 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.573707 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:12.574190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.574618 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:12.576342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.582120 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.582586 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:12.584051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.586463 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:12.588006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38ea6ab40>]}
[0m06:03:12.588726 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.30s]
[0m06:03:12.589549 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:12.590471 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:12.591068 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:12.591755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:12.592209 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:12.597308 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:12.598096 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:12.635083 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.635615 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251121060312628691"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:12.636102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:12.643374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.651246 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.651728 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:12.652403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.652865 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.653341 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251121060312628691'
      
      
      order by ordinal_position

  
[0m06:03:12.655903 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.661365 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.661875 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:12.664304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.671964 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.672428 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:12.675113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.676779 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.677220 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:12.677933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.695722 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:12.696421 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.696941 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251121060312628691"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251121060312628691"
    )
  
[0m06:03:12.755271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.757302 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:12.757763 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.758198 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:12.764490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.765405 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:12.766116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33c3c14c0>]}
[0m06:03:12.766800 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:03:12.767605 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:12.769605 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:12.770046 [debug] [MainThread]: On master: BEGIN
[0m06:03:12.770420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:12.771155 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:12.771547 [debug] [MainThread]: On master: COMMIT
[0m06:03:12.771973 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:12.772329 [debug] [MainThread]: On master: COMMIT
[0m06:03:12.772915 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:12.773305 [debug] [MainThread]: On master: Close
[0m06:03:12.773785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:12.774146 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:12.774544 [info ] [MainThread]: 
[0m06:03:12.775101 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.95 seconds (12.95s).
[0m06:03:12.776108 [debug] [MainThread]: Command end result
[0m06:03:12.803024 [info ] [MainThread]: 
[0m06:03:12.803646 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:12.804187 [info ] [MainThread]: 
[0m06:03:12.804726 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:12.805754 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.156757, "process_user_time": 5.662956, "process_kernel_time": 0.302676, "process_mem_max_rss": "332584", "process_in_blocks": "1200", "process_out_blocks": "107304"}
[0m06:03:12.806291 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:12.806189 after 15.16 seconds
[0m06:03:12.806737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38f8d5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36c57bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38d0e3a70>]}
[0m06:03:12.807160 [debug] [MainThread]: Flushing usage events
[0m06:03:14.790682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37469da930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37473b3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37458fc530>]}


============================== 06:03:14.793956 | 16ed70cf-4058-4fd0-ae12-acc6d1da4ac9 ==============================
[0m06:03:14.793956 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:14.794660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:03:14.915430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16ed70cf-4058-4fd0-ae12-acc6d1da4ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374483a2a0>]}
[0m06:03:14.933811 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19744481, "process_user_time": 1.408084, "process_kernel_time": 0.097005, "process_mem_max_rss": "99400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:03:14.934358 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:14.934254 after 0.20 seconds
[0m06:03:14.934809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374679c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3744aaf110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3744aafc80>]}
[0m06:03:14.935232 [debug] [MainThread]: Flushing usage events
[0m14:06:00.761642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9fb977a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9fbb5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9fb97890>]}


============================== 14:06:00.773998 | 6c79b183-917f-40d4-8d7c-a8894befcfb6 ==============================
[0m14:06:00.773998 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:00.774692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:00.917702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c79b183-917f-40d4-8d7c-a8894befcfb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9f7fd370>]}
[0m14:06:00.934006 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-m1rb07yp'
[0m14:06:00.934505 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:01.029900 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:01.031653 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:01.077072 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:01.082036 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:01.186461 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:01.187106 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:06:01.187651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6c79b183-917f-40d4-8d7c-a8894befcfb6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9f7ff410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9f7446e0>]}
[0m14:06:01.188136 [info ] [MainThread]: 
[0m14:06:01.188611 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:01.199111 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48842794, "process_user_time": 1.635622, "process_kernel_time": 0.148874, "process_mem_max_rss": "101156", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m14:06:01.199670 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:01.199566 after 0.49 seconds
[0m14:06:01.200136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca36cb530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9fa1c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9fb67200>]}
[0m14:06:01.200557 [debug] [MainThread]: Flushing usage events
[0m14:06:02.885372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3df9ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3e8ed5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3d58f110>]}


============================== 14:06:02.888460 | 86d98b8a-820d-47a5-946c-3bd1245117f2 ==============================
[0m14:06:02.888460 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:02.889142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:03.121687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3ef6d730>]}
[0m14:06:03.183217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3d21dc70>]}
[0m14:06:03.184889 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:06:03.204832 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:03.205526 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:03.206081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3d312450>]}
[0m14:06:04.592444 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:04.593084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf35c5af30>]}
[0m14:06:04.825033 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:04.830278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3557cf80>]}
[0m14:06:04.922975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3d313440>]}
[0m14:06:04.923477 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:06:04.923988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf35c88d10>]}
[0m14:06:04.925837 [info ] [MainThread]: 
[0m14:06:04.926503 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:04.931405 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:04.966955 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:04.967380 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:04.967762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:05.317665 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.319289 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:05.320216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:05.320754 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:05.328256 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:05.328665 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:05.329074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:05.330001 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.331279 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:05.331659 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:05.332254 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.332628 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:05.333004 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:05.333605 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.334506 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:05.334900 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:05.335249 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:05.335822 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.336208 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:05.337380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:05.343069 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:05.343462 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:05.343836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:05.344506 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.344921 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:05.345285 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:05.356621 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.358070 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:05.359327 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:05.359722 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:05.361761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf35447fe0>]}
[0m14:06:05.362295 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:05.362676 [debug] [MainThread]: On master: BEGIN
[0m14:06:05.363073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:05.363699 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:05.364112 [debug] [MainThread]: On master: COMMIT
[0m14:06:05.364484 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:05.364862 [debug] [MainThread]: On master: COMMIT
[0m14:06:05.365447 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:05.365868 [debug] [MainThread]: On master: Close
[0m14:06:05.366358 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:05.366835 [info ] [MainThread]: 
[0m14:06:05.384076 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:05.384672 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:05.385259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:05.385693 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:05.412447 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:05.413205 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:05.448754 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:05.449512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:13.165625 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.166198 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:13.166878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.167319 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.167737 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:13.168729 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.170102 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.170543 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:13.171645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.178431 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.178910 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:13.179648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.183823 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.184266 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:13.185231 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.201949 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:13.202408 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.202844 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:13.204804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.210533 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.211006 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:13.212144 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.214547 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:13.216058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf2ff00500>]}
[0m14:06:13.216732 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.83s]
[0m14:06:13.217606 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:13.218611 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:13.219213 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:13.219862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:13.220301 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:13.225265 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:13.225938 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:13.262529 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.263055 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251121140613256398"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:13.263510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:13.270740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.278443 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.278934 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:13.279622 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.280081 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.280502 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251121140613256398'
      
      
      order by ordinal_position

  
[0m14:06:13.282956 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.288152 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.288610 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:13.290983 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.298645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.299123 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:13.301493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.303182 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.303625 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:06:13.304347 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.321471 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:13.322175 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.322619 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251121140613256398"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251121140613256398"
    )
  
[0m14:06:13.379572 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.381584 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:13.382052 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.382465 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:13.388512 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.389453 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:13.390170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf06776180>]}
[0m14:06:13.390857 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:06:13.391669 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:13.393795 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:13.394212 [debug] [MainThread]: On master: BEGIN
[0m14:06:13.394582 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:13.395324 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:13.395721 [debug] [MainThread]: On master: COMMIT
[0m14:06:13.396151 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:13.396518 [debug] [MainThread]: On master: COMMIT
[0m14:06:13.397180 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:13.397626 [debug] [MainThread]: On master: Close
[0m14:06:13.398209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:13.398611 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:13.399054 [info ] [MainThread]: 
[0m14:06:13.399566 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.47 seconds (8.47s).
[0m14:06:13.400589 [debug] [MainThread]: Command end result
[0m14:06:13.427561 [info ] [MainThread]: 
[0m14:06:13.428222 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:13.428744 [info ] [MainThread]: 
[0m14:06:13.429295 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:13.430307 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.596053, "process_user_time": 5.524964, "process_kernel_time": 0.305053, "process_mem_max_rss": "360356", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m14:06:13.430895 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:13.430749 after 10.60 seconds
[0m14:06:13.431342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3de375f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf41ad3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeed42b560>]}
[0m14:06:13.431773 [debug] [MainThread]: Flushing usage events
[0m14:06:15.125884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f3098bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f30de9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2f4e7f20>]}


============================== 14:06:15.129013 | a71fc38f-db05-499c-a718-5f5beee240c3 ==============================
[0m14:06:15.129013 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:15.129645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:06:15.243507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a71fc38f-db05-499c-a718-5f5beee240c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2e0674d0>]}
[0m14:06:15.262975 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18801713, "process_user_time": 1.31611, "process_kernel_time": 0.104929, "process_mem_max_rss": "99292", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:15.263521 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:15.263418 after 0.19 seconds
[0m14:06:15.263996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f30b4b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2e0674d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2e67d460>]}
[0m14:06:15.264420 [debug] [MainThread]: Flushing usage events
[0m22:06:35.301394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9195993cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9193b9fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9193b9d7c0>]}


============================== 22:06:35.313919 | 6fb50e86-466a-4cfd-8bfb-414755d307f0 ==============================
[0m22:06:35.313919 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:35.314602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:35.476126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fb50e86-466a-4cfd-8bfb-414755d307f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9194a22510>]}
[0m22:06:35.491999 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1e3ohzqt'
[0m22:06:35.492495 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:35.558752 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:35.560277 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:35.591213 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:35.595876 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:35.823899 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:35.824524 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:06:35.825073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6fb50e86-466a-4cfd-8bfb-414755d307f0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9193111e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9193d15c10>]}
[0m22:06:35.825553 [info ] [MainThread]: 
[0m22:06:35.826021 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:35.838769 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.58808714, "process_user_time": 1.635583, "process_kernel_time": 0.14062, "process_mem_max_rss": "100832", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m22:06:35.839324 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:35.839219 after 0.59 seconds
[0m22:06:35.839790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9195993cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9192b17650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9192b14050>]}
[0m22:06:35.840213 [debug] [MainThread]: Flushing usage events
[0m22:06:37.453388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ccb836e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12cd395e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12cc948500>]}


============================== 22:06:37.456542 | 25ec4911-ff44-4326-ab0d-9a2d19f03f0a ==============================
[0m22:06:37.456542 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:37.457243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:37.692443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ce6980e0>]}
[0m22:06:37.754340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12cc69ed80>]}
[0m22:06:37.756151 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:37.776321 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:37.777065 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:37.777602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12cc91ac60>]}
[0m22:06:39.169532 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:39.170180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12c49be930>]}
[0m22:06:39.414373 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:39.419813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12c49f43e0>]}
[0m22:06:39.524013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12c5034860>]}
[0m22:06:39.524585 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:39.525090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12c50ef0e0>]}
[0m22:06:39.527009 [info ] [MainThread]: 
[0m22:06:39.527757 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:39.532704 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:39.568983 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:39.569426 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:39.569835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:39.917108 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.918835 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:39.919803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:39.920592 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:39.929077 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.929531 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:39.929928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:39.931284 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.932668 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.933059 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:39.933698 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.934078 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.934437 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:39.935074 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.936022 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:39.936412 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.936796 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:39.937369 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.937784 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:39.939029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:39.945095 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:39.945520 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:39.945886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:39.946578 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.946966 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:39.947334 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:39.958377 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.959918 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:39.961198 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:39.961620 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:39.963765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ce6ca0f0>]}
[0m22:06:39.964271 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:39.964689 [debug] [MainThread]: On master: BEGIN
[0m22:06:39.965047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:39.965712 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:39.966105 [debug] [MainThread]: On master: COMMIT
[0m22:06:39.966494 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:39.966856 [debug] [MainThread]: On master: COMMIT
[0m22:06:39.967438 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:39.967863 [debug] [MainThread]: On master: Close
[0m22:06:39.968358 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:39.968849 [info ] [MainThread]: 
[0m22:06:39.986695 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:39.987370 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:39.988091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:39.988567 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:40.016476 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:40.017354 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:40.053263 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:40.054148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:48.272647 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.273206 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:48.273955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.274383 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.274820 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:48.275762 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.277124 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.277598 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:48.278658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.285558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.286023 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:48.286782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.291034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.291498 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:48.292287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.308974 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:48.309470 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.309896 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:48.311176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.316903 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.317357 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:48.318610 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.321064 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:48.322601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ce663170>]}
[0m22:06:48.323293 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.33s]
[0m22:06:48.324131 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:48.324981 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:48.325758 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:48.326365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:48.326844 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:48.331895 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:48.332576 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:48.368582 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.369095 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251121220648362528"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:48.369560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:48.376933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.384760 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.385211 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:48.386112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.386571 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.386992 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251121220648362528'
      
      
      order by ordinal_position

  
[0m22:06:48.389568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.394841 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.395290 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:48.397790 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.405545 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.405996 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:48.408739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.410407 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.410867 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:48.411573 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.428890 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:48.429623 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.430131 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251121220648362528"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251121220648362528"
    )
  
[0m22:06:48.491154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.493182 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:48.493639 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.494055 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:48.500179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.501115 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:48.501804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12c513c560>]}
[0m22:06:48.502479 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m22:06:48.503202 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:48.504741 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:48.505153 [debug] [MainThread]: On master: BEGIN
[0m22:06:48.505567 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:48.506308 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:48.506754 [debug] [MainThread]: On master: COMMIT
[0m22:06:48.507126 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:48.507518 [debug] [MainThread]: On master: COMMIT
[0m22:06:48.508100 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:48.508513 [debug] [MainThread]: On master: Close
[0m22:06:48.508981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:48.509338 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:48.509758 [info ] [MainThread]: 
[0m22:06:48.510267 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.98 seconds (8.98s).
[0m22:06:48.511248 [debug] [MainThread]: Command end result
[0m22:06:48.538312 [info ] [MainThread]: 
[0m22:06:48.538978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:48.539507 [info ] [MainThread]: 
[0m22:06:48.540028 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:48.541031 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.139096, "process_user_time": 5.544868, "process_kernel_time": 0.332591, "process_mem_max_rss": "368528", "process_in_blocks": "1200", "process_out_blocks": "107328"}
[0m22:06:48.541586 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:48.541481 after 11.14 seconds
[0m22:06:48.542032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12cc948500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ccd0c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f127c67c530>]}
[0m22:06:48.542468 [debug] [MainThread]: Flushing usage events
[0m22:06:50.318555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f76e1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8fa24de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f76833b0>]}


============================== 22:06:50.321888 | 5640dcc7-29f8-4cd9-83b5-a3b6483a443b ==============================
[0m22:06:50.321888 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:50.322573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:50.436562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5640dcc7-29f8-4cd9-83b5-a3b6483a443b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f77de810>]}
[0m22:06:50.454565 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18738385, "process_user_time": 1.304815, "process_kernel_time": 0.13498, "process_mem_max_rss": "99492", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:50.455099 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:50.454998 after 0.19 seconds
[0m22:06:50.455655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f87a6630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f7beffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f7befce0>]}
[0m22:06:50.456072 [debug] [MainThread]: Flushing usage events
[0m06:02:48.916693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0024e518b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00230df0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0023a154c0>]}


============================== 06:02:48.930614 | 38d0ec57-b996-4362-aacb-e501405e3dbd ==============================
[0m06:02:48.930614 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:48.931384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:49.095123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38d0ec57-b996-4362-aacb-e501405e3dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0023d6bc50>]}
[0m06:02:49.112651 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-n9h8vowr'
[0m06:02:49.113237 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:49.249581 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:49.251870 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:49.299410 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:49.305136 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:49.401163 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:49.401746 [info ] [MainThread]: Updated version available: 1.3.2
[0m06:02:49.402300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '38d0ec57-b996-4362-aacb-e501405e3dbd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0022c6e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0022c9fdd0>]}
[0m06:02:49.402753 [info ] [MainThread]: 
[0m06:02:49.403232 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:49.413181 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5499759, "process_user_time": 1.764816, "process_kernel_time": 0.161983, "process_mem_max_rss": "100908", "process_in_blocks": "8760", "process_out_blocks": "5176"}
[0m06:02:49.413868 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:49.413759 after 0.55 seconds
[0m06:02:49.414348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0023a154c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0023d6bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0022c6e450>]}
[0m06:02:49.414776 [debug] [MainThread]: Flushing usage events
[0m06:02:51.258389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026d395e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20261ad4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026036d80>]}


============================== 06:02:51.261733 | 7ee08eb3-63ff-4302-9bd3-de88075a2d61 ==============================
[0m06:02:51.261733 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:51.262467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:51.505707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201db7d3d0>]}
[0m06:02:51.569299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2024fb63f0>]}
[0m06:02:51.571243 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:02:51.593338 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:51.594194 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:51.594744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2024f3eff0>]}
[0m06:02:53.028540 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:53.029278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201dab7ec0>]}
[0m06:02:53.303433 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:53.309658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201d1e90d0>]}
[0m06:02:53.412315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201daf4080>]}
[0m06:02:53.412934 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:02:53.413472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201db7de20>]}
[0m06:02:53.415599 [info ] [MainThread]: 
[0m06:02:53.416391 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:53.421768 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:53.460491 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:53.461021 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:53.461444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:53.836174 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.838396 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:53.839529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:53.840120 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:53.847989 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:53.848533 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:53.848915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:53.850286 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.851753 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:53.852166 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:53.852772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.853180 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:53.853547 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:53.854249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.855259 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:53.855648 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:53.856005 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:53.856605 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.857011 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:53.858452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:53.865277 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:53.865799 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:53.866192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:53.867135 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.867527 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:53.867898 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:53.879227 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.881073 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:53.882481 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:53.882919 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:53.885172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201d194470>]}
[0m06:02:53.885727 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:53.886151 [debug] [MainThread]: On master: BEGIN
[0m06:02:53.886519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:53.887458 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:53.887870 [debug] [MainThread]: On master: COMMIT
[0m06:02:53.888289 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:53.888658 [debug] [MainThread]: On master: COMMIT
[0m06:02:53.889303 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:53.889706 [debug] [MainThread]: On master: Close
[0m06:02:53.890288 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:53.890801 [info ] [MainThread]: 
[0m06:02:53.909338 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:53.910063 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:53.910783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:53.911258 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:53.940078 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:53.941021 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:53.979189 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:53.980172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:02.256289 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.256903 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:02.257825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.258307 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.258734 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:02.259891 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.261472 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.261928 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:02.263172 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.270753 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.271368 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:02.272540 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.277609 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.278171 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:02.279378 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.297491 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:02.298118 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.298565 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:02.301087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.307875 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.308495 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:02.310182 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.312934 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:02.314653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026e7aa80>]}
[0m06:03:02.315432 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.40s]
[0m06:03:02.316318 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:02.317273 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:02.317862 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:02.318645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:02.319128 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:02.324942 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:02.325786 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:02.364332 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.365089 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251122060302357804"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:02.365635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:02.373289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.382038 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.382642 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:02.383548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.383998 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.384467 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251122060302357804'
      
      
      order by ordinal_position

  
[0m06:03:02.387316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.393473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.394078 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:02.397177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.405963 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.406566 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:02.409649 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.411633 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.412132 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:02.413034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.431468 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:02.432390 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.432874 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251122060302357804"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251122060302357804"
    )
  
[0m06:03:02.493211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.495420 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:02.495961 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.496461 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:02.502645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.503874 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:02.504761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd521be90>]}
[0m06:03:02.505560 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.19s]
[0m06:03:02.506405 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:02.508699 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:02.509173 [debug] [MainThread]: On master: BEGIN
[0m06:03:02.509562 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:02.510505 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:02.510925 [debug] [MainThread]: On master: COMMIT
[0m06:03:02.511351 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:02.511728 [debug] [MainThread]: On master: COMMIT
[0m06:03:02.512386 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:02.512810 [debug] [MainThread]: On master: Close
[0m06:03:02.513382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:02.513753 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:02.514223 [info ] [MainThread]: 
[0m06:03:02.514728 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.10 seconds (9.10s).
[0m06:03:02.515721 [debug] [MainThread]: Command end result
[0m06:03:02.545468 [info ] [MainThread]: 
[0m06:03:02.546184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:02.546669 [info ] [MainThread]: 
[0m06:03:02.547168 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:02.548193 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.34226, "process_user_time": 5.854422, "process_kernel_time": 0.335425, "process_mem_max_rss": "323960", "process_in_blocks": "1200", "process_out_blocks": "107304"}
[0m06:03:02.548754 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:02.548646 after 11.34 seconds
[0m06:03:02.549239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026d395e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2025587a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd58727b0>]}
[0m06:03:02.549732 [debug] [MainThread]: Flushing usage events
[0m06:03:04.541158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e4385a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e50b6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e50b6090>]}


============================== 06:03:04.544612 | d1f7c138-0a74-4ce9-985a-6e31500253a9 ==============================
[0m06:03:04.544612 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:04.545404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:04.670008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1f7c138-0a74-4ce9-985a-6e31500253a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e3eda4e0>]}
[0m06:03:04.689329 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20137587, "process_user_time": 1.452365, "process_kernel_time": 0.114949, "process_mem_max_rss": "99896", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:03:04.689922 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:04.689812 after 0.20 seconds
[0m06:03:04.690406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e3eff8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e43842c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e4385a30>]}
[0m06:03:04.690851 [debug] [MainThread]: Flushing usage events
[0m14:05:17.532598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f2ec350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58fddd280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f2ecad0>]}


============================== 14:05:17.545804 | 5b300d89-c1de-4653-a304-ecf78c784803 ==============================
[0m14:05:17.545804 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:17.546446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:17.725768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b300d89-c1de-4653-a304-ecf78c784803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f6cd190>]}
[0m14:05:17.741617 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tw29ox31'
[0m14:05:17.742109 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:17.941084 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:17.942534 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:17.973389 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:17.977968 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:18.132288 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:18.132887 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:05:18.133414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5b300d89-c1de-4653-a304-ecf78c784803', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f50cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f37a630>]}
[0m14:05:18.133906 [info ] [MainThread]: 
[0m14:05:18.134374 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:18.168528 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6872557, "process_user_time": 1.68707, "process_kernel_time": 0.142005, "process_mem_max_rss": "100796", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m14:05:18.169118 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:18.169014 after 0.69 seconds
[0m14:05:18.169575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff593ad3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f28c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f6cd190>]}
[0m14:05:18.170060 [debug] [MainThread]: Flushing usage events
[0m14:05:19.813796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ca79a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c7ef38c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c7c33410>]}


============================== 14:05:19.817036 | 7c64aa58-f025-4453-b2c6-eac7fd04dea1 ==============================
[0m14:05:19.817036 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:19.817751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:20.048555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c8de8f50>]}
[0m14:05:20.110322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c7a3ebd0>]}
[0m14:05:20.112120 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:05:20.145387 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:20.146156 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:20.146702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c0620cb0>]}
[0m14:05:21.556127 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:21.556831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c00cd880>]}
[0m14:05:21.806862 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:21.812320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b3b7a960>]}
[0m14:05:21.908322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c0169df0>]}
[0m14:05:21.908929 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:05:21.909416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c015fce0>]}
[0m14:05:21.911265 [info ] [MainThread]: 
[0m14:05:21.911987 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:21.916873 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:21.952716 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:21.953172 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:21.953557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:22.281582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.283944 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:22.285160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:22.286024 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:22.294244 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.294678 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:22.295061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:22.296024 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.297320 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.297722 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:22.298300 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.298697 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.299061 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:22.299676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.300562 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:22.300972 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.301338 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:22.301913 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.302304 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:22.303488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:22.309277 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:22.309697 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:22.310065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:22.310726 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.311114 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:22.311488 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:22.322197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.323621 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:22.324903 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:22.325304 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:22.327514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c9981a60>]}
[0m14:05:22.328081 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.328462 [debug] [MainThread]: On master: BEGIN
[0m14:05:22.328864 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:22.329504 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.329926 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.330295 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.330650 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.331262 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.331678 [debug] [MainThread]: On master: Close
[0m14:05:22.332191 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:22.332709 [info ] [MainThread]: 
[0m14:05:22.353761 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:22.354358 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:22.355014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:22.355451 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:22.383235 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:22.384228 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:22.422380 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:22.423382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:30.550761 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.551310 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:30.551995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.552436 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.552906 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:05:30.553953 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.555314 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.555780 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:05:30.557001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.565031 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.565483 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:30.566242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.569264 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.569727 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:30.570442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.587071 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.587519 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.587952 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.589756 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.595514 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.595992 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:30.597192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.599588 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:30.601142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c0095070>]}
[0m14:05:30.601841 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.25s]
[0m14:05:30.602597 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:30.603585 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:30.604165 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:30.604746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:30.605179 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:30.610178 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:30.610857 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:30.647604 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.648148 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251122140530641497"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:30.648613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:30.655726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.663375 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.663847 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:30.664497 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.664952 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.665369 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251122140530641497'
      
      
      order by ordinal_position

  
[0m14:05:30.668738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.673985 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.674441 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.676956 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.684719 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.685177 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.687551 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.689238 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.689695 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:05:30.690447 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.708967 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:30.709652 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.710124 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251122140530641497"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251122140530641497"
    )
  
[0m14:05:30.769721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.771834 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.772328 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.772760 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.778840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.779795 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:30.780504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88737cd250>]}
[0m14:05:30.781209 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m14:05:30.781956 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:30.783928 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:30.784356 [debug] [MainThread]: On master: BEGIN
[0m14:05:30.784765 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:30.785501 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:30.785945 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.786319 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:30.786712 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.787276 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:30.787698 [debug] [MainThread]: On master: Close
[0m14:05:30.788167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:30.788526 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:30.788963 [info ] [MainThread]: 
[0m14:05:30.789468 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.88 seconds (8.88s).
[0m14:05:30.790474 [debug] [MainThread]: Command end result
[0m14:05:30.816228 [info ] [MainThread]: 
[0m14:05:30.816871 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:30.817385 [info ] [MainThread]: 
[0m14:05:30.817936 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:30.818973 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.05933, "process_user_time": 5.609932, "process_kernel_time": 0.311885, "process_mem_max_rss": "333580", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m14:05:30.819519 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:30.819417 after 11.06 seconds
[0m14:05:30.819987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ca79a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c7b7e180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c7a58e60>]}
[0m14:05:30.820412 [debug] [MainThread]: Flushing usage events
[0m14:05:32.657548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9157c832f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9157c45ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915982d370>]}


============================== 14:05:32.660763 | f841a433-fcc0-42a3-ace7-28b29ff29a74 ==============================
[0m14:05:32.660763 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:32.661458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:32.780924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f841a433-fcc0-42a3-ace7-28b29ff29a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9157bce5a0>]}
[0m14:05:32.799510 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19348136, "process_user_time": 1.402522, "process_kernel_time": 0.118959, "process_mem_max_rss": "99664", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:32.800100 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:32.799995 after 0.19 seconds
[0m14:05:32.800526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9158daa060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9157a38380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91582714c0>]}
[0m14:05:32.800994 [debug] [MainThread]: Flushing usage events
[0m22:06:16.465473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f58df7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f58df9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f58de420>]}


============================== 22:06:16.524213 | 4e586fd0-f9d2-4d15-928b-9af52a86b6f6 ==============================
[0m22:06:16.524213 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:16.524917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:16.760473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e586fd0-f9d2-4d15-928b-9af52a86b6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f4ffcdd0>]}
[0m22:06:16.776774 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8d4rxxv5'
[0m22:06:16.777321 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:16.892143 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:16.894082 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:16.942232 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:16.947626 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:17.043860 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:17.044543 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:06:17.045142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4e586fd0-f9d2-4d15-928b-9af52a86b6f6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f5261100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f4c703e0>]}
[0m22:06:17.045613 [info ] [MainThread]: 
[0m22:06:17.046103 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:17.077754 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.66445327, "process_user_time": 1.766131, "process_kernel_time": 0.138323, "process_mem_max_rss": "100676", "process_in_blocks": "8760", "process_out_blocks": "5176"}
[0m22:06:17.078520 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:17.078398 after 0.67 seconds
[0m22:06:17.079046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f52912e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f4df7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f4b67e90>]}
[0m22:06:17.079527 [debug] [MainThread]: Flushing usage events
[0m22:06:18.859054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62851ed4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62856bd760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62856bdd00>]}


============================== 22:06:18.862429 | fa1f70ea-5297-45bd-a081-efe2e989a355 ==============================
[0m22:06:18.862429 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:18.863136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:19.109175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6285de8fe0>]}
[0m22:06:19.173187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62875849e0>]}
[0m22:06:19.175187 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:19.209759 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:19.210620 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:19.211185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62849de210>]}
[0m22:06:20.654751 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:20.655492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627d596d80>]}
[0m22:06:20.928511 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:20.934527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6284c8f410>]}
[0m22:06:21.037158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627d460bc0>]}
[0m22:06:21.037759 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:21.038278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62856ecce0>]}
[0m22:06:21.040317 [info ] [MainThread]: 
[0m22:06:21.041079 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:21.046198 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:21.085269 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:21.085850 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:21.086292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:21.571730 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.573582 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:21.574825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:21.575578 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:21.585703 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:21.586286 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:21.586718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:21.588266 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.589988 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:21.590431 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:21.591157 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.591611 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:21.592074 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:21.592813 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.593785 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:21.594205 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:21.594590 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:21.595202 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.595613 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:21.597009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:21.603506 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:21.604175 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:21.604585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:21.605783 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.606228 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:21.606602 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:21.619039 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.620885 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:21.622289 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:21.622715 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:21.624915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62849de060>]}
[0m22:06:21.625455 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:21.625869 [debug] [MainThread]: On master: BEGIN
[0m22:06:21.626239 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:21.627215 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:21.627669 [debug] [MainThread]: On master: COMMIT
[0m22:06:21.628081 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:21.628472 [debug] [MainThread]: On master: COMMIT
[0m22:06:21.629146 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:21.629547 [debug] [MainThread]: On master: Close
[0m22:06:21.630111 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:21.630586 [info ] [MainThread]: 
[0m22:06:21.813944 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:21.814701 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:21.815523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:21.816048 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:21.845030 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:21.845965 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:21.893047 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:21.894054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:29.482575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.483191 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:29.484062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.484505 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.484972 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:29.486038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.487520 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.487989 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:29.489100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.496462 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.497000 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:29.497981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.502675 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.503166 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:29.504038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.521292 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:29.521903 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.522340 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:29.524229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.530834 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.531373 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:29.533036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.535665 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:29.537305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62355950a0>]}
[0m22:06:29.538066 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.72s]
[0m22:06:29.538868 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:29.539865 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:29.540445 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:29.541179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:29.541624 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:29.547178 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:29.547908 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:29.585446 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.586050 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251122220629579151"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:29.586529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:29.594058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.602584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.603143 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:29.604011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.604444 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.604878 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251122220629579151'
      
      
      order by ordinal_position

  
[0m22:06:29.607575 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.613409 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.613959 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:29.616944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.625656 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.626206 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:29.629318 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.631250 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.631722 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:29.632554 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.651016 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:29.651928 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.652437 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251122220629579151"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251122220629579151"
    )
  
[0m22:06:29.711657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.713856 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:29.714363 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.714836 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:29.722190 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.723364 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:29.724202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627cd88cb0>]}
[0m22:06:29.724969 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m22:06:29.725741 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:29.727443 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:29.727912 [debug] [MainThread]: On master: BEGIN
[0m22:06:29.728307 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:29.729209 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:29.729616 [debug] [MainThread]: On master: COMMIT
[0m22:06:29.730049 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:29.730418 [debug] [MainThread]: On master: COMMIT
[0m22:06:29.731068 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:29.731472 [debug] [MainThread]: On master: Close
[0m22:06:29.732009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:29.732374 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:29.732785 [info ] [MainThread]: 
[0m22:06:29.733304 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.69 seconds (8.69s).
[0m22:06:29.734303 [debug] [MainThread]: Command end result
[0m22:06:29.763593 [info ] [MainThread]: 
[0m22:06:29.764269 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:29.764753 [info ] [MainThread]: 
[0m22:06:29.765276 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:29.766299 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.960622, "process_user_time": 5.925612, "process_kernel_time": 0.354635, "process_mem_max_rss": "334852", "process_in_blocks": "1200", "process_out_blocks": "107336"}
[0m22:06:29.766874 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:29.766741 after 10.96 seconds
[0m22:06:29.767319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f628508f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627cda8230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62346def30>]}
[0m22:06:29.767759 [debug] [MainThread]: Flushing usage events
[0m22:06:31.685593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe806c46510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe805cb51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80540cad0>]}


============================== 22:06:31.689126 | 63f285a0-93e8-4a5c-8d8b-e63f8bded3c0 ==============================
[0m22:06:31.689126 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:31.689892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:31.811166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63f285a0-93e8-4a5c-8d8b-e63f8bded3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe804bc1580>]}
[0m22:06:31.831064 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19891493, "process_user_time": 1.419081, "process_kernel_time": 0.119837, "process_mem_max_rss": "99536", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:31.831644 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:31.831534 after 0.20 seconds
[0m22:06:31.832132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe804f8f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8049af3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80498f470>]}
[0m22:06:31.832589 [debug] [MainThread]: Flushing usage events
[0m06:02:55.269830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d45c59220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d467362a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d45d26810>]}


============================== 06:02:55.298146 | 42e4f472-b01e-461f-8a5c-7aa50762a376 ==============================
[0m06:02:55.298146 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:55.298858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:55.508613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42e4f472-b01e-461f-8a5c-7aa50762a376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d449bd700>]}
[0m06:02:55.523748 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-25w7v57_'
[0m06:02:55.524219 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:55.661723 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:55.663082 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:55.732469 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:55.737461 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:55.935864 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:55.936457 [info ] [MainThread]: Updated version available: 1.3.2
[0m06:02:55.937037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '42e4f472-b01e-461f-8a5c-7aa50762a376', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d4399ce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d438e8590>]}
[0m06:02:55.937471 [info ] [MainThread]: 
[0m06:02:55.937985 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:55.956878 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.73759365, "process_user_time": 1.624433, "process_kernel_time": 0.147766, "process_mem_max_rss": "100804", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m06:02:55.957419 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:55.957319 after 0.74 seconds
[0m06:02:55.957875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d44584b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d439ac6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d439aca10>]}
[0m06:02:55.958281 [debug] [MainThread]: Flushing usage events
[0m06:02:57.660017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3580dfc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3597f3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35b1cb530>]}


============================== 06:02:57.663150 | 471154e4-f271-436e-a8cb-fa1a5427d577 ==============================
[0m06:02:57.663150 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:57.663848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:57.891660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3585f8e00>]}
[0m06:02:57.952462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3591739e0>]}
[0m06:02:57.954194 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:02:57.975589 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:57.976332 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:57.976877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3571c4e30>]}
[0m06:02:59.356466 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:59.357152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34fc9ed80>]}
[0m06:02:59.594944 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:59.600336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34f478aa0>]}
[0m06:02:59.701231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34f554da0>]}
[0m06:02:59.701819 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:02:59.702338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34f5005f0>]}
[0m06:02:59.704208 [info ] [MainThread]: 
[0m06:02:59.704955 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:59.709789 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:59.745683 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:59.746170 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:59.746568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:00.314838 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:03:00.316447 [debug] [ThreadPool]: On list_petro: Close
[0m06:03:00.317300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:03:00.317855 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:03:00.325223 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.325654 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:03:00.326032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:00.327030 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.328579 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.329054 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:03:00.329747 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.330127 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.330486 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:03:00.331116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.332032 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:00.332429 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.332824 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:00.333389 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.333801 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:03:00.335016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:03:00.340823 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:00.341221 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:03:00.341577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:00.342485 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.342903 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:00.343277 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:03:00.353795 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.355256 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:03:00.356506 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:03:00.356937 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:03:00.358938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3591d5970>]}
[0m06:03:00.359447 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:00.359856 [debug] [MainThread]: On master: BEGIN
[0m06:03:00.360226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:00.360876 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:00.361266 [debug] [MainThread]: On master: COMMIT
[0m06:03:00.361651 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:00.362012 [debug] [MainThread]: On master: COMMIT
[0m06:03:00.362586 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:00.363001 [debug] [MainThread]: On master: Close
[0m06:03:00.363476 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:03:00.363963 [info ] [MainThread]: 
[0m06:03:00.386083 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:03:00.386691 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:03:00.387319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:03:00.387787 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:03:00.414629 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:03:00.415369 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:00.451377 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:00.452192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:10.414566 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.415118 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:10.415793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.416241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.416711 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:10.417722 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.419315 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.419786 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:10.420982 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.428891 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.429348 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:10.430112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.433122 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.433561 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:10.434298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.450942 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:10.451401 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.451837 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:10.454309 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.460131 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.460581 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:10.462025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.464457 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:10.465989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc303f0ecf0>]}
[0m06:03:10.466691 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.08s]
[0m06:03:10.467444 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:10.468244 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:10.468811 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:10.469440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:10.469911 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:10.474894 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:10.475783 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:10.511783 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.512270 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251123060310505796"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:10.512746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:10.519510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.526899 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.527341 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:10.527997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.528425 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.528863 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251123060310505796'
      
      
      order by ordinal_position

  
[0m06:03:10.531292 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.536392 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.536863 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:10.539305 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.546936 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.547389 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:10.550298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.551973 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.552413 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:10.553147 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.571470 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:10.572161 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.572631 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251123060310505796"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251123060310505796"
    )
  
[0m06:03:10.629945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.631942 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:10.632380 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.632814 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:10.638092 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.638984 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:10.639666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc30321ea50>]}
[0m06:03:10.640329 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:03:10.641141 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:10.642755 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:10.643174 [debug] [MainThread]: On master: BEGIN
[0m06:03:10.643546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:10.644261 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:10.644684 [debug] [MainThread]: On master: COMMIT
[0m06:03:10.645058 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:10.645421 [debug] [MainThread]: On master: COMMIT
[0m06:03:10.646040 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:10.646425 [debug] [MainThread]: On master: Close
[0m06:03:10.646939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:10.647299 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:10.647715 [info ] [MainThread]: 
[0m06:03:10.648165 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.94 seconds (10.94s).
[0m06:03:10.649078 [debug] [MainThread]: Command end result
[0m06:03:10.674608 [info ] [MainThread]: 
[0m06:03:10.675165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:10.675632 [info ] [MainThread]: 
[0m06:03:10.676094 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:10.677048 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.069069, "process_user_time": 5.712059, "process_kernel_time": 0.301214, "process_mem_max_rss": "365612", "process_in_blocks": "1200", "process_out_blocks": "107312"}
[0m06:03:10.677580 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:10.677479 after 13.07 seconds
[0m06:03:10.678037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3574431d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc357844740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc357817dd0>]}
[0m06:03:10.678462 [debug] [MainThread]: Flushing usage events
[0m06:03:12.512816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f599835ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5998f6bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5997465eb0>]}


============================== 06:03:12.516035 | 3a156b8d-77a2-4f69-911e-e84dc86c3012 ==============================
[0m06:03:12.516035 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:12.516742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:03:12.631255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a156b8d-77a2-4f69-911e-e84dc86c3012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59966abd70>]}
[0m06:03:12.649627 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1881399, "process_user_time": 1.323672, "process_kernel_time": 0.111972, "process_mem_max_rss": "99408", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:03:12.650170 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:12.650062 after 0.19 seconds
[0m06:03:12.650607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5996c30fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5996490380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59964ecb90>]}
[0m06:03:12.651034 [debug] [MainThread]: Flushing usage events
