[0m14:06:54.474287 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250715140654467815"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:54.474881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:54.482667 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.490110 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.490561 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:54.491169 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.491605 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.492058 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250715140654467815'
      
      
      order by ordinal_position

  
[0m14:06:54.494179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.499235 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.499683 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:54.501772 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.509308 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.509759 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:54.512134 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.530292 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:54.530949 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.531419 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250715140654467815"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250715140654467815"
    )
  
[0m14:06:54.579481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.581534 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:54.582021 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:54.582441 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:54.590003 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:54.590903 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:54.592487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09308d6d-edf1-4466-9431-a161911700cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e3732750>]}
[0m14:06:54.593182 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:06:54.593905 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:54.595517 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:54.595917 [debug] [MainThread]: On master: BEGIN
[0m14:06:54.596322 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:54.596956 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:54.597386 [debug] [MainThread]: On master: COMMIT
[0m14:06:54.597756 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:54.598158 [debug] [MainThread]: On master: COMMIT
[0m14:06:54.598668 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:54.599086 [debug] [MainThread]: On master: Close
[0m14:06:54.599708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:54.600097 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:54.600492 [info ] [MainThread]: 
[0m14:06:54.600953 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.52 seconds (8.52s).
[0m14:06:54.601884 [debug] [MainThread]: Command end result
[0m14:06:54.627801 [info ] [MainThread]: 
[0m14:06:54.628362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:54.628806 [info ] [MainThread]: 
[0m14:06:54.629278 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:54.630216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.538381, "process_user_time": 4.943477, "process_kernel_time": 0.274693, "process_mem_max_rss": "339808", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m14:06:54.630746 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:54.630646 after 10.54 seconds
[0m14:06:54.631199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9255cf1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9273674d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9259f23f0>]}
[0m14:06:54.631617 [debug] [MainThread]: Flushing usage events
[0m14:06:56.430822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6768e135c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6769b84f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67670bdee0>]}


============================== 14:06:56.433947 | d676c5db-9b13-438b-99e5-6cbbd5564aef ==============================
[0m14:06:56.433947 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:56.434659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:56.542057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd676c5db-9b13-438b-99e5-6cbbd5564aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6766e4b2f0>]}
[0m14:06:56.559685 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17781195, "process_user_time": 1.342943, "process_kernel_time": 0.097922, "process_mem_max_rss": "100468", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:06:56.560259 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:56.560155 after 0.18 seconds
[0m14:06:56.560668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f676738af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f676703f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6766fde660>]}
[0m14:06:56.561099 [debug] [MainThread]: Flushing usage events
[0m22:06:37.212915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53bacdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53bacf980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53bacfd70>]}


============================== 22:06:37.228375 | aabb3fd5-bfb4-489e-8aa5-efc015182123 ==============================
[0m22:06:37.228375 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:37.229046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:37.362884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aabb3fd5-bfb4-489e-8aa5-efc015182123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53baec560>]}
[0m22:06:37.378224 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yj9vlmh4'
[0m22:06:37.378705 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:37.465005 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:37.465726 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:37.506004 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:37.509847 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:37.878680 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:37.879264 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:37.879792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'aabb3fd5-bfb4-489e-8aa5-efc015182123', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53b198980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53b1982c0>]}
[0m22:06:37.880251 [info ] [MainThread]: 
[0m22:06:37.880734 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:37.890962 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.72705317, "process_user_time": 1.53077, "process_kernel_time": 0.147073, "process_mem_max_rss": "101828", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:37.891525 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:37.891422 after 0.73 seconds
[0m22:06:37.891942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53b4377a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53b56cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc53d7eb1a0>]}
[0m22:06:37.892375 [debug] [MainThread]: Flushing usage events
[0m22:06:39.668735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd92b512e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9080b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8ffcf950>]}


============================== 22:06:39.671802 | 07f61831-7c10-488c-aa9a-cde013106d34 ==============================
[0m22:06:39.671802 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:39.672440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:39.872747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8fe4ef90>]}
[0m22:06:39.931763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd91cdccb0>]}
[0m22:06:39.934306 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:39.958071 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:39.958785 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:39.959321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8fcb1c70>]}
[0m22:06:41.257700 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:41.258343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bddb350>]}
[0m22:06:41.489356 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:41.494798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bb78980>]}
[0m22:06:41.591409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bb19df0>]}
[0m22:06:41.591925 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:41.592464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bbdaa20>]}
[0m22:06:41.594279 [info ] [MainThread]: 
[0m22:06:41.594998 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:41.599646 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:41.633853 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:41.634300 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:41.634682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:42.118118 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.119955 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:42.121170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:42.121788 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:42.130250 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.130778 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:42.131309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.132436 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.134095 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.134645 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:42.135367 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.135779 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.136232 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:42.136884 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.137949 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.138387 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.138785 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.139363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.139789 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:42.141166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:42.147512 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.148033 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:42.148480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.149180 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.149642 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.150062 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:42.161782 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.163266 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:42.164494 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:42.164891 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:42.167228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bbd6810>]}
[0m22:06:42.167738 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.168118 [debug] [MainThread]: On master: BEGIN
[0m22:06:42.168500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:42.169097 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.169524 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.169887 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.170259 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.170775 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.171193 [debug] [MainThread]: On master: Close
[0m22:06:42.171723 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:42.172235 [info ] [MainThread]: 
[0m22:06:42.191027 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:42.191623 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:42.192266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:42.192703 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:42.219858 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:42.220731 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:42.256835 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:42.257715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.131366 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.131853 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:54.132518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.132949 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.133387 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:54.134061 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.136969 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.137423 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:54.138080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.154671 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.155124 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.155565 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.157016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.162600 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.163055 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:54.165002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.167376 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:54.168886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8a725e20>]}
[0m22:06:54.169571 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.98s]
[0m22:06:54.170390 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:54.171241 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:54.171793 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:54.172577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:54.173012 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:54.177899 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:54.178541 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:54.214469 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.214953 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250715220654208490"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:54.215423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.223242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.230804 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.231350 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:54.232014 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.232552 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.232968 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250715220654208490'
      
      
      order by ordinal_position

  
[0m22:06:54.236007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.241188 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.241644 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.243783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.251419 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.251872 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.254599 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.272778 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:54.273476 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.273936 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250715220654208490"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250715220654208490"
    )
  
[0m22:06:54.324834 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.326820 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.327295 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.327701 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.337283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.338165 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:54.339699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f61831-7c10-488c-aa9a-cde013106d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd51cff9e0>]}
[0m22:06:54.340384 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:06:54.341102 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:54.342474 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:54.342894 [debug] [MainThread]: On master: BEGIN
[0m22:06:54.343308 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:54.343940 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:54.344375 [debug] [MainThread]: On master: COMMIT
[0m22:06:54.344836 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:54.345226 [debug] [MainThread]: On master: COMMIT
[0m22:06:54.345741 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:54.346129 [debug] [MainThread]: On master: Close
[0m22:06:54.346829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:54.347233 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:54.347630 [info ] [MainThread]: 
[0m22:06:54.348156 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.75 seconds (12.75s).
[0m22:06:54.349167 [debug] [MainThread]: Command end result
[0m22:06:54.374556 [info ] [MainThread]: 
[0m22:06:54.375162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:54.375674 [info ] [MainThread]: 
[0m22:06:54.376203 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:54.377187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.757243, "process_user_time": 5.138785, "process_kernel_time": 0.273935, "process_mem_max_rss": "338488", "process_in_blocks": "1200", "process_out_blocks": "100152"}
[0m22:06:54.377716 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:54.377615 after 14.76 seconds
[0m22:06:54.378175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd90be5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd900cc860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8bb193d0>]}
[0m22:06:54.378597 [debug] [MainThread]: Flushing usage events
[0m22:06:56.323267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abf787680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abf07efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abf07ccb0>]}


============================== 22:06:56.326368 | 95fa7ffe-f6a5-4e22-86a0-17caea396030 ==============================
[0m22:06:56.326368 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:56.326999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:56.434372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95fa7ffe-f6a5-4e22-86a0-17caea396030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac0353440>]}
[0m22:06:56.451700 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1783122, "process_user_time": 1.325029, "process_kernel_time": 0.103923, "process_mem_max_rss": "100612", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:56.452240 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:56.452119 after 0.18 seconds
[0m22:06:56.452683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abebec500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abe9575f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abe905f70>]}
[0m22:06:56.453089 [debug] [MainThread]: Flushing usage events
[0m06:02:22.133185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef604d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef5ace3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef5acd9d0>]}


============================== 06:02:22.148970 | fe0263f7-afe7-4523-98b3-40ac2073f6c9 ==============================
[0m06:02:22.148970 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:22.149595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:22.282135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe0263f7-afe7-4523-98b3-40ac2073f6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef57e3c80>]}
[0m06:02:22.296398 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-c_151u01'
[0m06:02:22.296846 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:22.461089 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:22.461670 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:22.484325 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:22.488101 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:22.556772 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:22.557253 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:22.557780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fe0263f7-afe7-4523-98b3-40ac2073f6c9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef4ec3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef4ec36b0>]}
[0m06:02:22.558198 [info ] [MainThread]: 
[0m06:02:22.558651 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:22.566816 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4823665, "process_user_time": 1.539886, "process_kernel_time": 0.136078, "process_mem_max_rss": "101216", "process_in_blocks": "8744", "process_out_blocks": "5168"}
[0m06:02:22.567342 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:22.567241 after 0.48 seconds
[0m06:02:22.567766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef529c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef529f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ef5185c40>]}
[0m06:02:22.568186 [debug] [MainThread]: Flushing usage events
[0m06:02:24.167576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e255910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e7eb770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e254680>]}


============================== 06:02:24.170612 | 8b2c16f7-faaf-4259-ba0e-97c5c525244b ==============================
[0m06:02:24.170612 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.171275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.370525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22a11a1b0>]}
[0m06:02:24.428430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22ffd8c80>]}
[0m06:02:24.430961 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:24.454388 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:24.455099 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:24.455606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22a119c70>]}
[0m06:02:25.753023 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:25.753550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22ffd8a70>]}
[0m06:02:25.970929 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:25.976275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e27d940>]}
[0m06:02:26.079676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe229e57cb0>]}
[0m06:02:26.080189 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:26.080703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe229ef1ee0>]}
[0m06:02:26.082479 [info ] [MainThread]: 
[0m06:02:26.083143 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:26.087686 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:26.121488 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:26.121930 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:26.122313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:26.611513 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.613913 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:26.615271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:26.616105 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:26.624951 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.625370 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:26.625768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:26.626708 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.628031 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.628419 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:26.628959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.629341 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.629703 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:26.630307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.631237 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:26.631624 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.632007 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:26.632556 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.632992 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:26.634193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:26.639837 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:26.640323 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:26.640690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:26.641303 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.641688 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:26.642084 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:26.651535 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.652979 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:26.654206 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:26.654607 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:26.656873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe229f683e0>]}
[0m06:02:26.657371 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.657775 [debug] [MainThread]: On master: BEGIN
[0m06:02:26.658134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:26.658717 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.659140 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.659504 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.659881 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.660451 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.660864 [debug] [MainThread]: On master: Close
[0m06:02:26.661364 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:26.661847 [info ] [MainThread]: 
[0m06:02:26.686022 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:26.686590 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:26.687183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:26.687608 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:26.713873 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:26.714599 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:26.749326 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:26.750048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:34.254565 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.255070 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:34.255741 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.256173 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.256589 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:34.257321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.260166 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.260601 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:34.261270 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.277667 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:34.278153 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.278572 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:34.279633 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.285167 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.285618 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:34.286763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.289051 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:34.290530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2289c1e50>]}
[0m06:02:34.291216 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.60s]
[0m06:02:34.291982 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:34.292821 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:34.293377 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:34.294146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:34.294586 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:34.299405 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:34.300038 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:34.335622 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.336129 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250716060234329630"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:34.336577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:34.344074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.351394 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.351876 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:34.352467 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.352923 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.353336 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250716060234329630'
      
      
      order by ordinal_position

  
[0m06:02:34.355413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.360423 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.360896 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:34.362954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.370381 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.370850 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:34.373179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.391000 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:34.391637 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.392109 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250716060234329630"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250716060234329630"
    )
  
[0m06:02:34.441268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.443258 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:34.443704 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:34.444142 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:34.450907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.451814 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:34.453272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2c16f7-faaf-4259-ba0e-97c5c525244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1f0fe3aa0>]}
[0m06:02:34.453958 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:34.454691 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:34.455986 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:34.456394 [debug] [MainThread]: On master: BEGIN
[0m06:02:34.456786 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:34.457409 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:34.457832 [debug] [MainThread]: On master: COMMIT
[0m06:02:34.458205 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:34.458565 [debug] [MainThread]: On master: COMMIT
[0m06:02:34.459117 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:34.459505 [debug] [MainThread]: On master: Close
[0m06:02:34.460195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:34.460576 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:34.461004 [info ] [MainThread]: 
[0m06:02:34.461462 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.38 seconds (8.38s).
[0m06:02:34.462400 [debug] [MainThread]: Command end result
[0m06:02:34.489060 [info ] [MainThread]: 
[0m06:02:34.489655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:34.490133 [info ] [MainThread]: 
[0m06:02:34.490586 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:34.491528 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.372398, "process_user_time": 5.058285, "process_kernel_time": 0.255115, "process_mem_max_rss": "340888", "process_in_blocks": "1200", "process_out_blocks": "99944"}
[0m06:02:34.492111 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:34.492008 after 10.37 seconds
[0m06:02:34.492548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22ec87f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e27d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22e672630>]}
[0m06:02:34.492994 [debug] [MainThread]: Flushing usage events
[0m06:02:36.275928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda84dc41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda847b8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda84385910>]}


============================== 06:02:36.278785 | d7f03ad2-8ec7-4939-a39d-e05b19251acb ==============================
[0m06:02:36.278785 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:36.279404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:36.383775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7f03ad2-8ec7-4939-a39d-e05b19251acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda844032f0>]}
[0m06:02:36.401004 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17326723, "process_user_time": 1.278813, "process_kernel_time": 0.123885, "process_mem_max_rss": "100716", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:36.401505 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:36.401406 after 0.17 seconds
[0m06:02:36.401930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda84ffc980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda842d5ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda844f8e00>]}
[0m06:02:36.402326 [debug] [MainThread]: Flushing usage events
[0m14:06:12.632996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6c0285f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6abfb0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6a2b20f0>]}


============================== 14:06:12.648999 | 6603dc7b-2553-4b12-bc47-5a0d288b1481 ==============================
[0m14:06:12.648999 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:12.649624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:12.768487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6603dc7b-2553-4b12-bc47-5a0d288b1481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf69ebb2f0>]}
[0m14:06:12.783486 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fs0yalhe'
[0m14:06:12.783969 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:12.859521 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:12.860265 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:12.872290 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:12.876291 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:12.928017 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:12.928534 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:06:12.929066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6603dc7b-2553-4b12-bc47-5a0d288b1481', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf69bc7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6af080e0>]}
[0m14:06:12.929503 [info ] [MainThread]: 
[0m14:06:12.929964 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:12.935546 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3514694, "process_user_time": 1.558616, "process_kernel_time": 0.132052, "process_mem_max_rss": "101680", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m14:06:12.936109 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:12.936008 after 0.35 seconds
[0m14:06:12.936531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6a2d5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf69c28140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf69c28380>]}
[0m14:06:12.936979 [debug] [MainThread]: Flushing usage events
[0m14:06:14.546089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa1b64470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa1e80f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa19ff7d0>]}


============================== 14:06:14.549226 | e11eaf46-d5d0-4fb8-b904-6ba3366f0659 ==============================
[0m14:06:14.549226 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:14.549942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:14.752298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0a774d0>]}
[0m14:06:14.811297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0b871d0>]}
[0m14:06:14.814052 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:06:14.838777 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:14.839473 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:14.840004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0d30d10>]}
[0m14:06:16.119571 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:16.120228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0b0ac00>]}
[0m14:06:16.360569 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:16.366226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa293b680>]}
[0m14:06:16.469246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9c9f1190>]}
[0m14:06:16.469881 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m14:06:16.470409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9c9ddb50>]}
[0m14:06:16.472336 [info ] [MainThread]: 
[0m14:06:16.473068 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:16.477823 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:16.513560 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:16.514129 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:16.514558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:17.025084 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:06:17.027141 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:17.028323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:17.029066 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:17.037651 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.038109 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:17.038502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:17.039633 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.041032 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.041424 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:17.042029 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.042416 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.042811 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:17.043416 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.044370 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:17.044776 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:17.045142 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:17.045687 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.046130 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:17.047505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:17.053575 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:17.054103 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:17.054467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:17.055199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.055585 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:17.056009 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:17.066307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:17.068171 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:17.069567 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:17.070020 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:17.072428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9b3503e0>]}
[0m14:06:17.073030 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:17.073422 [debug] [MainThread]: On master: BEGIN
[0m14:06:17.073819 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:17.074600 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:17.075032 [debug] [MainThread]: On master: COMMIT
[0m14:06:17.075421 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:17.075803 [debug] [MainThread]: On master: COMMIT
[0m14:06:17.076369 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:17.076812 [debug] [MainThread]: On master: Close
[0m14:06:17.077409 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:17.077925 [info ] [MainThread]: 
[0m14:06:17.089903 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:17.090591 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:17.091254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:17.091697 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:17.119376 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:17.120338 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:17.156656 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:17.157611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:23.705359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.705901 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:23.706531 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.706995 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.707408 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:23.708116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.711197 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.711634 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:23.712322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.728979 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:23.729449 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.729889 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:23.731851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.737668 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:23.738144 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:23.740068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.742456 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:23.744010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5eba48f0>]}
[0m14:06:23.744679 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.65s]
[0m14:06:23.745508 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:23.746346 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:23.746979 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:23.747662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:23.748236 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:23.753206 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:23.753872 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:23.790247 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.790846 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250716140623784138"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:23.791321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:23.799614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.807744 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.808205 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:23.808882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.809314 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.809746 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250716140623784138'
      
      
      order by ordinal_position

  
[0m14:06:23.812285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.817467 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.817945 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:23.820897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.828580 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.829059 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:23.831808 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.849906 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:23.850594 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.851065 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250716140623784138"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250716140623784138"
    )
  
[0m14:06:23.897929 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.899989 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:23.900442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:23.900875 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:23.908342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:23.909246 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:23.910719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11eaf46-d5d0-4fb8-b904-6ba3366f0659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f900d6060>]}
[0m14:06:23.911410 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:06:23.912146 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:23.913493 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:23.913929 [debug] [MainThread]: On master: BEGIN
[0m14:06:23.914291 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:23.914929 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:23.915319 [debug] [MainThread]: On master: COMMIT
[0m14:06:23.915679 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:23.916070 [debug] [MainThread]: On master: COMMIT
[0m14:06:23.916581 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:23.916997 [debug] [MainThread]: On master: Close
[0m14:06:23.917589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:23.917997 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:23.918393 [info ] [MainThread]: 
[0m14:06:23.918885 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.45 seconds (7.45s).
[0m14:06:23.919836 [debug] [MainThread]: Command end result
[0m14:06:23.945858 [info ] [MainThread]: 
[0m14:06:23.946448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:23.946933 [info ] [MainThread]: 
[0m14:06:23.947416 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:23.948407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.451223, "process_user_time": 5.203976, "process_kernel_time": 0.292617, "process_mem_max_rss": "334352", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m14:06:23.948969 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:23.948863 after 9.45 seconds
[0m14:06:23.949395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa38ed1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fa0e135f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5e9d3560>]}
[0m14:06:23.949827 [debug] [MainThread]: Flushing usage events
[0m14:06:25.833688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff52914d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5297c4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5297c40e0>]}


============================== 14:06:25.836958 | 321da84a-e5c0-4a21-8797-f34a97dc65a2 ==============================
[0m14:06:25.836958 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:25.837591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:25.945080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '321da84a-e5c0-4a21-8797-f34a97dc65a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff528d02cf0>]}
[0m14:06:25.963382 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17884552, "process_user_time": 1.34691, "process_kernel_time": 0.11091, "process_mem_max_rss": "100768", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:06:25.963952 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:25.963846 after 0.18 seconds
[0m14:06:25.964372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5297c4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff529b64230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff528c16a20>]}
[0m14:06:25.964807 [debug] [MainThread]: Flushing usage events
[0m22:06:26.799923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02d195580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02dec3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02dbe7e60>]}


============================== 22:06:26.815508 | 151c28ef-8ade-4cd5-a1fe-d2d0b0fb68f4 ==============================
[0m22:06:26.815508 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:26.816194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:26.940088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '151c28ef-8ade-4cd5-a1fe-d2d0b0fb68f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02cf4b2f0>]}
[0m22:06:26.954701 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2n04ynic'
[0m22:06:26.955158 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:27.051671 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:27.052336 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:27.062519 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:27.066363 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:27.272176 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:27.272777 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:27.273360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '151c28ef-8ade-4cd5-a1fe-d2d0b0fb68f4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02cb100b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02dd10260>]}
[0m22:06:27.273847 [info ] [MainThread]: 
[0m22:06:27.274355 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:27.281412 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5302712, "process_user_time": 1.574517, "process_kernel_time": 0.132295, "process_mem_max_rss": "101436", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m22:06:27.281984 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:27.281881 after 0.53 seconds
[0m22:06:27.282402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02dec3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02d1b4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02cab9f40>]}
[0m22:06:27.282829 [debug] [MainThread]: Flushing usage events
[0m22:06:29.048671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a852a54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a858d86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a86d39580>]}


============================== 22:06:29.051667 | be82b3f8-3659-458c-9cdb-17cdf8fef51a ==============================
[0m22:06:29.051667 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:29.052370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:29.253262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a86973380>]}
[0m22:06:29.311481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a85dd0e60>]}
[0m22:06:29.314048 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m22:06:29.339324 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:29.340047 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:29.340560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a80b01df0>]}
[0m22:06:30.625685 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:30.626357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a80a7dac0>]}
[0m22:06:30.858309 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:30.863782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a84dc0b30>]}
[0m22:06:30.963484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8066a810>]}
[0m22:06:30.964123 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m22:06:30.964630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a80681520>]}
[0m22:06:30.966561 [info ] [MainThread]: 
[0m22:06:30.967297 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:30.972180 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:31.009706 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:31.010191 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:31.010585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:31.478929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.481216 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:31.482551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:31.483279 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:31.491985 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.492412 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:31.492813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:31.493733 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.495048 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.495439 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:31.496043 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.496427 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.496832 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:31.497427 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.498364 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:31.498779 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:31.499150 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:31.499762 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.500164 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:31.501424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:31.507151 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:31.507553 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:31.507937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:31.508656 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.509086 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:31.509462 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:31.518986 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:31.520418 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:31.521655 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:31.522073 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:31.524285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a869d5100>]}
[0m22:06:31.524812 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.525200 [debug] [MainThread]: On master: BEGIN
[0m22:06:31.525560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:31.526178 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.526571 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.526986 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.527349 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.527874 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.528267 [debug] [MainThread]: On master: Close
[0m22:06:31.528807 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:31.529267 [info ] [MainThread]: 
[0m22:06:31.546808 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:31.547392 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:31.547983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:31.548425 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:31.574966 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:31.575705 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:31.610832 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:31.611601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:42.044049 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.044535 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:42.045212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.045645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.046094 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:42.046842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.049732 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.050186 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:42.050889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.067404 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:42.067902 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.068324 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:42.069437 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.075042 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:42.075497 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:42.076675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.079011 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:42.080529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7f26eb40>]}
[0m22:06:42.081235 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.53s]
[0m22:06:42.081998 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:42.082907 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:42.083561 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:42.084178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:42.084609 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:42.089490 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:42.090149 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:42.126115 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.126600 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250716220642120108"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:42.127071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:42.134800 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.142144 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.142594 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:42.143204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.143636 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.144087 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250716220642120108'
      
      
      order by ordinal_position

  
[0m22:06:42.146222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.151274 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.151757 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:42.153839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.161398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.161877 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:42.164237 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.182100 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:42.182775 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.183231 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250716220642120108"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250716220642120108"
    )
  
[0m22:06:42.230104 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.232103 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:42.232548 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:42.232984 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:42.239972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:42.240865 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:42.242388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be82b3f8-3659-458c-9cdb-17cdf8fef51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a46367800>]}
[0m22:06:42.243076 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:06:42.243887 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:42.245220 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.245623 [debug] [MainThread]: On master: BEGIN
[0m22:06:42.246033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:42.246647 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.247072 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.247436 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:42.247832 [debug] [MainThread]: On master: COMMIT
[0m22:06:42.248348 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:42.248756 [debug] [MainThread]: On master: Close
[0m22:06:42.249360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:42.249748 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:42.250158 [info ] [MainThread]: 
[0m22:06:42.250669 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.28 seconds (11.28s).
[0m22:06:42.251678 [debug] [MainThread]: Command end result
[0m22:06:42.277176 [info ] [MainThread]: 
[0m22:06:42.277785 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:42.278294 [info ] [MainThread]: 
[0m22:06:42.278828 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:42.279820 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.279617, "process_user_time": 5.06972, "process_kernel_time": 0.280371, "process_mem_max_rss": "345932", "process_in_blocks": "1200", "process_out_blocks": "100136"}
[0m22:06:42.280359 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:42.280257 after 13.28 seconds
[0m22:06:42.280810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a84d24b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a85da7a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a47492ab0>]}
[0m22:06:42.281240 [debug] [MainThread]: Flushing usage events
[0m22:06:44.312400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6c9755e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6ee57140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6eb3ff50>]}


============================== 22:06:44.315577 | a9494496-d521-4b29-ab8a-f33b906cb8bb ==============================
[0m22:06:44.315577 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:44.316283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:44.423630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9494496-d521-4b29-ab8a-f33b906cb8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6c657380>]}
[0m22:06:44.441652 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1781356, "process_user_time": 1.328535, "process_kernel_time": 0.109961, "process_mem_max_rss": "100620", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:44.442217 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:44.442111 after 0.18 seconds
[0m22:06:44.442640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6c8d1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6eb3ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6c38fe60>]}
[0m22:06:44.443087 [debug] [MainThread]: Flushing usage events
[0m06:02:24.765499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4167ee7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41670f3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41670a8920>]}


============================== 06:02:24.779884 | 8749df10-7965-4093-96de-f8ea67da9811 ==============================
[0m06:02:24.779884 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.780513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.890836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8749df10-7965-4093-96de-f8ea67da9811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41680009b0>]}
[0m06:02:24.905609 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ogvzcj7o'
[0m06:02:24.906075 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:25.068823 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:25.069585 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:25.111270 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:25.115282 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:25.324178 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:25.324763 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:25.325276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8749df10-7965-4093-96de-f8ea67da9811', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166efe4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166efd4f0>]}
[0m06:02:25.325752 [info ] [MainThread]: 
[0m06:02:25.326232 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:25.331134 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6152713, "process_user_time": 1.576581, "process_kernel_time": 0.125364, "process_mem_max_rss": "101292", "process_in_blocks": "8744", "process_out_blocks": "5176"}
[0m06:02:25.331669 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:25.331568 after 0.62 seconds
[0m06:02:25.332117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41679a8f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166e04380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166e04350>]}
[0m06:02:25.332524 [debug] [MainThread]: Flushing usage events
[0m06:02:27.050657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4593a9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4593a9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4593a9b50>]}


============================== 06:02:27.053780 | b319958f-50c8-4358-97be-50c6f7f36638 ==============================
[0m06:02:27.053780 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.054456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.259267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4598a9220>]}
[0m06:02:27.318377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45927d250>]}
[0m06:02:27.320968 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m06:02:27.343863 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:27.344570 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:27.345112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4553a9df0>]}
[0m06:02:28.637748 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:28.638385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4552a14c0>]}
[0m06:02:28.867722 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:28.873115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4594f27e0>]}
[0m06:02:28.967594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4550d6570>]}
[0m06:02:28.968170 [info ] [MainThread]: Found 2 models, 1 test, 525 macros
[0m06:02:28.968666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4550b7d70>]}
[0m06:02:28.970515 [info ] [MainThread]: 
[0m06:02:28.971227 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:28.976032 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:29.010773 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:29.011206 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:29.011595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:29.476250 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.477908 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:29.479031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:29.479677 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:29.487564 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.488031 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:29.488410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.489514 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.490868 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.491260 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:29.491856 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.492254 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.492619 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:29.493220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.494145 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.494536 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.494924 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.495453 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.495871 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:29.497115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:29.502913 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.503401 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:29.503790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.504380 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.504785 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.505158 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:29.515346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.516817 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:29.518052 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:29.518442 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:29.520824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff455187dd0>]}
[0m06:02:29.521321 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.521752 [debug] [MainThread]: On master: BEGIN
[0m06:02:29.522125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:29.522759 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.523163 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.523544 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.523972 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.524498 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.524912 [debug] [MainThread]: On master: Close
[0m06:02:29.525427 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:29.525903 [info ] [MainThread]: 
[0m06:02:29.543799 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:29.544418 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:29.545022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:29.545461 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:29.572837 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:29.573575 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:29.609088 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:29.609840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:38.774023 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.774515 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:38.775162 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.775596 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.776038 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:38.776732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.779648 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.780108 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:38.780773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.797465 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.797944 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.798362 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.800028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.805753 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.806206 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:02:38.807558 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.809911 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:38.811432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff453c24680>]}
[0m06:02:38.812123 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.27s]
[0m06:02:38.812951 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:38.813785 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:38.814355 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:38.814997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:38.815461 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:38.820553 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:38.821219 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:38.857666 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.858197 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250717060238851555"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:38.858653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:38.866702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.874630 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.875118 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:38.875773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.876207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.876622 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250717060238851555'
      
      
      order by ordinal_position

  
[0m06:02:38.878769 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.883956 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.884427 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:38.886908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.894612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.895092 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:38.898048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.916282 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:38.916989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.917456 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250717060238851555"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250717060238851555"
    )
  
[0m06:02:38.967289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.969322 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:38.969814 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.970236 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:38.977017 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.977951 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:38.979473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b319958f-50c8-4358-97be-50c6f7f36638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff421d905c0>]}
[0m06:02:38.980184 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:02:38.981022 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:38.982365 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:38.982810 [debug] [MainThread]: On master: BEGIN
[0m06:02:38.983190 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:38.983867 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:38.984271 [debug] [MainThread]: On master: COMMIT
[0m06:02:38.984655 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:38.985065 [debug] [MainThread]: On master: COMMIT
[0m06:02:38.985614 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:38.986039 [debug] [MainThread]: On master: Close
[0m06:02:38.986635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:38.987039 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:38.987441 [info ] [MainThread]: 
[0m06:02:38.987981 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.02 seconds (10.02s).
[0m06:02:38.988994 [debug] [MainThread]: Command end result
[0m06:02:39.015121 [info ] [MainThread]: 
[0m06:02:39.015740 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:39.016255 [info ] [MainThread]: 
[0m06:02:39.016790 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:39.017806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.016199, "process_user_time": 5.101509, "process_kernel_time": 0.282415, "process_mem_max_rss": "339416", "process_in_blocks": "1200", "process_out_blocks": "100112"}
[0m06:02:39.018345 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:39.018241 after 12.02 seconds
[0m06:02:39.018801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4593a9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff459866720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff417039fa0>]}
[0m06:02:39.019232 [debug] [MainThread]: Flushing usage events
[0m06:02:40.969133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd971f81a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd973082ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd973083a10>]}


============================== 06:02:40.972221 | 2bef1067-5902-4bc1-b9d9-144ac25d8a11 ==============================
[0m06:02:40.972221 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:40.972915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:41.081320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bef1067-5902-4bc1-b9d9-144ac25d8a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd972989dc0>]}
[0m06:02:41.099653 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17934872, "process_user_time": 1.349669, "process_kernel_time": 0.100975, "process_mem_max_rss": "100732", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:41.100212 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:41.100109 after 0.18 seconds
[0m06:02:41.100650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9764d38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd972989dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd971f03110>]}
[0m06:02:41.101107 [debug] [MainThread]: Flushing usage events
