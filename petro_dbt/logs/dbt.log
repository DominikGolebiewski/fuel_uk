[0m06:02:09.649918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92fad8e7b0>]}
[0m06:02:09.651722 [info ] [MainThread]: 
[0m06:02:09.652425 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:09.657165 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:09.692544 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:09.693029 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:09.693441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:10.261445 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:10.263007 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:10.265159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:10.265719 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:10.272928 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.273363 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:10.273763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.280185 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.281687 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.282088 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:10.282625 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.283017 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.283390 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:10.283977 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.284929 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.285331 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.285703 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.286238 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.286642 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:10.288539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:10.295660 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.296071 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:10.296485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.302644 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.303059 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.303459 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:10.327573 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.329185 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:10.330451 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:10.330870 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:10.334493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9303b80dd0>]}
[0m06:02:10.335038 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.335437 [debug] [MainThread]: On master: BEGIN
[0m06:02:10.335813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:10.342252 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.342680 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.343067 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.343443 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.343976 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.344414 [debug] [MainThread]: On master: Close
[0m06:02:10.345736 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:10.346281 [info ] [MainThread]: 
[0m06:02:10.372933 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:10.373536 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:10.374273 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:10.374721 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:10.400593 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:10.401345 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:10.436877 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:10.437661 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:18.192676 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.193188 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:18.193857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.194307 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.194739 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:18.195442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.198374 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.198855 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:18.199531 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.220328 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:18.220827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.221263 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:18.223188 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.228133 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.228625 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:18.229823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.232119 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:18.261362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93034fe930>]}
[0m06:02:18.262116 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.89s]
[0m06:02:18.262874 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:18.263886 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:18.264490 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:18.265076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:18.265531 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:18.270840 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:18.271496 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:18.305170 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.305686 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241027060218299187"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:18.306159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:18.320021 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.327426 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.327886 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:18.328570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.329034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.329476 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241027060218299187'
      
      
      order by ordinal_position

  
[0m06:02:18.349766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.356284 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.356796 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:18.360937 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.368443 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.368929 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:18.371629 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.389509 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:18.390200 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.390664 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241027060218299187"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241027060218299187"
    )
  
[0m06:02:18.422636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.424602 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:18.425070 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.425492 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:18.433663 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.434559 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:18.626046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92b79650d0>]}
[0m06:02:18.626860 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m06:02:18.627614 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:18.629128 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.629594 [debug] [MainThread]: On master: BEGIN
[0m06:02:18.630015 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:18.637134 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.637802 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.638440 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.639067 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.639938 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.640626 [debug] [MainThread]: On master: Close
[0m06:02:18.642446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:18.642881 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:18.643278 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:18.643731 [info ] [MainThread]: 
[0m06:02:18.644274 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.99 seconds (8.99s).
[0m06:02:18.645340 [debug] [MainThread]: Command end result
[0m06:02:18.673207 [info ] [MainThread]: 
[0m06:02:18.673854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:18.674389 [info ] [MainThread]: 
[0m06:02:18.674937 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:18.675949 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.988357, "process_user_time": 5.635993, "process_kernel_time": 0.319999, "process_mem_max_rss": "291348", "process_in_blocks": "3808", "process_out_blocks": "116200"}
[0m06:02:18.676626 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:18.676515 after 10.99 seconds
[0m06:02:18.677137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9303398590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92fad60f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9302a747d0>]}
[0m06:02:18.677620 [debug] [MainThread]: Flushing usage events
[0m06:02:20.358883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b792570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97c0c0a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97c0c3b60>]}


============================== 06:02:20.361679 | 4262b812-ebd9-4f29-9045-c1575eadd653 ==============================
[0m06:02:20.361679 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:20.362399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.503733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4262b812-ebd9-4f29-9045-c1575eadd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b6f6b40>]}
[0m06:02:20.520439 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20978114, "process_user_time": 1.4195, "process_kernel_time": 0.087969, "process_mem_max_rss": "92276", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:20.521010 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:20.520908 after 0.21 seconds
[0m06:02:20.521433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97ba5f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b5b2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b5b1070>]}
[0m06:02:20.521850 [debug] [MainThread]: Flushing usage events
[0m14:05:16.133926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa339460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa45a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa33bf20>]}


============================== 14:05:16.141725 | 78023bc8-b36b-4e15-8dbb-9e1204979c39 ==============================
[0m14:05:16.141725 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:16.142500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:16.286222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78023bc8-b36b-4e15-8dbb-9e1204979c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa00b260>]}
[0m14:05:16.299845 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-099ghjmk'
[0m14:05:16.300322 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:16.326602 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:16.327230 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:16.338031 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:16.341870 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:16.557757 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:16.558339 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:16.558902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '78023bc8-b36b-4e15-8dbb-9e1204979c39', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa1a2c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea9f03d10>]}
[0m14:05:16.559370 [info ] [MainThread]: 
[0m14:05:16.559857 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:16.561652 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47698292, "process_user_time": 1.583668, "process_kernel_time": 0.134611, "process_mem_max_rss": "93512", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:16.562249 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:16.562145 after 0.48 seconds
[0m14:05:16.562742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa3371d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa1dc500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eab1b6b40>]}
[0m14:05:16.563165 [debug] [MainThread]: Flushing usage events
[0m14:05:18.540090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f6a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f7320>]}


============================== 14:05:18.543201 | cefd4d58-25b2-4a5b-9398-c93bead4f291 ==============================
[0m14:05:18.543201 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:18.543966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:18.793095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2298e660>]}
[0m14:05:18.853624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e29865af0>]}
[0m14:05:18.856407 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:18.931958 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:18.932772 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:18.933327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e298b3800>]}
[0m14:05:20.175385 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:20.176098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e227d0350>]}
[0m14:05:20.363487 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:20.369172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e227331d0>]}
[0m14:05:20.510975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2218fb90>]}
[0m14:05:20.511585 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:20.512131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e222e19a0>]}
[0m14:05:20.514002 [info ] [MainThread]: 
[0m14:05:20.514805 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:20.519774 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:20.556651 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:20.557188 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:20.557627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:21.007736 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.009411 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:21.011778 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:21.012363 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:21.019736 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.020177 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:21.020622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:21.027359 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.028853 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.029264 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:21.029826 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.030221 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.030640 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:21.031213 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.032133 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:21.032551 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.032925 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:21.033465 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.033873 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:21.036016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:21.043578 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:21.043991 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:21.044366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:21.050268 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.050726 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:21.051125 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:21.075283 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.077179 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:21.078596 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:21.079048 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:21.083255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2bf11340>]}
[0m14:05:21.083816 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.084226 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.084617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:21.091686 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.092129 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.092543 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.092930 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.093567 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.093987 [debug] [MainThread]: On master: Close
[0m14:05:21.095895 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:21.096411 [info ] [MainThread]: 
[0m14:05:21.106564 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:21.107237 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:21.107981 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:21.108445 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:21.135946 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:21.136902 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:21.174126 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:21.175093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:30.068868 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.069469 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:30.070311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.070822 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.071273 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:30.072130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.075574 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.076049 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:30.076828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.100428 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.101171 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.101686 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.114045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.120552 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.121056 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:30.145156 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.149021 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:30.208242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e221b8a70>]}
[0m14:05:30.209234 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.10s]
[0m14:05:30.210238 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:30.211494 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:30.212410 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:30.213314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:30.213879 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:30.223198 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:30.224161 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:30.268421 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.269063 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241027140530261605"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:30.269580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:30.287902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.296323 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.296837 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:30.297567 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.298034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.298505 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241027140530261605'
      
      
      order by ordinal_position

  
[0m14:05:30.323366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.334147 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.334937 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.339807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.351373 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.351860 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.354832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.373289 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:30.374027 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.374561 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241027140530261605"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241027140530261605"
    )
  
[0m14:05:30.411051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.413283 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.413799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.414246 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.561348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.562508 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:30.754709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de2d56b40>]}
[0m14:05:30.755538 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.54s]
[0m14:05:30.756296 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:30.757739 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:30.758217 [debug] [MainThread]: On master: BEGIN
[0m14:05:30.758757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:30.765582 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:30.766063 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.766542 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:30.766967 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.767586 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:30.768038 [debug] [MainThread]: On master: Close
[0m14:05:30.769509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:30.769940 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:30.770339 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:30.770884 [info ] [MainThread]: 
[0m14:05:30.771481 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.26 seconds (10.26s).
[0m14:05:30.772614 [debug] [MainThread]: Command end result
[0m14:05:30.801005 [info ] [MainThread]: 
[0m14:05:30.801753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:30.802365 [info ] [MainThread]: 
[0m14:05:30.803009 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:30.804135 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.313357, "process_user_time": 5.773754, "process_kernel_time": 0.323874, "process_mem_max_rss": "302296", "process_in_blocks": "3808", "process_out_blocks": "116696"}
[0m14:05:30.804785 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:30.804673 after 12.31 seconds
[0m14:05:30.805288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e29eb4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de2d9f7a0>]}
[0m14:05:30.805783 [debug] [MainThread]: Flushing usage events
[0m14:05:32.764828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f962e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f9610d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f962660>]}


============================== 14:05:32.767764 | 71eccba0-e1bc-4284-8aef-e2ee42a7aeeb ==============================
[0m14:05:32.767764 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:32.768481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:32.908977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71eccba0-e1bc-4284-8aef-e2ee42a7aeeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573fb3b200>]}
[0m14:05:32.925760 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20939516, "process_user_time": 1.402786, "process_kernel_time": 0.107906, "process_mem_max_rss": "92196", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:32.926347 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:32.926246 after 0.21 seconds
[0m14:05:32.926826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57406c8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573fa0fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f9aa060>]}
[0m14:05:32.927248 [debug] [MainThread]: Flushing usage events
[0m22:06:37.818970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd1479340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd185d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd3822270>]}


============================== 22:06:37.826466 | 90ac5466-6416-4b1c-85b1-1e85a1d0e0ad ==============================
[0m22:06:37.826466 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:37.827200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:37.979993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90ac5466-6416-4b1c-85b1-1e85a1d0e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd147bd40>]}
[0m22:06:37.994808 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mnavaskj'
[0m22:06:37.995340 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:38.062625 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:38.063472 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:38.098596 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:38.102810 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:38.462267 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:38.462926 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:38.463490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '90ac5466-6416-4b1c-85b1-1e85a1d0e0ad', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd12afc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd12ac3e0>]}
[0m22:06:38.463984 [info ] [MainThread]: 
[0m22:06:38.464510 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:38.466498 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6955928, "process_user_time": 1.603294, "process_kernel_time": 0.140288, "process_mem_max_rss": "93640", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:06:38.467094 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:38.466989 after 0.70 seconds
[0m22:06:38.467535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd18ea360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd11efe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd117e7e0>]}
[0m22:06:38.467969 [debug] [MainThread]: Flushing usage events
[0m22:06:40.277643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3219afef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3219cb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3219af6b0>]}


============================== 22:06:40.280812 | 33dad61b-4949-4309-8e77-a24b0795d7a0 ==============================
[0m22:06:40.280812 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:40.281603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:40.546518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa320ef8410>]}
[0m22:06:40.609342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa321abfef0>]}
[0m22:06:40.612131 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:40.632020 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:40.632875 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:40.633460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa321c05af0>]}
[0m22:06:41.875403 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:41.876121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31987a000>]}
[0m22:06:42.059627 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:42.065035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa319f3ad80>]}
[0m22:06:42.193864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3197a8440>]}
[0m22:06:42.194451 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:42.194931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa319817ce0>]}
[0m22:06:42.196701 [info ] [MainThread]: 
[0m22:06:42.197466 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:42.202403 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:42.238996 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:42.239516 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:42.239922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:42.932482 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:42.934054 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:42.936259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:42.936887 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:42.944032 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.944502 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:42.944898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.951491 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.953061 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.953476 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:42.954021 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.954423 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.954799 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:42.955418 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.956386 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.956786 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.957159 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.957699 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.958106 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:42.960208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:42.967557 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.967981 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:42.968397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.974563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.974999 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.975403 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:42.999698 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:43.001525 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:43.002845 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:43.003264 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:43.007359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3215ff860>]}
[0m22:06:43.007903 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:43.008343 [debug] [MainThread]: On master: BEGIN
[0m22:06:43.008740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:43.016047 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:43.016639 [debug] [MainThread]: On master: COMMIT
[0m22:06:43.017044 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:43.017436 [debug] [MainThread]: On master: COMMIT
[0m22:06:43.018005 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:43.018436 [debug] [MainThread]: On master: Close
[0m22:06:43.020478 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:43.021041 [info ] [MainThread]: 
[0m22:06:43.030895 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:43.031554 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:43.032269 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:43.032768 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:43.060219 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:43.061163 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:43.098459 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:43.099537 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:54.141664 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.142226 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:54.142945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.143402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.143843 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:54.144705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.147879 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.148383 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:54.149198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.171129 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.171738 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.172198 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.175132 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.180832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.181370 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:54.182898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.185439 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:54.216838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31970bb00>]}
[0m22:06:54.217685 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.18s]
[0m22:06:54.218484 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:54.219513 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:54.220082 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:54.220817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:54.221283 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:54.226786 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:54.227500 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:54.262615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.263238 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241027220654256372"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:54.263725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.279952 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.288496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.289063 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:54.289882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.290335 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.290781 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241027220654256372'
      
      
      order by ordinal_position

  
[0m22:06:54.312563 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.319878 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.320447 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.323597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.331691 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.332216 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.335620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.354596 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:54.355433 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.355923 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241027220654256372"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241027220654256372"
    )
  
[0m22:06:54.389710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.391779 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.392246 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.392704 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.402481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.403507 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:55.415250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2de439610>]}
[0m22:06:55.416103 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 1.19s]
[0m22:06:55.416903 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:55.418423 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:55.418930 [debug] [MainThread]: On master: BEGIN
[0m22:06:55.419397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:55.426669 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:55.427244 [debug] [MainThread]: On master: COMMIT
[0m22:06:55.427692 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:55.428122 [debug] [MainThread]: On master: COMMIT
[0m22:06:55.428761 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:55.429217 [debug] [MainThread]: On master: Close
[0m22:06:55.430946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:55.431384 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:55.431787 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:55.432256 [info ] [MainThread]: 
[0m22:06:55.432907 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.23 seconds (13.23s).
[0m22:06:55.434057 [debug] [MainThread]: Command end result
[0m22:06:55.462748 [info ] [MainThread]: 
[0m22:06:55.463515 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:55.464121 [info ] [MainThread]: 
[0m22:06:55.464761 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:55.465895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.238665, "process_user_time": 6.932973, "process_kernel_time": 0.301608, "process_mem_max_rss": "356188", "process_in_blocks": "3808", "process_out_blocks": "130560"}
[0m22:06:55.466559 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:55.466442 after 15.24 seconds
[0m22:06:55.467080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3214d7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa32160c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2de4d2f60>]}
[0m22:06:55.467567 [debug] [MainThread]: Flushing usage events
[0m22:06:57.437108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e375e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3348140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e375f860>]}


============================== 22:06:57.440420 | f3b777d2-4608-4fbe-ac6d-442a18d0d0d2 ==============================
[0m22:06:57.440420 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:57.441225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:57.601557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3b777d2-4608-4fbe-ac6d-442a18d0d0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e2c5f710>]}
[0m22:06:57.619386 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23291159, "process_user_time": 1.489889, "process_kernel_time": 0.100126, "process_mem_max_rss": "91996", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:57.620025 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:57.619911 after 0.23 seconds
[0m22:06:57.620553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3348140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e32497f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e31f3980>]}
[0m22:06:57.621025 [debug] [MainThread]: Flushing usage events
